2018-02-08 13:32:16.104986: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2018-02-08 13:32:16.105014: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2018-02-08 13:32:16.105024: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2018-02-08 13:32:16.284426: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:893] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-02-08 13:32:16.284968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties: 
name: GeForce GTX 1060 3GB
major: 6 minor: 1 memoryClockRate (GHz) 1.7085
pciBusID 0000:01:00.0
Total memory: 2.95GiB
Free memory: 2.83GiB
2018-02-08 13:32:16.284987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0 
2018-02-08 13:32:16.284997: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y 
2018-02-08 13:32:16.285012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
/home/wilhelmb/.local/lib/python3.5/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
INFO:hpbandster:DISPATCHER: started the 'discover_worker' thread
INFO:hpbandster:DISPATCHER: started the 'job_runner' thread
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: Connected to nameserver <Pyro4.core.Proxy at 0x7feb8e320a90; connected IPv4; for PYRO:Pyro.NameServer@localhost:46307>
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: No dispatcher found. Waiting for one to initiate contact.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start listening for jobs
INFO:hpbandster:DISPATCHER: Pyro daemon running on localhost:42029
DEBUG:hpbandster:HBMASTER: only 0 worker(s) available, waiting for at least 1.
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 0 currently in the pool.
INFO:hpbandster:DISPATCHER: discovered new worker, hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
INFO:hpbandster:HBMASTER: starting run at 1518093142.4495084
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 0) to dispatcher
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 0) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 1) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 0) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 149, 'zoom_range': 0.0, 'cnn_learning_rate': 9.877898007112171e-05, 'unfreeze_percentage': 0.09295043977267939, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 80, 'batch_size': 18, 'learning_rate': 0.0025331125283159736, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:32:25.484518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
optimizing without augmentation, but including all models.
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 7s - loss: 2.2326 - acc: 0.2531 - val_loss: 2.5141 - val_acc: 0.0367
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 0)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 149, 'zoom_range': 0.0, 'cnn_learning_rate': 9.877898007112171e-05, 'unfreeze_percentage': 0.09295043977267939, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 80, 'batch_size': 18, 'learning_rate': 0.0025331125283159736, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.9633027519518083, 'info': {'runtime': 14.23002028465271, 'histories': {'loss': [2.232570621702406], 'val_loss': [2.5140538828088603], 'acc': [0.2530864307449924], 'val_acc': [0.03669724804819177]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 0)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 1)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 1) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 1) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 1) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 176, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004041981316297862, 'unfreeze_percentage': 0.23545992359585471, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 323, 'batch_size': 16, 'learning_rate': 0.00041508260566158723, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:32:38.936182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.1743 - acc: 0.2500 - val_loss: 2.3502 - val_acc: 0.0917
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 1) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 1)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 176, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004041981316297862, 'unfreeze_percentage': 0.23545992359585471, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 323, 'batch_size': 16, 'learning_rate': 0.00041508260566158723, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.9082568803921752, 'info': {'runtime': 10.506613492965698, 'histories': {'loss': [2.174257588386536], 'val_loss': [2.350217834525152], 'acc': [0.25], 'val_acc': [0.0917431196078248]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 1)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 2)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 2) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 3) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 891, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017796954308221165, 'unfreeze_percentage': 0.04478912477888884, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 109, 'batch_size': 49, 'learning_rate': 0.00034997214739956715, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:32:48.610826: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 4s - loss: 2.6343 - acc: 0.1883 - val_loss: 3.1519 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 2)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 891, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017796954308221165, 'unfreeze_percentage': 0.04478912477888884, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 109, 'batch_size': 49, 'learning_rate': 0.00034997214739956715, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.875, 'info': {'runtime': 9.592824220657349, 'histories': {'loss': [2.705921151996714], 'val_loss': [3.151902675628662], 'acc': [0.18584070303600975], 'val_acc': [0.125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 3)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 3) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 4) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 3) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 3)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 101, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002142322679453026, 'unfreeze_percentage': 0.039343754839301914, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 66, 'batch_size': 62, 'num_dense_units_2': 24, 'learning_rate': 0.00014044920247110229, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:32:57.925390: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 4s - loss: 2.3966 - acc: 0.1129 - val_loss: 2.5256 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 3)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 101, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002142322679453026, 'unfreeze_percentage': 0.039343754839301914, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 66, 'batch_size': 62, 'num_dense_units_2': 24, 'learning_rate': 0.00014044920247110229, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.875, 'info': {'runtime': 10.52906084060669, 'histories': {'loss': [2.396609306335449], 'val_loss': [2.525646686553955], 'acc': [0.11290322244167328], 'val_acc': [0.125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 3)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 4)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 4) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 5) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 4) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 4)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 465, 'zoom_range': 0.0, 'cnn_learning_rate': 3.680271454650461e-05, 'unfreeze_percentage': 0.0016935991650591342, 'rotation_range': 0, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 151, 'batch_size': 16, 'learning_rate': 0.0017884860246027638, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:33:08.499301: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 12.8414 - acc: 0.1596 - val_loss: 14.6394 - val_acc: 0.0917
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 4)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 465, 'zoom_range': 0.0, 'cnn_learning_rate': 3.680271454650461e-05, 'unfreeze_percentage': 0.0016935991650591342, 'rotation_range': 0, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 151, 'batch_size': 16, 'learning_rate': 0.0017884860246027638, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.9082568800504054, 'info': {'runtime': 8.50662612915039, 'histories': {'loss': [13.829401875195439], 'val_loss': [14.639371075761428], 'acc': [0.13013698630136986], 'val_acc': [0.09174311994959455]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 4)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 5)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 5) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 5) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 6) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 5) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 5)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 296, 'zoom_range': 0.0, 'cnn_learning_rate': 1.4216984897327262e-05, 'unfreeze_percentage': 0.09320891440551066, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 189, 'batch_size': 46, 'num_dense_units_2': 24, 'learning_rate': 0.00020065396501131485, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:33:19.905974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 13:33:24.418265: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.14GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
2018-02-08 13:33:25.043084: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.73GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
2018-02-08 13:33:25.204390: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.36GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
2018-02-08 13:33:27.138620: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.22GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.2856 - acc: 0.1162 - val_loss: 2.3732 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 5), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 5) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 5) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 5) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 5)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 296, 'zoom_range': 0.0, 'cnn_learning_rate': 1.4216984897327262e-05, 'unfreeze_percentage': 0.09320891440551066, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 189, 'batch_size': 46, 'num_dense_units_2': 24, 'learning_rate': 0.00020065396501131485, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 13.891429424285889, 'histories': {'loss': [2.286686695855239], 'val_loss': [2.3731963634490967], 'acc': [0.12068965761312123], 'val_acc': [0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 5)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 6)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 6) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 7) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 6) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 6)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 572, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001315203616347986, 'unfreeze_percentage': 0.15229636834224586, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 72, 'batch_size': 24, 'learning_rate': 0.004162324257796444, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:33:39.261530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
2018-02-08 13:33:45.961946: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.26GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
2018-02-08 13:33:47.650772: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.21GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
2018-02-08 13:33:49.793798: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.32GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 8s - loss: 2.3353 - acc: 0.0579 - val_loss: 2.3209 - val_acc: 0.0390
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 6), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 6) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 6) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 6)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 572, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001315203616347986, 'unfreeze_percentage': 0.15229636834224586, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 72, 'batch_size': 24, 'learning_rate': 0.004162324257796444, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.961038961038961, 'info': {'runtime': 22.445890426635742, 'histories': {'loss': [2.3315485767696216], 'val_loss': [2.320865742571942], 'acc': [0.05797101670633192], 'val_acc': [0.03896103896103896]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 6)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 7)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 7) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 8) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 7) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 7) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 7)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 120, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001981048156820893, 'unfreeze_percentage': 0.03896956296584437, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 202, 'batch_size': 21, 'learning_rate': 0.00023329851781989585, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:34:00.012713: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
2018-02-08 13:34:07.285396: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.11GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
2018-02-08 13:34:07.512336: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.23GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 9s - loss: 2.2791 - acc: 0.1026 - val_loss: 2.3479 - val_acc: 0.0779
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 7), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 7) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 7) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 7) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 7)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 120, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001981048156820893, 'unfreeze_percentage': 0.03896956296584437, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 202, 'batch_size': 21, 'learning_rate': 0.00023329851781989585, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.9220779215941182, 'info': {'runtime': 21.69631838798523, 'histories': {'loss': [2.2750644734565246], 'val_loss': [2.347867182322911], 'acc': [0.10638298125977212], 'val_acc': [0.07792207840588186]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 7)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 8)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 8) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 8) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 9) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 8) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 8)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 307, 'zoom_range': 0.0, 'cnn_learning_rate': 4.688045338903401e-05, 'unfreeze_percentage': 0.19513473673126944, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 295, 'batch_size': 23, 'learning_rate': 0.00011375748109017814, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:34:17.337199: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3221 - acc: 0.0823 - val_loss: 2.3128 - val_acc: 0.0649
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 8), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 8) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 8) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 8) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 8)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 307, 'zoom_range': 0.0, 'cnn_learning_rate': 4.688045338903401e-05, 'unfreeze_percentage': 0.19513473673126944, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 295, 'batch_size': 23, 'learning_rate': 0.00011375748109017814, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.9350649340973272, 'info': {'runtime': 11.961396217346191, 'histories': {'loss': [2.303434697844142], 'val_loss': [2.3128284695860626], 'acc': [0.09352518036532745], 'val_acc': [0.06493506590267281]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 8)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 9)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 9) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 9) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 10) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 9)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 227, 'zoom_range': 0.0, 'cnn_learning_rate': 1.8255770139710306e-05, 'unfreeze_percentage': 0.2284550403414534, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 214, 'batch_size': 50, 'learning_rate': 0.0019326897441673276, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
DEBUG:hpbandster:DISPATCHER: job (0, 0, 9) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
2018-02-08 13:34:33.901080: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
2018-02-08 13:34:41.025040: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.80GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 8s - loss: 3.8529 - acc: 0.0954 - val_loss: 2.3655 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 9), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 9) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 9) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 9) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 9)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 227, 'zoom_range': 0.0, 'cnn_learning_rate': 1.8255770139710306e-05, 'unfreeze_percentage': 0.2284550403414534, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 214, 'batch_size': 50, 'learning_rate': 0.0019326897441673276, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.84375, 'info': {'runtime': 20.746559143066406, 'histories': {'loss': [4.02980780175754], 'val_loss': [2.3654749393463135], 'acc': [0.09821428065853459], 'val_acc': [0.15625]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 9)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 10)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 10) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 10) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 11) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 10) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 10)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 434, 'zoom_range': 0.0, 'cnn_learning_rate': 5.842470169221864e-05, 'unfreeze_percentage': 0.11415033233164489, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 59, 'batch_size': 28, 'learning_rate': 0.0024246393202496863, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:34:55.008813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 8s - loss: 5.2531 - acc: 0.0929 - val_loss: 3.4032 - val_acc: 0.1562
/home/wilhelmb/.local/lib/python3.5/site-packages/matplotlib/pyplot.py:528: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  max_open_warning, RuntimeWarning)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 10), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 10) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 10) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 10) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 10)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 434, 'zoom_range': 0.0, 'cnn_learning_rate': 5.842470169221864e-05, 'unfreeze_percentage': 0.11415033233164489, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 59, 'batch_size': 28, 'learning_rate': 0.0024246393202496863, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.84375, 'info': {'runtime': 19.910150051116943, 'histories': {'loss': [5.253132057189942], 'val_loss': [3.4032418727874756], 'acc': [0.09285714849829674], 'val_acc': [0.15625]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 10)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 11)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 11) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 12) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 11) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 11) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 11)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 105, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002847833240117488, 'unfreeze_percentage': 0.20561416632696608, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 147, 'batch_size': 49, 'learning_rate': 0.0017572034678060117, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:35:09.085234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 4s - loss: 3.2933 - acc: 0.1170 - val_loss: 3.1173 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 11), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 11) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 11) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 11) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 11)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 105, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002847833240117488, 'unfreeze_percentage': 0.20561416632696608, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 147, 'batch_size': 49, 'learning_rate': 0.0017572034678060117, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 9.656008958816528, 'histories': {'loss': [3.3689450373691794], 'val_loss': [3.117267608642578], 'acc': [0.14159292391443676], 'val_acc': [0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 11)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 12)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 12) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 12) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 13) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 12) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 12)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 292, 'zoom_range': 0.0, 'cnn_learning_rate': 1.0710498086103887e-05, 'unfreeze_percentage': 0.23648456381880276, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 117, 'batch_size': 30, 'num_dense_units_2': 93, 'learning_rate': 0.003500362069095258, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:35:20.570936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 10.1747 - acc: 0.0800 - val_loss: 3.2788 - val_acc: 0.0781
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 12), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 12) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 12) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 12) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 12)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 292, 'zoom_range': 0.0, 'cnn_learning_rate': 1.0710498086103887e-05, 'unfreeze_percentage': 0.23648456381880276, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 117, 'batch_size': 30, 'num_dense_units_2': 93, 'learning_rate': 0.003500362069095258, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.921875, 'info': {'runtime': 12.879701614379883, 'histories': {'loss': [10.174665212631226], 'val_loss': [3.278804302215576], 'acc': [0.08000000715255737], 'val_acc': [0.078125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 12)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 13)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 13) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 13) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 14) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 13) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 13)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 349, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0006831020214714252, 'unfreeze_percentage': 0.2642007578252278, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 242, 'batch_size': 54, 'learning_rate': 0.0011044654541744778, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:35:32.301085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3769 - acc: 0.0802 - val_loss: 2.3364 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 13), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 13) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 13) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 13) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 13)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 349, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0006831020214714252, 'unfreeze_percentage': 0.2642007578252278, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 242, 'batch_size': 54, 'learning_rate': 0.0011044654541744778, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.875, 'info': {'runtime': 12.644906044006348, 'histories': {'loss': [2.376917044321696], 'val_loss': [2.3363730907440186], 'acc': [0.08024691666165988], 'val_acc': [0.125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 13)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 14)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 14) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 14) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 15) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 14) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 14)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 449, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00012696418998944746, 'unfreeze_percentage': 0.14483784154926785, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 364, 'batch_size': 25, 'learning_rate': 0.00033825819329138027, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:35:50.485976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 8s - loss: 2.4402 - acc: 0.1548 - val_loss: 2.2395 - val_acc: 0.1558
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 14), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 14) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 14) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 14) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 14)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 449, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00012696418998944746, 'unfreeze_percentage': 0.14483784154926785, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 364, 'batch_size': 25, 'learning_rate': 0.00033825819329138027, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.8441558414465421, 'info': {'runtime': 20.262996196746826, 'histories': {'loss': [2.4441325281658313], 'val_loss': [2.239477844981404], 'acc': [0.16058393839719523], 'val_acc': [0.15584415855345787]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 14)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 15)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 15) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 15) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 16) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 15) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 15)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 130, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005510121333380795, 'unfreeze_percentage': 0.15405051415858556, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 55, 'batch_size': 29, 'num_dense_units_2': 29, 'learning_rate': 0.0037434151868649948, 'base_model': 'InceptionV3', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:36:06.866077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.4651 - acc: 0.0560 - val_loss: 2.3762 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 15), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 15) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 15) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 15) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 15)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 130, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005510121333380795, 'unfreeze_percentage': 0.15405051415858556, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 55, 'batch_size': 29, 'num_dense_units_2': 29, 'learning_rate': 0.0037434151868649948, 'base_model': 'InceptionV3', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 12.869597673416138, 'histories': {'loss': [2.460054632416345], 'val_loss': [2.376212954521179], 'acc': [0.060150374091209324], 'val_acc': [0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 15)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 16)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 16) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 16) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 17) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 16) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 16)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 530, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001982423155407523, 'unfreeze_percentage': 0.20806765098101035, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 181, 'batch_size': 17, 'learning_rate': 0.00011613751962476157, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:36:18.870860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.2364 - acc: 0.2181 - val_loss: 2.3417 - val_acc: 0.1284
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 16), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 16) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 16) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 16) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 16)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 530, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001982423155407523, 'unfreeze_percentage': 0.20806765098101035, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 181, 'batch_size': 17, 'learning_rate': 0.00011613751962476157, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8715596330275229, 'info': {'runtime': 11.004639148712158, 'histories': {'loss': [2.2421827982211937], 'val_loss': [2.3416970147999057], 'acc': [0.20689655740199417], 'val_acc': [0.12844036697247707]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 16)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 17)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 17) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 17) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 18) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 17) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 17)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 277, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00046250328972373867, 'unfreeze_percentage': 0.287720667307007, 'rotation_range': 0, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 67, 'batch_size': 64, 'learning_rate': 0.0012984918478087296, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:36:29.917750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 6.8841 - acc: 0.0703 - val_loss: 2.3145 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 17), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 17) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 17) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 17) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 17)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 277, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00046250328972373867, 'unfreeze_percentage': 0.287720667307007, 'rotation_range': 0, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 67, 'batch_size': 64, 'learning_rate': 0.0012984918478087296, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 12.714477062225342, 'histories': {'loss': [6.884108304977417], 'val_loss': [2.3145382404327393], 'acc': [0.0703125], 'val_acc': [0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 17)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 18)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 18) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 18) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 19) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 18) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 18)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 326, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001381059807167892, 'unfreeze_percentage': 0.10108310530940867, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 110, 'batch_size': 40, 'num_dense_units_2': 120, 'learning_rate': 0.0004717967871585603, 'base_model': 'InceptionV3', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:36:43.673379: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.5759 - acc: 0.0930 - val_loss: 2.7861 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 18), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 18) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 18) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 18) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 18)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 326, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001381059807167892, 'unfreeze_percentage': 0.10108310530940867, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 110, 'batch_size': 40, 'num_dense_units_2': 120, 'learning_rate': 0.0004717967871585603, 'base_model': 'InceptionV3', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.875, 'info': {'runtime': 12.610280275344849, 'histories': {'loss': [2.738321425484829], 'val_loss': [2.7860984802246094], 'acc': [0.11475410434554835], 'val_acc': [0.125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 18)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 19)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 19) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 19) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 20) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 19) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 19)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 262, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00011270861688737107, 'unfreeze_percentage': 0.007735940066590851, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 159, 'batch_size': 22, 'learning_rate': 0.00045470720205832726, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:36:56.309886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3219 - acc: 0.1448 - val_loss: 2.3081 - val_acc: 0.1558
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 19), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 19) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 19) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 19) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 19)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 262, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00011270861688737107, 'unfreeze_percentage': 0.007735940066590851, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 159, 'batch_size': 22, 'learning_rate': 0.00045470720205832726, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8441558431882363, 'info': {'runtime': 13.330912590026855, 'histories': {'loss': [2.328332448005676], 'val_loss': [2.30814419164286], 'acc': [0.13571428933313914], 'val_acc': [0.15584415681176372]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 19)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 20)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 20) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 20) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 21) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 20) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 20)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 217, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005239373720165107, 'unfreeze_percentage': 0.15732383401440722, 'rotation_range': 0, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 102, 'batch_size': 48, 'num_dense_units_2': 185, 'learning_rate': 0.0007956714667166996, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:37:08.476214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.2966 - acc: 0.0988 - val_loss: 2.2948 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 20), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 20) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 20) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 20) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 20)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 217, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005239373720165107, 'unfreeze_percentage': 0.15732383401440722, 'rotation_range': 0, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 102, 'batch_size': 48, 'num_dense_units_2': 185, 'learning_rate': 0.0007956714667166996, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 12.995102167129517, 'histories': {'loss': [2.2914198574266935], 'val_loss': [2.2948217391967773], 'acc': [0.09649123133797395], 'val_acc': [0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 20)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 21)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 21) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 21) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 22) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 21) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 21)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 855, 'zoom_range': 0.0, 'cnn_learning_rate': 1.0914801814100896e-05, 'unfreeze_percentage': 0.13622352685236144, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 139, 'batch_size': 24, 'num_dense_units_2': 66, 'learning_rate': 0.0005009194943239991, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 13:37:21.896000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.2983 - acc: 0.2485 - val_loss: 2.5132 - val_acc: 0.1039
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 21), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 21) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 21) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 21) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 21)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 855, 'zoom_range': 0.0, 'cnn_learning_rate': 1.0914801814100896e-05, 'unfreeze_percentage': 0.13622352685236144, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 139, 'batch_size': 24, 'num_dense_units_2': 66, 'learning_rate': 0.0005009194943239991, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.8961038956200922, 'info': {'runtime': 10.503235340118408, 'histories': {'loss': [2.2795119907545005], 'val_loss': [2.513171372475562], 'acc': [0.25362319499254227], 'val_acc': [0.10389610437990783]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 21)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 22)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 22) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 22) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 23) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 22) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 22)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 838, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0003795214697507409, 'unfreeze_percentage': 0.23351808230519835, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 233, 'batch_size': 36, 'learning_rate': 0.00011788099249234698, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:37:37.690356: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 7s - loss: 2.3792 - acc: 0.1000 - val_loss: 2.3417 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 22), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 22) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 22) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 22) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 22)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 838, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0003795214697507409, 'unfreeze_percentage': 0.23351808230519835, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 233, 'batch_size': 36, 'learning_rate': 0.00011788099249234698, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 21.02696418762207, 'histories': {'loss': [2.3703503608703613], 'val_loss': [2.341695189476013], 'acc': [0.11111111300332206], 'val_acc': [0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 22)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 23)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 23) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 23) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 24) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 23) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 23)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 260, 'zoom_range': 0.0, 'cnn_learning_rate': 2.4089732869708844e-05, 'unfreeze_percentage': 0.2466602090750386, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 341, 'batch_size': 33, 'num_dense_units_2': 129, 'learning_rate': 0.00386969457297436, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:37:58.797715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 8s - loss: 3.4508 - acc: 0.1008 - val_loss: 3.7408 - val_acc: 0.0781
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 23), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 23) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 23) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 23) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 23)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 260, 'zoom_range': 0.0, 'cnn_learning_rate': 2.4089732869708844e-05, 'unfreeze_percentage': 0.2466602090750386, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 341, 'batch_size': 33, 'num_dense_units_2': 129, 'learning_rate': 0.00386969457297436, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.921875, 'info': {'runtime': 21.30453872680664, 'histories': {'loss': [3.4295827455298844], 'val_loss': [3.740840792655945], 'acc': [0.10077519818793895], 'val_acc': [0.078125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 23)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 24)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 24) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 24) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 25) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 24)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 314, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002801880800492117, 'unfreeze_percentage': 0.29798698682578195, 'rotation_range': 0, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 52, 'batch_size': 19, 'learning_rate': 0.00023699920284707778, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
2018-02-08 13:38:20.521181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 8s - loss: 2.2656 - acc: 0.1457 - val_loss: 2.2594 - val_acc: 0.1376
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 24), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 24) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 24)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 314, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002801880800492117, 'unfreeze_percentage': 0.29798698682578195, 'rotation_range': 0, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 52, 'batch_size': 19, 'learning_rate': 0.00023699920284707778, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8623853207591476, 'info': {'runtime': 21.09393835067749, 'histories': {'loss': [2.26135907473264], 'val_loss': [2.2594034387431012], 'acc': [0.15384615400245974], 'val_acc': [0.13761467924085233]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 24)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 25)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 25) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 26) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 25) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 25) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 25)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 242, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00013310834396844547, 'unfreeze_percentage': 0.04054873149674173, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 316, 'batch_size': 20, 'num_dense_units_2': 123, 'learning_rate': 0.004111274117145302, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:38:36.265560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.3882 - acc: 0.1268 - val_loss: 2.4253 - val_acc: 0.0649
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 25), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 25) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 25) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 25) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 25)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 242, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00013310834396844547, 'unfreeze_percentage': 0.04054873149674173, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 316, 'batch_size': 20, 'num_dense_units_2': 123, 'learning_rate': 0.004111274117145302, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.935064935064935, 'info': {'runtime': 10.495434045791626, 'histories': {'loss': [2.2954208615800025], 'val_loss': [2.4252552243022176], 'acc': [0.14084507514473418], 'val_acc': [0.06493506493506493]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 25)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 26)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 26) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 26) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 27) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 26) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 26)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 129, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00010141078768957874, 'unfreeze_percentage': 0.008685523804271966, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 421, 'batch_size': 16, 'num_dense_units_2': 181, 'learning_rate': 0.002829961330365634, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:38:52.167690: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 8s - loss: 3.3353 - acc: 0.1009 - val_loss: 2.4758 - val_acc: 0.1101
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 26), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 26) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 26) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 26) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 26)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 129, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00010141078768957874, 'unfreeze_percentage': 0.008685523804271966, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 421, 'batch_size': 16, 'num_dense_units_2': 181, 'learning_rate': 0.002829961330365634, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.8899082565389642, 'info': {'runtime': 20.607115030288696, 'histories': {'loss': [3.478757298156007], 'val_loss': [2.4758417650100286], 'acc': [0.1095890410958904], 'val_acc': [0.11009174346103581]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 26)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 27)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 27) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 27) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 28) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 27) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 27)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 373, 'zoom_range': 0.0, 'cnn_learning_rate': 2.740421875387178e-05, 'unfreeze_percentage': 0.273090266340852, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 72, 'batch_size': 38, 'num_dense_units_2': 17, 'learning_rate': 0.003382010468032159, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:39:07.004094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.6593 - acc: 0.1464 - val_loss: 2.3371 - val_acc: 0.1406
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 27), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 27) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 27) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 27) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 27)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 373, 'zoom_range': 0.0, 'cnn_learning_rate': 2.740421875387178e-05, 'unfreeze_percentage': 0.273090266340852, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 72, 'batch_size': 38, 'num_dense_units_2': 17, 'learning_rate': 0.003382010468032159, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.859375, 'info': {'runtime': 8.994012117385864, 'histories': {'loss': [2.7230257372702322], 'val_loss': [2.3371238708496094], 'acc': [0.13709677419354838], 'val_acc': [0.140625]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 27)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 28)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 28) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 29) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 28) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 28) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 28)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 459, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00023567613196179572, 'unfreeze_percentage': 0.01981091363080779, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 408, 'batch_size': 36, 'num_dense_units_2': 205, 'learning_rate': 0.0037187620746642626, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:39:16.977336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.3614 - acc: 0.0897 - val_loss: 2.3402 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 28), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 28) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 28) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 28) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 28)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 459, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00023567613196179572, 'unfreeze_percentage': 0.01981091363080779, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 408, 'batch_size': 36, 'num_dense_units_2': 205, 'learning_rate': 0.0037187620746642626, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.875, 'info': {'runtime': 11.129650831222534, 'histories': {'loss': [2.355394090924944], 'val_loss': [2.3401763439178467], 'acc': [0.08730158848421914], 'val_acc': [0.125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 28)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 29)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 29) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 29) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 30) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 29) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 29)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 124, 'zoom_range': 0.0, 'cnn_learning_rate': 1.1006188626779592e-05, 'unfreeze_percentage': 0.2952933298998556, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 83, 'batch_size': 26, 'num_dense_units_2': 30, 'learning_rate': 0.009691940982068343, 'base_model': 'InceptionV3', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:39:29.192809: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.7407 - acc: 0.0969 - val_loss: 2.3828 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 29), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 29) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 29) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 29) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 29)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 124, 'zoom_range': 0.0, 'cnn_learning_rate': 1.1006188626779592e-05, 'unfreeze_percentage': 0.2952933298998556, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 83, 'batch_size': 26, 'num_dense_units_2': 30, 'learning_rate': 0.009691940982068343, 'base_model': 'InceptionV3', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.890625, 'info': {'runtime': 12.667283535003662, 'histories': {'loss': [2.775324625127456], 'val_loss': [2.382781982421875], 'acc': [0.08823529877425994], 'val_acc': [0.109375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 29)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 30)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 30) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 30) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 31) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 30) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 30)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 330, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017849012875809566, 'unfreeze_percentage': 0.11662387039618621, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 205, 'batch_size': 29, 'learning_rate': 0.001262845153327983, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:39:40.915951: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.5371 - acc: 0.0897 - val_loss: 2.5100 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 30), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 30) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 30) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 30) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 30)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 330, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017849012875809566, 'unfreeze_percentage': 0.11662387039618621, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 205, 'batch_size': 29, 'learning_rate': 0.001262845153327983, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 10.294298887252808, 'histories': {'loss': [2.5371069431304933], 'val_loss': [2.510045886039734], 'acc': [0.08965517282485962], 'val_acc': [0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 30)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 31)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 31) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 31) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 32) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 31) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 31)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 336, 'zoom_range': 0.0, 'cnn_learning_rate': 0.000625169787703683, 'unfreeze_percentage': 0.2156476528773683, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 80, 'batch_size': 17, 'learning_rate': 0.002852441816111047, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:39:50.870902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 7s - loss: 2.3694 - acc: 0.1117 - val_loss: 2.3378 - val_acc: 0.0826
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 31), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 31) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 31) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 31) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 31)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 336, 'zoom_range': 0.0, 'cnn_learning_rate': 0.000625169787703683, 'unfreeze_percentage': 0.2156476528773683, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 80, 'batch_size': 17, 'learning_rate': 0.002852441816111047, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.9174311923187807, 'info': {'runtime': 11.50013542175293, 'histories': {'loss': [2.3679586542063746], 'val_loss': [2.337825501730683], 'acc': [0.11724138062061934], 'val_acc': [0.0825688076812193]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 31)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 32)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 32) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 32) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 33) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 32) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 32)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 206, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0006554862413979314, 'unfreeze_percentage': 0.03566163681057118, 'rotation_range': 0, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 89, 'batch_size': 55, 'num_dense_units_2': 141, 'learning_rate': 0.00792953947616699, 'base_model': 'InceptionV3', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:40:03.780871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 7s - loss: 2.4489 - acc: 0.1027 - val_loss: 5.0291 - val_acc: 0.0000e+00
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 32), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 32) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 32) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 32) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 32)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 206, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0006554862413979314, 'unfreeze_percentage': 0.03566163681057118, 'rotation_range': 0, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 89, 'batch_size': 55, 'num_dense_units_2': 141, 'learning_rate': 0.00792953947616699, 'base_model': 'InceptionV3', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 1.0, 'info': {'runtime': 14.996944904327393, 'histories': {'loss': [2.449643914944658], 'val_loss': [5.029097557067871], 'acc': [0.10280373929259932], 'val_acc': [0.0]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 32)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 33)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 33) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 33) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 34) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 33)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 634, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008125354300193659, 'unfreeze_percentage': 0.2342130265714623, 'rotation_range': 0, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 183, 'batch_size': 33, 'learning_rate': 0.0009181489776842441, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:40:17.532338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 4.0911 - acc: 0.1534 - val_loss: 3.7207 - val_acc: 0.1719
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 33), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 33) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 33)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 634, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008125354300193659, 'unfreeze_percentage': 0.2342130265714623, 'rotation_range': 0, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 183, 'batch_size': 33, 'learning_rate': 0.0009181489776842441, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.828125, 'info': {'runtime': 10.757076740264893, 'histories': {'loss': [4.122321394986884], 'val_loss': [3.7206523418426514], 'acc': [0.15503876465697622], 'val_acc': [0.171875]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 33)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 34)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 34) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 34) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 35) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 34) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 34)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 472, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005236735402467172, 'unfreeze_percentage': 0.2646291639821614, 'rotation_range': 0, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 388, 'batch_size': 20, 'learning_rate': 0.003390726207044849, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:40:28.422394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 7s - loss: 5.6674 - acc: 0.0951 - val_loss: 4.3709 - val_acc: 0.0909
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 34), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 34) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 34) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 34) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 34)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 472, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005236735402467172, 'unfreeze_percentage': 0.2646291639821614, 'rotation_range': 0, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 388, 'batch_size': 20, 'learning_rate': 0.003390726207044849, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.9090909086071052, 'info': {'runtime': 12.380648374557495, 'histories': {'loss': [4.930532314407993], 'val_loss': [4.370896636665641], 'acc': [0.1056338049156565], 'val_acc': [0.09090909139289484]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 34)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 35)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 35) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 35) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 36) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 35) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 35)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 718, 'zoom_range': 0.0, 'cnn_learning_rate': 2.4748650169447134e-05, 'unfreeze_percentage': 0.11928912369964287, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 131, 'batch_size': 24, 'learning_rate': 0.0004808595538300197, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:40:42.249054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3584 - acc: 0.1250 - val_loss: 2.4207 - val_acc: 0.1558
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 35), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 35) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 35) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 35) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 35)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 718, 'zoom_range': 0.0, 'cnn_learning_rate': 2.4748650169447134e-05, 'unfreeze_percentage': 0.11928912369964287, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 131, 'batch_size': 24, 'learning_rate': 0.0004808595538300197, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8441558431882363, 'info': {'runtime': 12.380225658416748, 'histories': {'loss': [2.358416755994161], 'val_loss': [2.420694667023498], 'acc': [0.12500000124176344], 'val_acc': [0.15584415681176372]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 35)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 36)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 36) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 36) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 37) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 36) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 36)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 315, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00015092865948451766, 'unfreeze_percentage': 0.25868571428147885, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 179, 'batch_size': 30, 'num_dense_units_2': 60, 'learning_rate': 0.0016569814432495316, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:40:53.827857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.3795 - acc: 0.0970 - val_loss: 2.4336 - val_acc: 0.0781
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 36), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 36) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 36) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 36) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 36)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 315, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00015092865948451766, 'unfreeze_percentage': 0.25868571428147885, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 179, 'batch_size': 30, 'num_dense_units_2': 60, 'learning_rate': 0.0016569814432495316, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.921875, 'info': {'runtime': 10.455997943878174, 'histories': {'loss': [2.3819610313935713], 'val_loss': [2.4335744380950928], 'acc': [0.09848485768518665], 'val_acc': [0.078125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 36)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 37)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 37) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 37) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 38) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 37) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 37)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 306, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00011821544704388889, 'unfreeze_percentage': 0.207186701355353, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 153, 'batch_size': 50, 'learning_rate': 0.00039289466068720327, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:41:09.337107: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.4396 - acc: 0.1329 - val_loss: 2.3434 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 37), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 37) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 37) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 37) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 37)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 306, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00011821544704388889, 'unfreeze_percentage': 0.207186701355353, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 153, 'batch_size': 50, 'learning_rate': 0.00039289466068720327, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.875, 'info': {'runtime': 18.811591625213623, 'histories': {'loss': [2.4182067045143674], 'val_loss': [2.343409776687622], 'acc': [0.12499999813735485], 'val_acc': [0.125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 37)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 38)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 38) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 38) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 39) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 38) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 38)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 204, 'zoom_range': 0.0, 'cnn_learning_rate': 5.9927789593364736e-05, 'unfreeze_percentage': 0.29142406213914135, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 128, 'batch_size': 34, 'learning_rate': 0.0025735834085733327, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 13:41:23.057280: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3434 - acc: 0.0465 - val_loss: 2.3228 - val_acc: 0.0625
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 38), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 38) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 38) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 38) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 38)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 204, 'zoom_range': 0.0, 'cnn_learning_rate': 5.9927789593364736e-05, 'unfreeze_percentage': 0.29142406213914135, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 128, 'batch_size': 34, 'learning_rate': 0.0025735834085733327, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.9375, 'info': {'runtime': 11.259768009185791, 'histories': {'loss': [2.3411081209778786], 'val_loss': [2.3227676153182983], 'acc': [0.046875000931322575], 'val_acc': [0.0625]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 38)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 39)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 39) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 39) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 40) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 39) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 39)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 511, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00036914728758740225, 'unfreeze_percentage': 0.2392335602930878, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 200, 'batch_size': 33, 'learning_rate': 0.0017528830543086721, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:41:39.806461: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 7s - loss: 4.8903 - acc: 0.1364 - val_loss: 4.3599 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 39), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 39) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 39) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 39) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 39)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 511, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00036914728758740225, 'unfreeze_percentage': 0.2392335602930878, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 200, 'batch_size': 33, 'learning_rate': 0.0017528830543086721, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 19.82490372657776, 'histories': {'loss': [4.890324234962463], 'val_loss': [4.359886407852173], 'acc': [0.13636364042758942], 'val_acc': [0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 39)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 40)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 40) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 40) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 41) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 40)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 509, 'zoom_range': 0.0, 'cnn_learning_rate': 1.0296398920617354e-05, 'unfreeze_percentage': 0.06768409623555426, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 77, 'batch_size': 18, 'num_dense_units_2': 15, 'learning_rate': 0.0073802973172579465, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:41:55.824887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3200 - acc: 0.0864 - val_loss: 2.2888 - val_acc: 0.1101
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 40), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 40) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 40)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 509, 'zoom_range': 0.0, 'cnn_learning_rate': 1.0296398920617354e-05, 'unfreeze_percentage': 0.06768409623555426, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 77, 'batch_size': 18, 'num_dense_units_2': 15, 'learning_rate': 0.0073802973172579465, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8899082561971945, 'info': {'runtime': 14.1226966381073, 'histories': {'loss': [2.3199702633751764], 'val_loss': [2.288834121249138], 'acc': [0.08641975373029709], 'val_acc': [0.11009174380280556]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 40)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 41)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 41) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 41) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 42) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 41)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 733, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007262065826830968, 'unfreeze_percentage': 0.25499369760780827, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 132, 'batch_size': 56, 'num_dense_units_2': 17, 'learning_rate': 0.0003644744080225765, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:42:08.006556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 4s - loss: 2.6700 - acc: 0.0625 - val_loss: 2.8723 - val_acc: 0.0938
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 41), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 41) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 41)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 733, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007262065826830968, 'unfreeze_percentage': 0.25499369760780827, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 132, 'batch_size': 56, 'num_dense_units_2': 17, 'learning_rate': 0.0003644744080225765, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 16.025870084762573, 'histories': {'loss': [2.6700313091278076], 'val_loss': [2.87233829498291], 'acc': [0.0625000037252903], 'val_acc': [0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 41)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 42)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 42) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 43) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 42) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 42) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 42)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 318, 'zoom_range': 0.0, 'cnn_learning_rate': 1.4194847195140914e-05, 'unfreeze_percentage': 0.08029502158482678, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 87, 'batch_size': 48, 'num_dense_units_2': 78, 'learning_rate': 0.0009129438399704723, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:42:24.441969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.3388 - acc: 0.1123 - val_loss: 2.3565 - val_acc: 0.0625
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 42), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 42) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 42) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 42) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 42)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 318, 'zoom_range': 0.0, 'cnn_learning_rate': 1.4194847195140914e-05, 'unfreeze_percentage': 0.08029502158482678, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 87, 'batch_size': 48, 'num_dense_units_2': 78, 'learning_rate': 0.0009129438399704723, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.9375, 'info': {'runtime': 11.01364517211914, 'histories': {'loss': [2.3299921186346757], 'val_loss': [2.35648250579834], 'acc': [0.1228070217919977], 'val_acc': [0.0625]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 42)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 43)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 43) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 43) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 44) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 43) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 43)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 116, 'zoom_range': 0.0, 'cnn_learning_rate': 4.1668628344560094e-05, 'unfreeze_percentage': 0.07318801160647144, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 150, 'batch_size': 61, 'num_dense_units_2': 23, 'learning_rate': 0.0001749385513391603, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:42:35.533204: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3180 - acc: 0.0963 - val_loss: 2.3307 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 43), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 43) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 43) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 43) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 43)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 116, 'zoom_range': 0.0, 'cnn_learning_rate': 4.1668628344560094e-05, 'unfreeze_percentage': 0.07318801160647144, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 150, 'batch_size': 61, 'num_dense_units_2': 23, 'learning_rate': 0.0001749385513391603, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.84375, 'info': {'runtime': 12.672597408294678, 'histories': {'loss': [2.322089447833524], 'val_loss': [2.3307182788848877], 'acc': [0.09900990054749026], 'val_acc': [0.15625]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 43)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 44)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 44) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 44) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 45) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 44) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 44)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 290, 'zoom_range': 0.0, 'cnn_learning_rate': 1.5945739686319232e-05, 'unfreeze_percentage': 0.03336406358538977, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 107, 'batch_size': 22, 'learning_rate': 0.0004746876156547145, 'base_model': 'InceptionV3', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:42:49.661911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.5968 - acc: 0.1908 - val_loss: 2.4911 - val_acc: 0.0779
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 44), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 44) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 44) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 44) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 44)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 290, 'zoom_range': 0.0, 'cnn_learning_rate': 1.5945739686319232e-05, 'unfreeze_percentage': 0.03336406358538977, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 107, 'batch_size': 22, 'learning_rate': 0.0004746876156547145, 'base_model': 'InceptionV3', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.922077922077922, 'info': {'runtime': 12.270796060562134, 'histories': {'loss': [2.618828879083906], 'val_loss': [2.491146607832475], 'acc': [0.18571429082325527], 'val_acc': [0.07792207792207792]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 44)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 45)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 45) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 45) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 46) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 45) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 45)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 139, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002297025343878985, 'unfreeze_percentage': 0.20398138922964634, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 383, 'batch_size': 49, 'num_dense_units_2': 67, 'learning_rate': 0.0004459470835960811, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:43:02.087788: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3268 - acc: 0.0952 - val_loss: 2.3146 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 45), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 45) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 45) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 45) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 45)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 139, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002297025343878985, 'unfreeze_percentage': 0.20398138922964634, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 383, 'batch_size': 49, 'num_dense_units_2': 67, 'learning_rate': 0.0004459470835960811, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.84375, 'info': {'runtime': 12.737874984741211, 'histories': {'loss': [2.3267927169799805], 'val_loss': [2.314602851867676], 'acc': [0.09523809204498927], 'val_acc': [0.15625]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 45)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 46)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 46) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 47) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 46) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 46)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 141, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00035400466876502415, 'unfreeze_percentage': 0.12240612398788327, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 52, 'batch_size': 34, 'learning_rate': 0.00023117335827220676, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:43:13.524006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3793 - acc: 0.1656 - val_loss: 2.2248 - val_acc: 0.2031
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 46), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 46) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 46)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 141, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00035400466876502415, 'unfreeze_percentage': 0.12240612398788327, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 52, 'batch_size': 34, 'learning_rate': 0.00023117335827220676, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.796875, 'info': {'runtime': 11.241653680801392, 'histories': {'loss': [2.3761680386960506], 'val_loss': [2.224766969680786], 'acc': [0.17187500436557457], 'val_acc': [0.203125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 46)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 47)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 47) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 47) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 48) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 47)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 155, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005382208007501695, 'unfreeze_percentage': 0.006228173460867536, 'rotation_range': 0, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 180, 'batch_size': 42, 'num_dense_units_2': 98, 'learning_rate': 0.0021581339832599158, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:43:23.838215: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 4s - loss: 2.6869 - acc: 0.1767 - val_loss: 3.0914 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 47), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 47) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 47)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 155, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005382208007501695, 'unfreeze_percentage': 0.006228173460867536, 'rotation_range': 0, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 180, 'batch_size': 42, 'num_dense_units_2': 98, 'learning_rate': 0.0021581339832599158, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.875, 'info': {'runtime': 9.435789108276367, 'histories': {'loss': [2.702180325984955], 'val_loss': [3.0914318561553955], 'acc': [0.17500000894069673], 'val_acc': [0.125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 47)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 48)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 48) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 48) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 49) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 48) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 48)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 273, 'zoom_range': 0.0, 'cnn_learning_rate': 1.4636187565838117e-05, 'unfreeze_percentage': 0.26566343541450776, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 52, 'batch_size': 30, 'num_dense_units_2': 12, 'learning_rate': 0.0003590717780858941, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:43:34.782405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.2709 - acc: 0.1909 - val_loss: 2.4144 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 48), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 48) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 48) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 48) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 48)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 273, 'zoom_range': 0.0, 'cnn_learning_rate': 1.4636187565838117e-05, 'unfreeze_percentage': 0.26566343541450776, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 52, 'batch_size': 30, 'num_dense_units_2': 12, 'learning_rate': 0.0003590717780858941, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 10.310362100601196, 'histories': {'loss': [2.238913048397411], 'val_loss': [2.4144192934036255], 'acc': [0.21212122318419543], 'val_acc': [0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 48)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 49)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 49) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 49) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 50) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 49)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 589, 'zoom_range': 0.0, 'cnn_learning_rate': 1.3170303961801553e-05, 'unfreeze_percentage': 0.14820919345375544, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 115, 'batch_size': 16, 'num_dense_units_2': 33, 'learning_rate': 0.00021286728139435177, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:43:44.803514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3414 - acc: 0.1639 - val_loss: 2.2374 - val_acc: 0.1376
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 49), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 49) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 49)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 589, 'zoom_range': 0.0, 'cnn_learning_rate': 1.3170303961801553e-05, 'unfreeze_percentage': 0.14820919345375544, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 115, 'batch_size': 16, 'num_dense_units_2': 33, 'learning_rate': 0.00021286728139435177, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.8623853172730962, 'info': {'runtime': 11.632821798324585, 'histories': {'loss': [2.294313855367164], 'val_loss': [2.237417781024898], 'acc': [0.1780821917808219], 'val_acc': [0.1376146827269038]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 49)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 50)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 50) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 50) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 51) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 50) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 50)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 132, 'zoom_range': 0.0, 'cnn_learning_rate': 2.0035115628292118e-05, 'unfreeze_percentage': 0.1371384893108897, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 268, 'batch_size': 27, 'num_dense_units_2': 30, 'learning_rate': 0.007526756208708737, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:44:02.090054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 8s - loss: 2.8026 - acc: 0.1420 - val_loss: 2.4087 - val_acc: 0.1406
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 50), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 50) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 50) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 50) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 50)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 132, 'zoom_range': 0.0, 'cnn_learning_rate': 2.0035115628292118e-05, 'unfreeze_percentage': 0.1371384893108897, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 268, 'batch_size': 27, 'num_dense_units_2': 30, 'learning_rate': 0.007526756208708737, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.859375, 'info': {'runtime': 20.897866010665894, 'histories': {'loss': [2.802577018737793], 'val_loss': [2.4086990356445312], 'acc': [0.14197531218330064], 'val_acc': [0.140625]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 50)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 51)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 51) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 51) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 52) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 51) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 51)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 304, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001464566598910424, 'unfreeze_percentage': 0.05320190245643912, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 463, 'batch_size': 22, 'learning_rate': 0.00020049243043823047, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:44:17.596153: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.3231 - acc: 0.1448 - val_loss: 2.3445 - val_acc: 0.1039
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 51), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 51) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 51) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 51) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 51)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 304, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001464566598910424, 'unfreeze_percentage': 0.05320190245643912, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 463, 'batch_size': 22, 'learning_rate': 0.00020049243043823047, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8961038951362882, 'info': {'runtime': 10.607889652252197, 'histories': {'loss': [2.3396401814052035], 'val_loss': [2.3445007832019362], 'acc': [0.13571428933313914], 'val_acc': [0.10389610486371177]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 51)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 52)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 52) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 52) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 53) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 52) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 52)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 153, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0003398805473496143, 'unfreeze_percentage': 0.13922483087333437, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 77, 'batch_size': 49, 'learning_rate': 0.00024949673844736184, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:44:28.146948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.2798 - acc: 0.1109 - val_loss: 2.2736 - val_acc: 0.0312
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 52), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 52) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 52) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 52) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 52)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 153, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0003398805473496143, 'unfreeze_percentage': 0.13922483087333437, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 77, 'batch_size': 49, 'learning_rate': 0.00024949673844736184, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.96875, 'info': {'runtime': 11.410354137420654, 'histories': {'loss': [2.277635394999411], 'val_loss': [2.2735767364501953], 'acc': [0.10619468775998174], 'val_acc': [0.03125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 52)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 53)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 53) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 53) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 54) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 53) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 53)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 925, 'zoom_range': 0.0, 'cnn_learning_rate': 2.9093974783008127e-05, 'unfreeze_percentage': 0.28608455369016345, 'rotation_range': 0, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 124, 'batch_size': 42, 'learning_rate': 0.005315300074134611, 'base_model': 'InceptionV3', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:44:40.992879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.4392 - acc: 0.0714 - val_loss: 2.3796 - val_acc: 0.0625
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 53), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 53) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 53) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 53) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 53)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 925, 'zoom_range': 0.0, 'cnn_learning_rate': 2.9093974783008127e-05, 'unfreeze_percentage': 0.28608455369016345, 'rotation_range': 0, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 124, 'batch_size': 42, 'learning_rate': 0.005315300074134611, 'base_model': 'InceptionV3', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.9375, 'info': {'runtime': 12.62665581703186, 'histories': {'loss': [2.4392406145731607], 'val_loss': [2.379643440246582], 'acc': [0.07142857213815053], 'val_acc': [0.0625]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 53)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 54)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 54) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 55) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 54) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 54) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 54)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 405, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002710358697118043, 'unfreeze_percentage': 0.22443263227353524, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 81, 'batch_size': 35, 'num_dense_units_2': 58, 'learning_rate': 0.0008359345903885447, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:44:52.381067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3372 - acc: 0.1214 - val_loss: 2.3821 - val_acc: 0.0625
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 54), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 54) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 54) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 54) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 54)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 405, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002710358697118043, 'unfreeze_percentage': 0.22443263227353524, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 81, 'batch_size': 35, 'num_dense_units_2': 58, 'learning_rate': 0.0008359345903885447, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.9375, 'info': {'runtime': 11.464258670806885, 'histories': {'loss': [2.337218165397644], 'val_loss': [2.3821372985839844], 'acc': [0.12142857350409031], 'val_acc': [0.0625]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 54)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 55)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 55) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 56) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 55) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 55) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 55)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 105, 'zoom_range': 0.0, 'cnn_learning_rate': 1.894678710082623e-05, 'unfreeze_percentage': 0.09775102294953926, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 187, 'batch_size': 31, 'num_dense_units_2': 90, 'learning_rate': 0.00025746219627680803, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:45:04.272035: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.3102 - acc: 0.1381 - val_loss: 2.3093 - val_acc: 0.1406
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 55), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 55) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 55) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 55) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 55)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 105, 'zoom_range': 0.0, 'cnn_learning_rate': 1.894678710082623e-05, 'unfreeze_percentage': 0.09775102294953926, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 187, 'batch_size': 31, 'num_dense_units_2': 90, 'learning_rate': 0.00025746219627680803, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.859375, 'info': {'runtime': 10.860518455505371, 'histories': {'loss': [2.288582403241223], 'val_loss': [2.3092803955078125], 'acc': [0.13740457662644276], 'val_acc': [0.140625]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 55)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 56)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 56) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 57) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 56) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 56)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 624, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008663681836582676, 'unfreeze_percentage': 0.22190523731877246, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 85, 'batch_size': 36, 'learning_rate': 0.0003775798873630235, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:45:20.501327: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 7s - loss: 2.5160 - acc: 0.1000 - val_loss: 2.2343 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 56), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 56) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 56)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 624, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008663681836582676, 'unfreeze_percentage': 0.22190523731877246, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 85, 'batch_size': 36, 'learning_rate': 0.0003775798873630235, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.890625, 'info': {'runtime': 19.490818738937378, 'histories': {'loss': [2.537346226828439], 'val_loss': [2.2343013286590576], 'acc': [0.11111111300332206], 'val_acc': [0.109375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 56)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 57)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 57) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 57) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 58) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 57) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 57)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 277, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008414368670047831, 'unfreeze_percentage': 0.10390831707680268, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 244, 'batch_size': 40, 'num_dense_units_2': 15, 'learning_rate': 0.0008752366613374467, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:45:33.547608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 4s - loss: 2.3640 - acc: 0.0930 - val_loss: 2.4166 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 57), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 57) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 57) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 57) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 57)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 277, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008414368670047831, 'unfreeze_percentage': 0.10390831707680268, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 244, 'batch_size': 40, 'num_dense_units_2': 15, 'learning_rate': 0.0008752366613374467, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.875, 'info': {'runtime': 8.35303258895874, 'histories': {'loss': [2.308637611201552], 'val_loss': [2.416614055633545], 'acc': [0.11475410129203172], 'val_acc': [0.125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 57)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 58)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 58) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 58) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 59) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 58) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 58)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 275, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001284957869736779, 'unfreeze_percentage': 0.24213136605531954, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 364, 'batch_size': 20, 'num_dense_units_2': 13, 'learning_rate': 0.0011352853929701631, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:45:43.204614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 7s - loss: 2.2915 - acc: 0.1394 - val_loss: 2.3046 - val_acc: 0.1429
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 58), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 58) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 58) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 58) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 58)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 275, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001284957869736779, 'unfreeze_percentage': 0.24213136605531954, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 364, 'batch_size': 20, 'num_dense_units_2': 13, 'learning_rate': 0.0011352853929701631, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8571428544335551, 'info': {'runtime': 11.982801675796509, 'histories': {'loss': [2.28726559625545], 'val_loss': [2.3046181697350043], 'acc': [0.15492957819935302], 'val_acc': [0.14285714556644488]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 58)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 59)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 59) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 59) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 60) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 59) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 59)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 137, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001499884672887791, 'unfreeze_percentage': 0.10990302040357999, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 101, 'batch_size': 20, 'learning_rate': 0.005171396276300723, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:45:55.506525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 8s - loss: 12.6818 - acc: 0.1188 - val_loss: 13.9024 - val_acc: 0.1039
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 59), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 59) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 59) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 59) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 59)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 137, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001499884672887791, 'unfreeze_percentage': 0.10990302040357999, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 101, 'batch_size': 20, 'learning_rate': 0.005171396276300723, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8961038956200922, 'info': {'runtime': 13.400960445404053, 'histories': {'loss': [12.681813776493073], 'val_loss': [13.902393192439884], 'acc': [0.11875000409781933], 'val_acc': [0.10389610437990783]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 59)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 60)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 60) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 61) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 60) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 60) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 60)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 247, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0003292559617912699, 'unfreeze_percentage': 0.1457800690189708, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 322, 'batch_size': 22, 'learning_rate': 0.004668061834869695, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:46:07.743228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 4.2467 - acc: 0.0986 - val_loss: 3.1159 - val_acc: 0.2468
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 60), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 60) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 60) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 60) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 60)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 247, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0003292559617912699, 'unfreeze_percentage': 0.1457800690189708, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 322, 'batch_size': 22, 'learning_rate': 0.004668061834869695, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.7532467470540629, 'info': {'runtime': 10.149946689605713, 'histories': {'loss': [4.18609847341265], 'val_loss': [3.1159186518037476], 'acc': [0.10714286033596311], 'val_acc': [0.2467532529459371]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 60)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 61)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 61) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 61) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 62) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 61) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 61)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 127, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007386164877443023, 'unfreeze_percentage': 0.15583749916148368, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 52, 'batch_size': 22, 'num_dense_units_2': 13, 'learning_rate': 0.0011437366534364213, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:46:20.024585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3622 - acc: 0.0723 - val_loss: 2.3359 - val_acc: 0.0779
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 61), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 61) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 61) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 61) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 61)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 127, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007386164877443023, 'unfreeze_percentage': 0.15583749916148368, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 52, 'batch_size': 22, 'num_dense_units_2': 13, 'learning_rate': 0.0011437366534364213, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.9220779211103142, 'info': {'runtime': 12.202261209487915, 'histories': {'loss': [2.356399015017918], 'val_loss': [2.3359469438528087], 'acc': [0.07857143091303961], 'val_acc': [0.07792207888968579]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 61)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 62)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 62) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 62) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 63) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 62) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 62)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 555, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0006159298452209817, 'unfreeze_percentage': 0.15725621696427197, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 129, 'batch_size': 24, 'learning_rate': 0.00015126134777760159, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:46:32.389995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3813 - acc: 0.1247 - val_loss: 2.4107 - val_acc: 0.0909
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 62), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 62) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 62) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 62) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 62)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 555, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0006159298452209817, 'unfreeze_percentage': 0.15725621696427197, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 129, 'batch_size': 24, 'learning_rate': 0.00015126134777760159, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.9090909090909091, 'info': {'runtime': 12.700159549713135, 'histories': {'loss': [2.3823808172474736], 'val_loss': [2.4106679953537977], 'acc': [0.12318841076415518], 'val_acc': [0.09090909090909091]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 62)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 63)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 63) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 63) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 0) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 63) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 63)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 197, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004031273462513609, 'unfreeze_percentage': 0.19537368440648187, 'rotation_range': 0, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 54, 'batch_size': 25, 'learning_rate': 0.0005752311183739589, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:46:43.774444: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.5656 - acc: 0.2004 - val_loss: 2.3956 - val_acc: 0.1429
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 63), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 63) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 63) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 63) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 63)
args: ()
kwargs: {'budget': 1.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 197, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004031273462513609, 'unfreeze_percentage': 0.19537368440648187, 'rotation_range': 0, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 54, 'batch_size': 25, 'learning_rate': 0.0005752311183739589, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.8571428566590532, 'info': {'runtime': 11.448689699172974, 'histories': {'loss': [2.6012677398041215], 'val_loss': [2.3955592489861823], 'acc': [0.18978102053821522], 'val_acc': [0.1428571433409468]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 63)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 0) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 46) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 398, 'zoom_range': 0.0, 'cnn_learning_rate': 2.131280213165246e-05, 'unfreeze_percentage': 0.2492492133562639, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 205, 'batch_size': 44, 'learning_rate': 0.009568990106105379, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:47:00.879161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.3863 - acc: 0.0991 - val_loss: 2.3674 - val_acc: 0.1250
Epoch 2/2
 - 5s - loss: 2.2974 - acc: 0.1407 - val_loss: 2.3978 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 0)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 398, 'zoom_range': 0.0, 'cnn_learning_rate': 2.131280213165246e-05, 'unfreeze_percentage': 0.2492492133562639, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 205, 'batch_size': 44, 'learning_rate': 0.009568990106105379, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 24.40724277496338, 'histories': {'loss': [2.3891104762837037, 2.3014979362487793], 'val_loss': [2.3674025535583496, 2.3978118896484375], 'acc': [0.09322034554966425, 0.13559322741072058], 'val_acc': [0.125, 0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 0)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 46)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 46) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 9) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 46) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 46)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 141, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00035400466876502415, 'unfreeze_percentage': 0.12240612398788327, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 52, 'batch_size': 34, 'learning_rate': 0.00023117335827220676, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:47:20.092173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.3491 - acc: 0.1471 - val_loss: 2.2138 - val_acc: 0.1719
Epoch 2/2
 - 5s - loss: 1.9408 - acc: 0.3650 - val_loss: 2.0999 - val_acc: 0.1719
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 46), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 46) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 46)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 141, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00035400466876502415, 'unfreeze_percentage': 0.12240612398788327, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 52, 'batch_size': 34, 'learning_rate': 0.00023117335827220676, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.828125, 'info': {'runtime': 15.938502311706543, 'histories': {'loss': [2.3491091132164, 1.9307657678922017], 'val_loss': [2.2138198614120483, 2.0999072790145874], 'acc': [0.14705882826820016, 0.3750000106791655], 'val_acc': [0.171875, 0.171875]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 46)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 9)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 9) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 45) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 9) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 9) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 9)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 227, 'zoom_range': 0.0, 'cnn_learning_rate': 1.8255770139710306e-05, 'unfreeze_percentage': 0.2284550403414534, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 214, 'batch_size': 50, 'learning_rate': 0.0019326897441673276, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:47:41.537812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 4.2266 - acc: 0.0723 - val_loss: 2.9598 - val_acc: 0.1250
Epoch 2/2
 - 5s - loss: 2.9665 - acc: 0.0733 - val_loss: 2.2575 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 9), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 9) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 9) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 9) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 9)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 227, 'zoom_range': 0.0, 'cnn_learning_rate': 1.8255770139710306e-05, 'unfreeze_percentage': 0.2284550403414534, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 214, 'batch_size': 50, 'learning_rate': 0.0019326897441673276, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.875, 'info': {'runtime': 24.423462390899658, 'histories': {'loss': [3.9000813918454305, 2.9665258725484214], 'val_loss': [2.9597816467285156, 2.2574596405029297], 'acc': [0.089285708963871, 0.0733333316942056], 'val_acc': [0.125, 0.125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 9)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 45)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 45) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 58) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 45) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 45) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 45)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 139, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002297025343878985, 'unfreeze_percentage': 0.20398138922964634, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 383, 'batch_size': 49, 'num_dense_units_2': 67, 'learning_rate': 0.0004459470835960811, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:48:02.012706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.3521 - acc: 0.1067 - val_loss: 2.3538 - val_acc: 0.0938
Epoch 2/2
 - 4s - loss: 2.3572 - acc: 0.0920 - val_loss: 2.3077 - val_acc: 0.2188
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 45), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 45) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 45) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 45) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 45)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 139, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002297025343878985, 'unfreeze_percentage': 0.20398138922964634, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 383, 'batch_size': 49, 'num_dense_units_2': 67, 'learning_rate': 0.0004459470835960811, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.78125, 'info': {'runtime': 15.38489031791687, 'histories': {'loss': [2.346653761061947, 2.3564153561549905], 'val_loss': [2.3537840843200684, 2.3076508045196533], 'acc': [0.115044242842535, 0.09734512977631746], 'val_acc': [0.09375, 0.21875]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 45)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 58)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 58) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 57) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 58) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 58) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 58)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 275, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001284957869736779, 'unfreeze_percentage': 0.24213136605531954, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 364, 'batch_size': 20, 'num_dense_units_2': 13, 'learning_rate': 0.0011352853929701631, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:48:16.019304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.3117 - acc: 0.1014 - val_loss: 2.2999 - val_acc: 0.0779
Epoch 2/2
 - 5s - loss: 2.3261 - acc: 0.1014 - val_loss: 2.2987 - val_acc: 0.0779
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 58), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 58) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 58) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 58) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 58)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 275, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001284957869736779, 'unfreeze_percentage': 0.24213136605531954, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 364, 'batch_size': 20, 'num_dense_units_2': 13, 'learning_rate': 0.0011352853929701631, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.9220779215941182, 'info': {'runtime': 21.68330669403076, 'histories': {'loss': [2.304731187686114, 2.3119144036736285], 'val_loss': [2.2999183326572568, 2.2987390121856293], 'acc': [0.11267605906640979, 0.11267606011578735], 'val_acc': [0.07792207840588186, 0.07792207840588186]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 58)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 57)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 57) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 43) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 57) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 57) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 57)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 277, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008414368670047831, 'unfreeze_percentage': 0.10390831707680268, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 244, 'batch_size': 40, 'num_dense_units_2': 15, 'learning_rate': 0.0008752366613374467, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:48:36.740087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 4s - loss: 2.3230 - acc: 0.0863 - val_loss: 2.3309 - val_acc: 0.0625
Epoch 2/2
 - 3s - loss: 2.2120 - acc: 0.1880 - val_loss: 2.2063 - val_acc: 0.2188
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 57), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 57) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 57) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 57) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 57)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 277, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008414368670047831, 'unfreeze_percentage': 0.10390831707680268, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 244, 'batch_size': 40, 'num_dense_units_2': 15, 'learning_rate': 0.0008752366613374467, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.78125, 'info': {'runtime': 15.135839939117432, 'histories': {'loss': [2.324994927547017, 2.2326885051414616], 'val_loss': [2.330936908721924, 2.2062716484069824], 'acc': [0.10655737680489899, 0.11475410055918772], 'val_acc': [0.0625, 0.21875]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 57)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 43)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 43) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 56) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 43) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 43) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 43)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 116, 'zoom_range': 0.0, 'cnn_learning_rate': 4.1668628344560094e-05, 'unfreeze_percentage': 0.07318801160647144, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 150, 'batch_size': 61, 'num_dense_units_2': 23, 'learning_rate': 0.0001749385513391603, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:48:52.861480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.3356 - acc: 0.1050 - val_loss: 2.4054 - val_acc: 0.0625
Epoch 2/2
 - 5s - loss: 2.2064 - acc: 0.2377 - val_loss: 2.3898 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 43), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 43) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 43) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 43) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 43)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 116, 'zoom_range': 0.0, 'cnn_learning_rate': 4.1668628344560094e-05, 'unfreeze_percentage': 0.07318801160647144, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 150, 'batch_size': 61, 'num_dense_units_2': 23, 'learning_rate': 0.0001749385513391603, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 15.181139707565308, 'histories': {'loss': [2.339512522857968, 2.2064194679260254], 'val_loss': [2.4054055213928223, 2.3898277282714844], 'acc': [0.10891088784331142, 0.23770491033792496], 'val_acc': [0.0625, 0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 43)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 56)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 56) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 21) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 56) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 56)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 624, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008663681836582676, 'unfreeze_percentage': 0.22190523731877246, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 85, 'batch_size': 36, 'learning_rate': 0.0003775798873630235, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:49:13.873308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.4501 - acc: 0.1548 - val_loss: 2.2248 - val_acc: 0.1406
Epoch 2/2
 - 5s - loss: 2.1708 - acc: 0.2014 - val_loss: 2.2456 - val_acc: 0.2031
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 56), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 56) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 56)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 624, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008663681836582676, 'unfreeze_percentage': 0.22190523731877246, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 85, 'batch_size': 36, 'learning_rate': 0.0003775798873630235, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.796875, 'info': {'runtime': 24.886474609375, 'histories': {'loss': [2.468927724020822, 2.1707906126976013], 'val_loss': [2.2247724533081055, 2.2456297874450684], 'acc': [0.13492063965116227, 0.2013888955116272], 'val_acc': [0.140625, 0.203125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 56)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 21)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 21) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 40) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 21) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 21) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 21)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 855, 'zoom_range': 0.0, 'cnn_learning_rate': 1.0914801814100896e-05, 'unfreeze_percentage': 0.13622352685236144, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 139, 'batch_size': 24, 'num_dense_units_2': 66, 'learning_rate': 0.0005009194943239991, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:49:33.343909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.6059 - acc: 0.1667 - val_loss: 2.6079 - val_acc: 0.0909
Epoch 2/2
 - 4s - loss: 1.4416 - acc: 0.5602 - val_loss: 2.6600 - val_acc: 0.1039
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 21), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 21) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 21) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 21) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 21)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 855, 'zoom_range': 0.0, 'cnn_learning_rate': 1.0914801814100896e-05, 'unfreeze_percentage': 0.13622352685236144, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 139, 'batch_size': 24, 'num_dense_units_2': 66, 'learning_rate': 0.0005009194943239991, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.8961038951362882, 'info': {'runtime': 15.04891037940979, 'histories': {'loss': [2.6059075196584067, 1.4448213577270508], 'val_loss': [2.6079287188393727, 2.6599535384735504], 'acc': [0.16666666915019354, 0.560606065121564], 'val_acc': [0.09090909090909091, 0.10389610486371177]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 21)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 40)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 40) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 19) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 40) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 40)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 509, 'zoom_range': 0.0, 'cnn_learning_rate': 1.0296398920617354e-05, 'unfreeze_percentage': 0.06768409623555426, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 77, 'batch_size': 18, 'num_dense_units_2': 15, 'learning_rate': 0.0073802973172579465, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:49:49.862492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.3239 - acc: 0.0988 - val_loss: 2.3071 - val_acc: 0.0826
Epoch 2/2
 - 5s - loss: 2.2985 - acc: 0.1235 - val_loss: 2.2796 - val_acc: 0.1284
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 40), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 40) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 40)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 509, 'zoom_range': 0.0, 'cnn_learning_rate': 1.0296398920617354e-05, 'unfreeze_percentage': 0.06768409623555426, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 77, 'batch_size': 18, 'num_dense_units_2': 15, 'learning_rate': 0.0073802973172579465, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8715596326857532, 'info': {'runtime': 18.383300304412842, 'histories': {'loss': [2.323899745941162, 2.2985424200693765], 'val_loss': [2.307082307448081, 2.2795672547926595], 'acc': [0.09876543366246754, 0.12345679228504498], 'val_acc': [0.0825688076812193, 0.12844036731424682]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 40)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 19)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 19) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 55) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 19) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 19) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 19)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 262, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00011270861688737107, 'unfreeze_percentage': 0.007735940066590851, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 159, 'batch_size': 22, 'learning_rate': 0.00045470720205832726, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:50:08.357129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.3457 - acc: 0.1745 - val_loss: 2.2373 - val_acc: 0.1169
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/2
 - 5s - loss: 2.0829 - acc: 0.3117 - val_loss: 2.1819 - val_acc: 0.2078
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 19), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 19) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 19) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 19) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 19)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 262, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00011270861688737107, 'unfreeze_percentage': 0.007735940066590851, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 159, 'batch_size': 22, 'learning_rate': 0.00045470720205832726, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.7922077912401844, 'info': {'runtime': 17.899656057357788, 'histories': {'loss': [2.3658090012414115, 2.0829128878457204], 'val_loss': [2.237276857549494, 2.181913050738248], 'acc': [0.15714286118745804, 0.3116883188486099], 'val_acc': [0.11688311736692082, 0.20779220875981566]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 19)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 55)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 55) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 18) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 55) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 55) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 55)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 105, 'zoom_range': 0.0, 'cnn_learning_rate': 1.894678710082623e-05, 'unfreeze_percentage': 0.09775102294953926, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 187, 'batch_size': 31, 'num_dense_units_2': 90, 'learning_rate': 0.00025746219627680803, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:50:24.926568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.3598 - acc: 0.0849 - val_loss: 2.3453 - val_acc: 0.0938
Epoch 2/2
 - 4s - loss: 2.1240 - acc: 0.3161 - val_loss: 2.3327 - val_acc: 0.0781
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 55), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 55) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 55) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 55) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 55)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 105, 'zoom_range': 0.0, 'cnn_learning_rate': 1.894678710082623e-05, 'unfreeze_percentage': 0.09775102294953926, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 187, 'batch_size': 31, 'num_dense_units_2': 90, 'learning_rate': 0.00025746219627680803, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.921875, 'info': {'runtime': 14.1457359790802, 'histories': {'loss': [2.3754727858623474, 2.1239638805389403], 'val_loss': [2.345289707183838, 2.3327345848083496], 'acc': [0.07633587615635559, 0.3161290228366852], 'val_acc': [0.09375, 0.078125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 55)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 18)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 18) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 3) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 18) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 18) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 18)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 326, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001381059807167892, 'unfreeze_percentage': 0.10108310530940867, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 110, 'batch_size': 40, 'num_dense_units_2': 120, 'learning_rate': 0.0004717967871585603, 'base_model': 'InceptionV3', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:50:40.569517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.5674 - acc: 0.0863 - val_loss: 2.5985 - val_acc: 0.0625
Epoch 2/2
 - 4s - loss: 2.2319 - acc: 0.2830 - val_loss: 2.6615 - val_acc: 0.0625
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 18), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 18) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 18) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 18) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 18)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 326, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001381059807167892, 'unfreeze_percentage': 0.10108310530940867, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 110, 'batch_size': 40, 'num_dense_units_2': 120, 'learning_rate': 0.0004717967871585603, 'base_model': 'InceptionV3', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.9375, 'info': {'runtime': 15.978113412857056, 'histories': {'loss': [2.473930296350698, 2.581296923707743], 'val_loss': [2.5985140800476074, 2.66147780418396], 'acc': [0.10655738291193227, 0.11475409860493707], 'val_acc': [0.0625, 0.0625]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 18)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 3)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 3) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 16) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 3) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 3)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 101, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002142322679453026, 'unfreeze_percentage': 0.039343754839301914, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 66, 'batch_size': 62, 'num_dense_units_2': 24, 'learning_rate': 0.00014044920247110229, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:50:54.530696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.4367 - acc: 0.1210 - val_loss: 2.5566 - val_acc: 0.0938
Epoch 2/2
 - 3s - loss: 2.1857 - acc: 0.2691 - val_loss: 2.4970 - val_acc: 0.0312
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 3)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 101, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002142322679453026, 'unfreeze_percentage': 0.039343754839301914, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 66, 'batch_size': 62, 'num_dense_units_2': 24, 'learning_rate': 0.00014044920247110229, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.96875, 'info': {'runtime': 11.722150087356567, 'histories': {'loss': [2.4366602897644043, 2.185316843986511], 'val_loss': [2.556556463241577, 2.49700927734375], 'acc': [0.12096773833036423, 0.2699999892711639], 'val_acc': [0.09375, 0.03125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 3)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 16)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 16) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 16) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 16) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 16)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 530, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001982423155407523, 'unfreeze_percentage': 0.20806765098101035, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 181, 'batch_size': 17, 'learning_rate': 0.00011613751962476157, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:51:07.282878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.1771 - acc: 0.2563 - val_loss: 2.5055 - val_acc: 0.0459
Epoch 2/2
 - 4s - loss: 1.5329 - acc: 0.5716 - val_loss: 2.5361 - val_acc: 0.0826
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 16), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 16) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 16) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 16) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 16)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 530, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001982423155407523, 'unfreeze_percentage': 0.20806765098101035, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 181, 'batch_size': 17, 'learning_rate': 0.00011613751962476157, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.9174311926605505, 'info': {'runtime': 14.525239944458008, 'histories': {'loss': [2.164070964681691, 1.5320708184406675], 'val_loss': [2.5055221548867883, 2.536093361880801], 'acc': [0.2689655221741775, 0.5724138098544088], 'val_acc': [0.04587155997479728, 0.08256880733944955]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 16)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 2)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 2) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 51) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 891, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017796954308221165, 'unfreeze_percentage': 0.04478912477888884, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 109, 'batch_size': 49, 'learning_rate': 0.00034997214739956715, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:51:20.857025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.5323 - acc: 0.1769 - val_loss: 2.2075 - val_acc: 0.1875
Epoch 2/2
 - 3s - loss: 1.6599 - acc: 0.4802 - val_loss: 2.0684 - val_acc: 0.2812
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 2)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 891, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017796954308221165, 'unfreeze_percentage': 0.04478912477888884, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 109, 'batch_size': 49, 'learning_rate': 0.00034997214739956715, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.71875, 'info': {'runtime': 11.523734331130981, 'histories': {'loss': [2.5323095321655273, 1.6737674654057595], 'val_loss': [2.2075159549713135, 2.0683631896972656], 'acc': [0.17687074343363443, 0.4690265304746881], 'val_acc': [0.1875, 0.28125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 51)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 51) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 37) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 51) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 51) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 51)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 304, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001464566598910424, 'unfreeze_percentage': 0.05320190245643912, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 463, 'batch_size': 22, 'learning_rate': 0.00020049243043823047, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:51:33.665408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.4006 - acc: 0.1623 - val_loss: 2.4390 - val_acc: 0.1169
Epoch 2/2
 - 4s - loss: 2.4466 - acc: 0.1267 - val_loss: 2.4455 - val_acc: 0.1299
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 51), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 51) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 51) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 51) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 51)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 304, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001464566598910424, 'unfreeze_percentage': 0.05320190245643912, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 463, 'batch_size': 22, 'learning_rate': 0.00020049243043823047, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8701298674205681, 'info': {'runtime': 14.520141363143921, 'histories': {'loss': [2.400618212563651, 2.428962026323591], 'val_loss': [2.4390062945229665, 2.445535591670445], 'acc': [0.16233766504696437, 0.12698413029549613], 'val_acc': [0.11688311959241891, 0.12987013257943192]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 51)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 37)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 37) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 50) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 37) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 37) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 37)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 306, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00011821544704388889, 'unfreeze_percentage': 0.207186701355353, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 153, 'batch_size': 50, 'learning_rate': 0.00039289466068720327, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:51:53.543043: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.4278 - acc: 0.0933 - val_loss: 2.3496 - val_acc: 0.0938
Epoch 2/2
 - 4s - loss: 2.4208 - acc: 0.1304 - val_loss: 2.3905 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 37), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 37) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 37) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 37) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 37)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 306, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00011821544704388889, 'unfreeze_percentage': 0.207186701355353, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 153, 'batch_size': 50, 'learning_rate': 0.00039289466068720327, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.875, 'info': {'runtime': 24.45879554748535, 'histories': {'loss': [2.427826166152954, 2.4419156409598686], 'val_loss': [2.3495850563049316, 2.390523672103882], 'acc': [0.09333332752188046, 0.1081081085108422], 'val_acc': [0.09375, 0.125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 37)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 50)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 50) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 29) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 50) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 50) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 50)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 132, 'zoom_range': 0.0, 'cnn_learning_rate': 2.0035115628292118e-05, 'unfreeze_percentage': 0.1371384893108897, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 268, 'batch_size': 27, 'num_dense_units_2': 30, 'learning_rate': 0.007526756208708737, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:52:18.376020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.8554 - acc: 0.1111 - val_loss: 2.5936 - val_acc: 0.0781
Epoch 2/2
 - 6s - loss: 2.5157 - acc: 0.0556 - val_loss: 2.3101 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 50), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 50) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 50) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 50) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 50)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 132, 'zoom_range': 0.0, 'cnn_learning_rate': 2.0035115628292118e-05, 'unfreeze_percentage': 0.1371384893108897, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 268, 'batch_size': 27, 'num_dense_units_2': 30, 'learning_rate': 0.007526756208708737, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.890625, 'info': {'runtime': 26.35155487060547, 'histories': {'loss': [2.8553667465845742, 2.5156710545221963], 'val_loss': [2.5936131477355957, 2.3101176023483276], 'acc': [0.1111111119389534, 0.0555555559694767], 'val_acc': [0.078125, 0.109375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 50)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 29)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 29) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 49) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 29) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 29) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 29)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 124, 'zoom_range': 0.0, 'cnn_learning_rate': 1.1006188626779592e-05, 'unfreeze_percentage': 0.2952933298998556, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 83, 'batch_size': 26, 'num_dense_units_2': 30, 'learning_rate': 0.009691940982068343, 'base_model': 'InceptionV3', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:52:40.445739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.7706 - acc: 0.0982 - val_loss: 2.4981 - val_acc: 0.0938
Epoch 2/2
 - 4s - loss: 2.4918 - acc: 0.0577 - val_loss: 2.3345 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 29), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 29) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 29) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 29) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 29)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 124, 'zoom_range': 0.0, 'cnn_learning_rate': 1.1006188626779592e-05, 'unfreeze_percentage': 0.2952933298998556, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 83, 'batch_size': 26, 'num_dense_units_2': 30, 'learning_rate': 0.009691940982068343, 'base_model': 'InceptionV3', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 16.548120260238647, 'histories': {'loss': [2.772017065216513, 2.491772929827372], 'val_loss': [2.498081684112549, 2.334464192390442], 'acc': [0.11029412318021059, 0.05769231046239535], 'val_acc': [0.09375, 0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 29)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 49)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 49) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 35) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 49) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 49)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 589, 'zoom_range': 0.0, 'cnn_learning_rate': 1.3170303961801553e-05, 'unfreeze_percentage': 0.14820919345375544, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 115, 'batch_size': 16, 'num_dense_units_2': 33, 'learning_rate': 0.00021286728139435177, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:52:55.655375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.3823 - acc: 0.0883 - val_loss: 2.2363 - val_acc: 0.1651
Epoch 2/2
 - 6s - loss: 1.7698 - acc: 0.4688 - val_loss: 1.9570 - val_acc: 0.3486
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 49), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 49) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 49)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 589, 'zoom_range': 0.0, 'cnn_learning_rate': 1.3170303961801553e-05, 'unfreeze_percentage': 0.14820919345375544, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 115, 'batch_size': 16, 'num_dense_units_2': 33, 'learning_rate': 0.00021286728139435177, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.6513761448750802, 'info': {'runtime': 17.254876613616943, 'histories': {'loss': [2.37271385976713, 1.7698121190071106], 'val_loss': [2.236267697920493, 1.956992527760497], 'acc': [0.0958904109589041, 0.46875], 'val_acc': [0.1651376165928097, 0.3486238551249198]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 49)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 35)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 35) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 28) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 35) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 35) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 35)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 718, 'zoom_range': 0.0, 'cnn_learning_rate': 2.4748650169447134e-05, 'unfreeze_percentage': 0.11928912369964287, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 131, 'batch_size': 24, 'learning_rate': 0.0004808595538300197, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:53:14.169456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.3836 - acc: 0.0948 - val_loss: 2.3467 - val_acc: 0.0519
Epoch 2/2
 - 5s - loss: 2.3710 - acc: 0.1088 - val_loss: 2.3352 - val_acc: 0.0779
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 35), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 35) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 35) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 35) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 35)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 718, 'zoom_range': 0.0, 'cnn_learning_rate': 2.4748650169447134e-05, 'unfreeze_percentage': 0.11928912369964287, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 131, 'batch_size': 24, 'learning_rate': 0.0004808595538300197, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.9220779215941182, 'info': {'runtime': 17.016727209091187, 'histories': {'loss': [2.3864999232084854, 2.3725455532903257], 'val_loss': [2.3467317649296353, 2.3352106948951623], 'acc': [0.09420290103425151, 0.10869565508935762], 'val_acc': [0.05194805194805195, 0.07792207840588186]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 35)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 28)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 28) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 14) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 28) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 28) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 28)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 459, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00023567613196179572, 'unfreeze_percentage': 0.01981091363080779, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 408, 'batch_size': 36, 'num_dense_units_2': 205, 'learning_rate': 0.0037187620746642626, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:53:30.078892: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.4724 - acc: 0.0897 - val_loss: 2.5006 - val_acc: 0.1250
Epoch 2/2
 - 4s - loss: 2.3470 - acc: 0.1508 - val_loss: 2.4474 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 28), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 28) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 28) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 28) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 28)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 459, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00023567613196179572, 'unfreeze_percentage': 0.01981091363080779, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 408, 'batch_size': 36, 'num_dense_units_2': 205, 'learning_rate': 0.0037187620746642626, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.84375, 'info': {'runtime': 14.954632759094238, 'histories': {'loss': [2.4754420689174106, 2.347595827920096], 'val_loss': [2.500560998916626, 2.447442650794983], 'acc': [0.08730158848421914, 0.14285714711461747], 'val_acc': [0.125, 0.15625]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 28)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 14)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 14) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 27) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 14) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 14) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 14)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 449, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00012696418998944746, 'unfreeze_percentage': 0.14483784154926785, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 364, 'batch_size': 25, 'learning_rate': 0.00033825819329138027, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:53:50.645545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.3992 - acc: 0.1211 - val_loss: 2.2623 - val_acc: 0.2208
Epoch 2/2
 - 6s - loss: 1.9554 - acc: 0.4733 - val_loss: 2.2263 - val_acc: 0.1688
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 14), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 14) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 14) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 14) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 14)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 449, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00012696418998944746, 'unfreeze_percentage': 0.14483784154926785, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 364, 'batch_size': 25, 'learning_rate': 0.00033825819329138027, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.8311688306850272, 'info': {'runtime': 26.547672986984253, 'histories': {'loss': [2.4075885288906793, 1.955409010251363], 'val_loss': [2.2622995252733107, 2.22633678882153], 'acc': [0.12408758884798872, 0.47333332896232605], 'val_acc': [0.22077922174682865, 0.16883116931497277]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 14)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 27)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 27) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 13) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 27) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 27) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 27)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 373, 'zoom_range': 0.0, 'cnn_learning_rate': 2.740421875387178e-05, 'unfreeze_percentage': 0.273090266340852, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 72, 'batch_size': 38, 'num_dense_units_2': 17, 'learning_rate': 0.003382010468032159, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:54:10.797019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.9689 - acc: 0.0688 - val_loss: 2.2317 - val_acc: 0.2500
Epoch 2/2
 - 3s - loss: 2.0747 - acc: 0.1866 - val_loss: 1.9515 - val_acc: 0.2656
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 27), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 27) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 27) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 27) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 27)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 373, 'zoom_range': 0.0, 'cnn_learning_rate': 2.740421875387178e-05, 'unfreeze_percentage': 0.273090266340852, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 72, 'batch_size': 38, 'num_dense_units_2': 17, 'learning_rate': 0.003382010468032159, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.734375, 'info': {'runtime': 11.946430683135986, 'histories': {'loss': [3.0081376144962926, 2.0830127885264735], 'val_loss': [2.231660008430481, 1.9514609575271606], 'acc': [0.08064516303279708, 0.20161291392099473], 'val_acc': [0.25, 0.265625]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 27)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 13)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 13) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 63) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 13) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 13) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 13)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 349, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0006831020214714252, 'unfreeze_percentage': 0.2642007578252278, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 242, 'batch_size': 54, 'learning_rate': 0.0011044654541744778, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 13:54:24.123920: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.3760 - acc: 0.0988 - val_loss: 2.3576 - val_acc: 0.0625
Epoch 2/2
 - 5s - loss: 2.3732 - acc: 0.0864 - val_loss: 2.3820 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 13), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 13) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 13) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 13) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 13)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 349, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0006831020214714252, 'unfreeze_percentage': 0.2642007578252278, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 242, 'batch_size': 54, 'learning_rate': 0.0011044654541744778, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.875, 'info': {'runtime': 16.550336837768555, 'histories': {'loss': [2.376049280166626, 2.373150904973348], 'val_loss': [2.357619285583496, 2.382044792175293], 'acc': [0.09876543159286182, 0.08641975248853366], 'val_acc': [0.0625, 0.125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 13)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 63)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 63) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 33) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 63) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 63) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 63)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 197, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004031273462513609, 'unfreeze_percentage': 0.19537368440648187, 'rotation_range': 0, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 54, 'batch_size': 25, 'learning_rate': 0.0005752311183739589, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:54:40.421354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.6864 - acc: 0.1487 - val_loss: 2.2468 - val_acc: 0.2727
Epoch 2/2
 - 5s - loss: 1.6966 - acc: 0.3970 - val_loss: 2.2110 - val_acc: 0.2078
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 63), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 63) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 63) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 63) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 63)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 197, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004031273462513609, 'unfreeze_percentage': 0.19537368440648187, 'rotation_range': 0, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 54, 'batch_size': 25, 'learning_rate': 0.0005752311183739589, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.7922077912401844, 'info': {'runtime': 15.77578353881836, 'histories': {'loss': [2.6215123834401153, 1.694905600408568], 'val_loss': [2.2467738343523695, 2.2110332544747884], 'acc': [0.1605839380165086, 0.40875911408097204], 'val_acc': [0.27272727543657477, 0.20779220875981566]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 63)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 33)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 33) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 26) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 33) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 33)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 634, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008125354300193659, 'unfreeze_percentage': 0.2342130265714623, 'rotation_range': 0, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 183, 'batch_size': 33, 'learning_rate': 0.0009181489776842441, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:54:56.266173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 4.9350 - acc: 0.0843 - val_loss: 3.3728 - val_acc: 0.1406
Epoch 2/2
 - 5s - loss: 3.0361 - acc: 0.1306 - val_loss: 2.2726 - val_acc: 0.2656
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 33), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 33) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 33)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 634, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008125354300193659, 'unfreeze_percentage': 0.2342130265714623, 'rotation_range': 0, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 183, 'batch_size': 33, 'learning_rate': 0.0009181489776842441, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.734375, 'info': {'runtime': 15.251951694488525, 'histories': {'loss': [4.86885507716689, 3.0474691169206487], 'val_loss': [3.372842311859131, 2.272581696510315], 'acc': [0.08527132054400999, 0.13178295001041057], 'val_acc': [0.140625, 0.265625]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 33)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 26)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 26) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 47) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 26) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 26) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 26)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 129, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00010141078768957874, 'unfreeze_percentage': 0.008685523804271966, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 421, 'batch_size': 16, 'num_dense_units_2': 181, 'learning_rate': 0.002829961330365634, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:55:17.481291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 8s - loss: 3.1420 - acc: 0.0757 - val_loss: 2.6291 - val_acc: 0.1193
Epoch 2/2
 - 6s - loss: 2.3355 - acc: 0.2352 - val_loss: 2.2849 - val_acc: 0.1468
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 26), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 26) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 26) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 26) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 26)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 129, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00010141078768957874, 'unfreeze_percentage': 0.008685523804271966, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 421, 'batch_size': 16, 'num_dense_units_2': 181, 'learning_rate': 0.002829961330365634, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.8532110072604013, 'info': {'runtime': 26.576269149780273, 'histories': {'loss': [3.0377596567754876, 2.376320135103513], 'val_loss': [2.6291426015556407, 2.2848991035321435], 'acc': [0.0821917808219178, 0.21232876712328766], 'val_acc': [0.11926605504587157, 0.1467889927395987]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 26)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 47)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 47) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 24) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 47) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 47)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 155, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005382208007501695, 'unfreeze_percentage': 0.006228173460867536, 'rotation_range': 0, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 180, 'batch_size': 42, 'num_dense_units_2': 98, 'learning_rate': 0.0021581339832599158, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:55:37.942462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.7418 - acc: 0.1386 - val_loss: 3.6997 - val_acc: 0.0938
Epoch 2/2
 - 3s - loss: 2.8317 - acc: 0.1270 - val_loss: 2.5586 - val_acc: 0.1875
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 47), trying to register it.
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 47)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 155, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005382208007501695, 'unfreeze_percentage': 0.006228173460867536, 'rotation_range': 0, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 180, 'batch_size': 42, 'num_dense_units_2': 98, 'learning_rate': 0.0021581339832599158, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.8125, 'info': {'runtime': 11.76216435432434, 'histories': {'loss': [2.750584077835083, 2.831732193628947], 'val_loss': [3.6997244358062744, 2.558581590652466], 'acc': [0.14166667237877845, 0.1269841343164444], 'val_acc': [0.09375, 0.1875]}}}
exception: None

INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 47) with dispatcher
DEBUG:hpbandster:job_callback for (0, 0, 47)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 24)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 24) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 10) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 24) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 24)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 314, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002801880800492117, 'unfreeze_percentage': 0.29798698682578195, 'rotation_range': 0, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 52, 'batch_size': 19, 'learning_rate': 0.00023699920284707778, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:55:55.706764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.3350 - acc: 0.1457 - val_loss: 2.2619 - val_acc: 0.1193
Epoch 2/2
 - 6s - loss: 2.1787 - acc: 0.3231 - val_loss: 2.2415 - val_acc: 0.2202
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 24), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 24) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 24)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 314, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002801880800492117, 'unfreeze_percentage': 0.29798698682578195, 'rotation_range': 0, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 52, 'batch_size': 19, 'learning_rate': 0.00023699920284707778, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.7798165099336467, 'info': {'runtime': 26.069507598876953, 'histories': {'loss': [2.335708049627451, 2.186111341823231], 'val_loss': [2.2618849846201203, 2.2415450997308852], 'acc': [0.15384615400245974, 0.30769230539982134], 'val_acc': [0.11926605538764132, 0.22018349006635332]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 24)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 10)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 10) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 60) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 10) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 10) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 10)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 434, 'zoom_range': 0.0, 'cnn_learning_rate': 5.842470169221864e-05, 'unfreeze_percentage': 0.11415033233164489, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 59, 'batch_size': 28, 'learning_rate': 0.0024246393202496863, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:56:22.398111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 7.2139 - acc: 0.1393 - val_loss: 5.5308 - val_acc: 0.0781
Epoch 2/2
 - 5s - loss: 3.5909 - acc: 0.0952 - val_loss: 2.8694 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 10), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 10) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 10) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 10) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 10)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 434, 'zoom_range': 0.0, 'cnn_learning_rate': 5.842470169221864e-05, 'unfreeze_percentage': 0.11415033233164489, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 59, 'batch_size': 28, 'learning_rate': 0.0024246393202496863, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 25.793204069137573, 'histories': {'loss': [7.197946534227969, 3.552421826035229], 'val_loss': [5.530788898468018, 2.8694359064102173], 'acc': [0.13432836510352233, 0.0970149311556745], 'val_acc': [0.078125, 0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 10)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 60)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 60) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 60) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 1) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 60)
DEBUG:hpbandster:DISPATCHER: job (0, 0, 60) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 247, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0003292559617912699, 'unfreeze_percentage': 0.1457800690189708, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 322, 'batch_size': 22, 'learning_rate': 0.004668061834869695, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:56:41.463405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 3.1378 - acc: 0.1446 - val_loss: 2.8993 - val_acc: 0.2078
Epoch 2/2
 - 4s - loss: 2.2138 - acc: 0.3520 - val_loss: 1.7668 - val_acc: 0.4805
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 60), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 60) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 60) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 60) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 60)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 247, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0003292559617912699, 'unfreeze_percentage': 0.1457800690189708, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 322, 'batch_size': 22, 'learning_rate': 0.004668061834869695, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.5194805163841743, 'info': {'runtime': 11.809827089309692, 'histories': {'loss': [3.1569046497344972, 2.2709838594709124], 'val_loss': [2.899290419244147, 1.7667510261783352], 'acc': [0.15714286182607923, 0.3500000027673585], 'val_acc': [0.20779221050150984, 0.4805194836158257]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 60)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 1)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 1) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 1) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 46) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 1) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 193, 'zoom_range': 0.0, 'cnn_learning_rate': 0.000579851875049454, 'unfreeze_percentage': 0.25185935108768076, 'rotation_range': 0, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 172, 'batch_size': 31, 'num_dense_units_2': 56, 'learning_rate': 0.006906938090900082, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:56:55.369474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.7179 - acc: 0.1355 - val_loss: 2.5955 - val_acc: 0.0938
Epoch 2/2
 - 4s - loss: 2.0684 - acc: 0.2031 - val_loss: 2.3605 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 1) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 1)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 193, 'zoom_range': 0.0, 'cnn_learning_rate': 0.000579851875049454, 'unfreeze_percentage': 0.25185935108768076, 'rotation_range': 0, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 172, 'batch_size': 31, 'num_dense_units_2': 56, 'learning_rate': 0.006906938090900082, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.890625, 'info': {'runtime': 14.440201997756958, 'histories': {'loss': [2.7178604125976564, 2.079284213881456], 'val_loss': [2.5954840183258057, 2.3604979515075684], 'acc': [0.13548386693000794, 0.19083969010651566], 'val_acc': [0.09375, 0.109375]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 1)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 46)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 46) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 45) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 46) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 46)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 141, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00035400466876502415, 'unfreeze_percentage': 0.12240612398788327, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 52, 'batch_size': 34, 'learning_rate': 0.00023117335827220676, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:57:08.922855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.3419 - acc: 0.1618 - val_loss: 2.2787 - val_acc: 0.2188
Epoch 2/4
 - 5s - loss: 1.9411 - acc: 0.4014 - val_loss: 2.2056 - val_acc: 0.1875
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/4
 - 5s - loss: 1.7464 - acc: 0.5074 - val_loss: 2.1577 - val_acc: 0.2656
Epoch 4/4
 - 5s - loss: 1.5330 - acc: 0.7008 - val_loss: 2.1441 - val_acc: 0.2500
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 46), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 46) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 46)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 141, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00035400466876502415, 'unfreeze_percentage': 0.12240612398788327, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 52, 'batch_size': 34, 'learning_rate': 0.00023117335827220676, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.75, 'info': {'runtime': 24.572947025299072, 'histories': {'loss': [2.3360352776944637, 1.9426409807056189, 1.746378630399704, 1.530872467905283], 'val_loss': [2.2787094116210938, 2.2056440114974976, 2.1577277183532715, 2.144139051437378], 'acc': [0.16406250512227416, 0.3984375239815563, 0.5073529705405235, 0.7031250353902578], 'val_acc': [0.21875, 0.1875, 0.265625, 0.25]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 46)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 45)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 45) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 57) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 45) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 45) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 45)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 139, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002297025343878985, 'unfreeze_percentage': 0.20398138922964634, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 383, 'batch_size': 49, 'num_dense_units_2': 67, 'learning_rate': 0.0004459470835960811, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:57:35.019919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.3271 - acc: 0.0774 - val_loss: 2.3063 - val_acc: 0.0312
Epoch 2/4
 - 4s - loss: 2.3137 - acc: 0.1078 - val_loss: 2.3120 - val_acc: 0.0312
Epoch 3/4
 - 4s - loss: 2.3516 - acc: 0.0680 - val_loss: 2.2682 - val_acc: 0.0938
Epoch 4/4
 - 4s - loss: 2.3239 - acc: 0.1182 - val_loss: 2.2444 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 45), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 45) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 45) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 45) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 45)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 139, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002297025343878985, 'unfreeze_percentage': 0.20398138922964634, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 383, 'batch_size': 49, 'num_dense_units_2': 67, 'learning_rate': 0.0004459470835960811, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 22.648815155029297, 'histories': {'loss': [2.325449287363913, 2.3271661522114173, 2.3515961170196533, 2.320238022677666], 'val_loss': [2.3062705993652344, 2.3120288848876953, 2.268160820007324, 2.244417190551758], 'acc': [0.07964601832549129, 0.08849557551794347, 0.06802721073230107, 0.11504424752387325], 'val_acc': [0.03125, 0.03125, 0.09375, 0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 45)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 57)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 57) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 56) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 57) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 57) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 57)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 277, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008414368670047831, 'unfreeze_percentage': 0.10390831707680268, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 244, 'batch_size': 40, 'num_dense_units_2': 15, 'learning_rate': 0.0008752366613374467, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:57:55.644910: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.4286 - acc: 0.0875 - val_loss: 2.3580 - val_acc: 0.1875
Epoch 2/4
 - 3s - loss: 2.3746 - acc: 0.0930 - val_loss: 2.4086 - val_acc: 0.2188
Epoch 3/4
 - 3s - loss: 2.2330 - acc: 0.0295 - val_loss: 2.4107 - val_acc: 0.0625
Epoch 4/4
 - 3s - loss: 2.3865 - acc: 0.0938 - val_loss: 2.5389 - val_acc: 0.0000e+00
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 57), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 57) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 57) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 57) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 57)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 277, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008414368670047831, 'unfreeze_percentage': 0.10390831707680268, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 244, 'batch_size': 40, 'num_dense_units_2': 15, 'learning_rate': 0.0008752366613374467, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 1.0, 'info': {'runtime': 17.30945587158203, 'histories': {'loss': [2.4286245107650757, 2.4008251369976605, 2.371817185765221, 2.386455476284027], 'val_loss': [2.3580029010772705, 2.4086127281188965, 2.410731554031372, 2.5389397144317627], 'acc': [0.08750000223517418, 0.11475410373484501, 0.04761904832862672, 0.09375000093132257], 'val_acc': [0.1875, 0.21875, 0.0625, 0.0]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 57)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 56)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 56) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 19) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 56) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 56)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 624, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008663681836582676, 'unfreeze_percentage': 0.22190523731877246, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 85, 'batch_size': 36, 'learning_rate': 0.0003775798873630235, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:58:19.165812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 7s - loss: 2.4118 - acc: 0.1056 - val_loss: 2.3095 - val_acc: 0.0938
Epoch 2/4
 - 5s - loss: 2.2235 - acc: 0.2153 - val_loss: 2.1974 - val_acc: 0.2500
Epoch 3/4
 - 5s - loss: 1.9791 - acc: 0.2833 - val_loss: 2.1568 - val_acc: 0.2500
Epoch 4/4
 - 5s - loss: 1.7655 - acc: 0.5130 - val_loss: 2.2074 - val_acc: 0.1875
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 56), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 56) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 56)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 624, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008663681836582676, 'unfreeze_percentage': 0.22190523731877246, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 85, 'batch_size': 36, 'learning_rate': 0.0003775798873630235, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8125, 'info': {'runtime': 35.17397093772888, 'histories': {'loss': [2.404299463544573, 2.223456025123596, 1.9865269831248693, 1.7571579217910767], 'val_loss': [2.3094749450683594, 2.197372555732727, 2.15682852268219, 2.207446813583374], 'acc': [0.11111111247113772, 0.21527778916060925, 0.27777779528072905, 0.5092592934767405], 'val_acc': [0.09375, 0.25, 0.25, 0.1875]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 56)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 19)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 19) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 19) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 19) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 19)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 262, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00011270861688737107, 'unfreeze_percentage': 0.007735940066590851, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 159, 'batch_size': 22, 'learning_rate': 0.00045470720205832726, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:58:50.515125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.3624 - acc: 0.0855 - val_loss: 2.3081 - val_acc: 0.1429
Epoch 2/4
 - 5s - loss: 2.0614 - acc: 0.3618 - val_loss: 2.2199 - val_acc: 0.1688
Epoch 3/4
 - 5s - loss: 1.8451 - acc: 0.4506 - val_loss: 2.0823 - val_acc: 0.3247
Epoch 4/4
 - 5s - loss: 1.6003 - acc: 0.4801 - val_loss: 2.0058 - val_acc: 0.3247
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 19), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 19) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 19) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 19) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 19)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 262, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00011270861688737107, 'unfreeze_percentage': 0.007735940066590851, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 159, 'batch_size': 22, 'learning_rate': 0.00045470720205832726, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.6753246699060713, 'info': {'runtime': 26.991725206375122, 'histories': {'loss': [2.3678413425173077, 2.071134555339813, 1.852424396787371, 1.570529694216592], 'val_loss': [2.3080641573125664, 2.2198545777952514, 2.0823479101255344, 2.0058310047372596], 'acc': [0.09285714562450137, 0.371428582072258, 0.45714286076171057, 0.5000000074505806], 'val_acc': [0.1428571447923586, 0.16883117154047086, 0.32467532564293256, 0.32467533009392874]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 19)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 2)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 2) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 49) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 891, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017796954308221165, 'unfreeze_percentage': 0.04478912477888884, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 109, 'batch_size': 49, 'learning_rate': 0.00034997214739956715, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 13:59:15.058037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 4s - loss: 2.5753 - acc: 0.1694 - val_loss: 2.4252 - val_acc: 0.2188
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/4
 - 3s - loss: 1.8168 - acc: 0.3473 - val_loss: 2.3412 - val_acc: 0.1562
Epoch 3/4
 - 3s - loss: 1.3874 - acc: 0.5306 - val_loss: 2.0913 - val_acc: 0.2500
Epoch 4/4
 - 3s - loss: 1.0500 - acc: 0.6215 - val_loss: 1.6601 - val_acc: 0.4062
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 2)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 891, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017796954308221165, 'unfreeze_percentage': 0.04478912477888884, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 109, 'batch_size': 49, 'learning_rate': 0.00034997214739956715, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.59375, 'info': {'runtime': 17.360514879226685, 'histories': {'loss': [2.533405301845179, 1.8603691843758643, 1.387427568435669, 1.116846421123606], 'val_loss': [2.4251718521118164, 2.341170072555542, 2.0913338661193848, 1.6601382493972778], 'acc': [0.1769911464864174, 0.3362831718626276, 0.5306122303009033, 0.584070759009471], 'val_acc': [0.21875, 0.15625, 0.25, 0.40625]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 49)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 49) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 28) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 49) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 49)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 589, 'zoom_range': 0.0, 'cnn_learning_rate': 1.3170303961801553e-05, 'unfreeze_percentage': 0.14820919345375544, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 115, 'batch_size': 16, 'num_dense_units_2': 33, 'learning_rate': 0.00021286728139435177, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 13:59:33.142261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.3050 - acc: 0.2813 - val_loss: 2.1129 - val_acc: 0.2477
Epoch 2/4
 - 6s - loss: 1.6651 - acc: 0.4562 - val_loss: 1.8476 - val_acc: 0.4220
Epoch 3/4
 - 5s - loss: 1.2980 - acc: 0.6481 - val_loss: 1.8190 - val_acc: 0.3945
Epoch 4/4
 - 6s - loss: 1.1307 - acc: 0.6937 - val_loss: 1.5691 - val_acc: 0.5321
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 49), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 49) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 49)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 589, 'zoom_range': 0.0, 'cnn_learning_rate': 1.3170303961801553e-05, 'unfreeze_percentage': 0.14820919345375544, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 115, 'batch_size': 16, 'num_dense_units_2': 33, 'learning_rate': 0.00021286728139435177, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.4678899060695543, 'info': {'runtime': 27.963488817214966, 'histories': {'loss': [2.359594661895543, 1.6651267051696776, 1.3095026756777908, 1.1306514382362365], 'val_loss': [2.1128699517031326, 1.84758549873982, 1.8189582135699212, 1.5690868896081906], 'acc': [0.2191780821917808, 0.45625, 0.6287878787878788, 0.69375], 'val_acc': [0.24770642270188814, 0.42201835299850604, 0.3944954142111157, 0.5321100939304457]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 49)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 28)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 28) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 14) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 28) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 28) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 28)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 459, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00023567613196179572, 'unfreeze_percentage': 0.01981091363080779, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 408, 'batch_size': 36, 'num_dense_units_2': 205, 'learning_rate': 0.0037187620746642626, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:00:02.004961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.3504 - acc: 0.1111 - val_loss: 2.3344 - val_acc: 0.0625
Epoch 2/4
 - 4s - loss: 2.2699 - acc: 0.1736 - val_loss: 2.3670 - val_acc: 0.0938
Epoch 3/4
 - 4s - loss: 2.2456 - acc: 0.1611 - val_loss: 2.3782 - val_acc: 0.0938
Epoch 4/4
 - 4s - loss: 2.1926 - acc: 0.2024 - val_loss: 2.3382 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 28), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 28) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 28) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 28) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 28)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 459, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00023567613196179572, 'unfreeze_percentage': 0.01981091363080779, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 408, 'batch_size': 36, 'num_dense_units_2': 205, 'learning_rate': 0.0037187620746642626, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.890625, 'info': {'runtime': 21.22802233695984, 'histories': {'loss': [2.344226598739624, 2.269856631755829, 2.2383064883095876, 2.1882529258728027], 'val_loss': [2.334352970123291, 2.3670250177383423, 2.3782399892807007, 2.3382294178009033], 'acc': [0.11111111406769071, 0.1736111156642437, 0.16666667056935175, 0.20634921320847102], 'val_acc': [0.0625, 0.09375, 0.09375, 0.109375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 28)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 14)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 14) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 27) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 14) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 14) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 14)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 449, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00012696418998944746, 'unfreeze_percentage': 0.14483784154926785, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 364, 'batch_size': 25, 'learning_rate': 0.00033825819329138027, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 14:00:28.541181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 8s - loss: 2.3154 - acc: 0.1867 - val_loss: 2.2210 - val_acc: 0.2078
Epoch 2/4
 - 6s - loss: 1.8679 - acc: 0.3729 - val_loss: 2.1726 - val_acc: 0.2468
Epoch 3/4
 - 6s - loss: 1.4716 - acc: 0.5333 - val_loss: 2.3987 - val_acc: 0.1688
Epoch 4/4
 - 6s - loss: 1.1305 - acc: 0.7038 - val_loss: 1.8135 - val_acc: 0.3896
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 14), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 14) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 14) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 14) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 14)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 449, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00012696418998944746, 'unfreeze_percentage': 0.14483784154926785, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 364, 'batch_size': 25, 'learning_rate': 0.00033825819329138027, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.61038960419692, 'info': {'runtime': 37.9090211391449, 'histories': {'loss': [2.315433382987976, 1.824866646720517, 1.4716280698776245, 1.1342240506715149], 'val_loss': [2.220981808451863, 2.1726472780301975, 2.3986531217376905, 1.8135137805691013], 'acc': [0.18666666001081467, 0.38709675724948606, 0.5333333164453506, 0.6934306343106458], 'val_acc': [0.20779221050150984, 0.2467532486884625, 0.1688311742497729, 0.38961039580308]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 14)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 27)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 27) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 63) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 27) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 27) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 27)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 373, 'zoom_range': 0.0, 'cnn_learning_rate': 2.740421875387178e-05, 'unfreeze_percentage': 0.273090266340852, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 72, 'batch_size': 38, 'num_dense_units_2': 17, 'learning_rate': 0.003382010468032159, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:00:59.919836: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.9032 - acc: 0.1041 - val_loss: 2.2594 - val_acc: 0.1875
Epoch 2/4
 - 3s - loss: 2.2664 - acc: 0.1908 - val_loss: 2.2619 - val_acc: 0.2500
Epoch 3/4
 - 3s - loss: 2.2382 - acc: 0.1248 - val_loss: 2.1505 - val_acc: 0.2500
Epoch 4/4
 - 3s - loss: 2.1282 - acc: 0.1660 - val_loss: 2.1662 - val_acc: 0.2656
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 27), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 27) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 27) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 27) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 27)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 373, 'zoom_range': 0.0, 'cnn_learning_rate': 2.740421875387178e-05, 'unfreeze_percentage': 0.273090266340852, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 72, 'batch_size': 38, 'num_dense_units_2': 17, 'learning_rate': 0.003382010468032159, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.734375, 'info': {'runtime': 17.702026844024658, 'histories': {'loss': [2.920107853028082, 2.266431212425232, 2.234415042784906, 2.1260038191272366], 'val_loss': [2.259438157081604, 2.2619128227233887, 2.150467872619629, 2.1661897897720337], 'acc': [0.10483871051861395, 0.19078947976231575, 0.12903225794434547, 0.1774193619287783], 'val_acc': [0.1875, 0.25, 0.25, 0.265625]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 27)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 63)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 63) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 33) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 63) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 63) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 63)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 197, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004031273462513609, 'unfreeze_percentage': 0.19537368440648187, 'rotation_range': 0, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 54, 'batch_size': 25, 'learning_rate': 0.0005752311183739589, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:01:19.056028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.6998 - acc: 0.1470 - val_loss: 2.0692 - val_acc: 0.2857
Epoch 2/4
 - 5s - loss: 1.8661 - acc: 0.3603 - val_loss: 1.8903 - val_acc: 0.4416
Epoch 3/4
 - 5s - loss: 1.4934 - acc: 0.5400 - val_loss: 1.7053 - val_acc: 0.5325
Epoch 4/4
 - 5s - loss: 1.1493 - acc: 0.7038 - val_loss: 1.8551 - val_acc: 0.2727
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 63), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 63) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 63) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 63) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 63)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 197, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004031273462513609, 'unfreeze_percentage': 0.19537368440648187, 'rotation_range': 0, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 54, 'batch_size': 25, 'learning_rate': 0.0005752311183739589, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.7272727253375115, 'info': {'runtime': 26.87799382209778, 'histories': {'loss': [2.748878905372898, 1.9040978250712375, 1.4933741688728333, 1.170380266478462], 'val_loss': [2.0692133500978542, 1.8903075982997943, 1.70526499407632, 1.8550787250716965], 'acc': [0.13868612605724892, 0.3357664148194076, 0.5399999767541885, 0.6934306451874058], 'val_acc': [0.28571428842358776, 0.441558445428873, 0.5324675371120502, 0.2727272746624885]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 63)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 33)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 33) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 26) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 33) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 33)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 634, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008125354300193659, 'unfreeze_percentage': 0.2342130265714623, 'rotation_range': 0, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 183, 'batch_size': 33, 'learning_rate': 0.0009181489776842441, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:01:45.654249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 4.6352 - acc: 0.0950 - val_loss: 3.8105 - val_acc: 0.0625
Epoch 2/4
 - 5s - loss: 2.6883 - acc: 0.1406 - val_loss: 2.1833 - val_acc: 0.1094
Epoch 3/4
 - 5s - loss: 1.8562 - acc: 0.3182 - val_loss: 2.4974 - val_acc: 0.0781
Epoch 4/4
 - 5s - loss: 1.7910 - acc: 0.3808 - val_loss: 2.0680 - val_acc: 0.2344
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 33), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 33) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 33)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 634, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008125354300193659, 'unfreeze_percentage': 0.2342130265714623, 'rotation_range': 0, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 183, 'batch_size': 33, 'learning_rate': 0.0009181489776842441, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.765625, 'info': {'runtime': 24.950348615646362, 'histories': {'loss': [4.6267146565193356, 2.6993695358897365, 1.8561517596244812, 1.7937509708626325], 'val_loss': [3.810525894165039, 2.1832692623138428, 2.4973801374435425, 2.0679811239242554], 'acc': [0.09302326135857161, 0.13953489065170288, 0.3181818276643753, 0.37984497048134025], 'val_acc': [0.0625, 0.109375, 0.078125, 0.234375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 33)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 26)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 26) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 47) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 26) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 26) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 26)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 129, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00010141078768957874, 'unfreeze_percentage': 0.008685523804271966, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 421, 'batch_size': 16, 'num_dense_units_2': 181, 'learning_rate': 0.002829961330365634, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:02:16.324759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 8s - loss: 2.8068 - acc: 0.1687 - val_loss: 2.4216 - val_acc: 0.2202
Epoch 2/4
 - 6s - loss: 2.3056 - acc: 0.2017 - val_loss: 2.2130 - val_acc: 0.2569
Epoch 3/4
 - 6s - loss: 2.0056 - acc: 0.2739 - val_loss: 2.4555 - val_acc: 0.2202
Epoch 4/4
 - 6s - loss: 1.8373 - acc: 0.3550 - val_loss: 1.8334 - val_acc: 0.4587
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 26), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 26) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 26) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 26) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 26)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 129, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00010141078768957874, 'unfreeze_percentage': 0.008685523804271966, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 421, 'batch_size': 16, 'num_dense_units_2': 181, 'learning_rate': 0.002829961330365634, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.5412844028494774, 'info': {'runtime': 38.607468605041504, 'histories': {'loss': [2.8068326473236085, 2.317470756295609, 1.9461530447006226, 1.8443273093602428], 'val_loss': [2.4216439505235865, 2.2129531956593924, 2.455530254119033, 1.8333911108314445], 'acc': [0.16875, 0.2191780821917808, 0.32575757575757575, 0.3424657534246575], 'val_acc': [0.22018348692207163, 0.25688073777277537, 0.22018348760561113, 0.4587155971505226]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 26)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 47)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 47) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 24) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 47) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 47)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 155, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005382208007501695, 'unfreeze_percentage': 0.006228173460867536, 'rotation_range': 0, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 180, 'batch_size': 42, 'num_dense_units_2': 98, 'learning_rate': 0.0021581339832599158, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:02:48.442540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 4s - loss: 2.9097 - acc: 0.1508 - val_loss: 2.7761 - val_acc: 0.2500
Epoch 2/4
 - 3s - loss: 2.4061 - acc: 0.2661 - val_loss: 2.1790 - val_acc: 0.3438
Epoch 3/4
 - 3s - loss: 2.1554 - acc: 0.2610 - val_loss: 2.0028 - val_acc: 0.3438
Epoch 4/4
 - 3s - loss: 2.0645 - acc: 0.2641 - val_loss: 1.9322 - val_acc: 0.3750
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 47), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 47) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 47)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 155, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005382208007501695, 'unfreeze_percentage': 0.006228173460867536, 'rotation_range': 0, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 180, 'batch_size': 42, 'num_dense_units_2': 98, 'learning_rate': 0.0021581339832599158, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.625, 'info': {'runtime': 16.635421991348267, 'histories': {'loss': [2.909683624903361, 2.3951072096824646, 2.158965456485748, 2.0604362726211547], 'val_loss': [2.7761006355285645, 2.1790127754211426, 2.002840280532837, 1.9322271347045898], 'acc': [0.15079365670681, 0.26666667610406875, 0.25833335146307945, 0.26666668653488157], 'val_acc': [0.25, 0.34375, 0.34375, 0.375]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 47)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 24)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 24) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 60) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 24) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 24)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 314, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002801880800492117, 'unfreeze_percentage': 0.29798698682578195, 'rotation_range': 0, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 52, 'batch_size': 19, 'learning_rate': 0.00023699920284707778, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:03:12.211895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 8s - loss: 2.3333 - acc: 0.0987 - val_loss: 2.2841 - val_acc: 0.1009
Epoch 2/4
 - 6s - loss: 2.1774 - acc: 0.2491 - val_loss: 2.2110 - val_acc: 0.2110
Epoch 3/4
 - 6s - loss: 2.0511 - acc: 0.4741 - val_loss: 2.1954 - val_acc: 0.2569
Epoch 4/4
 - 6s - loss: 1.9502 - acc: 0.3684 - val_loss: 2.0597 - val_acc: 0.3028
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 24), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 24) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 24)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 314, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002801880800492117, 'unfreeze_percentage': 0.29798698682578195, 'rotation_range': 0, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 52, 'batch_size': 19, 'learning_rate': 0.00023699920284707778, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.6972477050549393, 'info': {'runtime': 38.9680609703064, 'histories': {'loss': [2.3332789838314056, 2.1744493957775743, 2.0538829748447123, 1.9502455741167068], 'val_loss': [2.2840592795555743, 2.211023851272163, 2.195431278386247, 2.0596704636145073], 'acc': [0.0986842093989253, 0.2313432846941165, 0.4615384709168147, 0.36842105910182], 'val_acc': [0.10091743153443031, 0.21100917622583723, 0.25688073462849365, 0.3027522949450607]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 24)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 60)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 60) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 60) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 60) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 60)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 247, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0003292559617912699, 'unfreeze_percentage': 0.1457800690189708, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 322, 'batch_size': 22, 'learning_rate': 0.004668061834869695, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:03:44.311515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 3.6052 - acc: 0.1234 - val_loss: 3.2823 - val_acc: 0.0909
Epoch 2/4
 - 4s - loss: 3.1652 - acc: 0.1466 - val_loss: 2.9055 - val_acc: 0.1169
Epoch 3/4
 - 4s - loss: 2.3434 - acc: 0.2896 - val_loss: 2.3891 - val_acc: 0.2468
Epoch 4/4
 - 4s - loss: 1.8445 - acc: 0.3914 - val_loss: 2.0763 - val_acc: 0.2857
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 60), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 60) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 60) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 60) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 60)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 247, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0003292559617912699, 'unfreeze_percentage': 0.1457800690189708, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 322, 'batch_size': 22, 'learning_rate': 0.004668061834869695, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.7142857115764123, 'info': {'runtime': 19.525079011917114, 'histories': {'loss': [3.6052256652287076, 3.4661557863629056, 2.406477643762316, 1.8684983134269715], 'val_loss': [3.2822891767922933, 2.9054976933962338, 2.3891284310972534, 2.0762940196247843], 'acc': [0.12337662705353328, 0.1269841298224434, 0.2714285786662783, 0.392857158609799], 'val_acc': [0.09090909187669878, 0.11688311785072475, 0.24675324946254878, 0.28571428842358776]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 60)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 2)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 2) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 19) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 2) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 396, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004959561681103795, 'unfreeze_percentage': 0.10341127000543639, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 111, 'batch_size': 28, 'num_dense_units_2': 215, 'learning_rate': 0.0010328963557155344, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:04:05.685095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.1690 - acc: 0.2720 - val_loss: 2.3776 - val_acc: 0.0938
Epoch 2/2
 - 4s - loss: 1.3623 - acc: 0.6249 - val_loss: 2.4572 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 2)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 396, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004959561681103795, 'unfreeze_percentage': 0.10341127000543639, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 111, 'batch_size': 28, 'num_dense_units_2': 215, 'learning_rate': 0.0010328963557155344, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.890625, 'info': {'runtime': 14.812745571136475, 'histories': {'loss': [2.1824172361573178, 1.370409049204926], 'val_loss': [2.3776237964630127, 2.4572160243988037], 'acc': [0.26865673065185547, 0.6194030082047876], 'val_acc': [0.09375, 0.109375]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 19)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 19) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 19) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 19) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 19)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 262, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00011270861688737107, 'unfreeze_percentage': 0.007735940066590851, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 159, 'batch_size': 22, 'learning_rate': 0.00045470720205832726, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:04:21.133407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 6s - loss: 2.3041 - acc: 0.0855 - val_loss: 2.2737 - val_acc: 0.1688
Epoch 2/8
 - 5s - loss: 2.0804 - acc: 0.2795 - val_loss: 2.1546 - val_acc: 0.2468
Epoch 3/8
 - 5s - loss: 1.7665 - acc: 0.5325 - val_loss: 2.0381 - val_acc: 0.3117
Epoch 4/8
 - 5s - loss: 1.4988 - acc: 0.6546 - val_loss: 2.0172 - val_acc: 0.2727
Epoch 5/8
 - 5s - loss: 1.3959 - acc: 0.6382 - val_loss: 1.9212 - val_acc: 0.2987
Epoch 6/8
 - 5s - loss: 1.3101 - acc: 0.6869 - val_loss: 1.6559 - val_acc: 0.4675
Epoch 7/8
 - 5s - loss: 0.9423 - acc: 0.8506 - val_loss: 1.6076 - val_acc: 0.4675
Epoch 8/8
 - 5s - loss: 0.8237 - acc: 0.8092 - val_loss: 1.6183 - val_acc: 0.4286
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 19), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 19) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 19) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 19) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 19)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 262, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00011270861688737107, 'unfreeze_percentage': 0.007735940066590851, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 159, 'batch_size': 22, 'learning_rate': 0.00045470720205832726, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.5714285667840536, 'info': {'runtime': 46.15870189666748, 'histories': {'loss': [2.307123419216701, 2.0646973609924317, 1.7665062631879533, 1.479497970853533, 1.3976377946989877, 1.2864654612919642, 0.9422627942902702, 0.8141085020133427], 'val_loss': [2.2737355541873288, 2.154649883121639, 2.0380601108848273, 2.017243750683673, 1.921240613058016, 1.6558869179193076, 1.6075500358234753, 1.6183023994619197], 'acc': [0.09285714562450137, 0.2928571513720921, 0.5324675398213523, 0.6571428826877049, 0.6285714553935188, 0.7222222392521207, 0.8506493823868888, 0.8142857372760772], 'val_acc': [0.16883116931497277, 0.2467532486884625, 0.31168831284944115, 0.2727272746624885, 0.29870129986242816, 0.4675324694676833, 0.467532471402899, 0.4285714332159464]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 19)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 2)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 2) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 49) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 891, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017796954308221165, 'unfreeze_percentage': 0.04478912477888884, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 109, 'batch_size': 49, 'learning_rate': 0.00034997214739956715, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:05:05.501129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 4s - loss: 2.6986 - acc: 0.0878 - val_loss: 2.3192 - val_acc: 0.1562
Epoch 2/8
 - 3s - loss: 1.9972 - acc: 0.3705 - val_loss: 2.1199 - val_acc: 0.2188
Epoch 3/8
 - 3s - loss: 1.2953 - acc: 0.6531 - val_loss: 2.0429 - val_acc: 0.2188
Epoch 4/8
 - 3s - loss: 0.9268 - acc: 0.7239 - val_loss: 1.6584 - val_acc: 0.3438
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 5/8
 - 3s - loss: 0.8123 - acc: 0.8263 - val_loss: 1.4373 - val_acc: 0.4375
Epoch 6/8
 - 3s - loss: 0.4540 - acc: 0.9388 - val_loss: 1.3859 - val_acc: 0.5625
Epoch 7/8
 - 3s - loss: 0.4873 - acc: 0.8933 - val_loss: 1.7273 - val_acc: 0.5625
Epoch 8/8
 - 3s - loss: 0.8222 - acc: 0.7636 - val_loss: 1.4650 - val_acc: 0.5312
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 2)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 891, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017796954308221165, 'unfreeze_percentage': 0.04478912477888884, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 109, 'batch_size': 49, 'learning_rate': 0.00034997214739956715, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.46875, 'info': {'runtime': 28.329601287841797, 'histories': {'loss': [2.720476469107434, 2.00082402313705, 1.295258641242981, 0.929319206592256, 0.776288508313947, 0.45398586988449097, 0.5263012900816656, 0.7835304694893086], 'val_loss': [2.319188117980957, 2.1198604106903076, 2.04291033744812, 1.65835702419281, 1.4373323917388916, 1.3858680725097656, 1.7273476123809814, 1.4649800062179565], 'acc': [0.10619468485887072, 0.3362831857088393, 0.6530611912409464, 0.7079645827808211, 0.8318583807059093, 0.9387754797935486, 0.8849557079045118, 0.7699114780510421], 'val_acc': [0.15625, 0.21875, 0.21875, 0.34375, 0.4375, 0.5625, 0.5625, 0.53125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 49)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 49) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 14) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 49) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 49)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 589, 'zoom_range': 0.0, 'cnn_learning_rate': 1.3170303961801553e-05, 'unfreeze_percentage': 0.14820919345375544, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 115, 'batch_size': 16, 'num_dense_units_2': 33, 'learning_rate': 0.00021286728139435177, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:05:34.463646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 6s - loss: 2.4346 - acc: 0.1261 - val_loss: 2.1439 - val_acc: 0.2661
Epoch 2/8
 - 6s - loss: 1.7074 - acc: 0.6250 - val_loss: 1.9189 - val_acc: 0.4404
Epoch 3/8
 - 5s - loss: 1.4584 - acc: 0.6624 - val_loss: 1.8732 - val_acc: 0.3945
Epoch 4/8
 - 5s - loss: 1.3045 - acc: 0.7250 - val_loss: 1.6626 - val_acc: 0.4128
Epoch 5/8
 - 5s - loss: 1.1222 - acc: 0.7080 - val_loss: 1.5490 - val_acc: 0.5413
Epoch 6/8
 - 5s - loss: 1.0089 - acc: 0.7900 - val_loss: 1.4917 - val_acc: 0.5138
Epoch 7/8
 - 6s - loss: 0.6972 - acc: 0.9625 - val_loss: 1.3398 - val_acc: 0.6606
Epoch 8/8
 - 5s - loss: 0.7185 - acc: 0.9307 - val_loss: 1.3698 - val_acc: 0.5963
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 49), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 49) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 49)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 589, 'zoom_range': 0.0, 'cnn_learning_rate': 1.3170303961801553e-05, 'unfreeze_percentage': 0.14820919345375544, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 115, 'batch_size': 16, 'num_dense_units_2': 33, 'learning_rate': 0.00021286728139435177, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.40366972148965263, 'info': {'runtime': 48.748170614242554, 'histories': {'loss': [2.4190114752887046, 1.7073933959007264, 1.4661300850637031, 1.1802269889883799, 1.0532309290480941, 0.9656674486317046, 0.6972202003002167, 0.6771274886719169], 'val_loss': [2.143908321310621, 1.9189298021683998, 1.8732471137965492, 1.662634754399641, 1.5490487628026839, 1.4917176283827616, 1.339811033065166, 1.369849655606331], 'acc': [0.136986301369863, 0.625, 0.5984848484848485, 0.7876712328767124, 0.726027397260274, 0.815068493150685, 0.9625, 0.9246575342465754], 'val_acc': [0.26605504621332937, 0.44036697439097483, 0.3944954150313631, 0.4128440399782373, 0.5412844050368038, 0.5137614717177295, 0.6605504669180704, 0.5963302785103474]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 49)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 14)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 14) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 26) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 14) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 14) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 14)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 449, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00012696418998944746, 'unfreeze_percentage': 0.14483784154926785, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 364, 'batch_size': 25, 'learning_rate': 0.00033825819329138027, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 14:06:29.063728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 7s - loss: 2.3923 - acc: 0.0997 - val_loss: 2.3431 - val_acc: 0.1429
Epoch 2/8
 - 6s - loss: 1.8878 - acc: 0.3885 - val_loss: 2.0899 - val_acc: 0.3636
Epoch 3/8
 - 6s - loss: 1.4479 - acc: 0.6267 - val_loss: 2.0713 - val_acc: 0.1948
Epoch 4/8
 - 6s - loss: 1.2391 - acc: 0.6397 - val_loss: 1.8916 - val_acc: 0.2597
Epoch 5/8
 - 6s - loss: 1.0412 - acc: 0.7714 - val_loss: 1.7271 - val_acc: 0.3896
Epoch 6/8
 - 6s - loss: 1.0103 - acc: 0.7309 - val_loss: 1.6918 - val_acc: 0.3247
Epoch 7/8
 - 6s - loss: 0.7318 - acc: 0.8007 - val_loss: 1.5875 - val_acc: 0.4156
Epoch 8/8
 - 6s - loss: 0.5525 - acc: 0.9133 - val_loss: 1.4116 - val_acc: 0.4935
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 14), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 14) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 14) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 14) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 14)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 449, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00012696418998944746, 'unfreeze_percentage': 0.14483784154926785, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 364, 'batch_size': 25, 'learning_rate': 0.00033825819329138027, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.5064935037842044, 'info': {'runtime': 61.10288977622986, 'histories': {'loss': [2.388537253776606, 1.9049631844471842, 1.4478580156962078, 1.2021029983123723, 1.0473718151558924, 1.0029446243369666, 0.7051961672132032, 0.5524880290031433], 'val_loss': [2.3430525915963307, 2.08986915086771, 2.0713281445689016, 1.8915808479507248, 1.7270736973007004, 1.6917958724034297, 1.5875422211436483, 1.4116435856014102], 'acc': [0.08759123940754981, 0.37956203357146606, 0.6266666601101557, 0.6642335483627598, 0.7664233306898688, 0.7226277085116309, 0.8248175130273304, 0.9133333166440328], 'val_acc': [0.14285714556644488, 0.363636369829054, 0.19480519674041055, 0.2597402597402597, 0.3896103942549074, 0.32467532661054044, 0.415584421777106, 0.49350649621579556]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 14)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 26)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 26) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 47) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 26) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 26) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 26)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 129, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00010141078768957874, 'unfreeze_percentage': 0.008685523804271966, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 421, 'batch_size': 16, 'num_dense_units_2': 181, 'learning_rate': 0.002829961330365634, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 14:07:30.395801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 8s - loss: 3.4336 - acc: 0.1513 - val_loss: 3.6370 - val_acc: 0.0734
Epoch 2/8
 - 6s - loss: 2.6080 - acc: 0.1639 - val_loss: 2.6096 - val_acc: 0.0826
Epoch 3/8
 - 6s - loss: 2.3447 - acc: 0.1562 - val_loss: 2.4655 - val_acc: 0.1101
Epoch 4/8
 - 6s - loss: 2.2267 - acc: 0.2144 - val_loss: 2.1331 - val_acc: 0.2294
Epoch 5/8
 - 6s - loss: 1.9979 - acc: 0.2803 - val_loss: 2.1127 - val_acc: 0.2385
Epoch 6/8
 - 6s - loss: 1.6392 - acc: 0.3563 - val_loss: 2.2289 - val_acc: 0.2110
Epoch 7/8
 - 6s - loss: 1.4670 - acc: 0.4180 - val_loss: 2.1788 - val_acc: 0.3394
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/8
 - 6s - loss: 1.9043 - acc: 0.4098 - val_loss: 1.9510 - val_acc: 0.3578
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 26), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 26) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 26) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 26) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 26)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 129, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00010141078768957874, 'unfreeze_percentage': 0.008685523804271966, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 421, 'batch_size': 16, 'num_dense_units_2': 181, 'learning_rate': 0.002829961330365634, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.6422018329484747, 'info': {'runtime': 63.79345154762268, 'histories': {'loss': [3.304272233623348, 2.5786629180385643, 2.3446589708328247, 2.1507986669671046, 1.918781143246275, 1.639169406890869, 1.489575208049931, 1.7014771291654405], 'val_loss': [3.637015272717957, 2.609649032627771, 2.4655186583142763, 2.1331456702783567, 2.1127346918123577, 2.2289126575539964, 2.178846287071158, 1.9509886557902765], 'acc': [0.1643835616438356, 0.1780821917808219, 0.15625, 0.2328767123287671, 0.3333333333333333, 0.35625, 0.410958904109589, 0.4452054794520548], 'val_acc': [0.07339449732675465, 0.08256880925336016, 0.11009174346103581, 0.2293578000790482, 0.23853211043351288, 0.21100917622583723, 0.3394495431983143, 0.3577981670515253]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 26)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 47)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 47) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 24) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 47) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 47)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 155, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005382208007501695, 'unfreeze_percentage': 0.006228173460867536, 'rotation_range': 0, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 180, 'batch_size': 42, 'num_dense_units_2': 98, 'learning_rate': 0.0021581339832599158, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:08:28.235764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 2.9115 - acc: 0.1190 - val_loss: 2.7451 - val_acc: 0.1562
Epoch 2/8
 - 3s - loss: 2.6846 - acc: 0.1067 - val_loss: 3.1351 - val_acc: 0.1875
Epoch 3/8
 - 3s - loss: 2.5961 - acc: 0.1587 - val_loss: 2.3150 - val_acc: 0.3438
Epoch 4/8
 - 3s - loss: 2.0899 - acc: 0.2942 - val_loss: 2.0555 - val_acc: 0.2812
Epoch 5/8
 - 3s - loss: 2.0556 - acc: 0.3254 - val_loss: 1.9490 - val_acc: 0.2812
Epoch 6/8
 - 3s - loss: 1.4088 - acc: 0.5163 - val_loss: 2.4648 - val_acc: 0.1875
Epoch 7/8
 - 3s - loss: 1.3441 - acc: 0.5571 - val_loss: 1.7871 - val_acc: 0.4688
Epoch 8/8
 - 3s - loss: 1.3687 - acc: 0.5556 - val_loss: 1.6445 - val_acc: 0.4688
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 47), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 47) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 47)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 155, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005382208007501695, 'unfreeze_percentage': 0.006228173460867536, 'rotation_range': 0, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 180, 'batch_size': 42, 'num_dense_units_2': 98, 'learning_rate': 0.0021581339832599158, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.53125, 'info': {'runtime': 30.63817310333252, 'histories': {'loss': [2.911473592122396, 2.698667676825272, 2.5961173375447593, 2.0883008360862734, 2.055618325869242, 1.4070141440943669, 1.3574430048465729, 1.3687310218811035], 'val_loss': [2.745136260986328, 3.135063409805298, 2.315002918243408, 2.055471658706665, 1.9489867687225342, 2.464763641357422, 1.7870985269546509, 1.6445262432098389], 'acc': [0.11904762188593547, 0.10526316142395924, 0.15873016168673834, 0.3000000074505806, 0.3253968556722005, 0.5175438491921676, 0.5500000223517418, 0.5555555820465088], 'val_acc': [0.15625, 0.1875, 0.34375, 0.28125, 0.28125, 0.1875, 0.46875, 0.46875]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 47)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 24)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 24) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 60) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 24) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 24)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 314, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002801880800492117, 'unfreeze_percentage': 0.29798698682578195, 'rotation_range': 0, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 52, 'batch_size': 19, 'learning_rate': 0.00023699920284707778, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:09:05.013455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 8s - loss: 2.2732 - acc: 0.1378 - val_loss: 2.2553 - val_acc: 0.1835
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/8
 - 6s - loss: 2.1028 - acc: 0.3126 - val_loss: 2.2404 - val_acc: 0.1927
Epoch 3/8
 - 6s - loss: 1.9350 - acc: 0.4848 - val_loss: 2.0743 - val_acc: 0.2661
Epoch 4/8
 - 6s - loss: 1.7991 - acc: 0.5724 - val_loss: 2.0395 - val_acc: 0.2294
Epoch 5/8
 - 6s - loss: 1.6682 - acc: 0.6269 - val_loss: 1.9066 - val_acc: 0.2569
Epoch 6/8
 - 6s - loss: 1.4996 - acc: 0.7105 - val_loss: 1.8724 - val_acc: 0.2844
Epoch 7/8
 - 6s - loss: 1.4671 - acc: 0.6438 - val_loss: 1.6279 - val_acc: 0.4862
Epoch 8/8
 - 6s - loss: 1.2802 - acc: 0.7391 - val_loss: 1.5413 - val_acc: 0.4679
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 24), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 24) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 24)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 314, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002801880800492117, 'unfreeze_percentage': 0.29798698682578195, 'rotation_range': 0, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 52, 'batch_size': 19, 'learning_rate': 0.00023699920284707778, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.5321100884621297, 'info': {'runtime': 63.22364163398743, 'histories': {'loss': [2.2777244227749485, 2.1094382976318573, 1.932383350559048, 1.7990993559360504, 1.6554287752108787, 1.4996170550584793, 1.4514968061780595, 1.2777848293731262], 'val_loss': [2.255268788118975, 2.240387426603825, 2.0743489954449714, 2.0394870688062197, 1.906570611743752, 1.872413147480116, 1.6278684893879323, 1.5413415902251497], 'acc': [0.1398601389744065, 0.30769231019320187, 0.489510487426411, 0.5723684132099152, 0.6417910554515782, 0.7105263210833073, 0.6573426565090259, 0.7412587408419256], 'val_acc': [0.1834862392156496, 0.1926605511422551, 0.26605505024621245, 0.22935780253979043, 0.25688073777277537, 0.28440367040831016, 0.48623853593791294, 0.46788991153787035]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 24)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 60)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 60) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 60) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 3) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 60) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 60)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 247, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0003292559617912699, 'unfreeze_percentage': 0.1457800690189708, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 322, 'batch_size': 22, 'learning_rate': 0.004668061834869695, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:10:02.367341: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 7s - loss: 3.6281 - acc: 0.1450 - val_loss: 4.3929 - val_acc: 0.1039
Epoch 2/8
 - 4s - loss: 3.1758 - acc: 0.2335 - val_loss: 2.3543 - val_acc: 0.2727
Epoch 3/8
 - 4s - loss: 1.7375 - acc: 0.4739 - val_loss: 1.8956 - val_acc: 0.3506
Epoch 4/8
 - 4s - loss: 1.2334 - acc: 0.6217 - val_loss: 1.4380 - val_acc: 0.5065
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 5/8
 - 4s - loss: 1.0364 - acc: 0.6299 - val_loss: 1.7561 - val_acc: 0.4156
Epoch 6/8
 - 4s - loss: 0.9495 - acc: 0.6768 - val_loss: 1.7200 - val_acc: 0.4805
Epoch 7/8
 - 4s - loss: 1.0901 - acc: 0.6429 - val_loss: 2.2533 - val_acc: 0.3247
Epoch 8/8
 - 4s - loss: 0.9303 - acc: 0.6347 - val_loss: 1.6656 - val_acc: 0.4675
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 60), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 60) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 60) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 60) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 60)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 247, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0003292559617912699, 'unfreeze_percentage': 0.1457800690189708, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 322, 'batch_size': 22, 'learning_rate': 0.004668061834869695, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.5324675305323168, 'info': {'runtime': 36.311413288116455, 'histories': {'loss': [3.7124617985316686, 3.289812305995396, 1.7863395367349897, 1.229956797191075, 1.0363693407603674, 0.9136174226564074, 1.0900886825152807, 0.9185223238808768], 'val_loss': [4.392906523370123, 2.3543226130597, 1.8956283423807714, 1.4379643774651862, 1.7560774134351063, 1.7199686765670776, 2.253256794694182, 1.665595766785857], 'acc': [0.11428571684019906, 0.2428571451987539, 0.4500000144754137, 0.6214285982506615, 0.6298701507704598, 0.6984127144964914, 0.6428571556295667, 0.657142869063786], 'val_acc': [0.10389610486371177, 0.2727272736948806, 0.350649356842041, 0.506493510363938, 0.4155844182937176, 0.4805194944530338, 0.32467532738462673, 0.4675324694676833]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 60)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 3)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 3) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 3) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 3)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 596, 'zoom_range': 0.0, 'cnn_learning_rate': 6.075112003970132e-05, 'unfreeze_percentage': 0.18214831344469687, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 126, 'batch_size': 31, 'learning_rate': 0.002310184814343086, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:10:44.843181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 8s - loss: 4.7820 - acc: 0.0716 - val_loss: 2.9714 - val_acc: 0.1406
Epoch 2/2
 - 6s - loss: 2.8129 - acc: 0.1419 - val_loss: 2.3827 - val_acc: 0.1406
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 3)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 596, 'zoom_range': 0.0, 'cnn_learning_rate': 6.075112003970132e-05, 'unfreeze_percentage': 0.18214831344469687, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 126, 'batch_size': 31, 'learning_rate': 0.002310184814343086, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.859375, 'info': {'runtime': 26.164860486984253, 'histories': {'loss': [5.121509670301248, 2.812861204147339], 'val_loss': [2.9714380502700806, 2.382675886154175], 'acc': [0.06106870103883379, 0.1419354796409607], 'val_acc': [0.140625, 0.140625]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 3)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 2)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 2) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 49) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 891, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017796954308221165, 'unfreeze_percentage': 0.04478912477888884, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 109, 'batch_size': 49, 'learning_rate': 0.00034997214739956715, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:11:04.424260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 4s - loss: 2.4237 - acc: 0.2858 - val_loss: 2.2545 - val_acc: 0.0312
Epoch 2/16
 - 3s - loss: 1.6788 - acc: 0.4490 - val_loss: 2.2829 - val_acc: 0.1562
Epoch 3/16
 - 3s - loss: 1.6284 - acc: 0.5521 - val_loss: 1.8058 - val_acc: 0.4062
Epoch 4/16
 - 3s - loss: 0.8706 - acc: 0.7678 - val_loss: 1.4328 - val_acc: 0.5625
Epoch 5/16
 - 3s - loss: 0.7074 - acc: 0.8294 - val_loss: 1.6781 - val_acc: 0.3750
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 6/16
 - 3s - loss: 0.6317 - acc: 0.8639 - val_loss: 1.4400 - val_acc: 0.5938
Epoch 7/16
 - 3s - loss: 0.4102 - acc: 0.9519 - val_loss: 1.3057 - val_acc: 0.5625
Epoch 8/16
 - 3s - loss: 0.3804 - acc: 0.9299 - val_loss: 1.4640 - val_acc: 0.6562
Epoch 9/16
 - 3s - loss: 0.2289 - acc: 0.9927 - val_loss: 1.2374 - val_acc: 0.6250
Epoch 10/16
 - 3s - loss: 0.3378 - acc: 0.9184 - val_loss: 1.3022 - val_acc: 0.5625
Epoch 11/16
 - 3s - loss: 0.1489 - acc: 0.9927 - val_loss: 1.1376 - val_acc: 0.6250
Epoch 12/16
 - 3s - loss: 0.2047 - acc: 0.9738 - val_loss: 1.1356 - val_acc: 0.6562
Epoch 13/16
 - 3s - loss: 0.2257 - acc: 0.9707 - val_loss: 1.1321 - val_acc: 0.5938
Epoch 14/16
 - 3s - loss: 0.0641 - acc: 1.0000 - val_loss: 0.8877 - val_acc: 0.6875
Epoch 15/16
 - 3s - loss: 0.0775 - acc: 1.0000 - val_loss: 0.9039 - val_acc: 0.7500
Epoch 16/16
 - 3s - loss: 0.0919 - acc: 1.0000 - val_loss: 1.0295 - val_acc: 0.6562
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 2)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 891, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017796954308221165, 'unfreeze_percentage': 0.04478912477888884, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 109, 'batch_size': 49, 'learning_rate': 0.00034997214739956715, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.34375, 'info': {'runtime': 50.90312576293945, 'histories': {'loss': [2.477732046515541, 1.6788254181543987, 1.6077019472037797, 0.8979246315702928, 0.6641850503145066, 0.6317049860954285, 0.4134429355638217, 0.3882522490699734, 0.2355140236626684, 0.33784907062848407, 0.13307599459601716, 0.18283310229271915, 0.21797397818449324, 0.06407911827166875, 0.07334060043887755, 0.08792210007663322], 'val_loss': [2.25449538230896, 2.2828726768493652, 1.8058381080627441, 1.43282151222229, 1.6781096458435059, 1.440009355545044, 1.3056501150131226, 1.463989496231079, 1.2374284267425537, 1.3021869659423828, 1.1376099586486816, 1.1355971097946167, 1.1321024894714355, 0.8877394199371338, 0.903887152671814, 1.0294954776763916], 'acc': [0.24778761022386298, 0.44897958636283875, 0.5840708064821969, 0.7610619284410393, 0.8495574757061174, 0.8639455040295919, 0.9557522118619058, 0.929203500262404, 0.9911504466976739, 0.9183672865231832, 0.991150420851412, 0.9823008976151458, 0.964601735098172, 1.0, 1.0, 1.0], 'val_acc': [0.03125, 0.15625, 0.40625, 0.5625, 0.375, 0.59375, 0.5625, 0.65625, 0.625, 0.5625, 0.625, 0.65625, 0.59375, 0.6875, 0.75, 0.65625]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 49)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 49) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 49) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 14) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 49)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 589, 'zoom_range': 0.0, 'cnn_learning_rate': 1.3170303961801553e-05, 'unfreeze_percentage': 0.14820919345375544, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 115, 'batch_size': 16, 'num_dense_units_2': 33, 'learning_rate': 0.00021286728139435177, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:11:56.066158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 6s - loss: 2.4141 - acc: 0.1639 - val_loss: 2.2098 - val_acc: 0.1193
Epoch 2/16
 - 5s - loss: 1.7686 - acc: 0.4389 - val_loss: 2.0737 - val_acc: 0.3486
Epoch 3/16
 - 6s - loss: 1.3377 - acc: 0.6500 - val_loss: 1.8031 - val_acc: 0.2477
Epoch 4/16
 - 5s - loss: 1.1976 - acc: 0.7485 - val_loss: 1.7982 - val_acc: 0.3119
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 5/16
 - 5s - loss: 0.9593 - acc: 0.7937 - val_loss: 1.5128 - val_acc: 0.4954
Epoch 6/16
 - 5s - loss: 0.9755 - acc: 0.8010 - val_loss: 1.5574 - val_acc: 0.4312
Epoch 7/16
 - 6s - loss: 0.7415 - acc: 0.9000 - val_loss: 1.3006 - val_acc: 0.5780
Epoch 8/16
 - 5s - loss: 0.6974 - acc: 0.9117 - val_loss: 1.3948 - val_acc: 0.4954
Epoch 9/16
 - 5s - loss: 0.6357 - acc: 0.8846 - val_loss: 1.2015 - val_acc: 0.5872
Epoch 10/16
 - 5s - loss: 0.5345 - acc: 0.9622 - val_loss: 1.2121 - val_acc: 0.6055
Epoch 11/16
 - 5s - loss: 0.6286 - acc: 0.8889 - val_loss: 1.3054 - val_acc: 0.5963
Epoch 12/16
 - 5s - loss: 0.7166 - acc: 0.8322 - val_loss: 1.1418 - val_acc: 0.5963
Epoch 13/16
 - 5s - loss: 0.5443 - acc: 0.9035 - val_loss: 1.1178 - val_acc: 0.5780
Epoch 14/16
 - 5s - loss: 0.4238 - acc: 0.9413 - val_loss: 1.1787 - val_acc: 0.6330
Epoch 15/16
 - 6s - loss: 0.4003 - acc: 0.9625 - val_loss: 0.9695 - val_acc: 0.6789
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 16/16
 - 5s - loss: 0.4684 - acc: 0.9559 - val_loss: 1.0147 - val_acc: 0.6697
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 49), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 49) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 49)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 589, 'zoom_range': 0.0, 'cnn_learning_rate': 1.3170303961801553e-05, 'unfreeze_percentage': 0.14820919345375544, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 115, 'batch_size': 16, 'num_dense_units_2': 33, 'learning_rate': 0.00021286728139435177, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.3302752255299769, 'info': {'runtime': 91.7083113193512, 'histories': {'loss': [2.3731747457425887, 1.8099614659400836, 1.337687861919403, 1.0921311053362759, 0.9592929542064667, 0.8841148443294294, 0.7414730191230774, 0.6434609759343813, 0.609428394330691, 0.5321040855695124, 0.47328517208360643, 0.574082710971571, 0.5018050229712708, 0.3675391918992343, 0.4002556085586548, 0.4110148018353606], 'val_loss': [2.209821088598409, 2.0737177669455154, 1.8031215809900827, 1.798245954951015, 1.5128355037181749, 1.5573640361838383, 1.3006069375834335, 1.3948341181518835, 1.2015221118927002, 1.2121270359109302, 1.3054301016921297, 1.1418029496429163, 1.117826796999765, 1.1787355733573983, 0.969520256059979, 1.0147145188182867], 'acc': [0.1780821917808219, 0.3904109589041096, 0.65, 0.7954545454545454, 0.79375, 0.8106060606060606, 0.9, 0.9041095890410958, 0.9178082191780822, 0.958904109589041, 0.9657534246575342, 0.9041095890410958, 0.9383561643835616, 0.9794520547945206, 0.9625, 0.952054794520548], 'val_acc': [0.11926605538764132, 0.348623857585662, 0.24770642529933826, 0.3119266061881267, 0.49541284622402365, 0.43119266328461675, 0.5779816520596863, 0.4954128538796661, 0.5871559665837419, 0.6055045885230423, 0.5963302785103474, 0.5963302779635158, 0.57798165246981, 0.6330275251231062, 0.678899085849797, 0.6697247744700231]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 49)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 14)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 14) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 47) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 14) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 14) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 14)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 449, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00012696418998944746, 'unfreeze_percentage': 0.14483784154926785, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 364, 'batch_size': 25, 'learning_rate': 0.00033825819329138027, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:13:33.687289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 7s - loss: 2.4208 - acc: 0.1470 - val_loss: 2.1641 - val_acc: 0.2597
Epoch 2/16
 - 6s - loss: 1.7983 - acc: 0.4358 - val_loss: 2.0715 - val_acc: 0.3247
Epoch 3/16
 - 6s - loss: 1.4960 - acc: 0.6047 - val_loss: 2.0179 - val_acc: 0.3117
Epoch 4/16
 - 6s - loss: 1.2332 - acc: 0.6841 - val_loss: 1.7620 - val_acc: 0.4026
Epoch 5/16
 - 6s - loss: 0.9833 - acc: 0.8046 - val_loss: 1.6898 - val_acc: 0.4416
Epoch 6/16
 - 6s - loss: 0.8760 - acc: 0.7800 - val_loss: 1.5855 - val_acc: 0.4156
Epoch 7/16
 - 6s - loss: 0.6776 - acc: 0.8660 - val_loss: 1.4495 - val_acc: 0.5065
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/16
 - 6s - loss: 0.5925 - acc: 0.9065 - val_loss: 1.5094 - val_acc: 0.4416
Epoch 9/16
 - 6s - loss: 0.4647 - acc: 0.9324 - val_loss: 1.5884 - val_acc: 0.4675
Epoch 10/16
 - 6s - loss: 0.3916 - acc: 0.9533 - val_loss: 1.2305 - val_acc: 0.5584
Epoch 11/16
 - 6s - loss: 0.3565 - acc: 0.9200 - val_loss: 1.3314 - val_acc: 0.5325
Epoch 12/16
 - 6s - loss: 0.2874 - acc: 0.9794 - val_loss: 1.2917 - val_acc: 0.5974
Epoch 13/16
 - 6s - loss: 0.3400 - acc: 0.9403 - val_loss: 1.1602 - val_acc: 0.6104
Epoch 14/16
 - 6s - loss: 0.2536 - acc: 0.9467 - val_loss: 1.2131 - val_acc: 0.5974
Epoch 15/16
 - 6s - loss: 0.1907 - acc: 0.9932 - val_loss: 1.1366 - val_acc: 0.6494
Epoch 16/16
 - 6s - loss: 0.1735 - acc: 0.9865 - val_loss: 1.0732 - val_acc: 0.6364
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 14), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 14) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 14) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 14) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 14)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 449, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00012696418998944746, 'unfreeze_percentage': 0.14483784154926785, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 364, 'batch_size': 25, 'learning_rate': 0.00033825819329138027, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.3636363582177595, 'info': {'runtime': 110.23677682876587, 'histories': {'loss': [2.431359392012993, 1.8071465918617526, 1.4899698887428228, 1.2295159493049566, 0.9850801338244529, 0.8759695688883463, 0.6765063261463694, 0.5878288571851967, 0.4620855317933716, 0.3916311164697011, 0.3462014900941918, 0.28315529972314835, 0.3120823867999724, 0.25361204892396927, 0.18830124315989277, 0.17365284829679198], 'val_loss': [2.164091035917208, 2.07149228801975, 2.0179157566714596, 1.7619802270616804, 1.6897630443820706, 1.5855462814306285, 1.4494919157647468, 1.509403556972355, 1.5883868313454963, 1.230492220296488, 1.3313651704168938, 1.2917211086719067, 1.1602235211954488, 1.2130773191328172, 1.1366478158281994, 1.073158007163506], 'acc': [0.1386861274168439, 0.4306569134231901, 0.6131386543712477, 0.6788320758917036, 0.7956204209884588, 0.7799999813238779, 0.868613123023597, 0.9124087452018348, 0.927007281867257, 0.95333331823349, 0.9270072714255674, 0.9758064386344725, 0.9489051042682063, 0.9466666479905447, 0.9927007260113737, 0.9854014520227474], 'val_acc': [0.2597402624495618, 0.32467532661054044, 0.31168831439761374, 0.402597408790093, 0.4415584477511319, 0.415584421777106, 0.5064935074611143, 0.4415584477511319, 0.4675324694676833, 0.5584415638601625, 0.532467533628662, 0.5974026001118994, 0.6103896134859556, 0.5974026004989426, 0.6493506617360301, 0.6363636417822405]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 14)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 47)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 47) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 4) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 47) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 47)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 155, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005382208007501695, 'unfreeze_percentage': 0.006228173460867536, 'rotation_range': 0, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 180, 'batch_size': 42, 'num_dense_units_2': 98, 'learning_rate': 0.0021581339832599158, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:15:17.608231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 4s - loss: 2.9593 - acc: 0.1335 - val_loss: 2.8955 - val_acc: 0.0625
Epoch 2/16
 - 3s - loss: 2.9520 - acc: 0.1104 - val_loss: 2.2765 - val_acc: 0.1250
Epoch 3/16
 - 3s - loss: 2.4291 - acc: 0.0952 - val_loss: 2.3665 - val_acc: 0.1250
Epoch 4/16
 - 3s - loss: 1.8846 - acc: 0.3885 - val_loss: 2.1502 - val_acc: 0.1875
Epoch 5/16
 - 3s - loss: 1.5916 - acc: 0.4799 - val_loss: 2.0625 - val_acc: 0.1562
Epoch 6/16
 - 3s - loss: 1.6356 - acc: 0.4730 - val_loss: 1.7742 - val_acc: 0.4062
Epoch 7/16
 - 3s - loss: 1.3008 - acc: 0.6111 - val_loss: 1.6000 - val_acc: 0.4688
Epoch 8/16
 - 3s - loss: 0.7487 - acc: 0.7590 - val_loss: 1.4352 - val_acc: 0.5000
Epoch 9/16
 - 3s - loss: 1.1490 - acc: 0.5794 - val_loss: 2.1339 - val_acc: 0.4688
Epoch 10/16
 - 3s - loss: 1.0962 - acc: 0.6808 - val_loss: 1.0036 - val_acc: 0.7188
Epoch 11/16
 - 3s - loss: 0.4070 - acc: 0.8976 - val_loss: 1.5448 - val_acc: 0.4688
Epoch 12/16
 - 3s - loss: 0.4496 - acc: 0.8665 - val_loss: 1.3754 - val_acc: 0.5625
Epoch 13/16
 - 3s - loss: 0.1979 - acc: 0.9839 - val_loss: 1.0023 - val_acc: 0.5312
Epoch 14/16
 - 3s - loss: 0.2102 - acc: 0.9365 - val_loss: 1.3473 - val_acc: 0.5625
Epoch 15/16
 - 3s - loss: 0.2758 - acc: 0.9106 - val_loss: 1.6107 - val_acc: 0.5000
Epoch 16/16
 - 3s - loss: 0.4714 - acc: 0.8825 - val_loss: 1.4454 - val_acc: 0.6562
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 47), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 47) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 47)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 155, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005382208007501695, 'unfreeze_percentage': 0.006228173460867536, 'rotation_range': 0, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 180, 'batch_size': 42, 'num_dense_units_2': 98, 'learning_rate': 0.0021581339832599158, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.34375, 'info': {'runtime': 52.236185789108276, 'histories': {'loss': [2.981121873855591, 2.962258315086365, 2.429093678792318, 1.8922052800655365, 1.6038451075553894, 1.6157176971435547, 1.300819198290507, 0.7498637557029724, 1.1490321358044941, 1.0782036244869233, 0.4026948720216751, 0.4507523700594902, 0.19817958697676658, 0.21021519104639688, 0.2802568309009075, 0.46525880247354506], 'val_loss': [2.895502805709839, 2.2765400409698486, 2.3665060997009277, 2.1502106189727783, 2.062483787536621, 1.7742475271224976, 1.6000378131866455, 1.4352355003356934, 2.133944511413574, 1.0036247968673706, 1.5448153018951416, 1.375421166419983, 1.0023292303085327, 1.3472692966461182, 1.610656499862671, 1.4454011917114258], 'acc': [0.13333333767950534, 0.10833333525806665, 0.09523809949556987, 0.3833333447575569, 0.47500002980232237, 0.48333336114883424, 0.6111111442248026, 0.7583333402872086, 0.5793651044368744, 0.6833333432674408, 0.9000000596046448, 0.8666667014360427, 0.9833333969116211, 0.9365079800287882, 0.9083333730697631, 0.883333346247673], 'val_acc': [0.0625, 0.125, 0.125, 0.1875, 0.15625, 0.40625, 0.46875, 0.5, 0.46875, 0.71875, 0.46875, 0.5625, 0.53125, 0.5625, 0.5, 0.65625]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 47)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 4)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 4) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 4) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 4)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 429, 'zoom_range': 0.0, 'cnn_learning_rate': 9.43431269119671e-05, 'unfreeze_percentage': 0.07511596400380839, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 129, 'batch_size': 39, 'num_dense_units_2': 80, 'learning_rate': 0.00012859240126032232, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:16:11.714397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.3783 - acc: 0.1013 - val_loss: 2.4692 - val_acc: 0.0938
Epoch 2/2
 - 3s - loss: 2.4040 - acc: 0.0743 - val_loss: 2.4627 - val_acc: 0.0625
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 4)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 429, 'zoom_range': 0.0, 'cnn_learning_rate': 9.43431269119671e-05, 'unfreeze_percentage': 0.07511596400380839, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 129, 'batch_size': 39, 'num_dense_units_2': 80, 'learning_rate': 0.00012859240126032232, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.9375, 'info': {'runtime': 14.194727897644043, 'histories': {'loss': [2.385537252193544, 2.4180752068031124], 'val_loss': [2.4691522121429443, 2.4626541137695312], 'acc': [0.12195122405523207, 0.08943089665617884], 'val_acc': [0.09375, 0.0625]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 4)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 2)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 2) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 49) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 891, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017796954308221165, 'unfreeze_percentage': 0.04478912477888884, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 109, 'batch_size': 49, 'learning_rate': 0.00034997214739956715, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:16:24.156288: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/30
 - 5s - loss: 2.8153 - acc: 0.1701 - val_loss: 2.5090 - val_acc: 0.1562
Epoch 2/30
 - 3s - loss: 1.9712 - acc: 0.3608 - val_loss: 1.9023 - val_acc: 0.4688
Epoch 3/30
 - 3s - loss: 1.1357 - acc: 0.6916 - val_loss: 1.5004 - val_acc: 0.6562
Epoch 4/30
 - 3s - loss: 0.9850 - acc: 0.7586 - val_loss: 1.5635 - val_acc: 0.3750
Epoch 5/30
 - 3s - loss: 0.7353 - acc: 0.7959 - val_loss: 1.7142 - val_acc: 0.4688
Epoch 6/30
 - 3s - loss: 0.9367 - acc: 0.6715 - val_loss: 1.3408 - val_acc: 0.5938
Epoch 7/30
 - 3s - loss: 0.7984 - acc: 0.7447 - val_loss: 1.2200 - val_acc: 0.7188
Epoch 8/30
 - 3s - loss: 0.4870 - acc: 0.9330 - val_loss: 1.4303 - val_acc: 0.4688
Epoch 9/30
 - 3s - loss: 0.3134 - acc: 0.9342 - val_loss: 1.0324 - val_acc: 0.7500
Epoch 10/30
 - 3s - loss: 0.1443 - acc: 1.0000 - val_loss: 1.0637 - val_acc: 0.6562
Epoch 11/30
 - 3s - loss: 0.6567 - acc: 0.7806 - val_loss: 1.0546 - val_acc: 0.6875
Epoch 12/30
 - 3s - loss: 0.3519 - acc: 0.9110 - val_loss: 1.1039 - val_acc: 0.6562
Epoch 13/30
 - 3s - loss: 0.1173 - acc: 0.9927 - val_loss: 0.9304 - val_acc: 0.6562
Epoch 14/30
 - 3s - loss: 0.0995 - acc: 1.0000 - val_loss: 0.8426 - val_acc: 0.7812
Epoch 15/30
 - 3s - loss: 0.0594 - acc: 1.0000 - val_loss: 0.9286 - val_acc: 0.7500
Epoch 16/30
 - 3s - loss: 0.0972 - acc: 1.0000 - val_loss: 0.8127 - val_acc: 0.7500
Epoch 17/30
 - 3s - loss: 0.0679 - acc: 1.0000 - val_loss: 1.7194 - val_acc: 0.5312
Epoch 18/30
 - 3s - loss: 0.5186 - acc: 0.8221 - val_loss: 1.5108 - val_acc: 0.3750
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 19/30
 - 3s - loss: 0.1478 - acc: 0.9660 - val_loss: 0.9936 - val_acc: 0.6875
Epoch 20/30
 - 3s - loss: 0.0407 - acc: 1.0000 - val_loss: 1.0340 - val_acc: 0.7188
Epoch 21/30
 - 3s - loss: 0.0584 - acc: 1.0000 - val_loss: 0.7388 - val_acc: 0.7188
Epoch 22/30
 - 3s - loss: 0.0242 - acc: 1.0000 - val_loss: 0.7814 - val_acc: 0.7500
Epoch 23/30
 - 3s - loss: 0.0220 - acc: 1.0000 - val_loss: 0.8054 - val_acc: 0.8125
Epoch 24/30
 - 3s - loss: 0.0290 - acc: 1.0000 - val_loss: 0.6855 - val_acc: 0.8125
Epoch 25/30
 - 3s - loss: 0.0147 - acc: 1.0000 - val_loss: 0.6489 - val_acc: 0.8125
Epoch 26/30
 - 3s - loss: 0.1131 - acc: 0.9405 - val_loss: 2.7353 - val_acc: 0.2188
Epoch 27/30
 - 3s - loss: 0.2952 - acc: 0.9252 - val_loss: 0.8497 - val_acc: 0.7500
Epoch 28/30
 - 3s - loss: 0.0182 - acc: 1.0000 - val_loss: 0.8132 - val_acc: 0.8125
Epoch 29/30
 - 3s - loss: 0.0215 - acc: 1.0000 - val_loss: 0.6525 - val_acc: 0.7812
Epoch 30/30
 - 3s - loss: 0.0099 - acc: 1.0000 - val_loss: 1.1735 - val_acc: 0.7188
{'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 891, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017796954308221165, 'unfreeze_percentage': 0.04478912477888884, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 109, 'batch_size': 49, 'learning_rate': 0.00034997214739956715, 'base_model': 'MobileNet', 'activation': 'relu'}

 ****** MobileNet unfrozen 1 top blocks, cut_off after layer 78 ******
Epoch 1/2
 - 4s - loss: 0.0071 - acc: 1.0000 - val_loss: 0.9933 - val_acc: 0.7188
Epoch 2/2
 - 3s - loss: 0.0142 - acc: 1.0000 - val_loss: 0.8694 - val_acc: 0.6875
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 2)
args: ()
kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 891, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017796954308221165, 'unfreeze_percentage': 0.04478912477888884, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 109, 'batch_size': 49, 'learning_rate': 0.00034997214739956715, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.3125, 'info': {'runtime': 102.30822777748108, 'histories': {'loss': [2.815340439478556, 1.9641070787885548, 1.1424838014408552, 1.1029784064904777, 0.735264241695404, 0.900579126007789, 0.7880853050577957, 0.4370205919299505, 0.354861302845246, 0.1442681054274241, 0.7118354373801071, 0.32197361314191225, 0.11325658824855248, 0.09639643234884844, 0.05942411224047343, 0.09979872880256281, 0.055248039057560726, 0.46844126376430545, 0.14780334383249283, 0.03774924104851959, 0.05423261591159137, 0.021071129379612683, 0.021998404214779537, 0.02814806882390934, 0.014668949569265047, 0.08948212975188147, 0.2951800798376401, 0.01599887797229849, 0.016080788954828694, 0.009870486333966255, 0.00713862261424462, 0.011363467124962731], 'val_loss': [2.5089783668518066, 1.9022760391235352, 1.5004035234451294, 1.5634896755218506, 1.7142155170440674, 1.340775728225708, 1.219973087310791, 1.430316686630249, 1.0324124097824097, 1.0637484788894653, 1.0545597076416016, 1.1039073467254639, 0.9304489493370056, 0.8426319360733032, 0.9285529851913452, 0.8127010464668274, 1.7193727493286133, 1.5107829570770264, 0.9936478734016418, 1.0339572429656982, 0.7387809753417969, 0.7814021706581116, 0.805408239364624, 0.68553626537323, 0.6489346027374268, 2.735316514968872, 0.8496980667114258, 0.8131899833679199, 0.6524689197540283, 1.17350172996521, 0.993285596370697, 0.8693612217903137], 'acc': [0.170068030556043, 0.38053095287981287, 0.6548672149666642, 0.7079645600994077, 0.795918345451355, 0.6725663492637398, 0.7610619210563929, 0.9469026290209948, 0.9203539168940181, 1.0, 0.7345132458526477, 0.9203539691140167, 0.991150420851412, 1.0, 1.0, 1.0, 1.0, 0.8407079224037913, 0.9659863710403442, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9620253300365014, 0.9251700242360433, 1.0, 1.0, 1.0, 1.0, 1.0], 'val_acc': [0.15625, 0.46875, 0.65625, 0.375, 0.46875, 0.59375, 0.71875, 0.46875, 0.75, 0.65625, 0.6875, 0.65625, 0.65625, 0.78125, 0.75, 0.75, 0.53125, 0.375, 0.6875, 0.71875, 0.71875, 0.75, 0.8125, 0.8125, 0.8125, 0.21875, 0.75, 0.8125, 0.78125, 0.71875, 0.71875, 0.6875]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 49)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 49) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 49) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 5) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 49)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 589, 'zoom_range': 0.0, 'cnn_learning_rate': 1.3170303961801553e-05, 'unfreeze_percentage': 0.14820919345375544, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 115, 'batch_size': 16, 'num_dense_units_2': 33, 'learning_rate': 0.00021286728139435177, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:18:07.732700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/17
 - 6s - loss: 2.2920 - acc: 0.1891 - val_loss: 2.1442 - val_acc: 0.2110
Epoch 2/17
 - 5s - loss: 1.6454 - acc: 0.5335 - val_loss: 2.0990 - val_acc: 0.2018
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/17
 - 5s - loss: 1.4150 - acc: 0.6135 - val_loss: 1.6727 - val_acc: 0.5596
Epoch 4/17
 - 5s - loss: 1.1356 - acc: 0.7333 - val_loss: 1.8484 - val_acc: 0.3670
Epoch 5/17
 - 6s - loss: 1.0111 - acc: 0.7688 - val_loss: 1.4510 - val_acc: 0.5413
Epoch 6/17
 - 5s - loss: 1.1289 - acc: 0.6562 - val_loss: 1.5009 - val_acc: 0.4862
Epoch 7/17
 - 6s - loss: 0.8188 - acc: 0.8562 - val_loss: 1.3311 - val_acc: 0.5688
Epoch 8/17
 - 5s - loss: 0.7187 - acc: 0.8574 - val_loss: 1.3770 - val_acc: 0.6422
Epoch 9/17
 - 5s - loss: 0.8202 - acc: 0.8467 - val_loss: 1.3828 - val_acc: 0.5229
Epoch 10/17
 - 6s - loss: 0.6933 - acc: 0.8657 - val_loss: 1.2321 - val_acc: 0.6330
Epoch 11/17
 - 6s - loss: 0.7385 - acc: 0.8448 - val_loss: 1.4104 - val_acc: 0.5596
Epoch 12/17
 - 6s - loss: 0.4956 - acc: 0.9622 - val_loss: 1.1716 - val_acc: 0.6514
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 13/17
 - 6s - loss: 0.6428 - acc: 0.8448 - val_loss: 1.4280 - val_acc: 0.5413
Epoch 14/17
 - 6s - loss: 0.4053 - acc: 0.9625 - val_loss: 1.0950 - val_acc: 0.6972
Epoch 15/17
 - 6s - loss: 0.3998 - acc: 0.9685 - val_loss: 1.0801 - val_acc: 0.7156
Epoch 16/17
 - 6s - loss: 0.3452 - acc: 0.9937 - val_loss: 1.1660 - val_acc: 0.6789
Epoch 17/17
 - 6s - loss: 0.3856 - acc: 0.9811 - val_loss: 1.1342 - val_acc: 0.6330
{'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 589, 'zoom_range': 0.0, 'cnn_learning_rate': 1.3170303961801553e-05, 'unfreeze_percentage': 0.14820919345375544, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 115, 'batch_size': 16, 'num_dense_units_2': 33, 'learning_rate': 0.00021286728139435177, 'base_model': 'Xception', 'activation': 'tanh'}

 ****** Xception unfrozen 1 top blocks, cut_off after layer 125 ******
Epoch 1/15
 - 6s - loss: 0.2970 - acc: 0.9937 - val_loss: 1.2173 - val_acc: 0.6422
Epoch 2/15
 - 6s - loss: 0.3091 - acc: 0.9937 - val_loss: 1.1610 - val_acc: 0.6514
Epoch 3/15
 - 6s - loss: 0.3460 - acc: 0.9539 - val_loss: 1.2112 - val_acc: 0.6697
Epoch 4/15
 - 6s - loss: 0.3375 - acc: 0.9937 - val_loss: 1.1657 - val_acc: 0.6881
Epoch 5/15
 - 6s - loss: 0.4954 - acc: 0.9078 - val_loss: 1.1938 - val_acc: 0.6881
Epoch 6/15
 - 6s - loss: 0.3687 - acc: 1.0000 - val_loss: 1.1980 - val_acc: 0.6789
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 7/15
 - 6s - loss: 0.2781 - acc: 0.9938 - val_loss: 1.2737 - val_acc: 0.6697
Epoch 8/15
 - 6s - loss: 0.7081 - acc: 0.8091 - val_loss: 1.3147 - val_acc: 0.6514
Epoch 9/15
 - 6s - loss: 0.2917 - acc: 1.0000 - val_loss: 1.2705 - val_acc: 0.6606
Epoch 10/15
 - 6s - loss: 0.4617 - acc: 0.8952 - val_loss: 1.2327 - val_acc: 0.6789
Epoch 11/15
 - 6s - loss: 0.3624 - acc: 0.9937 - val_loss: 1.2179 - val_acc: 0.6514
Epoch 12/15
 - 6s - loss: 0.3830 - acc: 0.9937 - val_loss: 1.2685 - val_acc: 0.6697
Epoch 13/15
 - 6s - loss: 0.3082 - acc: 0.9875 - val_loss: 1.2291 - val_acc: 0.6789
Epoch 14/15
 - 6s - loss: 0.3736 - acc: 0.9873 - val_loss: 1.1511 - val_acc: 0.6972
Epoch 15/15
 - 6s - loss: 0.4900 - acc: 0.9078 - val_loss: 1.2427 - val_acc: 0.6789
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 49), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 49) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 49)
args: ()
kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 589, 'zoom_range': 0.0, 'cnn_learning_rate': 1.3170303961801553e-05, 'unfreeze_percentage': 0.14820919345375544, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 115, 'batch_size': 16, 'num_dense_units_2': 33, 'learning_rate': 0.00021286728139435177, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.32110091415020303, 'info': {'runtime': 188.83376455307007, 'histories': {'loss': [2.2698442903283524, 1.68282851944231, 1.405794770750281, 1.0985361239681506, 1.0111493349075318, 0.9816231619228016, 0.8187933385372161, 0.6429708118308081, 0.7460819956374495, 0.620489674071743, 0.5899667217306894, 0.4671476426189893, 0.5141025699981271, 0.40527590215206144, 0.37737885076705724, 0.3194671877442974, 0.35815046911370263, 0.2869287655778127, 0.3002472752577638, 0.29336421130454704, 0.3083154714270814, 0.34657733734339885, 0.3117293413371256, 0.27810738384723666, 0.36793112032341235, 0.2916667327284813, 0.330970339579125, 0.3195929992688845, 0.32355594635009766, 0.30821726769208907, 0.3419274380712798, 0.31968677370515586], 'val_loss': [2.14415166356148, 2.098983491232636, 1.6727492328083844, 1.8483868738926879, 1.4509582125812495, 1.5009257279404806, 1.3311385495947041, 1.377029125843573, 1.3828383913827598, 1.2320534603311382, 1.410384208784191, 1.1715663310584672, 1.4280160359286387, 1.0949915439710705, 1.0801155337499917, 1.1659769705676157, 1.1342019706691078, 1.217269303601816, 1.160964486795828, 1.2111935265567324, 1.1656771690473644, 1.1938264129358693, 1.198005796572484, 1.2736658339106708, 1.3146807731838401, 1.2704894870793053, 1.2327499422458335, 1.2179199161879513, 1.2685095115539131, 1.2291465308688103, 1.1511213560716822, 1.2426681934146706], 'acc': [0.2054794520547945, 0.4931506849315068, 0.6232876712328768, 0.7534246575342466, 0.76875, 0.7803030303030303, 0.85625, 0.9315068493150684, 0.8767123287671232, 0.8972602739726028, 0.9178082191780822, 0.958904109589041, 0.9178082191780822, 0.9625, 0.9657534246575342, 0.9931506849315068, 0.9794520547945206, 0.9931506849315068, 0.9931506849315068, 0.9931506849315068, 0.9931506849315068, 0.9863013698630136, 1.0, 0.99375, 0.9621212121212122, 1.0, 0.9726027397260274, 0.9931506849315068, 0.9931506849315068, 0.9875, 0.9848484848484849, 0.9863013698630136], 'val_acc': [0.21100917567900562, 0.20183486429923173, 0.559633031350757, 0.3669724803452098, 0.541284407497546, 0.4862385364847446, 0.5688073492925102, 0.6422018370497118, 0.5229357825506717, 0.6330275256699378, 0.5596330297102622, 0.6513761566319597, 0.541284407497546, 0.697247715171324, 0.7155963324625557, 0.6788990847561338, 0.6330275251231062, 0.6422018447053541, 0.6513761506168121, 0.6697247728295282, 0.6880733966827393, 0.6880733983232341, 0.6788990907712814, 0.6697247793915075, 0.6513761544446333, 0.6605504685585651, 0.6788990847561338, 0.6513761489763172, 0.6697247728295282, 0.6788990847561338, 0.6972477086093447, 0.678899085849797]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 49)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 5)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 5) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 5) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 5) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 5)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 785, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0009344771029197748, 'unfreeze_percentage': 0.19338138495722026, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 79, 'batch_size': 31, 'learning_rate': 0.007005588697838697, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:21:16.571407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 11.6102 - acc: 0.1097 - val_loss: 14.8589 - val_acc: 0.0781
Epoch 2/2
 - 5s - loss: 14.4279 - acc: 0.1049 - val_loss: 14.6070 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 5), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 5) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 5) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 5) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 5)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 785, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0009344771029197748, 'unfreeze_percentage': 0.19338138495722026, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 79, 'batch_size': 31, 'learning_rate': 0.007005588697838697, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 16.77526044845581, 'histories': {'loss': [11.610162401199341, 14.51858912897474], 'val_loss': [14.858868598937988, 14.6070237159729], 'acc': [0.1096774160861969, 0.09923663883263828], 'val_acc': [0.078125, 0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 5)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 2)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 2) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 6) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (0, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 64.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 891, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017796954308221165, 'unfreeze_percentage': 0.04478912477888884, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 109, 'batch_size': 49, 'learning_rate': 0.00034997214739956715, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:21:32.695407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/30
 - 4s - loss: 2.4291 - acc: 0.2102 - val_loss: 2.1813 - val_acc: 0.2812
Epoch 2/30
 - 3s - loss: 1.8158 - acc: 0.3878 - val_loss: 1.8539 - val_acc: 0.4375
Epoch 3/30
 - 3s - loss: 1.1003 - acc: 0.7605 - val_loss: 1.4399 - val_acc: 0.5000
Epoch 4/30
 - 3s - loss: 0.7508 - acc: 0.8098 - val_loss: 1.3424 - val_acc: 0.5625
Epoch 5/30
 - 3s - loss: 0.5096 - acc: 0.9456 - val_loss: 1.5588 - val_acc: 0.5625
Epoch 6/30
 - 3s - loss: 0.5314 - acc: 0.8251 - val_loss: 1.1339 - val_acc: 0.6875
Epoch 7/30
 - 3s - loss: 0.4794 - acc: 0.8757 - val_loss: 1.3331 - val_acc: 0.5625
Epoch 8/30
 - 3s - loss: 0.3600 - acc: 0.9153 - val_loss: 1.3916 - val_acc: 0.5312
Epoch 9/30
 - 3s - loss: 0.2527 - acc: 0.9561 - val_loss: 1.3772 - val_acc: 0.5312
Epoch 10/30
 - 3s - loss: 0.1355 - acc: 1.0000 - val_loss: 0.7419 - val_acc: 0.8125
Epoch 11/30
 - 3s - loss: 0.3004 - acc: 0.9415 - val_loss: 1.3704 - val_acc: 0.5312
Epoch 12/30
 - 3s - loss: 0.3940 - acc: 0.8848 - val_loss: 0.9372 - val_acc: 0.7500
Epoch 13/30
 - 3s - loss: 0.0589 - acc: 1.0000 - val_loss: 0.9871 - val_acc: 0.6250
Epoch 14/30
 - 3s - loss: 0.1195 - acc: 0.9927 - val_loss: 1.0022 - val_acc: 0.6250
Epoch 15/30
 - 3s - loss: 0.0464 - acc: 1.0000 - val_loss: 0.8675 - val_acc: 0.7500
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 16/30
 - 3s - loss: 0.0725 - acc: 0.9927 - val_loss: 1.0396 - val_acc: 0.6250
Epoch 17/30
 - 3s - loss: 0.0353 - acc: 1.0000 - val_loss: 0.9743 - val_acc: 0.6562
Epoch 18/30
 - 3s - loss: 0.4620 - acc: 0.8628 - val_loss: 2.1633 - val_acc: 0.3438
Epoch 19/30
 - 3s - loss: 0.2385 - acc: 0.9252 - val_loss: 0.9990 - val_acc: 0.6875
Epoch 20/30
 - 3s - loss: 0.0341 - acc: 1.0000 - val_loss: 0.6623 - val_acc: 0.7812
Epoch 21/30
 - 3s - loss: 0.0223 - acc: 1.0000 - val_loss: 0.9715 - val_acc: 0.6562
Epoch 22/30
 - 3s - loss: 0.0404 - acc: 1.0000 - val_loss: 0.8707 - val_acc: 0.6875
Epoch 23/30
 - 3s - loss: 0.0188 - acc: 1.0000 - val_loss: 0.6919 - val_acc: 0.7812
Epoch 24/30
 - 3s - loss: 0.0182 - acc: 1.0000 - val_loss: 0.9881 - val_acc: 0.7188
Epoch 25/30
 - 3s - loss: 0.0179 - acc: 1.0000 - val_loss: 0.6750 - val_acc: 0.8125
Epoch 26/30
 - 3s - loss: 0.0182 - acc: 1.0000 - val_loss: 1.9245 - val_acc: 0.5000
Epoch 27/30
 - 3s - loss: 0.1167 - acc: 0.9592 - val_loss: 0.4345 - val_acc: 0.8125
Epoch 28/30
 - 3s - loss: 0.0165 - acc: 1.0000 - val_loss: 1.0928 - val_acc: 0.6875
Epoch 29/30
 - 3s - loss: 0.0116 - acc: 1.0000 - val_loss: 0.9350 - val_acc: 0.6875
Epoch 30/30
 - 3s - loss: 0.2130 - acc: 0.9561 - val_loss: 1.3416 - val_acc: 0.6562
{'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 891, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017796954308221165, 'unfreeze_percentage': 0.04478912477888884, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 109, 'batch_size': 49, 'learning_rate': 0.00034997214739956715, 'base_model': 'MobileNet', 'activation': 'relu'}

 ****** MobileNet unfrozen 1 top blocks, cut_off after layer 78 ******
Epoch 1/34
 - 4s - loss: 0.3164 - acc: 0.8952 - val_loss: 1.5191 - val_acc: 0.5000
Epoch 2/34
 - 3s - loss: 0.1061 - acc: 0.9781 - val_loss: 1.1204 - val_acc: 0.6250
Epoch 3/34
 - 3s - loss: 0.1477 - acc: 0.9728 - val_loss: 1.3328 - val_acc: 0.5625
Epoch 4/34
 - 3s - loss: 0.0735 - acc: 1.0000 - val_loss: 1.1777 - val_acc: 0.6562
Epoch 5/34
 - 3s - loss: 0.0526 - acc: 0.9927 - val_loss: 1.1228 - val_acc: 0.5938
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 6/34
 - 3s - loss: 0.0571 - acc: 0.9932 - val_loss: 1.0716 - val_acc: 0.6562
Epoch 7/34
 - 3s - loss: 0.0448 - acc: 1.0000 - val_loss: 1.1598 - val_acc: 0.6250
Epoch 8/34
 - 3s - loss: 0.0496 - acc: 1.0000 - val_loss: 1.3679 - val_acc: 0.5312
Epoch 9/34
 - 3s - loss: 0.0528 - acc: 1.0000 - val_loss: 1.1140 - val_acc: 0.6250
Epoch 10/34
 - 3s - loss: 0.0414 - acc: 1.0000 - val_loss: 0.8742 - val_acc: 0.6875
Epoch 11/34
 - 3s - loss: 0.0190 - acc: 1.0000 - val_loss: 1.0125 - val_acc: 0.6562
Epoch 12/34
 - 3s - loss: 0.0155 - acc: 1.0000 - val_loss: 0.8223 - val_acc: 0.7188
Epoch 13/34
 - 3s - loss: 0.0217 - acc: 1.0000 - val_loss: 1.0484 - val_acc: 0.6875
Epoch 14/34
 - 3s - loss: 0.0207 - acc: 1.0000 - val_loss: 0.8651 - val_acc: 0.6875
Epoch 15/34
 - 3s - loss: 0.0181 - acc: 1.0000 - val_loss: 0.7466 - val_acc: 0.6875
Epoch 16/34
 - 3s - loss: 0.0147 - acc: 1.0000 - val_loss: 0.8177 - val_acc: 0.8125
Epoch 17/34
 - 3s - loss: 0.0203 - acc: 1.0000 - val_loss: 1.1566 - val_acc: 0.6250
Epoch 18/34
 - 3s - loss: 0.0169 - acc: 1.0000 - val_loss: 0.7270 - val_acc: 0.7500
Epoch 19/34
 - 3s - loss: 0.0152 - acc: 1.0000 - val_loss: 0.7195 - val_acc: 0.8438
Epoch 20/34
 - 3s - loss: 0.0125 - acc: 1.0000 - val_loss: 0.9703 - val_acc: 0.6250
Epoch 21/34
 - 3s - loss: 0.0099 - acc: 1.0000 - val_loss: 1.1889 - val_acc: 0.6250
Epoch 22/34
 - 3s - loss: 0.0240 - acc: 1.0000 - val_loss: 0.5294 - val_acc: 0.8125
Epoch 23/34
 - 3s - loss: 0.0137 - acc: 1.0000 - val_loss: 0.6120 - val_acc: 0.7812
Epoch 24/34
 - 3s - loss: 0.0102 - acc: 1.0000 - val_loss: 0.8602 - val_acc: 0.7500
Epoch 25/34
 - 3s - loss: 0.0186 - acc: 1.0000 - val_loss: 1.1582 - val_acc: 0.6875
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 26/34
 - 3s - loss: 0.0266 - acc: 1.0000 - val_loss: 1.0146 - val_acc: 0.7188
Epoch 27/34
 - 3s - loss: 0.0153 - acc: 1.0000 - val_loss: 0.6697 - val_acc: 0.7812
Epoch 28/34
 - 3s - loss: 0.0099 - acc: 1.0000 - val_loss: 1.0353 - val_acc: 0.7812
Epoch 29/34
 - 3s - loss: 0.0113 - acc: 1.0000 - val_loss: 1.0103 - val_acc: 0.7188
Epoch 30/34
 - 3s - loss: 0.0098 - acc: 1.0000 - val_loss: 0.7477 - val_acc: 0.7812
Epoch 31/34
 - 3s - loss: 0.0110 - acc: 1.0000 - val_loss: 0.5263 - val_acc: 0.8750
Epoch 32/34
 - 3s - loss: 0.0085 - acc: 1.0000 - val_loss: 1.0541 - val_acc: 0.7500
Epoch 33/34
 - 3s - loss: 0.0127 - acc: 1.0000 - val_loss: 1.0244 - val_acc: 0.8125
Epoch 34/34
 - 3s - loss: 0.0082 - acc: 1.0000 - val_loss: 0.6361 - val_acc: 0.7812
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (0, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (0, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (0, 0, 2)
args: ()
kwargs: {'budget': 64.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 891, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017796954308221165, 'unfreeze_percentage': 0.04478912477888884, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 109, 'batch_size': 49, 'learning_rate': 0.00034997214739956715, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.21875, 'info': {'runtime': 197.27835941314697, 'histories': {'loss': [2.383592799701522, 1.8157586654027302, 1.0839766601545622, 0.8231626284860931, 0.5096236566702524, 0.5005050349024545, 0.541646373087326, 0.3447582705885963, 0.26356533262054477, 0.1354901815454165, 0.2830303788712594, 0.37507087677980944, 0.058882790307203926, 0.11085454967960848, 0.04471460096867739, 0.06994699897755564, 0.0353215808669726, 0.42160700431352927, 0.2384734091659387, 0.02970903623948055, 0.02295772665369827, 0.03722231826885084, 0.018806120691200096, 0.013678684360883405, 0.017994868206437184, 0.01433485166573551, 0.11671893298625946, 0.013383029449104735, 0.008476756381250061, 0.24605675559260148, 0.24625199281536372, 0.12138394012519743, 0.14773347973823547, 0.07577896873112273, 0.05272401467097544, 0.057051386684179306, 0.047244290400922824, 0.03864528342619934, 0.03379074164328322, 0.037855325860127936, 0.018961776979267597, 0.014385486087572258, 0.019718357831635308, 0.02068896830675349, 0.018124583487709362, 0.01358124892334495, 0.01829056375025384, 0.016909096390008926, 0.011632791411263489, 0.012938214301139908, 0.0099265460545818, 0.01926947149294841, 0.011111213528938525, 0.010184777900576591, 0.014568569286998394, 0.016857589998867658, 0.010850420691468547, 0.00991807629664739, 0.010426319138336498, 0.009329788831878552, 0.009549049841882908, 0.00853964313864708, 0.011011648725355622, 0.007556932092339328], 'val_loss': [2.181255340576172, 1.8539061546325684, 1.4399349689483643, 1.3423569202423096, 1.5588200092315674, 1.1339263916015625, 1.3330515623092651, 1.391575813293457, 1.377190113067627, 0.7418684959411621, 1.3704063892364502, 0.9372146725654602, 0.987143337726593, 1.002190351486206, 0.8674828410148621, 1.0395615100860596, 0.9742898941040039, 2.1632704734802246, 0.9990113973617554, 0.6622666120529175, 0.9715402126312256, 0.8706656694412231, 0.6919151544570923, 0.9880654811859131, 0.675012469291687, 1.9245262145996094, 0.43446633219718933, 1.092763900756836, 0.9350167512893677, 1.3415806293487549, 1.519101858139038, 1.1204297542572021, 1.3328309059143066, 1.1777265071868896, 1.1228430271148682, 1.071553349494934, 1.1598401069641113, 1.367894172668457, 1.1140309572219849, 0.8741620182991028, 1.0124738216400146, 0.8223428726196289, 1.0484098196029663, 0.8651233315467834, 0.7466061115264893, 0.8177091479301453, 1.1566137075424194, 0.726992666721344, 0.7194511890411377, 0.9702922105789185, 1.1889050006866455, 0.5294213891029358, 0.6119650602340698, 0.8601558804512024, 1.1581571102142334, 1.0146139860153198, 0.6696931719779968, 1.0352983474731445, 1.0103116035461426, 0.7477237582206726, 0.5263063311576843, 1.054140329360962, 1.024409294128418, 0.636094331741333], 'acc': [0.21238937828920584, 0.3877550959587097, 0.7522123492924513, 0.7699114849082137, 0.9455781579017639, 0.8584070590745031, 0.8495574904754098, 0.9115043936577518, 0.9469026026472581, 1.0, 0.9292035218888679, 0.9026548071245176, 1.0, 0.991150420851412, 1.0, 0.991150420851412, 1.0, 0.8607594650002974, 0.9251700242360433, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9591836531956991, 1.0, 1.0, 0.94690262849352, 0.9292034891854345, 0.9734512884004981, 0.9727890491485596, 1.0, 0.991150420851412, 0.9931972622871399, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], 'val_acc': [0.28125, 0.4375, 0.5, 0.5625, 0.5625, 0.6875, 0.5625, 0.53125, 0.53125, 0.8125, 0.53125, 0.75, 0.625, 0.625, 0.75, 0.625, 0.65625, 0.34375, 0.6875, 0.78125, 0.65625, 0.6875, 0.78125, 0.71875, 0.8125, 0.5, 0.8125, 0.6875, 0.6875, 0.65625, 0.5, 0.625, 0.5625, 0.65625, 0.59375, 0.65625, 0.625, 0.53125, 0.625, 0.6875, 0.65625, 0.71875, 0.6875, 0.6875, 0.6875, 0.8125, 0.625, 0.75, 0.84375, 0.625, 0.625, 0.8125, 0.78125, 0.75, 0.6875, 0.71875, 0.78125, 0.78125, 0.71875, 0.78125, 0.875, 0.75, 0.8125, 0.78125]}}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 6)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 6) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 7) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 6) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 6)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 318, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00037001528960456116, 'unfreeze_percentage': 0.1092688085528541, 'rotation_range': 0, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 75, 'batch_size': 32, 'learning_rate': 0.002858168521561307, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:24:51.105198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.7989 - acc: 0.1493 - val_loss: 2.5262 - val_acc: 0.0938
Epoch 2/2
 - 4s - loss: 1.7521 - acc: 0.4312 - val_loss: 2.4229 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 6), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 6) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 6) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 6)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 318, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00037001528960456116, 'unfreeze_percentage': 0.1092688085528541, 'rotation_range': 0, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 75, 'batch_size': 32, 'learning_rate': 0.002858168521561307, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 15.069790363311768, 'histories': {'loss': [2.7343760453737698, 1.752086067199707], 'val_loss': [2.526161789894104, 2.422910213470459], 'acc': [0.17692307692307693, 0.43125], 'val_acc': [0.09375, 0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 6)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 7)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 7) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 7) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 8) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 7) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 7)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 887, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0009234344396982769, 'unfreeze_percentage': 0.26388770998635935, 'rotation_range': 0, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 126, 'batch_size': 25, 'num_dense_units_2': 209, 'learning_rate': 0.0008993079435562728, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:25:11.347814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 8s - loss: 2.8717 - acc: 0.1211 - val_loss: 2.5549 - val_acc: 0.0909
Epoch 2/2
 - 6s - loss: 2.4055 - acc: 0.1470 - val_loss: 2.3574 - val_acc: 0.0909
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 7), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 7) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 7) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 7) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 7)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 887, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0009234344396982769, 'unfreeze_percentage': 0.26388770998635935, 'rotation_range': 0, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 126, 'batch_size': 25, 'num_dense_units_2': 209, 'learning_rate': 0.0008993079435562728, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.9090909090909091, 'info': {'runtime': 26.43833065032959, 'histories': {'loss': [2.8082577677538794, 2.418422041148165], 'val_loss': [2.554909223085874, 2.357433814507026], 'acc': [0.12408758884798872, 0.1386861287764389], 'val_acc': [0.09090909090909091, 0.09090909090909091]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 7)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 8)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 8) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 8) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 9) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 8) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 8)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 841, 'zoom_range': 0.0, 'cnn_learning_rate': 8.206800096052727e-05, 'unfreeze_percentage': 0.02000424133619941, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 145, 'batch_size': 24, 'learning_rate': 0.00022645921466755685, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:25:31.410684: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.2966 - acc: 0.2485 - val_loss: 1.9813 - val_acc: 0.3377
Epoch 2/2
 - 3s - loss: 1.4006 - acc: 0.5769 - val_loss: 1.5024 - val_acc: 0.5195
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 8), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 8) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 8) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 8) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 8)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 841, 'zoom_range': 0.0, 'cnn_learning_rate': 8.206800096052727e-05, 'unfreeze_percentage': 0.02000424133619941, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 145, 'batch_size': 24, 'learning_rate': 0.00022645921466755685, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.48051946658592715, 'info': {'runtime': 12.253070592880249, 'histories': {'loss': [2.2933895173280137, 1.3942370777544768], 'val_loss': [1.9813118383481905, 1.5024299311947513], 'acc': [0.25362319758404855, 0.5797101673872574], 'val_acc': [0.33766234308094173, 0.5194805334140729]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 8)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 9)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 9) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 10) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 9) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 9) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 9)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 235, 'zoom_range': 0.0, 'cnn_learning_rate': 2.0155738055572705e-05, 'unfreeze_percentage': 0.13665202884501917, 'rotation_range': 0, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 123, 'batch_size': 39, 'learning_rate': 0.0002437575464987383, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:25:46.415858: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.3844 - acc: 0.0675 - val_loss: 2.3080 - val_acc: 0.1250
Epoch 2/2
 - 4s - loss: 2.3269 - acc: 0.0473 - val_loss: 2.3765 - val_acc: 0.0312
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 9), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 9) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 9) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 9) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 9)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 235, 'zoom_range': 0.0, 'cnn_learning_rate': 2.0155738055572705e-05, 'unfreeze_percentage': 0.13665202884501917, 'rotation_range': 0, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 123, 'batch_size': 39, 'learning_rate': 0.0002437575464987383, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.96875, 'info': {'runtime': 16.298277854919434, 'histories': {'loss': [2.388854881612266, 2.3209142045276923], 'val_loss': [2.3080475330352783, 2.3764681816101074], 'acc': [0.08130081524936164, 0.05691057043831523], 'val_acc': [0.125, 0.03125]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 9)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 10)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 10) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 10) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 11) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 10)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002956101170379864, 'unfreeze_percentage': 0.2665666007241914, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 350, 'batch_size': 29, 'learning_rate': 0.003003819282627949, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:26:00.616705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 4.8733 - acc: 0.1312 - val_loss: 2.6723 - val_acc: 0.1719
Epoch 2/2
 - 3s - loss: 2.3640 - acc: 0.2345 - val_loss: 2.1060 - val_acc: 0.3438
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 10), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 10) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 10)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002956101170379864, 'unfreeze_percentage': 0.2665666007241914, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 350, 'batch_size': 29, 'learning_rate': 0.003003819282627949, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.65625, 'info': {'runtime': 13.634474515914917, 'histories': {'loss': [5.036703038036375, 2.363981914520264], 'val_loss': [2.6723008155822754, 2.1059670448303223], 'acc': [0.12781954741567597, 0.2344827577471733], 'val_acc': [0.171875, 0.34375]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 10)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 11)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 11) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 11) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 12) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 11) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 11)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 396, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00036377354602511495, 'unfreeze_percentage': 0.16783155475559328, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 70, 'batch_size': 25, 'num_dense_units_2': 12, 'learning_rate': 0.0016168767586911337, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:26:14.890912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.3333 - acc: 0.0878 - val_loss: 2.3954 - val_acc: 0.0260
Epoch 2/2
 - 5s - loss: 2.2767 - acc: 0.1531 - val_loss: 2.3523 - val_acc: 0.0260
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 11), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 11) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 11) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 11) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 11)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 396, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00036377354602511495, 'unfreeze_percentage': 0.16783155475559328, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 70, 'batch_size': 25, 'num_dense_units_2': 12, 'learning_rate': 0.0016168767586911337, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.974025974025974, 'info': {'runtime': 17.601946353912354, 'histories': {'loss': [2.3274658439803297, 2.2905969463125633], 'val_loss': [2.3954259358443224, 2.352329563784909], 'acc': [0.0948905074683419, 0.1386861298097311], 'val_acc': [0.025974025974025976, 0.025974025974025976]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 11)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 12)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 12) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 12) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 13) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 12) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 12)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 508, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001745473799498149, 'unfreeze_percentage': 0.11834969158639597, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 94, 'batch_size': 42, 'learning_rate': 0.0013236387348095954, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:26:32.989006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.5506 - acc: 0.1349 - val_loss: 2.5084 - val_acc: 0.0938
Epoch 2/2
 - 3s - loss: 1.5151 - acc: 0.5346 - val_loss: 2.8789 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 12), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 12) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 12) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 12) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 12)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 508, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001745473799498149, 'unfreeze_percentage': 0.11834969158639597, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 94, 'batch_size': 42, 'learning_rate': 0.0013236387348095954, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 13.775306940078735, 'histories': {'loss': [2.5505693753560386, 1.512125065452174], 'val_loss': [2.5084123611450195, 2.878896713256836], 'acc': [0.13492063929637274, 0.5350877485777202], 'val_acc': [0.09375, 0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 12)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 13)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 13) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 13) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 14) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 13) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 13)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 135, 'zoom_range': 0.0, 'cnn_learning_rate': 1.5704157902554578e-05, 'unfreeze_percentage': 0.02381270600769416, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 263, 'batch_size': 57, 'learning_rate': 0.00014958784430567113, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:26:46.470171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.3029 - acc: 0.0957 - val_loss: 2.2561 - val_acc: 0.1875
Epoch 2/2
 - 5s - loss: 2.2753 - acc: 0.1930 - val_loss: 2.2844 - val_acc: 0.1875
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 13), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 13) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 13) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 13) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 13)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 135, 'zoom_range': 0.0, 'cnn_learning_rate': 1.5704157902554578e-05, 'unfreeze_percentage': 0.02381270600769416, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 263, 'batch_size': 57, 'learning_rate': 0.00014958784430567113, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8125, 'info': {'runtime': 15.023841857910156, 'histories': {'loss': [2.3033699921199253, 2.2753294706344604], 'val_loss': [2.256091594696045, 2.2844326496124268], 'acc': [0.09523809786353793, 0.19298245757818222], 'val_acc': [0.1875, 0.1875]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 13)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 14)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 14) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 15) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 14) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 14) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 14)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 365, 'zoom_range': 0.0, 'cnn_learning_rate': 1.50647561353589e-05, 'unfreeze_percentage': 0.1682997566657824, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 56, 'batch_size': 40, 'num_dense_units_2': 42, 'learning_rate': 0.004416431328381548, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:27:00.445518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.4003 - acc: 0.2079 - val_loss: 2.4998 - val_acc: 0.1250
Epoch 2/2
 - 3s - loss: 2.4119 - acc: 0.1125 - val_loss: 2.3731 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 14), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 14) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 14) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 14) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 14)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 365, 'zoom_range': 0.0, 'cnn_learning_rate': 1.50647561353589e-05, 'unfreeze_percentage': 0.1682997566657824, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 56, 'batch_size': 40, 'num_dense_units_2': 42, 'learning_rate': 0.004416431328381548, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.875, 'info': {'runtime': 11.166054248809814, 'histories': {'loss': [2.4336288991521617, 2.4119073152542114], 'val_loss': [2.4997687339782715, 2.3730685710906982], 'acc': [0.13934426669214592, 0.11250000447034836], 'val_acc': [0.125, 0.125]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 14)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 15)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 15) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 15) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 16) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 15) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 15)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 549, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002707429901227452, 'unfreeze_percentage': 0.05338008879900713, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 284, 'batch_size': 16, 'learning_rate': 0.0011410406015479025, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:27:13.202749: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 4.7259 - acc: 0.1387 - val_loss: 2.5451 - val_acc: 0.0642
Epoch 2/2
 - 4s - loss: 1.6881 - acc: 0.4748 - val_loss: 2.3004 - val_acc: 0.1743
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 15), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 15) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 15) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 15) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 15)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 549, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002707429901227452, 'unfreeze_percentage': 0.05338008879900713, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 284, 'batch_size': 16, 'learning_rate': 0.0011410406015479025, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8256880730527256, 'info': {'runtime': 24.29757332801819, 'histories': {'loss': [4.892926993435377, 1.6970152414008364], 'val_loss': [2.5450909968909867, 2.3004347971819956], 'acc': [0.1506849315068493, 0.4726027397260274], 'val_acc': [0.06422018382800829, 0.17431192694727435]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 15)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 16)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 16) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 16) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 17) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 16) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 16)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 300, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007711683203040776, 'unfreeze_percentage': 0.040678847527422644, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 54, 'batch_size': 16, 'learning_rate': 0.0008454467260258397, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:27:42.568649: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 9s - loss: 2.5062 - acc: 0.1438 - val_loss: 2.3763 - val_acc: 0.2202
Epoch 2/2
 - 6s - loss: 2.1409 - acc: 0.2819 - val_loss: 2.1506 - val_acc: 0.3303
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 16), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 16) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 16) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 16) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 16)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 300, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007711683203040776, 'unfreeze_percentage': 0.040678847527422644, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 54, 'batch_size': 16, 'learning_rate': 0.0008454467260258397, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.6697247687282912, 'info': {'runtime': 33.29257297515869, 'histories': {'loss': [2.506194067001343, 2.0485900062503237], 'val_loss': [2.3763110331439097, 2.1506166808102107], 'acc': [0.14375, 0.2878787878787879], 'val_acc': [0.22018348705877952, 0.33027523127170877]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 16)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 17)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 17) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 17) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 18) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 17) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 17)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 993, 'zoom_range': 0.0, 'cnn_learning_rate': 4.516626323296138e-05, 'unfreeze_percentage': 0.15388960110982627, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 103, 'batch_size': 23, 'learning_rate': 0.00493046747113642, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:28:10.571964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.4624 - acc: 0.0697 - val_loss: 2.4997 - val_acc: 0.1429
Epoch 2/2
 - 4s - loss: 2.2101 - acc: 0.1520 - val_loss: 2.4448 - val_acc: 0.1688
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 17), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 17) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 17) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 17) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 17)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 993, 'zoom_range': 0.0, 'cnn_learning_rate': 4.516626323296138e-05, 'unfreeze_percentage': 0.15388960110982627, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 103, 'batch_size': 23, 'learning_rate': 0.00493046747113642, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8311688284595291, 'info': {'runtime': 13.927663803100586, 'histories': {'loss': [2.504659429728556, 2.2074538306366627], 'val_loss': [2.499664969258494, 2.444803253396765], 'acc': [0.0791366915051028, 0.17266187495250496], 'val_acc': [0.1428571433409468, 0.16883117154047086]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 17)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 18)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 18) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 18) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 19) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 18) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 18)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 125, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00025025396419323467, 'unfreeze_percentage': 0.09199187437198351, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 73, 'batch_size': 28, 'learning_rate': 0.005892671258199788, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 14:28:30.843699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.3429 - acc: 0.0536 - val_loss: 2.4052 - val_acc: 0.1406
Epoch 2/2
 - 5s - loss: 2.2995 - acc: 0.1000 - val_loss: 2.3781 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 18), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 18) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 18) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 18) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 18)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 125, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00025025396419323467, 'unfreeze_percentage': 0.09199187437198351, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 73, 'batch_size': 28, 'learning_rate': 0.005892671258199788, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.890625, 'info': {'runtime': 25.218148708343506, 'histories': {'loss': [2.345317256984426, 2.2995064735412596], 'val_loss': [2.4052098989486694, 2.3780847787857056], 'acc': [0.052238808083000465, 0.10000000670552253], 'val_acc': [0.140625, 0.109375]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 18)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 19)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 19) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 19) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 20) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 19) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 19)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 430, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008850084607653113, 'unfreeze_percentage': 0.2950354371214048, 'rotation_range': 0, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 304, 'batch_size': 41, 'learning_rate': 0.0004063357454979262, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:28:48.913647: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 4s - loss: 2.4549 - acc: 0.0901 - val_loss: 2.1433 - val_acc: 0.2188
Epoch 2/2
 - 3s - loss: 1.7790 - acc: 0.4958 - val_loss: 1.9119 - val_acc: 0.2812
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 19), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 19) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 19) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 19) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 19)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 430, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008850084607653113, 'unfreeze_percentage': 0.2950354371214048, 'rotation_range': 0, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 304, 'batch_size': 41, 'learning_rate': 0.0004063357454979262, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.71875, 'info': {'runtime': 11.468803882598877, 'histories': {'loss': [2.4525883375120556, 1.7783197430539723], 'val_loss': [2.1433000564575195, 1.9119303226470947], 'acc': [0.09090908793809492, 0.49586776834874113], 'val_acc': [0.21875, 0.28125]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 19)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 20)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 20) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 20) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 21) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 20) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 20)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 275, 'zoom_range': 0.0, 'cnn_learning_rate': 1.4645704593898427e-05, 'unfreeze_percentage': 0.026485085281958275, 'rotation_range': 0, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 210, 'batch_size': 56, 'learning_rate': 0.009365839132899267, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:29:00.438196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 4s - loss: 4.3808 - acc: 0.0625 - val_loss: 4.3720 - val_acc: 0.0312
Epoch 2/2
 - 3s - loss: 4.8604 - acc: 0.1142 - val_loss: 7.1177 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 20), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 20) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 20) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 20) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 20)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 275, 'zoom_range': 0.0, 'cnn_learning_rate': 1.4645704593898427e-05, 'unfreeze_percentage': 0.026485085281958275, 'rotation_range': 0, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 210, 'batch_size': 56, 'learning_rate': 0.009365839132899267, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 11.101739883422852, 'histories': {'loss': [4.380795240402222, 4.922691066310091], 'val_loss': [4.3719940185546875, 7.117710113525391], 'acc': [0.0625000037252903, 0.11320754154673163], 'val_acc': [0.03125, 0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 20)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 21)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 21) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 22) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 21) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 21) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 21)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 116, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00011816876273160953, 'unfreeze_percentage': 0.02700665312364713, 'rotation_range': 0, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 148, 'batch_size': 52, 'num_dense_units_2': 215, 'learning_rate': 0.0037340006132453992, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:29:13.156621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 4.1163 - acc: 0.1077 - val_loss: 4.0868 - val_acc: 0.0000e+00
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/2
 - 3s - loss: 4.4695 - acc: 0.1218 - val_loss: 4.4179 - val_acc: 0.0625
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 21), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 21) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 21) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 21) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 21)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 116, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00011816876273160953, 'unfreeze_percentage': 0.02700665312364713, 'rotation_range': 0, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 148, 'batch_size': 52, 'num_dense_units_2': 215, 'learning_rate': 0.0037340006132453992, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.9375, 'info': {'runtime': 13.806090593338013, 'histories': {'loss': [4.585296032645486, 4.7131366296248], 'val_loss': [4.086767196655273, 4.417919635772705], 'acc': [0.09090909686955538, 0.10909091396765276], 'val_acc': [0.0, 0.0625]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 21)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 22)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 22) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 23) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 22) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 22) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 22)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 573, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017982513285836262, 'unfreeze_percentage': 0.11306886756247031, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 480, 'batch_size': 33, 'learning_rate': 0.00041638502378627456, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:29:32.486861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.4348 - acc: 0.1565 - val_loss: 2.3880 - val_acc: 0.1094
Epoch 2/2
 - 5s - loss: 1.9566 - acc: 0.2045 - val_loss: 2.0025 - val_acc: 0.2969
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 22), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 22) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 22) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 22) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 22)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 573, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017982513285836262, 'unfreeze_percentage': 0.11306886756247031, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 480, 'batch_size': 33, 'learning_rate': 0.00041638502378627456, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.703125, 'info': {'runtime': 24.852684020996094, 'histories': {'loss': [2.434406263883724, 1.9565600752830505], 'val_loss': [2.3880385160446167, 2.0024892687797546], 'acc': [0.15503876638966937, 0.20454546064138412], 'val_acc': [0.109375, 0.296875]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 22)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 23)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 23) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 23) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 24) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 23) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 23)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 259, 'zoom_range': 0.0, 'cnn_learning_rate': 3.076650801892846e-05, 'unfreeze_percentage': 0.13845711508115638, 'rotation_range': 0, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 352, 'batch_size': 39, 'num_dense_units_2': 14, 'learning_rate': 0.0044258836165815725, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:29:53.581204: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.2941 - acc: 0.1240 - val_loss: 2.2934 - val_acc: 0.0938
Epoch 2/2
 - 4s - loss: 2.2973 - acc: 0.1454 - val_loss: 2.3132 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 23), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 23) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 23) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 23) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 23)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 259, 'zoom_range': 0.0, 'cnn_learning_rate': 3.076650801892846e-05, 'unfreeze_percentage': 0.13845711508115638, 'rotation_range': 0, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 352, 'batch_size': 39, 'num_dense_units_2': 14, 'learning_rate': 0.0044258836165815725, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.875, 'info': {'runtime': 16.37324285507202, 'histories': {'loss': [2.3020342384896626, 2.309543022295324], 'val_loss': [2.293400287628174, 2.3132100105285645], 'acc': [0.08130081434075426, 0.07317073352453185], 'val_acc': [0.09375, 0.125]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 23)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 24)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 24) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 24) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 25) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 24)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 252, 'zoom_range': 0.0, 'cnn_learning_rate': 4.216189818804691e-05, 'unfreeze_percentage': 0.18393042887761338, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 160, 'batch_size': 17, 'learning_rate': 0.00694332055562021, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
DEBUG:hpbandster:DISPATCHER: job (1, 0, 24) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
2018-02-08 14:30:13.685136: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 8s - loss: 2.3336 - acc: 0.1077 - val_loss: 2.2988 - val_acc: 0.1560
Epoch 2/2
 - 6s - loss: 2.2972 - acc: 0.1326 - val_loss: 2.2785 - val_acc: 0.2110
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 24), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 24) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 24) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 24) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 24)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 252, 'zoom_range': 0.0, 'cnn_learning_rate': 4.216189818804691e-05, 'unfreeze_percentage': 0.18393042887761338, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 160, 'batch_size': 17, 'learning_rate': 0.00694332055562021, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.7889908253463036, 'info': {'runtime': 27.55533742904663, 'histories': {'loss': [2.3386106408875564, 2.30295803135839], 'val_loss': [2.2987912772992334, 2.2784822971448984], 'acc': [0.09655172503713903, 0.11724138116014415], 'val_acc': [0.1559633046662042, 0.21100917465369637]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 24)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 25)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 25) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 25) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 26) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 25) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 25)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 133, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00018307408941620467, 'unfreeze_percentage': 0.13774994206369276, 'rotation_range': 0, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 109, 'batch_size': 38, 'learning_rate': 0.0034018642263589816, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:30:41.762843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 6.4755 - acc: 0.1316 - val_loss: 2.5827 - val_acc: 0.0781
Epoch 2/2
 - 5s - loss: 2.6521 - acc: 0.1464 - val_loss: 2.8622 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 25), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 25) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 25) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 25) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 25)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 133, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00018307408941620467, 'unfreeze_percentage': 0.13774994206369276, 'rotation_range': 0, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 109, 'batch_size': 38, 'learning_rate': 0.0034018642263589816, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 25.559258699417114, 'histories': {'loss': [7.192063785368396, 2.620582130647475], 'val_loss': [2.582704782485962, 2.8622101545333862], 'acc': [0.1370967752750843, 0.13709677876003326], 'val_acc': [0.078125, 0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 25)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 26)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 26) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 26) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 27) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 26) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 26)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 594, 'zoom_range': 0.0, 'cnn_learning_rate': 5.929194294333992e-05, 'unfreeze_percentage': 0.0825286030105998, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 89, 'batch_size': 16, 'learning_rate': 0.0016544273318660231, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:31:01.990420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 3.2691 - acc: 0.0883 - val_loss: 2.5730 - val_acc: 0.0917
Epoch 2/2
 - 6s - loss: 2.3305 - acc: 0.1625 - val_loss: 2.1630 - val_acc: 0.2110
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 26), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 26) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 26) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 26) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 26)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 594, 'zoom_range': 0.0, 'cnn_learning_rate': 5.929194294333992e-05, 'unfreeze_percentage': 0.0825286030105998, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 89, 'batch_size': 16, 'learning_rate': 0.0016544273318660231, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.7889908243209944, 'info': {'runtime': 17.635968446731567, 'histories': {'loss': [3.283078422285106, 2.3305357694625854], 'val_loss': [2.572983138058164, 2.162991238296579], 'acc': [0.0958904109589041, 0.1625], 'val_acc': [0.0917431196078248, 0.21100917567900562]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 26)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 27)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 27) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 28) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 27) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 27) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 27)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 667, 'zoom_range': 0.0, 'cnn_learning_rate': 5.68331327817518e-05, 'unfreeze_percentage': 0.19197100562348035, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 354, 'batch_size': 33, 'num_dense_units_2': 125, 'learning_rate': 0.009564890865281206, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:31:18.734370: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.5140 - acc: 0.0697 - val_loss: 2.4414 - val_acc: 0.1719
Epoch 2/2
 - 3s - loss: 2.2885 - acc: 0.1711 - val_loss: 2.3508 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 27), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 27) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 27) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 27) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 27)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 667, 'zoom_range': 0.0, 'cnn_learning_rate': 5.68331327817518e-05, 'unfreeze_percentage': 0.19197100562348035, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 354, 'batch_size': 33, 'num_dense_units_2': 125, 'learning_rate': 0.009564890865281206, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.84375, 'info': {'runtime': 12.89119577407837, 'histories': {'loss': [2.512140684349592, 2.2886928680331207], 'val_loss': [2.4413965940475464, 2.350768208503723], 'acc': [0.06976744428623555, 0.1705426435137904], 'val_acc': [0.171875, 0.15625]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 27)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 28)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 28) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 28) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 29) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 28) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 28)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 455, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001103285383622951, 'unfreeze_percentage': 0.2908174270366359, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 63, 'batch_size': 36, 'learning_rate': 0.0002413653795818032, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:31:32.745464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.3170 - acc: 0.2024 - val_loss: 2.4667 - val_acc: 0.1094
Epoch 2/2
 - 4s - loss: 1.6246 - acc: 0.5762 - val_loss: 2.4641 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 28), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 28) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 28) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 28) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 28)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 455, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001103285383622951, 'unfreeze_percentage': 0.2908174270366359, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 63, 'batch_size': 36, 'learning_rate': 0.0002413653795818032, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 13.964107036590576, 'histories': {'loss': [2.2901855536869595, 1.662860938480922], 'val_loss': [2.466659665107727, 2.4640684127807617], 'acc': [0.20634921107973372, 0.5476190788405282], 'val_acc': [0.109375, 0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 28)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 29)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 29) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 29) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 30) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 29) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 29)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 110, 'zoom_range': 0.0, 'cnn_learning_rate': 7.316929490893968e-05, 'unfreeze_percentage': 0.06323186283248969, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 80, 'batch_size': 26, 'learning_rate': 0.0006848154188786375, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:31:52.360456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 8s - loss: 2.4096 - acc: 0.1034 - val_loss: 2.3079 - val_acc: 0.1719
Epoch 2/2
 - 5s - loss: 2.0541 - acc: 0.2513 - val_loss: 2.2649 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 29), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 29) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 29) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 29) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 29)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 110, 'zoom_range': 0.0, 'cnn_learning_rate': 7.316929490893968e-05, 'unfreeze_percentage': 0.06323186283248969, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 80, 'batch_size': 26, 'learning_rate': 0.0006848154188786375, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.875, 'info': {'runtime': 26.206625938415527, 'histories': {'loss': [2.424874642316033, 2.099246093455483], 'val_loss': [2.307872772216797, 2.2648608684539795], 'acc': [0.09558824093683678, 0.22058824909960523], 'val_acc': [0.171875, 0.125]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 29)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 30)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 30) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 31) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 30) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 30) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 30)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 627, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0003332881151285898, 'unfreeze_percentage': 0.07887194919775631, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 96, 'batch_size': 24, 'num_dense_units_2': 296, 'learning_rate': 0.0003654671975082566, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:32:11.664503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.4652 - acc: 0.0529 - val_loss: 2.4069 - val_acc: 0.0649
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/2
 - 4s - loss: 2.4627 - acc: 0.0409 - val_loss: 2.4425 - val_acc: 0.0390
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 30), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 30) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 30) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 30) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 30)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 627, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0003332881151285898, 'unfreeze_percentage': 0.07887194919775631, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 96, 'batch_size': 24, 'num_dense_units_2': 296, 'learning_rate': 0.0003654671975082566, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.961038961038961, 'info': {'runtime': 13.252919912338257, 'histories': {'loss': [2.470082676928976, 2.4655824536862583], 'val_loss': [2.406874244863337, 2.442484796821297], 'acc': [0.050724638868933136, 0.036231885137765305], 'val_acc': [0.06493506541886887, 0.03896103896103896]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 30)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 31)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 31) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 31) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 0) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 31)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 151, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00015415880854765962, 'unfreeze_percentage': 0.03938619114153193, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 180, 'batch_size': 20, 'learning_rate': 0.0002291702024322162, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:32:24.955534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.2198 - acc: 0.1965 - val_loss: 2.1537 - val_acc: 0.1818
Epoch 2/2
 - 4s - loss: 1.9303 - acc: 0.3232 - val_loss: 1.9651 - val_acc: 0.3506
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 31), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 31) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 31)
args: ()
kwargs: {'budget': 2.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 151, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00015415880854765962, 'unfreeze_percentage': 0.03938619114153193, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 180, 'batch_size': 20, 'learning_rate': 0.0002291702024322162, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.6493506474154336, 'info': {'runtime': 12.856663227081299, 'histories': {'loss': [2.255424331611311, 1.815331025862358], 'val_loss': [2.153710931926579, 1.9650890223391644], 'acc': [0.2183098660808214, 0.35915493335522397], 'val_acc': [0.18181818375339756, 0.35064935258456637]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 31)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 0) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 24) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 0) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 151, 'zoom_range': 0.0, 'cnn_learning_rate': 4.5115076711316286e-05, 'unfreeze_percentage': 0.12578119934472562, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 233, 'batch_size': 20, 'learning_rate': 0.0018919149581356326, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:32:37.860171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 3.4530 - acc: 0.1331 - val_loss: 2.1813 - val_acc: 0.2468
Epoch 2/4
 - 3s - loss: 1.8611 - acc: 0.3866 - val_loss: 2.4648 - val_acc: 0.1299
Epoch 3/4
 - 4s - loss: 1.6245 - acc: 0.4493 - val_loss: 1.5186 - val_acc: 0.4286
Epoch 4/4
 - 4s - loss: 1.5494 - acc: 0.5451 - val_loss: 1.2836 - val_acc: 0.5974
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 0)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 151, 'zoom_range': 0.0, 'cnn_learning_rate': 4.5115076711316286e-05, 'unfreeze_percentage': 0.12578119934472562, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 233, 'batch_size': 20, 'learning_rate': 0.0018919149581356326, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.4025973902120219, 'info': {'runtime': 19.63880205154419, 'histories': {'loss': [3.33889640217096, 1.7080833072393713, 1.6496759031859922, 1.3370938922317934], 'val_loss': [2.1812970142859918, 2.4647605759756908, 1.51864920034037, 1.2835597744235745], 'acc': [0.14788732719673237, 0.42957746227022625, 0.44366198778152466, 0.6056338170884361], 'val_acc': [0.24675324946254878, 0.12987012987012986, 0.42857143476411896, 0.5974026097879781]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 0)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 24)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 24) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 3) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 24) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 24) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 24)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 252, 'zoom_range': 0.0, 'cnn_learning_rate': 4.216189818804691e-05, 'unfreeze_percentage': 0.18393042887761338, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 160, 'batch_size': 17, 'learning_rate': 0.00694332055562021, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:33:04.216070: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 8s - loss: 2.3061 - acc: 0.1117 - val_loss: 2.3400 - val_acc: 0.0826
Epoch 2/4
 - 6s - loss: 2.2599 - acc: 0.1879 - val_loss: 2.3369 - val_acc: 0.1101
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/4
 - 6s - loss: 2.2363 - acc: 0.2470 - val_loss: 2.3117 - val_acc: 0.1193
Epoch 4/4
 - 6s - loss: 2.2057 - acc: 0.2418 - val_loss: 2.2695 - val_acc: 0.1560
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 24), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 24) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 24) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 24) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 24)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 252, 'zoom_range': 0.0, 'cnn_learning_rate': 4.216189818804691e-05, 'unfreeze_percentage': 0.18393042887761338, 'rotation_range': 0, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 160, 'batch_size': 17, 'learning_rate': 0.00694332055562021, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8440366965641669, 'info': {'runtime': 38.93226766586304, 'histories': {'loss': [2.305955872042426, 2.2625722309638716, 2.235312660809221, 2.2057222260369196], 'val_loss': [2.3399719448264586, 2.336869869757136, 2.3116667883111797, 2.2694583026641006], 'acc': [0.1172413814941357, 0.1862069003540894, 0.2482758691598629, 0.24183007288310263], 'val_acc': [0.08256880733944955, 0.11009174346103581, 0.11926605504587157, 0.1559633034358331]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 24)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 3)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 3) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 10) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 3) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 3)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 596, 'zoom_range': 0.0, 'cnn_learning_rate': 6.075112003970132e-05, 'unfreeze_percentage': 0.18214831344469687, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 126, 'batch_size': 31, 'learning_rate': 0.002310184814343086, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:33:44.007644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 8s - loss: 4.3655 - acc: 0.0665 - val_loss: 2.7590 - val_acc: 0.1094
Epoch 2/4
 - 5s - loss: 2.5023 - acc: 0.1115 - val_loss: 2.2865 - val_acc: 0.1406
Epoch 3/4
 - 5s - loss: 2.3595 - acc: 0.1248 - val_loss: 2.3867 - val_acc: 0.1406
Epoch 4/4
 - 6s - loss: 2.3787 - acc: 0.0710 - val_loss: 2.4080 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 3)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 596, 'zoom_range': 0.0, 'cnn_learning_rate': 6.075112003970132e-05, 'unfreeze_percentage': 0.18214831344469687, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 126, 'batch_size': 31, 'learning_rate': 0.002310184814343086, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.890625, 'info': {'runtime': 39.12171649932861, 'histories': {'loss': [4.152827681475923, 2.543416966008776, 2.388839202982779, 2.378721237182617], 'val_loss': [2.758965492248535, 2.2864824533462524, 2.386731743812561, 2.4080135822296143], 'acc': [0.07633587558760897, 0.10687022639139918, 0.12213740150892098, 0.07096773982048035], 'val_acc': [0.109375, 0.140625, 0.140625, 0.109375]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 3)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 10)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 10) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 22) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 10) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 10)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002956101170379864, 'unfreeze_percentage': 0.2665666007241914, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 350, 'batch_size': 29, 'learning_rate': 0.003003819282627949, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:34:16.798534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 4s - loss: 4.5845 - acc: 0.1743 - val_loss: 4.2021 - val_acc: 0.1719
Epoch 2/4
 - 3s - loss: 3.2792 - acc: 0.3184 - val_loss: 2.3236 - val_acc: 0.3906
Epoch 3/4
 - 3s - loss: 2.0823 - acc: 0.4276 - val_loss: 1.7933 - val_acc: 0.4219
Epoch 4/4
 - 3s - loss: 1.3867 - acc: 0.6256 - val_loss: 1.6090 - val_acc: 0.5469
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 10), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 10) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 10)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002956101170379864, 'unfreeze_percentage': 0.2665666007241914, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 350, 'batch_size': 29, 'learning_rate': 0.003003819282627949, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.453125, 'info': {'runtime': 18.046368837356567, 'histories': {'loss': [4.635428609704613, 3.348046492813225, 2.082310199737549, 1.3895897560549857], 'val_loss': [4.202134609222412, 2.3235892057418823, 1.79326993227005, 1.6090062260627747], 'acc': [0.1654135324901208, 0.315789470547124, 0.4275861978530884, 0.624060144549922], 'val_acc': [0.171875, 0.390625, 0.421875, 0.546875]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 10)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 22)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 22) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 23) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 22) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 22) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 22)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 573, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017982513285836262, 'unfreeze_percentage': 0.11306886756247031, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 480, 'batch_size': 33, 'learning_rate': 0.00041638502378627456, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:34:40.765446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 7s - loss: 2.4496 - acc: 0.1236 - val_loss: 2.4739 - val_acc: 0.1406
Epoch 2/4
 - 5s - loss: 2.1110 - acc: 0.2955 - val_loss: 2.1241 - val_acc: 0.2500
Epoch 3/4
 - 5s - loss: 1.4260 - acc: 0.6021 - val_loss: 2.2757 - val_acc: 0.2031
Epoch 4/4
 - 5s - loss: 1.3169 - acc: 0.6773 - val_loss: 2.2451 - val_acc: 0.2031
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 22), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 22) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 22) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 22) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 22)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 573, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017982513285836262, 'unfreeze_percentage': 0.11306886756247031, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 480, 'batch_size': 33, 'learning_rate': 0.00041638502378627456, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.796875, 'info': {'runtime': 39.08141469955444, 'histories': {'loss': [2.454880442730216, 2.111043870449066, 1.4214515187019525, 1.3217007773263114], 'val_loss': [2.473899722099304, 2.124116539955139, 2.2757402658462524, 2.2450568675994873], 'acc': [0.12403101283450459, 0.29545455425977707, 0.6046511849691701, 0.6746032188336054], 'val_acc': [0.140625, 0.25, 0.203125, 0.203125]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 22)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 23)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 23) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 8) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 23) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 23) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 23)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 259, 'zoom_range': 0.0, 'cnn_learning_rate': 3.076650801892846e-05, 'unfreeze_percentage': 0.13845711508115638, 'rotation_range': 0, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 352, 'batch_size': 39, 'num_dense_units_2': 14, 'learning_rate': 0.0044258836165815725, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:35:15.373279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.3005 - acc: 0.1228 - val_loss: 2.3245 - val_acc: 0.0625
Epoch 2/4
 - 4s - loss: 2.2980 - acc: 0.1538 - val_loss: 2.3274 - val_acc: 0.0312
Epoch 3/4
 - 4s - loss: 2.2936 - acc: 0.1160 - val_loss: 2.3314 - val_acc: 0.0312
Epoch 4/4
 - 4s - loss: 2.3502 - acc: 0.1081 - val_loss: 2.3096 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 23), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 23) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 23) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 23) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 23)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 259, 'zoom_range': 0.0, 'cnn_learning_rate': 3.076650801892846e-05, 'unfreeze_percentage': 0.13845711508115638, 'rotation_range': 0, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 352, 'batch_size': 39, 'num_dense_units_2': 14, 'learning_rate': 0.0044258836165815725, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.84375, 'info': {'runtime': 23.14581298828125, 'histories': {'loss': [2.3235022207585776, 2.2979859113693237, 2.323880370070295, 2.322541917242655], 'val_loss': [2.3244540691375732, 2.327432632446289, 2.331352710723877, 2.3096420764923096], 'acc': [0.11382114160351636, 0.15384615771472454, 0.10569106078729397, 0.1300813084150233], 'val_acc': [0.0625, 0.03125, 0.03125, 0.15625]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 23)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 8)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 8) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 31) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 8) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 8) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 8)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 841, 'zoom_range': 0.0, 'cnn_learning_rate': 8.206800096052727e-05, 'unfreeze_percentage': 0.02000424133619941, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 145, 'batch_size': 24, 'learning_rate': 0.00022645921466755685, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:35:36.692143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.3020 - acc: 0.2555 - val_loss: 2.1143 - val_acc: 0.2078
Epoch 2/4
 - 4s - loss: 1.4104 - acc: 0.6597 - val_loss: 1.6622 - val_acc: 0.4675
Epoch 3/4
 - 4s - loss: 0.9349 - acc: 0.7702 - val_loss: 1.6796 - val_acc: 0.4026
Epoch 4/4
 - 4s - loss: 0.8475 - acc: 0.7815 - val_loss: 1.2467 - val_acc: 0.6234
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 8), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 8) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 8) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 8) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 8)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 841, 'zoom_range': 0.0, 'cnn_learning_rate': 8.206800096052727e-05, 'unfreeze_percentage': 0.02000424133619941, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 145, 'batch_size': 24, 'learning_rate': 0.00022645921466755685, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.37662337507520405, 'info': {'runtime': 18.818681716918945, 'histories': {'loss': [2.262339280999225, 1.4104404747486115, 0.923994394865903, 0.8399421080299045], 'val_loss': [2.114274263381958, 1.6622251783098494, 1.6796366487230574, 1.246732305396687], 'acc': [0.26086957849886105, 0.6597222487131754, 0.7803030393340371, 0.789855086285135], 'val_acc': [0.20779220875981566, 0.467532471402899, 0.40259740453261833, 0.623376624924796]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 8)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 31)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 31) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 14) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 31) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 31)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 151, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00015415880854765962, 'unfreeze_percentage': 0.03938619114153193, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 180, 'batch_size': 20, 'learning_rate': 0.0002291702024322162, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:35:55.551964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.3032 - acc: 0.1648 - val_loss: 2.1430 - val_acc: 0.1818
Epoch 2/4
 - 4s - loss: 1.9093 - acc: 0.3676 - val_loss: 2.0734 - val_acc: 0.2727
Epoch 3/4
 - 4s - loss: 1.5116 - acc: 0.6577 - val_loss: 1.8236 - val_acc: 0.4156
Epoch 4/4
 - 4s - loss: 1.3638 - acc: 0.6938 - val_loss: 1.6035 - val_acc: 0.5325
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 31), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 31) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 31)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 151, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00015415880854765962, 'unfreeze_percentage': 0.03938619114153193, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 180, 'batch_size': 20, 'learning_rate': 0.0002291702024322162, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.4675324628879498, 'info': {'runtime': 19.951915740966797, 'histories': {'loss': [2.3184717675329933, 1.874597022231196, 1.5135057274724397, 1.3637951761484146], 'val_loss': [2.1430459703717912, 2.073435052648767, 1.8236449910448742, 1.6035041809082031], 'acc': [0.18309859847518759, 0.40845071555862966, 0.6197183283281998, 0.6937500014901161], 'val_acc': [0.18181818452748386, 0.27272727891996307, 0.4155844210030197, 0.5324675371120502]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 31)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 14)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 14) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 29) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 14) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 14) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 14)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 365, 'zoom_range': 0.0, 'cnn_learning_rate': 1.50647561353589e-05, 'unfreeze_percentage': 0.1682997566657824, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 56, 'batch_size': 40, 'num_dense_units_2': 42, 'learning_rate': 0.004416431328381548, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:36:15.563859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 4s - loss: 2.3373 - acc: 0.0930 - val_loss: 2.5464 - val_acc: 0.0938
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/4
 - 3s - loss: 2.2607 - acc: 0.3294 - val_loss: 2.4665 - val_acc: 0.0625
Epoch 3/4
 - 3s - loss: 2.3493 - acc: 0.1875 - val_loss: 2.5394 - val_acc: 0.0938
Epoch 4/4
 - 3s - loss: 2.2600 - acc: 0.2743 - val_loss: 2.5178 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 14), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 14) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 14) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 14) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 14)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 365, 'zoom_range': 0.0, 'cnn_learning_rate': 1.50647561353589e-05, 'unfreeze_percentage': 0.1682997566657824, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 56, 'batch_size': 40, 'num_dense_units_2': 42, 'learning_rate': 0.004416431328381548, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 16.94053363800049, 'histories': {'loss': [2.4723221649889084, 2.4302542600475374, 2.3492581248283386, 2.3303503677493236], 'val_loss': [2.546389579772949, 2.466456890106201, 2.539423942565918, 2.517764091491699], 'acc': [0.11475410373484501, 0.1721311529151729, 0.1875000037252903, 0.22131148224971334], 'val_acc': [0.09375, 0.0625, 0.09375, 0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 14)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 29)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 29) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 15) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 29) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 29) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 29)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 110, 'zoom_range': 0.0, 'cnn_learning_rate': 7.316929490893968e-05, 'unfreeze_percentage': 0.06323186283248969, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 80, 'batch_size': 26, 'learning_rate': 0.0006848154188786375, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:36:39.283466: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 7s - loss: 2.3691 - acc: 0.1026 - val_loss: 2.2898 - val_acc: 0.1719
Epoch 2/4
 - 5s - loss: 2.0270 - acc: 0.2904 - val_loss: 2.4259 - val_acc: 0.0938
Epoch 3/4
 - 6s - loss: 1.8560 - acc: 0.3718 - val_loss: 2.2023 - val_acc: 0.1875
Epoch 4/4
 - 5s - loss: 1.4078 - acc: 0.6492 - val_loss: 1.9631 - val_acc: 0.2344
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 29), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 29) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 29) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 29) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 29)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 110, 'zoom_range': 0.0, 'cnn_learning_rate': 7.316929490893968e-05, 'unfreeze_percentage': 0.06323186283248969, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 80, 'batch_size': 26, 'learning_rate': 0.0006848154188786375, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.765625, 'info': {'runtime': 36.64713454246521, 'histories': {'loss': [2.3691492875417075, 1.9810327928641747, 1.8560062845547993, 1.4297867206966175], 'val_loss': [2.289760947227478, 2.4259090423583984, 2.2022509574890137, 1.9631497859954834], 'acc': [0.10256410948932171, 0.30172416156735915, 0.3717948993047078, 0.6470588673563564], 'val_acc': [0.171875, 0.09375, 0.1875, 0.234375]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 29)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 15)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 15) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 19) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 15) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 15) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 15)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 549, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002707429901227452, 'unfreeze_percentage': 0.05338008879900713, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 284, 'batch_size': 16, 'learning_rate': 0.0011410406015479025, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:37:10.497052: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 5.2131 - acc: 0.1135 - val_loss: 2.3313 - val_acc: 0.1193
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/4
 - 4s - loss: 1.9563 - acc: 0.3613 - val_loss: 2.3707 - val_acc: 0.1284
Epoch 3/4
 - 4s - loss: 1.5557 - acc: 0.4748 - val_loss: 2.3883 - val_acc: 0.0917
Epoch 4/4
 - 4s - loss: 1.4324 - acc: 0.5252 - val_loss: 2.4779 - val_acc: 0.1193
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 15), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 15) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 15) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 15) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 15)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 549, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002707429901227452, 'unfreeze_percentage': 0.05338008879900713, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 284, 'batch_size': 16, 'learning_rate': 0.0011410406015479025, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8807339446123587, 'info': {'runtime': 23.914382934570312, 'histories': {'loss': [4.96043201342021, 1.968766103052113, 1.59793456613201, 1.4676547034146035], 'val_loss': [2.331347483013748, 2.370737027684483, 2.388340040084419, 2.4778548905608853], 'acc': [0.1232876712328767, 0.3493150684931507, 0.4726027397260274, 0.5273972602739726], 'val_acc': [0.11926605695978217, 0.12844036731424682, 0.09174311926605505, 0.11926605538764132]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 15)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 19)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 19) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 26) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 19) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 19) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 19)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 430, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008850084607653113, 'unfreeze_percentage': 0.2950354371214048, 'rotation_range': 0, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 304, 'batch_size': 41, 'learning_rate': 0.0004063357454979262, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:37:33.406135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 4s - loss: 2.3490 - acc: 0.1545 - val_loss: 2.0799 - val_acc: 0.1875
Epoch 2/4
 - 3s - loss: 1.6299 - acc: 0.5846 - val_loss: 1.8945 - val_acc: 0.3750
Epoch 3/4
 - 3s - loss: 1.2963 - acc: 0.7027 - val_loss: 1.7416 - val_acc: 0.3750
Epoch 4/4
 - 3s - loss: 1.0028 - acc: 0.8521 - val_loss: 1.7664 - val_acc: 0.3125
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 19), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 19) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 19) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 19) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 19)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 430, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008850084607653113, 'unfreeze_percentage': 0.2950354371214048, 'rotation_range': 0, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 304, 'batch_size': 41, 'learning_rate': 0.0004063357454979262, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.6875, 'info': {'runtime': 16.80266284942627, 'histories': {'loss': [2.3490103085835776, 1.6263577622815597, 1.2950772076598869, 1.0049072858715846], 'val_loss': [2.0799269676208496, 1.8945395946502686, 1.7415581941604614, 1.7664337158203125], 'acc': [0.15447153647740683, 0.5867768614745337, 0.7024793191389604, 0.8512396275504561], 'val_acc': [0.1875, 0.375, 0.375, 0.3125]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 19)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 26)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 26) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 13) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 26) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 26) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 26)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 594, 'zoom_range': 0.0, 'cnn_learning_rate': 5.929194294333992e-05, 'unfreeze_percentage': 0.0825286030105998, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 89, 'batch_size': 16, 'learning_rate': 0.0016544273318660231, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:37:51.551682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 3.3410 - acc: 0.1198 - val_loss: 2.3523 - val_acc: 0.1376
Epoch 2/4
 - 5s - loss: 2.2720 - acc: 0.1261 - val_loss: 2.3122 - val_acc: 0.0917
Epoch 3/4
 - 5s - loss: 2.2879 - acc: 0.1639 - val_loss: 2.2150 - val_acc: 0.3119
Epoch 4/4
 - 6s - loss: 1.9915 - acc: 0.3375 - val_loss: 2.0661 - val_acc: 0.3028
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 26), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 26) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 26) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 26) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 26)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 594, 'zoom_range': 0.0, 'cnn_learning_rate': 5.929194294333992e-05, 'unfreeze_percentage': 0.0825286030105998, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 89, 'batch_size': 16, 'learning_rate': 0.0016544273318660231, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.697247705601771, 'info': {'runtime': 27.616278648376465, 'histories': {'loss': [3.1932055003022493, 2.283878065135381, 2.2550017866369796, 1.99149409532547], 'val_loss': [2.3522801967935822, 2.3122402834236073, 2.214963318011083, 2.0661408562179004], 'acc': [0.13013698630136986, 0.136986301369863, 0.1780821917808219, 0.3375], 'val_acc': [0.13761467958262208, 0.09174312364070787, 0.3119266061881267, 0.30275229439822904]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 26)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 13)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 13) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 16) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 13) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 13) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 13)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 135, 'zoom_range': 0.0, 'cnn_learning_rate': 1.5704157902554578e-05, 'unfreeze_percentage': 0.02381270600769416, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 263, 'batch_size': 57, 'learning_rate': 0.00014958784430567113, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:38:18.611560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.3146 - acc: 0.0867 - val_loss: 2.3563 - val_acc: 0.0000e+00
Epoch 2/4
 - 4s - loss: 2.2992 - acc: 0.0614 - val_loss: 2.3227 - val_acc: 0.0625
Epoch 3/4
 - 4s - loss: 2.2594 - acc: 0.1531 - val_loss: 2.2904 - val_acc: 0.1875
Epoch 4/4
 - 4s - loss: 2.2410 - acc: 0.2368 - val_loss: 2.2754 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 13), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 13) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 13) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 13) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 13)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 135, 'zoom_range': 0.0, 'cnn_learning_rate': 1.5704157902554578e-05, 'unfreeze_percentage': 0.02381270600769416, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 263, 'batch_size': 57, 'learning_rate': 0.00014958784430567113, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.84375, 'info': {'runtime': 23.17531943321228, 'histories': {'loss': [2.3145038672855924, 2.2991549968719482, 2.260830593109131, 2.240986704826355], 'val_loss': [2.3562753200531006, 2.3226916790008545, 2.2903521060943604, 2.2754180431365967], 'acc': [0.08571428826877049, 0.061403509229421616, 0.1523809552192688, 0.2368421107530594], 'val_acc': [0.0, 0.0625, 0.1875, 0.15625]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 13)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 16)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 16) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 27) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 16) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 16) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 16)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 300, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007711683203040776, 'unfreeze_percentage': 0.040678847527422644, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 54, 'batch_size': 16, 'learning_rate': 0.0008454467260258397, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:38:47.924779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 8s - loss: 2.6803 - acc: 0.1217 - val_loss: 2.2757 - val_acc: 0.1651
Epoch 2/4
 - 6s - loss: 2.0924 - acc: 0.2774 - val_loss: 2.1981 - val_acc: 0.1193
Epoch 3/4
 - 6s - loss: 2.0014 - acc: 0.3026 - val_loss: 2.1460 - val_acc: 0.1927
Epoch 4/4
 - 6s - loss: 1.8340 - acc: 0.4313 - val_loss: 1.9393 - val_acc: 0.3211
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 16), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 16) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 16) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 16) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 16)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 300, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007711683203040776, 'unfreeze_percentage': 0.040678847527422644, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 54, 'batch_size': 16, 'learning_rate': 0.0008454467260258397, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.6788990806548967, 'info': {'runtime': 38.918824434280396, 'histories': {'loss': [2.7172258749400098, 2.0709517883927853, 1.9865529308580372, 1.8339936852455139], 'val_loss': [2.275663629584356, 2.1981194763008607, 2.145988735583944, 1.9393409053120045], 'acc': [0.08904109589041095, 0.3013698630136986, 0.3287671232876712, 0.43125], 'val_acc': [0.1651376190535519, 0.11926605695978217, 0.19266055080048536, 0.32110091934510326]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 16)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 27)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 27) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 17) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 27) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 27) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 27)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 667, 'zoom_range': 0.0, 'cnn_learning_rate': 5.68331327817518e-05, 'unfreeze_percentage': 0.19197100562348035, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 354, 'batch_size': 33, 'num_dense_units_2': 125, 'learning_rate': 0.009564890865281206, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:39:20.299417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.4189 - acc: 0.1184 - val_loss: 2.4267 - val_acc: 0.0625
Epoch 2/4
 - 3s - loss: 2.1728 - acc: 0.2819 - val_loss: 2.3454 - val_acc: 0.1094
Epoch 3/4
 - 3s - loss: 2.0062 - acc: 0.3826 - val_loss: 2.2308 - val_acc: 0.1875
Epoch 4/4
 - 3s - loss: 1.9230 - acc: 0.4015 - val_loss: 2.2191 - val_acc: 0.1875
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 27), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 27) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 27) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 27) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 27)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 667, 'zoom_range': 0.0, 'cnn_learning_rate': 5.68331327817518e-05, 'unfreeze_percentage': 0.19197100562348035, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 354, 'batch_size': 33, 'num_dense_units_2': 125, 'learning_rate': 0.009564890865281206, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8125, 'info': {'runtime': 18.67947268486023, 'histories': {'loss': [2.4196487360222396, 2.1747878983963367, 2.008955794711446, 1.922989934682846], 'val_loss': [2.426679015159607, 2.3453874588012695, 2.230842113494873, 2.219062566757202], 'acc': [0.11627907531205998, 0.2790697806103285, 0.37984497533288114, 0.4015151634812355], 'val_acc': [0.0625, 0.109375, 0.1875, 0.1875]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 27)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 17)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 17) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 17) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 1) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 17) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 17)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 993, 'zoom_range': 0.0, 'cnn_learning_rate': 4.516626323296138e-05, 'unfreeze_percentage': 0.15388960110982627, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 103, 'batch_size': 23, 'learning_rate': 0.00493046747113642, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:39:40.129728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.3798 - acc: 0.1203 - val_loss: 2.4614 - val_acc: 0.1688
Epoch 2/4
 - 4s - loss: 2.1638 - acc: 0.1457 - val_loss: 2.5017 - val_acc: 0.1299
Epoch 3/4
 - 4s - loss: 1.9445 - acc: 0.3856 - val_loss: 2.3573 - val_acc: 0.1948
Epoch 4/4
 - 4s - loss: 1.9414 - acc: 0.3168 - val_loss: 2.3740 - val_acc: 0.1818
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 17), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 17) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 17) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 17) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 17)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 993, 'zoom_range': 0.0, 'cnn_learning_rate': 4.516626323296138e-05, 'unfreeze_percentage': 0.15388960110982627, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 103, 'batch_size': 23, 'learning_rate': 0.00493046747113642, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8181818154725161, 'info': {'runtime': 23.311461687088013, 'histories': {'loss': [2.3599424653773684, 2.143782699708458, 1.9934506124729732, 1.9414280823298864], 'val_loss': [2.461432138046661, 2.5016564084337904, 2.3573359452284777, 2.3740417028402354], 'acc': [0.13669064941166117, 0.16546762713211047, 0.3021582794918431, 0.31677019383226124], 'val_acc': [0.16883116979877671, 0.12987013083773774, 0.19480519674041055, 0.18181818452748386]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 17)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 1)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 1) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 10) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 1) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (2, 0, 1) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 340, 'zoom_range': 0.0, 'cnn_learning_rate': 8.705649802226435e-05, 'unfreeze_percentage': 0.19268042590792275, 'rotation_range': 0, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 404, 'batch_size': 19, 'learning_rate': 0.002165250231381009, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:40:09.269678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 8s - loss: 2.3253 - acc: 0.0848 - val_loss: 2.2917 - val_acc: 0.1009
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/4
 - 6s - loss: 2.3065 - acc: 0.1447 - val_loss: 2.2845 - val_acc: 0.1193
Epoch 3/4
 - 6s - loss: 2.3085 - acc: 0.0914 - val_loss: 2.2675 - val_acc: 0.1468
Epoch 4/4
 - 6s - loss: 2.2693 - acc: 0.2026 - val_loss: 2.2756 - val_acc: 0.1193
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 1) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 1)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 340, 'zoom_range': 0.0, 'cnn_learning_rate': 8.705649802226435e-05, 'unfreeze_percentage': 0.19268042590792275, 'rotation_range': 0, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 404, 'batch_size': 19, 'learning_rate': 0.002165250231381009, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8807339442705889, 'info': {'runtime': 38.260151386260986, 'histories': {'loss': [2.3271324134373166, 2.306525856256485, 2.310758744086419, 2.273000572111223], 'val_loss': [2.2917090052858407, 2.2845418343850232, 2.267460219356992, 2.275611549342444], 'acc': [0.08391608360347215, 0.14473684132099152, 0.09090908965864382, 0.2027972063922382], 'val_acc': [0.10091743153443031, 0.11926605572941107, 0.14678899116745783, 0.11926605572941107]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 1)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 10)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 10) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 22) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 10) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 10)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002956101170379864, 'unfreeze_percentage': 0.2665666007241914, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 350, 'batch_size': 29, 'learning_rate': 0.003003819282627949, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:40:40.895092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 4.3372 - acc: 0.2138 - val_loss: 4.3520 - val_acc: 0.0938
Epoch 2/8
 - 3s - loss: 2.6190 - acc: 0.2289 - val_loss: 1.8823 - val_acc: 0.2969
Epoch 3/8
 - 3s - loss: 1.5117 - acc: 0.4897 - val_loss: 1.6909 - val_acc: 0.3281
Epoch 4/8
 - 3s - loss: 1.0528 - acc: 0.7386 - val_loss: 1.3886 - val_acc: 0.6875
Epoch 5/8
 - 3s - loss: 0.6773 - acc: 0.8589 - val_loss: 1.1004 - val_acc: 0.6719
Epoch 6/8
 - 3s - loss: 0.4758 - acc: 0.8621 - val_loss: 1.3671 - val_acc: 0.5781
Epoch 7/8
 - 3s - loss: 0.3706 - acc: 0.9027 - val_loss: 1.3648 - val_acc: 0.6250
Epoch 8/8
 - 3s - loss: 0.2927 - acc: 0.9259 - val_loss: 1.1507 - val_acc: 0.6562
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 10), trying to register it.
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 10)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002956101170379864, 'unfreeze_percentage': 0.2665666007241914, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 350, 'batch_size': 29, 'learning_rate': 0.003003819282627949, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.34375, 'info': {'runtime': 30.034250736236572, 'histories': {'loss': [4.337244033813477, 2.5240380547263404, 1.511684823036194, 1.033623034796439, 0.6773236461151811, 0.4757522940635681, 0.33925574256065194, 0.287895976824868], 'val_loss': [4.3519980907440186, 1.8822561502456665, 1.6908987760543823, 1.3885525465011597, 1.1004464626312256, 1.367068886756897, 1.3647700548171997, 1.1506903171539307], 'acc': [0.2137931041419506, 0.22314049737635722, 0.48965516686439514, 0.7438016504295601, 0.8571428544539258, 0.8620689511299133, 0.9172932241196022, 0.9248120278344119], 'val_acc': [0.09375, 0.296875, 0.328125, 0.6875, 0.671875, 0.578125, 0.625, 0.65625]}}}
exception: None

INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 10) with dispatcher
DEBUG:hpbandster:job_callback for (1, 0, 10)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 22)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 22) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 8) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 22) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 22) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 22)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 573, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017982513285836262, 'unfreeze_percentage': 0.11306886756247031, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 480, 'batch_size': 33, 'learning_rate': 0.00041638502378627456, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:41:18.503899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 7s - loss: 2.6310 - acc: 0.0621 - val_loss: 2.3571 - val_acc: 0.1719
Epoch 2/8
 - 5s - loss: 1.8727 - acc: 0.4423 - val_loss: 2.2953 - val_acc: 0.2344
Epoch 3/8
 - 5s - loss: 1.3832 - acc: 0.6364 - val_loss: 2.1408 - val_acc: 0.2656
Epoch 4/8
 - 5s - loss: 1.0090 - acc: 0.8067 - val_loss: 2.1932 - val_acc: 0.3125
Epoch 5/8
 - 5s - loss: 0.9650 - acc: 0.7470 - val_loss: 2.0638 - val_acc: 0.3438
Epoch 6/8
 - 5s - loss: 0.7554 - acc: 0.8225 - val_loss: 2.0898 - val_acc: 0.3594
Epoch 7/8
 - 5s - loss: 0.6296 - acc: 0.8840 - val_loss: 2.2276 - val_acc: 0.3281
Epoch 8/8
 - 5s - loss: 0.4342 - acc: 0.9015 - val_loss: 2.0657 - val_acc: 0.3594
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 22), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 22) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 22) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 22) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 22)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 573, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017982513285836262, 'unfreeze_percentage': 0.11306886756247031, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 480, 'batch_size': 33, 'learning_rate': 0.00041638502378627456, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.640625, 'info': {'runtime': 57.17587852478027, 'histories': {'loss': [2.6285732790481213, 1.8753222532050555, 1.3832261264324188, 1.0078794997791911, 0.9690385599469029, 0.7563522374907206, 0.6288672824238621, 0.43422097712755203], 'val_loss': [2.357147693634033, 2.2952996492385864, 2.140822410583496, 2.1932440996170044, 2.0638113617897034, 2.0897839069366455, 2.227579712867737, 2.0656500458717346], 'acc': [0.06201550607071366, 0.4418604741262835, 0.6363636553287506, 0.8062015855035116, 0.7441860770070275, 0.8217054605484009, 0.8837209648864214, 0.9015151858329773], 'val_acc': [0.171875, 0.234375, 0.265625, 0.3125, 0.34375, 0.359375, 0.328125, 0.359375]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 22)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 8)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 8) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 31) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 8) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 8) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 8)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 841, 'zoom_range': 0.0, 'cnn_learning_rate': 8.206800096052727e-05, 'unfreeze_percentage': 0.02000424133619941, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 145, 'batch_size': 24, 'learning_rate': 0.00022645921466755685, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:42:08.383229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 2.1611 - acc: 0.3134 - val_loss: 1.9482 - val_acc: 0.4026
Epoch 2/8
 - 4s - loss: 1.3396 - acc: 0.6042 - val_loss: 1.6094 - val_acc: 0.5844
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/8
 - 4s - loss: 0.8718 - acc: 0.7855 - val_loss: 1.6041 - val_acc: 0.5325
Epoch 4/8
 - 4s - loss: 0.6354 - acc: 0.8952 - val_loss: 1.4958 - val_acc: 0.5455
Epoch 5/8
 - 4s - loss: 0.5218 - acc: 0.8604 - val_loss: 1.2598 - val_acc: 0.5714
Epoch 6/8
 - 4s - loss: 0.4854 - acc: 0.8750 - val_loss: 1.2130 - val_acc: 0.6364
Epoch 7/8
 - 4s - loss: 0.3791 - acc: 0.9281 - val_loss: 1.2608 - val_acc: 0.6494
Epoch 8/8
 - 4s - loss: 0.2115 - acc: 0.9930 - val_loss: 1.1192 - val_acc: 0.6364
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 8), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 8) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 8) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 8) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 8)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 841, 'zoom_range': 0.0, 'cnn_learning_rate': 8.206800096052727e-05, 'unfreeze_percentage': 0.02000424133619941, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 145, 'batch_size': 24, 'learning_rate': 0.00022645921466755685, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.3636363597659321, 'info': {'runtime': 34.860700845718384, 'histories': {'loss': [2.1542071570520815, 1.3396183749039967, 0.8604685845582382, 0.6369580237761788, 0.5273166982965036, 0.48543671270211536, 0.3801292155099952, 0.2136936077605123], 'val_loss': [1.948188760063865, 1.609415103862812, 1.6040667682499081, 1.495837214705232, 1.2598259712194468, 1.2129995296527813, 1.2608220855911056, 1.1192009309669593], 'acc': [0.31884058726870496, 0.6041666766007742, 0.7898550888766414, 0.8913043581921122, 0.8560606295412237, 0.875000019868215, 0.9275362465692603, 0.9927536300990892], 'val_acc': [0.4025974072419204, 0.5844155968009651, 0.5324675378861365, 0.545454549324977, 0.5714285853621247, 0.6363636402340679, 0.6493506524469945, 0.6363636402340679]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 8)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 31)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 31) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 29) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 31) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 31)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 151, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00015415880854765962, 'unfreeze_percentage': 0.03938619114153193, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 180, 'batch_size': 20, 'learning_rate': 0.0002291702024322162, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:42:43.285329: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 2.3058 - acc: 0.1838 - val_loss: 2.1330 - val_acc: 0.2597
Epoch 2/8
 - 4s - loss: 1.8141 - acc: 0.4313 - val_loss: 1.9230 - val_acc: 0.4026
Epoch 3/8
 - 3s - loss: 1.5446 - acc: 0.5694 - val_loss: 1.7917 - val_acc: 0.4286
Epoch 4/8
 - 4s - loss: 1.3502 - acc: 0.6563 - val_loss: 1.6547 - val_acc: 0.4805
Epoch 5/8
 - 4s - loss: 1.2868 - acc: 0.6161 - val_loss: 1.5938 - val_acc: 0.5195
Epoch 6/8
 - 4s - loss: 0.9905 - acc: 0.8250 - val_loss: 1.4558 - val_acc: 0.5455
Epoch 7/8
 - 4s - loss: 1.2019 - acc: 0.6435 - val_loss: 1.6917 - val_acc: 0.4545
Epoch 8/8
 - 4s - loss: 0.8926 - acc: 0.8500 - val_loss: 1.4685 - val_acc: 0.6234
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 31), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 31) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 31)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 151, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00015415880854765962, 'unfreeze_percentage': 0.03938619114153193, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 180, 'batch_size': 20, 'learning_rate': 0.0002291702024322162, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.3766233727529451, 'info': {'runtime': 32.96227669715881, 'histories': {'loss': [2.3034058993970845, 1.81413896381855, 1.5314048451762046, 1.3502268344163895, 1.2981436733276612, 0.9904780983924866, 1.0398713811751334, 0.8926282376050949], 'val_loss': [2.132969193644338, 1.9230163499906465, 1.7917032783681697, 1.6546658881298908, 1.593777761830912, 1.4558491722329872, 1.6916842863157198, 1.4685109590555165], 'acc': [0.20422535882869236, 0.4312500082887709, 0.5241935618462101, 0.6562500149011612, 0.645161320124903, 0.8250000104308128, 0.741935505021003, 0.8500000089406967], 'val_acc': [0.2597402607078676, 0.40259740453261833, 0.4285714332159464, 0.4805194867121709, 0.5194805256732098, 0.5454545593880987, 0.454545458415886, 0.6233766272470549]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 31)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 29)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 29) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 19) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 29) on hpbandster.run_0.worker.tfpool20.27905140655330039552
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 29)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 110, 'zoom_range': 0.0, 'cnn_learning_rate': 7.316929490893968e-05, 'unfreeze_percentage': 0.06323186283248969, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 80, 'batch_size': 26, 'learning_rate': 0.0006848154188786375, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
DEBUG:hpbandster:DISPATCHER: job (1, 0, 29) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
2018-02-08 14:43:23.101364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 7s - loss: 2.4400 - acc: 0.0769 - val_loss: 2.2798 - val_acc: 0.1562
Epoch 2/8
 - 5s - loss: 2.1652 - acc: 0.1932 - val_loss: 2.2034 - val_acc: 0.2031
Epoch 3/8
 - 6s - loss: 1.7464 - acc: 0.5321 - val_loss: 2.0865 - val_acc: 0.3750
Epoch 4/8
 - 5s - loss: 1.4658 - acc: 0.6809 - val_loss: 1.9598 - val_acc: 0.3750
Epoch 5/8
 - 5s - loss: 1.4363 - acc: 0.5811 - val_loss: 1.8450 - val_acc: 0.3906
Epoch 6/8
 - 6s - loss: 1.3169 - acc: 0.6603 - val_loss: 1.9390 - val_acc: 0.3750
Epoch 7/8
 - 5s - loss: 1.0659 - acc: 0.8246 - val_loss: 1.7621 - val_acc: 0.3750
Epoch 8/8
 - 5s - loss: 0.9561 - acc: 0.8312 - val_loss: 1.7679 - val_acc: 0.3594
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 29), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 29) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 29) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 29) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 29)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 110, 'zoom_range': 0.0, 'cnn_learning_rate': 7.316929490893968e-05, 'unfreeze_percentage': 0.06323186283248969, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 80, 'batch_size': 26, 'learning_rate': 0.0006848154188786375, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.640625, 'info': {'runtime': 59.427746534347534, 'histories': {'loss': [2.440044403076172, 2.117581971760454, 1.7463622093200684, 1.4847910774165187, 1.4951256092856913, 1.316923201084137, 1.0429739619002623, 0.9514629209742826], 'val_loss': [2.2797935009002686, 2.2034164667129517, 2.086466431617737, 1.9597753882408142, 1.8450323939323425, 1.9390233159065247, 1.762100338935852, 1.7679078578948975], 'acc': [0.07692308040956657, 0.2241379418249788, 0.5320513049761454, 0.637931085866073, 0.5294117813601213, 0.6602564553419749, 0.8235294748755062, 0.8308823985211989], 'val_acc': [0.15625, 0.203125, 0.375, 0.375, 0.390625, 0.375, 0.375, 0.359375]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 29)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 19)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 19) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 26) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 19) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 19) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 19)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 430, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008850084607653113, 'unfreeze_percentage': 0.2950354371214048, 'rotation_range': 0, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 304, 'batch_size': 41, 'learning_rate': 0.0004063357454979262, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:44:15.945459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 4s - loss: 2.3423 - acc: 0.1485 - val_loss: 2.3515 - val_acc: 0.0625
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/8
 - 3s - loss: 1.8323 - acc: 0.5215 - val_loss: 1.9330 - val_acc: 0.3750
Epoch 3/8
 - 3s - loss: 1.2301 - acc: 0.8049 - val_loss: 1.7486 - val_acc: 0.4062
Epoch 4/8
 - 3s - loss: 0.9047 - acc: 0.8754 - val_loss: 1.6295 - val_acc: 0.4375
Epoch 5/8
 - 3s - loss: 0.6191 - acc: 0.9168 - val_loss: 1.4311 - val_acc: 0.4375
Epoch 6/8
 - 3s - loss: 0.4672 - acc: 0.9422 - val_loss: 1.3315 - val_acc: 0.4688
Epoch 7/8
 - 3s - loss: 0.2627 - acc: 0.9919 - val_loss: 1.1864 - val_acc: 0.5938
Epoch 8/8
 - 3s - loss: 0.2301 - acc: 0.9507 - val_loss: 1.1358 - val_acc: 0.6562
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 19), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 19) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 19) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 19) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 19)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 430, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008850084607653113, 'unfreeze_percentage': 0.2950354371214048, 'rotation_range': 0, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 304, 'batch_size': 41, 'learning_rate': 0.0004063357454979262, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.34375, 'info': {'runtime': 28.450823545455933, 'histories': {'loss': [2.3424556826757006, 1.833551029528468, 1.2301066319147747, 0.9036342181450079, 0.6190068766105273, 0.467967771547885, 0.2626898189385732, 0.23025166902167737], 'val_loss': [2.3515262603759766, 1.9330241680145264, 1.7486101388931274, 1.6294690370559692, 1.4311295747756958, 1.3314878940582275, 1.186368465423584, 1.1357789039611816], 'acc': [0.14876033144056305, 0.52066115259139, 0.8048780163129171, 0.8760330233692137, 0.9173553329853972, 0.9421487199373482, 0.9918699264526367, 0.9504132226478955], 'val_acc': [0.0625, 0.375, 0.40625, 0.4375, 0.4375, 0.46875, 0.59375, 0.65625]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 19)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 26)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 26) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 16) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 26) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 26) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 26)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 594, 'zoom_range': 0.0, 'cnn_learning_rate': 5.929194294333992e-05, 'unfreeze_percentage': 0.0825286030105998, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 89, 'batch_size': 16, 'learning_rate': 0.0016544273318660231, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:44:45.121244: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 7s - loss: 3.2952 - acc: 0.0813 - val_loss: 2.3929 - val_acc: 0.0917
Epoch 2/8
 - 5s - loss: 2.3991 - acc: 0.1147 - val_loss: 2.2580 - val_acc: 0.0917
Epoch 3/8
 - 6s - loss: 2.3473 - acc: 0.1198 - val_loss: 2.2384 - val_acc: 0.2202
Epoch 4/8
 - 6s - loss: 2.2853 - acc: 0.2270 - val_loss: 1.8558 - val_acc: 0.3761
Epoch 5/8
 - 6s - loss: 2.3036 - acc: 0.1576 - val_loss: 2.2596 - val_acc: 0.2569
Epoch 6/8
 - 6s - loss: 1.8710 - acc: 0.3720 - val_loss: 2.0262 - val_acc: 0.2202
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 7/8
 - 6s - loss: 1.4730 - acc: 0.4875 - val_loss: 1.7223 - val_acc: 0.2752
Epoch 8/8
 - 6s - loss: 1.5580 - acc: 0.3583 - val_loss: 1.6419 - val_acc: 0.3394
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 26), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 26) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 26) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 26) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 26)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 594, 'zoom_range': 0.0, 'cnn_learning_rate': 5.929194294333992e-05, 'unfreeze_percentage': 0.0825286030105998, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 89, 'batch_size': 16, 'learning_rate': 0.0016544273318660231, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.6605504543409435, 'info': {'runtime': 51.288477182388306, 'histories': {'loss': [3.295246148109436, 2.3918080402143076, 2.309014725358519, 2.2020027964082485, 2.256093439990527, 1.8219104466372973, 1.4730303525924682, 1.6108278108365608], 'val_loss': [2.3929230707501055, 2.2580378296178414, 2.238432610800507, 1.855808424293448, 2.2595590604554623, 2.0261636513088823, 1.722268211732217, 1.6418886775270514], 'acc': [0.08125, 0.13636363636363635, 0.13013698630136986, 0.2465753424657534, 0.17123287671232876, 0.4041095890410959, 0.4875, 0.3787878787878788], 'val_acc': [0.09174311994959455, 0.09174311994959455, 0.22018348815244274, 0.3761467903579047, 0.25688073585886473, 0.22018348951952174, 0.27522935971207574, 0.3394495456590565]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 26)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 16)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 16) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 16) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 16) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 16)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 300, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007711683203040776, 'unfreeze_percentage': 0.040678847527422644, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 54, 'batch_size': 16, 'learning_rate': 0.0008454467260258397, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:45:42.625637: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 8s - loss: 2.5052 - acc: 0.1848 - val_loss: 2.4809 - val_acc: 0.1009
Epoch 2/8
 - 6s - loss: 2.1184 - acc: 0.1954 - val_loss: 2.1058 - val_acc: 0.2385
Epoch 3/8
 - 6s - loss: 1.8969 - acc: 0.2900 - val_loss: 2.1166 - val_acc: 0.2752
Epoch 4/8
 - 6s - loss: 1.6186 - acc: 0.4500 - val_loss: 1.7120 - val_acc: 0.4220
Epoch 5/8
 - 6s - loss: 1.4725 - acc: 0.5191 - val_loss: 1.8519 - val_acc: 0.4128
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 6/8
 - 6s - loss: 1.2772 - acc: 0.5812 - val_loss: 1.4479 - val_acc: 0.5413
Epoch 7/8
 - 6s - loss: 1.0571 - acc: 0.7436 - val_loss: 1.3187 - val_acc: 0.6239
Epoch 8/8
 - 6s - loss: 1.0512 - acc: 0.6809 - val_loss: 1.5645 - val_acc: 0.4679
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 16), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 16) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 16) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 16) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 16)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 300, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007711683203040776, 'unfreeze_percentage': 0.040678847527422644, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 54, 'batch_size': 16, 'learning_rate': 0.0008454467260258397, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.5321100903760403, 'info': {'runtime': 64.11627292633057, 'histories': {'loss': [2.564835927257799, 2.1470423299972325, 1.8729127694482672, 1.6185768365859985, 1.4113396261677598, 1.2771637916564942, 1.0246024962627527, 0.9288132615285377], 'val_loss': [2.4808551587096046, 2.1057869261557904, 2.1166173208744152, 1.712036571371446, 1.8518595050234314, 1.4479214007701349, 1.3187028585223977, 1.5645268510241028], 'acc': [0.15753424657534246, 0.21232876712328766, 0.3150684931506849, 0.45, 0.5227272727272727, 0.58125, 0.7424242424242424, 0.7397260273972602], 'val_acc': [0.10091743153443031, 0.23853211200565372, 0.27522935848170466, 0.42201835245167446, 0.4128440375174951, 0.5412844055836353, 0.6238532208521431, 0.46788990962395977]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 16)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 2)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 2) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 10) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (2, 0, 2) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 463, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001938974055054752, 'unfreeze_percentage': 0.038466581383059494, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 166, 'batch_size': 20, 'num_dense_units_2': 71, 'learning_rate': 0.005820798357109191, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:46:42.912993: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 4.2667 - acc: 0.0697 - val_loss: 4.0209 - val_acc: 0.1299
Epoch 2/4
 - 5s - loss: 3.0790 - acc: 0.1324 - val_loss: 2.3577 - val_acc: 0.1818
Epoch 3/4
 - 5s - loss: 2.3896 - acc: 0.0887 - val_loss: 2.3540 - val_acc: 0.1429
Epoch 4/4
 - 5s - loss: 2.2025 - acc: 0.1375 - val_loss: 2.1963 - val_acc: 0.1948
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 2)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 463, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001938974055054752, 'unfreeze_percentage': 0.038466581383059494, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 166, 'batch_size': 20, 'num_dense_units_2': 71, 'learning_rate': 0.005820798357109191, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8051948047110012, 'info': {'runtime': 27.58192777633667, 'histories': {'loss': [4.40465270297628, 3.221300017665809, 2.4209299557645556, 2.2025201618671417], 'val_loss': [4.02089296068464, 2.3577407211452335, 2.3539908768294695, 2.1962983824990014], 'acc': [0.07746479041139845, 0.0915492980832785, 0.09859155181428077, 0.13750000204890966], 'val_acc': [0.12987012987012986, 0.18181818452748386, 0.14285714285714285, 0.19480519528899873]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 10)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 10) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 8) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 10) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 10)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002956101170379864, 'unfreeze_percentage': 0.2665666007241914, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 350, 'batch_size': 29, 'learning_rate': 0.003003819282627949, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:47:07.825379: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/10
 - 4s - loss: 5.1437 - acc: 0.1662 - val_loss: 3.5501 - val_acc: 0.1719
Epoch 2/10
 - 3s - loss: 2.9627 - acc: 0.1971 - val_loss: 2.1798 - val_acc: 0.2969
Epoch 3/10
 - 3s - loss: 1.9819 - acc: 0.3062 - val_loss: 1.9181 - val_acc: 0.3594
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/10
 - 3s - loss: 1.4287 - acc: 0.5517 - val_loss: 1.6029 - val_acc: 0.4375
Epoch 5/10
 - 3s - loss: 1.2384 - acc: 0.7034 - val_loss: 1.3777 - val_acc: 0.5156
Epoch 6/10
 - 3s - loss: 0.8911 - acc: 0.7819 - val_loss: 1.1872 - val_acc: 0.5781
Epoch 7/10
 - 3s - loss: 0.5892 - acc: 0.8690 - val_loss: 1.3227 - val_acc: 0.5156
Epoch 8/10
 - 3s - loss: 0.4405 - acc: 0.9219 - val_loss: 1.0590 - val_acc: 0.6562
Epoch 9/10
 - 3s - loss: 0.3412 - acc: 0.9230 - val_loss: 1.0773 - val_acc: 0.5781
Epoch 10/10
 - 3s - loss: 0.2036 - acc: 0.9650 - val_loss: 1.0483 - val_acc: 0.6719
{'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002956101170379864, 'unfreeze_percentage': 0.2665666007241914, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 350, 'batch_size': 29, 'learning_rate': 0.003003819282627949, 'base_model': 'MobileNet', 'activation': 'tanh'}

 ****** MobileNet unfrozen 7 top blocks, cut_off after layer 60 ******
Epoch 1/6
 - 4s - loss: 0.1436 - acc: 1.0000 - val_loss: 1.0642 - val_acc: 0.6562
Epoch 2/6
 - 3s - loss: 0.1312 - acc: 1.0000 - val_loss: 1.0164 - val_acc: 0.6875
Epoch 3/6
 - 3s - loss: 0.1392 - acc: 1.0000 - val_loss: 0.9999 - val_acc: 0.6406
Epoch 4/6
 - 3s - loss: 0.1215 - acc: 1.0000 - val_loss: 0.9671 - val_acc: 0.7031
Epoch 5/6
 - 3s - loss: 0.1255 - acc: 1.0000 - val_loss: 0.9369 - val_acc: 0.7031
Epoch 6/6
 - 3s - loss: 0.1200 - acc: 1.0000 - val_loss: 0.9259 - val_acc: 0.6875
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 10), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 10) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 10)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002956101170379864, 'unfreeze_percentage': 0.2665666007241914, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 350, 'batch_size': 29, 'learning_rate': 0.003003819282627949, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.3125, 'info': {'runtime': 58.50269937515259, 'histories': {'loss': [5.1922036023964555, 2.9505257319687006, 1.9627935285855056, 1.428669309616089, 1.1890832795236344, 0.9004990548119509, 0.5892073273658752, 0.4334428960219362, 0.34135152365928306, 0.2114259197299642, 0.14475238468862117, 0.13118596076965333, 0.13457633935867397, 0.11671258755644462, 0.12435943862997499, 0.1212116962760911], 'val_loss': [3.550073504447937, 2.179771661758423, 1.918108344078064, 1.6028786897659302, 1.3776755332946777, 1.1872478723526, 1.3227308988571167, 1.0589808225631714, 1.077292025089264, 1.0483143031597137, 1.064200222492218, 1.0163823962211609, 0.9998907446861267, 0.967132568359375, 0.9368821084499359, 0.9259001761674881], 'acc': [0.16541353305031484, 0.2030075189650507, 0.3157894658414941, 0.5517241358757019, 0.7293232995316499, 0.7744360821587699, 0.8689655065536499, 0.9248120117008238, 0.9172932277048441, 0.9624060078671104, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], 'val_acc': [0.171875, 0.296875, 0.359375, 0.4375, 0.515625, 0.578125, 0.515625, 0.65625, 0.578125, 0.671875, 0.65625, 0.6875, 0.640625, 0.703125, 0.703125, 0.6875]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 10)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 8)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 8) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 31) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 8) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 8) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 8)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 841, 'zoom_range': 0.0, 'cnn_learning_rate': 8.206800096052727e-05, 'unfreeze_percentage': 0.02000424133619941, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 145, 'batch_size': 24, 'learning_rate': 0.00022645921466755685, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:48:06.400070: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 5s - loss: 2.1275 - acc: 0.3502 - val_loss: 1.8020 - val_acc: 0.4286
Epoch 2/16
 - 4s - loss: 1.2450 - acc: 0.6307 - val_loss: 1.8070 - val_acc: 0.2208
Epoch 3/16
 - 4s - loss: 0.8631 - acc: 0.7986 - val_loss: 1.5007 - val_acc: 0.3766
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/16
 - 4s - loss: 0.6182 - acc: 0.8745 - val_loss: 1.3599 - val_acc: 0.5325
Epoch 5/16
 - 4s - loss: 0.4037 - acc: 0.9514 - val_loss: 1.1746 - val_acc: 0.6364
Epoch 6/16
 - 4s - loss: 0.3381 - acc: 0.9611 - val_loss: 1.1793 - val_acc: 0.6753
Epoch 7/16
 - 4s - loss: 0.3379 - acc: 0.9371 - val_loss: 1.1500 - val_acc: 0.6104
Epoch 8/16
 - 4s - loss: 0.2154 - acc: 0.9790 - val_loss: 0.9535 - val_acc: 0.6494
Epoch 9/16
 - 4s - loss: 0.2803 - acc: 0.9231 - val_loss: 0.9179 - val_acc: 0.7143
Epoch 10/16
 - 4s - loss: 0.1088 - acc: 1.0000 - val_loss: 0.7603 - val_acc: 0.7532
Epoch 11/16
 - 4s - loss: 0.0774 - acc: 1.0000 - val_loss: 0.8927 - val_acc: 0.6883
Epoch 12/16
 - 4s - loss: 0.0779 - acc: 0.9910 - val_loss: 0.5706 - val_acc: 0.8052
Epoch 13/16
 - 4s - loss: 0.0666 - acc: 1.0000 - val_loss: 1.0349 - val_acc: 0.7143
Epoch 14/16
 - 4s - loss: 0.0997 - acc: 0.9771 - val_loss: 0.9483 - val_acc: 0.7273
Epoch 15/16
 - 4s - loss: 0.0259 - acc: 1.0000 - val_loss: 0.8090 - val_acc: 0.7662
Epoch 16/16
 - 4s - loss: 0.0736 - acc: 1.0000 - val_loss: 1.1709 - val_acc: 0.6364
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 8), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 8) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 8) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 8) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 8)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 841, 'zoom_range': 0.0, 'cnn_learning_rate': 8.206800096052727e-05, 'unfreeze_percentage': 0.02000424133619941, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 145, 'batch_size': 24, 'learning_rate': 0.00022645921466755685, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.36363634970281034, 'info': {'runtime': 62.56919193267822, 'histories': {'loss': [2.147170813187309, 1.2623896106429722, 0.8631218175093333, 0.6289131234992634, 0.4036703209082286, 0.33378127346868103, 0.34130281728246936, 0.2160186495469964, 0.28401103097459546, 0.10570035939631255, 0.07738371317585309, 0.07576724692531255, 0.0677160206048385, 0.09774704407090726, 0.02520957913087762, 0.07356224892040093], 'val_loss': [1.8019738259253564, 1.807036170711765, 1.5007232288261512, 1.3599343888171307, 1.1745723501428382, 1.179253014651212, 1.1499572543354777, 0.9535235863227349, 0.9178743819137672, 0.7602579996183321, 0.8926762481788536, 0.5705693035156696, 1.03489031961986, 0.9483354943139213, 0.8090091711514956, 1.1709475269565335], 'acc': [0.3405797222386236, 0.6231884334398352, 0.7986111342906952, 0.8712121221152219, 0.9513889153798422, 0.9637681271718896, 0.9347826294277025, 0.9782608902972677, 0.9202898688938307, 1.0, 1.0, 0.9927536197330641, 1.0, 0.9782608799312426, 1.0, 1.0], 'val_acc': [0.42857143399003267, 0.2207792212630247, 0.37662337855859235, 0.532467536337964, 0.6363636402340679, 0.6753246784210205, 0.6103896243231637, 0.6493506539951671, 0.714285726671095, 0.7532467563430985, 0.6883116914080335, 0.8051948160320134, 0.714285726671095, 0.727272739658108, 0.7662337778450606, 0.6363636502971897]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 8)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 31)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 31) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 19) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 31) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 31)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 151, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00015415880854765962, 'unfreeze_percentage': 0.03938619114153193, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 180, 'batch_size': 20, 'learning_rate': 0.0002291702024322162, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:49:09.638693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 5s - loss: 2.4003 - acc: 0.1394 - val_loss: 2.1064 - val_acc: 0.2857
Epoch 2/16
 - 3s - loss: 1.7850 - acc: 0.5246 - val_loss: 2.0181 - val_acc: 0.2727
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/16
 - 3s - loss: 1.6016 - acc: 0.5310 - val_loss: 1.6991 - val_acc: 0.5714
Epoch 4/16
 - 4s - loss: 1.2976 - acc: 0.6813 - val_loss: 1.5905 - val_acc: 0.6104
Epoch 5/16
 - 3s - loss: 1.1881 - acc: 0.6965 - val_loss: 1.5147 - val_acc: 0.6234
Epoch 6/16
 - 3s - loss: 1.4340 - acc: 0.5548 - val_loss: 1.3906 - val_acc: 0.6623
Epoch 7/16
 - 4s - loss: 0.9416 - acc: 0.8625 - val_loss: 1.3268 - val_acc: 0.6753
Epoch 8/16
 - 3s - loss: 0.9627 - acc: 0.7669 - val_loss: 1.3136 - val_acc: 0.6234
Epoch 9/16
 - 3s - loss: 0.8035 - acc: 0.8549 - val_loss: 1.3658 - val_acc: 0.6104
Epoch 10/16
 - 3s - loss: 0.7339 - acc: 0.8986 - val_loss: 1.1605 - val_acc: 0.6883
Epoch 11/16
 - 3s - loss: 0.6461 - acc: 0.8803 - val_loss: 1.3522 - val_acc: 0.5584
Epoch 12/16
 - 3s - loss: 0.5264 - acc: 0.9493 - val_loss: 1.2137 - val_acc: 0.6364
Epoch 13/16
 - 3s - loss: 0.4702 - acc: 0.9430 - val_loss: 1.3754 - val_acc: 0.5714
Epoch 14/16
 - 3s - loss: 0.6220 - acc: 0.8739 - val_loss: 1.0932 - val_acc: 0.6623
Epoch 15/16
 - 4s - loss: 0.3813 - acc: 0.9687 - val_loss: 0.9723 - val_acc: 0.7143
Epoch 16/16
 - 3s - loss: 0.4953 - acc: 0.9056 - val_loss: 1.0074 - val_acc: 0.7273
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 31), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 31) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 31)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 151, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00015415880854765962, 'unfreeze_percentage': 0.03938619114153193, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 180, 'batch_size': 20, 'learning_rate': 0.0002291702024322162, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.272727260341892, 'info': {'runtime': 60.7773711681366, 'histories': {'loss': [2.372445993020501, 1.8187349447062318, 1.6623302446284764, 1.2976486831903458, 1.136854693923198, 1.2057916195161882, 0.9415726736187935, 0.807344741384748, 0.7177071520979975, 0.734385285578983, 0.5748439280080123, 0.5545828539720723, 0.4639389548503177, 0.5127009212131232, 0.3812926635146141, 0.3877168364927802], 'val_loss': [2.1064055399461226, 2.018060382310446, 1.6991495683595732, 1.5905491361370334, 1.5147125333934635, 1.3906471001637446, 1.326773268835885, 1.3136143436679593, 1.3658138916089937, 1.160459625256526, 1.3522253562877704, 1.2136947179769542, 1.3754038748803077, 1.093246416612105, 0.9722846823853332, 1.007382956418124], 'acc': [0.15492958344624075, 0.47183099850802357, 0.4788732411156238, 0.6812500134110451, 0.7183098608339337, 0.6935483986331571, 0.8625000044703484, 0.8521126693403217, 0.8943661904670823, 0.8873239419829677, 0.9225352028725853, 0.9436619667939736, 0.9366197031988225, 0.9154929560674748, 0.9687499925494194, 0.9507042152780882], 'val_acc': [0.2857142866818936, 0.27272727543657477, 0.5714285745249166, 0.6103896134859556, 0.6233766287952275, 0.6623376747230431, 0.6753246784210205, 0.6233766287952275, 0.6103896158082145, 0.688311700697069, 0.5584415638601625, 0.6363636502971897, 0.5714285752990029, 0.6623376654340075, 0.714285726671095, 0.727272739658108]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 31)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 19)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 19) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 19) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 3) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 19) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 19)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 430, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008850084607653113, 'unfreeze_percentage': 0.2950354371214048, 'rotation_range': 0, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 304, 'batch_size': 41, 'learning_rate': 0.0004063357454979262, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:50:09.834728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/13
 - 4s - loss: 2.5639 - acc: 0.1168 - val_loss: 2.1227 - val_acc: 0.3438
Epoch 2/13
 - 3s - loss: 1.7986 - acc: 0.4634 - val_loss: 2.2047 - val_acc: 0.3438
Epoch 3/13
 - 3s - loss: 1.6367 - acc: 0.5890 - val_loss: 1.9967 - val_acc: 0.4062
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/13
 - 3s - loss: 1.1143 - acc: 0.8049 - val_loss: 1.6984 - val_acc: 0.5625
Epoch 5/13
 - 3s - loss: 0.8565 - acc: 0.8506 - val_loss: 1.5041 - val_acc: 0.5938
Epoch 6/13
 - 3s - loss: 0.6390 - acc: 0.8943 - val_loss: 1.3991 - val_acc: 0.4688
Epoch 7/13
 - 3s - loss: 0.4641 - acc: 0.9422 - val_loss: 1.3686 - val_acc: 0.4688
Epoch 8/13
 - 3s - loss: 0.3237 - acc: 0.9749 - val_loss: 1.1079 - val_acc: 0.6562
Epoch 9/13
 - 3s - loss: 0.2216 - acc: 0.9837 - val_loss: 1.1923 - val_acc: 0.5625
Epoch 10/13
 - 3s - loss: 0.1734 - acc: 0.9830 - val_loss: 1.0523 - val_acc: 0.7188
Epoch 11/13
 - 3s - loss: 0.1740 - acc: 0.9756 - val_loss: 1.1975 - val_acc: 0.6250
Epoch 12/13
 - 3s - loss: 0.0898 - acc: 0.9918 - val_loss: 1.0230 - val_acc: 0.6875
Epoch 13/13
 - 3s - loss: 0.0664 - acc: 1.0000 - val_loss: 1.2038 - val_acc: 0.6250
{'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 430, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008850084607653113, 'unfreeze_percentage': 0.2950354371214048, 'rotation_range': 0, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 304, 'batch_size': 41, 'learning_rate': 0.0004063357454979262, 'base_model': 'MobileNet', 'activation': 'relu'}

 ****** MobileNet unfrozen 7 top blocks, cut_off after layer 60 ******
Epoch 1/3
 - 4s - loss: 0.0579 - acc: 1.0000 - val_loss: 0.9084 - val_acc: 0.6875
Epoch 2/3
 - 3s - loss: 0.0458 - acc: 1.0000 - val_loss: 0.5178 - val_acc: 0.8125
Epoch 3/3
 - 3s - loss: 0.0427 - acc: 1.0000 - val_loss: 0.8449 - val_acc: 0.6875
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 19), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 19) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 19) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 19) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 19)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 430, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0008850084607653113, 'unfreeze_percentage': 0.2950354371214048, 'rotation_range': 0, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 304, 'batch_size': 41, 'learning_rate': 0.0004063357454979262, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.3125, 'info': {'runtime': 55.02432656288147, 'histories': {'loss': [2.5675032237344535, 1.7983554217441022, 1.641388951254285, 1.1143409212430317, 0.8550018776546825, 0.6390106578667959, 0.46389380343689407, 0.3230808579232082, 0.22163408994674683, 0.1734943962147256, 0.17398551603158316, 0.08993609588254582, 0.06648333346055559, 0.057871935268243156, 0.04590111810806369, 0.04272868662826286], 'val_loss': [2.122704029083252, 2.204735279083252, 1.9967252016067505, 1.698449730873108, 1.5041193962097168, 1.3991471529006958, 1.3685753345489502, 1.1079366207122803, 1.192258358001709, 1.0523234605789185, 1.1974865198135376, 1.0229790210723877, 1.2038209438323975, 0.9084463119506836, 0.5178465843200684, 0.8448682427406311], 'acc': [0.11570247835364224, 0.4628099156312706, 0.5867768437409204, 0.804878036181132, 0.8512396511952739, 0.8943089048067728, 0.9421487401339633, 0.9752066204370546, 0.9837398529052734, 0.9831932783126831, 0.9756097396214803, 0.9917355450716886, 1.0, 1.0, 1.0, 1.0], 'val_acc': [0.34375, 0.34375, 0.40625, 0.5625, 0.59375, 0.46875, 0.46875, 0.65625, 0.5625, 0.71875, 0.625, 0.6875, 0.625, 0.6875, 0.8125, 0.6875]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 19)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 3)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 3) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 10) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (2, 0, 3) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 3)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 284, 'zoom_range': 0.0, 'cnn_learning_rate': 8.935599075522274e-05, 'unfreeze_percentage': 0.10894391973378831, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 419, 'batch_size': 38, 'num_dense_units_2': 29, 'learning_rate': 0.007555720952796526, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:51:05.998606: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 4.7412 - acc: 0.1532 - val_loss: 2.4067 - val_acc: 0.0781
Epoch 2/4
 - 4s - loss: 2.4382 - acc: 0.1974 - val_loss: 2.3060 - val_acc: 0.0781
Epoch 3/4
 - 4s - loss: 2.2524 - acc: 0.1444 - val_loss: 2.3048 - val_acc: 0.1250
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/4
 - 4s - loss: 2.1746 - acc: 0.2141 - val_loss: 2.2981 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 3)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 284, 'zoom_range': 0.0, 'cnn_learning_rate': 8.935599075522274e-05, 'unfreeze_percentage': 0.10894391973378831, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 419, 'batch_size': 38, 'num_dense_units_2': 29, 'learning_rate': 0.007555720952796526, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.890625, 'info': {'runtime': 21.9754581451416, 'histories': {'loss': [4.51670072155614, 2.438157081604004, 2.2286808452298565, 2.151727311072811], 'val_loss': [2.4066625833511353, 2.3059821128845215, 2.304833769798279, 2.298097848892212], 'acc': [0.1451612915242872, 0.19736842811107635, 0.16935484111309052, 0.23387097867746506], 'val_acc': [0.078125, 0.078125, 0.125, 0.109375]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 3)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 10)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 10) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 31) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 10) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 10)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002956101170379864, 'unfreeze_percentage': 0.2665666007241914, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 350, 'batch_size': 29, 'learning_rate': 0.003003819282627949, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:51:26.995026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/10
 - 5s - loss: 3.8347 - acc: 0.2082 - val_loss: 3.4256 - val_acc: 0.2969
Epoch 2/10
 - 3s - loss: 2.1111 - acc: 0.3674 - val_loss: 1.8447 - val_acc: 0.4219
Epoch 3/10
 - 3s - loss: 1.1444 - acc: 0.6116 - val_loss: 1.7011 - val_acc: 0.3750
Epoch 4/10
 - 3s - loss: 0.6091 - acc: 0.8128 - val_loss: 1.4891 - val_acc: 0.5625
Epoch 5/10
 - 3s - loss: 0.5511 - acc: 0.8207 - val_loss: 1.6723 - val_acc: 0.5469
Epoch 6/10
 - 3s - loss: 0.5027 - acc: 0.7627 - val_loss: 1.3469 - val_acc: 0.6406
Epoch 7/10
 - 3s - loss: 0.2573 - acc: 0.9230 - val_loss: 1.6945 - val_acc: 0.5781
Epoch 8/10
 - 3s - loss: 0.2343 - acc: 0.9469 - val_loss: 1.2996 - val_acc: 0.6094
Epoch 9/10
 - 3s - loss: 0.1302 - acc: 0.9655 - val_loss: 1.3038 - val_acc: 0.7188
Epoch 10/10
 - 3s - loss: 0.0725 - acc: 0.9819 - val_loss: 1.7669 - val_acc: 0.5000
{'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002956101170379864, 'unfreeze_percentage': 0.2665666007241914, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 350, 'batch_size': 29, 'learning_rate': 0.003003819282627949, 'base_model': 'MobileNet', 'activation': 'tanh'}

 ****** MobileNet unfrozen 7 top blocks, cut_off after layer 60 ******
Epoch 1/22
 - 4s - loss: 0.1621 - acc: 0.9539 - val_loss: 1.8976 - val_acc: 0.5000
Epoch 2/22
 - 3s - loss: 0.0843 - acc: 0.9862 - val_loss: 1.6180 - val_acc: 0.5625
Epoch 3/22
 - 3s - loss: 0.1148 - acc: 0.9746 - val_loss: 1.6027 - val_acc: 0.6094
Epoch 4/22
 - 3s - loss: 0.0590 - acc: 0.9889 - val_loss: 1.3276 - val_acc: 0.6875
Epoch 5/22
 - 3s - loss: 0.0727 - acc: 0.9862 - val_loss: 1.5147 - val_acc: 0.6406
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 6/22
 - 3s - loss: 0.0447 - acc: 0.9889 - val_loss: 1.4579 - val_acc: 0.6562
Epoch 7/22
 - 3s - loss: 0.0439 - acc: 1.0000 - val_loss: 1.2699 - val_acc: 0.6719
Epoch 8/22
 - 3s - loss: 0.0409 - acc: 1.0000 - val_loss: 1.3816 - val_acc: 0.6562
Epoch 9/22
 - 3s - loss: 0.0439 - acc: 1.0000 - val_loss: 0.9757 - val_acc: 0.7188
Epoch 10/22
 - 3s - loss: 0.0392 - acc: 1.0000 - val_loss: 1.3472 - val_acc: 0.6719
Epoch 11/22
 - 3s - loss: 0.0282 - acc: 1.0000 - val_loss: 1.4097 - val_acc: 0.6719
Epoch 12/22
 - 3s - loss: 0.0278 - acc: 1.0000 - val_loss: 1.1846 - val_acc: 0.7031
Epoch 13/22
 - 3s - loss: 0.0459 - acc: 1.0000 - val_loss: 1.2794 - val_acc: 0.7188
Epoch 14/22
 - 3s - loss: 0.0275 - acc: 1.0000 - val_loss: 1.2206 - val_acc: 0.7500
Epoch 15/22
 - 3s - loss: 0.0478 - acc: 0.9888 - val_loss: 1.2651 - val_acc: 0.7031
Epoch 16/22
 - 3s - loss: 0.0238 - acc: 1.0000 - val_loss: 1.1707 - val_acc: 0.7188
Epoch 17/22
 - 3s - loss: 0.0231 - acc: 1.0000 - val_loss: 1.1227 - val_acc: 0.7344
Epoch 18/22
 - 3s - loss: 0.0265 - acc: 1.0000 - val_loss: 1.1956 - val_acc: 0.7188
Epoch 19/22
 - 3s - loss: 0.0213 - acc: 1.0000 - val_loss: 1.3123 - val_acc: 0.6875
Epoch 20/22
 - 3s - loss: 0.0285 - acc: 1.0000 - val_loss: 1.2519 - val_acc: 0.7031
Epoch 21/22
 - 3s - loss: 0.0254 - acc: 1.0000 - val_loss: 1.2029 - val_acc: 0.7031
Epoch 22/22
 - 3s - loss: 0.0329 - acc: 0.9931 - val_loss: 1.2476 - val_acc: 0.7188
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 10), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 10) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 10)
args: ()
kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002956101170379864, 'unfreeze_percentage': 0.2665666007241914, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 350, 'batch_size': 29, 'learning_rate': 0.003003819282627949, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.28125, 'info': {'runtime': 112.26237368583679, 'histories': {'loss': [3.9399296807167223, 2.132936889963939, 1.161321140769729, 0.6203177923098543, 0.5511419534683227, 0.5000085734335104, 0.26584978177583307, 0.23334207514623054, 0.13022590279579163, 0.06562025870259543, 0.15460277326349028, 0.0842578537762165, 0.10554827294073814, 0.052242714687621684, 0.07273826897144317, 0.04083050959708547, 0.04119264143974261, 0.039381908140796465, 0.04385220482945442, 0.03800104233555328, 0.027265795513539387, 0.02761970972992424, 0.03802158624718064, 0.0275279201567173, 0.04174427484924143, 0.02186535573319385, 0.021601471468750248, 0.026473058760166167, 0.021315086260437967, 0.026939812928606244, 0.02496598705587801, 0.032901985384523866], 'val_loss': [3.4255727529525757, 1.8446571230888367, 1.70110684633255, 1.489066243171692, 1.6722705960273743, 1.3468888998031616, 1.6944776773452759, 1.2996098399162292, 1.3038188815116882, 1.7668724060058594, 1.897553563117981, 1.6179665923118591, 1.6027056574821472, 1.327585220336914, 1.5147307515144348, 1.4578583240509033, 1.2699118852615356, 1.3815710544586182, 0.9756754636764526, 1.3472492694854736, 1.40968918800354, 1.1846404671669006, 1.2793866395950317, 1.2205588817596436, 1.2651357650756836, 1.1707326769828796, 1.122711956501007, 1.1956168413162231, 1.3122888207435608, 1.2518965601921082, 1.20289146900177, 1.2476217150688171], 'acc': [0.21052631646170653, 0.36842104523701774, 0.609022555494667, 0.8120300603988475, 0.8206896543502807, 0.7669172815810469, 0.9172932147083426, 0.947368417915545, 0.9655172228813171, 0.9849624100484347, 0.9548872059449217, 0.9862068891525269, 0.9752066115702479, 0.992481203455674, 0.9862068891525269, 0.992481203455674, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355460568893, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9931034445762634], 'val_acc': [0.296875, 0.421875, 0.375, 0.5625, 0.546875, 0.640625, 0.578125, 0.609375, 0.71875, 0.5, 0.5, 0.5625, 0.609375, 0.6875, 0.640625, 0.65625, 0.671875, 0.65625, 0.71875, 0.671875, 0.671875, 0.703125, 0.71875, 0.75, 0.703125, 0.71875, 0.734375, 0.71875, 0.6875, 0.703125, 0.703125, 0.71875]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 10)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 31)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 31) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 31) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 4) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 31)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 151, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00015415880854765962, 'unfreeze_percentage': 0.03938619114153193, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 180, 'batch_size': 20, 'learning_rate': 0.0002291702024322162, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:53:20.042039: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/18
 - 5s - loss: 2.3759 - acc: 0.1204 - val_loss: 2.2558 - val_acc: 0.2078
Epoch 2/18
 - 4s - loss: 1.9005 - acc: 0.3993 - val_loss: 2.1515 - val_acc: 0.1948
Epoch 3/18
 - 4s - loss: 1.6026 - acc: 0.4993 - val_loss: 2.0422 - val_acc: 0.2597
Epoch 4/18
 - 4s - loss: 1.3943 - acc: 0.6211 - val_loss: 1.9052 - val_acc: 0.3247
Epoch 5/18
 - 4s - loss: 1.2459 - acc: 0.7063 - val_loss: 1.7103 - val_acc: 0.4545
Epoch 6/18
 - 4s - loss: 1.1111 - acc: 0.7725 - val_loss: 1.4570 - val_acc: 0.5974
Epoch 7/18
 - 4s - loss: 0.8933 - acc: 0.8542 - val_loss: 1.4352 - val_acc: 0.5974
Epoch 8/18
 - 4s - loss: 1.1379 - acc: 0.6845 - val_loss: 1.4680 - val_acc: 0.5584
Epoch 9/18
 - 4s - loss: 0.8847 - acc: 0.7923 - val_loss: 1.3874 - val_acc: 0.6104
Epoch 10/18
 - 4s - loss: 0.7436 - acc: 0.8549 - val_loss: 1.2083 - val_acc: 0.6883
Epoch 11/18
 - 4s - loss: 0.8807 - acc: 0.7606 - val_loss: 1.2817 - val_acc: 0.6364
Epoch 12/18
 - 4s - loss: 0.6606 - acc: 0.8803 - val_loss: 1.3488 - val_acc: 0.6104
Epoch 13/18
 - 4s - loss: 0.5656 - acc: 0.8556 - val_loss: 1.3676 - val_acc: 0.4675
Epoch 14/18
 - 4s - loss: 0.5325 - acc: 0.9125 - val_loss: 1.0899 - val_acc: 0.7013
Epoch 15/18
 - 4s - loss: 0.6337 - acc: 0.8176 - val_loss: 1.0067 - val_acc: 0.7273
Epoch 16/18
 - 4s - loss: 0.4538 - acc: 0.9310 - val_loss: 1.0777 - val_acc: 0.6494
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 17/18
 - 4s - loss: 0.4783 - acc: 0.8993 - val_loss: 1.0489 - val_acc: 0.7013
Epoch 18/18
 - 4s - loss: 0.2804 - acc: 0.9873 - val_loss: 0.9528 - val_acc: 0.7662
{'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 151, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00015415880854765962, 'unfreeze_percentage': 0.03938619114153193, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 180, 'batch_size': 20, 'learning_rate': 0.0002291702024322162, 'base_model': 'MobileNet', 'activation': 'tanh'}

 ****** MobileNet unfrozen 1 top blocks, cut_off after layer 78 ******
Epoch 1/14
 - 5s - loss: 0.2797 - acc: 0.9812 - val_loss: 0.9161 - val_acc: 0.7792
Epoch 2/14
 - 4s - loss: 0.3866 - acc: 0.9871 - val_loss: 1.0304 - val_acc: 0.7013
Epoch 3/14
 - 4s - loss: 0.2894 - acc: 0.9810 - val_loss: 1.0674 - val_acc: 0.7143
Epoch 4/14
 - 4s - loss: 0.3317 - acc: 0.9810 - val_loss: 0.9044 - val_acc: 0.7532
Epoch 5/14
 - 4s - loss: 0.2785 - acc: 0.9687 - val_loss: 1.0481 - val_acc: 0.7403
Epoch 6/14
 - 4s - loss: 0.3969 - acc: 0.9242 - val_loss: 1.0260 - val_acc: 0.7403
Epoch 7/14
 - 4s - loss: 0.2131 - acc: 0.9937 - val_loss: 1.0330 - val_acc: 0.7662
Epoch 8/14
 - 4s - loss: 0.3065 - acc: 0.9873 - val_loss: 1.0246 - val_acc: 0.7532
Epoch 9/14
 - 4s - loss: 0.3008 - acc: 0.9937 - val_loss: 1.0215 - val_acc: 0.7792
Epoch 10/14
 - 4s - loss: 0.3061 - acc: 1.0000 - val_loss: 0.9138 - val_acc: 0.7662
Epoch 11/14
 - 4s - loss: 0.2868 - acc: 0.9812 - val_loss: 0.9941 - val_acc: 0.7662
Epoch 12/14
 - 4s - loss: 0.5680 - acc: 0.8746 - val_loss: 1.0347 - val_acc: 0.7792
Epoch 13/14
 - 4s - loss: 0.5063 - acc: 0.9373 - val_loss: 1.1276 - val_acc: 0.6883
Epoch 14/14
 - 4s - loss: 0.4809 - acc: 0.8871 - val_loss: 1.1747 - val_acc: 0.6883
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 31), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 31) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 31)
args: ()
kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 151, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00015415880854765962, 'unfreeze_percentage': 0.03938619114153193, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 180, 'batch_size': 20, 'learning_rate': 0.0002291702024322162, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.31168830781788026, 'info': {'runtime': 123.0416316986084, 'histories': {'loss': [2.382375697015037, 1.836199377624082, 1.6321124375705989, 1.350788395169755, 1.2458942383527756, 1.0250908757599306, 0.9212448647324468, 0.9197712515441465, 0.7455417757302942, 0.6844228052757155, 0.7022214825724212, 0.5735122301209141, 0.46870195697730693, 0.5325217954814434, 0.48275983501488057, 0.37402036576203895, 0.3973464865080068, 0.29147847479497885, 0.27971668541431427, 0.2745853700945454, 0.28007671320942085, 0.2980304780140729, 0.27853628620505333, 0.29694328336946424, 0.21305379457771778, 0.2787662538844095, 0.26174599561892764, 0.24232848513294275, 0.28683553636074066, 0.27594039767560824, 0.2732193394446037, 0.26835854495725325], 'val_loss': [2.255773624816498, 2.151520586633063, 2.042167632610767, 1.9052189495656398, 1.71033226205157, 1.4570264537613113, 1.4351546284440275, 1.4679949624197823, 1.3873934668379944, 1.2083102046669303, 1.2817299830449091, 1.3488446148959072, 1.3675502987651083, 1.089931659884267, 1.0067057485704298, 1.0777148519243513, 1.0489340525168878, 0.9527522789967524, 0.9160649157189703, 1.030445698019746, 1.0673952954156058, 0.9044233150296397, 1.0481179209498617, 1.0259624727360614, 1.033026512567099, 1.024628564908907, 1.0214967201282452, 0.9137803207744252, 0.9940890615636652, 1.034700153710006, 1.1275862517294946, 1.1746794929752102], 'acc': [0.13380282046929212, 0.44366197267048796, 0.44366198610252056, 0.6901408585024552, 0.7062500193715096, 0.8028169064454629, 0.838028180767113, 0.7605633853187024, 0.8802816817458247, 0.8943661904670823, 0.8450704057451704, 0.9225351944775648, 0.9507042253521126, 0.9124999865889549, 0.9084506941513276, 0.9788732360786115, 0.9436619600779573, 0.9859154895997383, 0.9812499955296516, 0.9838709638964745, 0.9788732343996075, 0.9788732343996075, 0.9687499925494194, 0.9677419297156795, 0.9937499985098839, 0.9859154895997383, 0.9929577447998692, 1.0, 0.9812499955296516, 0.9718309825574848, 0.9859154912787425, 0.9838709677419355], 'val_acc': [0.20779220875981566, 0.19480519577280267, 0.2597402624495618, 0.32467532661054044, 0.4545454591899723, 0.5974026004989426, 0.5974026012730289, 0.5584415623119899, 0.6103896150341281, 0.688311700697069, 0.6363636402340679, 0.6103896158082145, 0.4675324706288127, 0.7012987028468739, 0.7272727388840217, 0.6493506632842027, 0.7012987129099957, 0.7662337677819389, 0.7792207823171244, 0.7012987051691327, 0.7142857173820595, 0.7532467648580476, 0.740259752645121, 0.740259752645121, 0.7662337677819389, 0.753246765632134, 0.7792207823171244, 0.7662337778450606, 0.7662337778450606, 0.7792207900579874, 0.6883116929562061, 0.6883116921821197]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 31)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 4)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 4) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 10) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (2, 0, 4) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 4)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 359, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00029654204321131225, 'unfreeze_percentage': 0.20537550376366095, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 254, 'batch_size': 16, 'num_dense_units_2': 10, 'learning_rate': 0.0004652752273333024, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 14:55:22.440348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.2908 - acc: 0.1702 - val_loss: 2.2565 - val_acc: 0.2110
Epoch 2/4
 - 4s - loss: 2.0438 - acc: 0.2144 - val_loss: 2.1038 - val_acc: 0.1927
Epoch 3/4
 - 4s - loss: 1.8633 - acc: 0.3404 - val_loss: 1.9508 - val_acc: 0.4495
Epoch 4/4
 - 4s - loss: 1.9244 - acc: 0.3215 - val_loss: 1.9895 - val_acc: 0.3211
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 4)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 359, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00029654204321131225, 'unfreeze_percentage': 0.20537550376366095, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 254, 'batch_size': 16, 'num_dense_units_2': 10, 'learning_rate': 0.0004652752273333024, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.6788990787409861, 'info': {'runtime': 20.27230143547058, 'histories': {'loss': [2.297630499487054, 2.085161463855064, 1.787856206502, 1.8790585210878554], 'val_loss': [2.2564685038470347, 2.103831225578938, 1.950761296333523, 1.9895429895558487], 'acc': [0.18493150684931506, 0.2328767123287671, 0.3698630136986301, 0.3493150684931507], 'val_acc': [0.21100917499546612, 0.19266055080048536, 0.449541288231491, 0.3211009212590139]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 4)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 10)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 10) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 10) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 5) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (1, 0, 10)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 64.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002956101170379864, 'unfreeze_percentage': 0.2665666007241914, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 350, 'batch_size': 29, 'learning_rate': 0.003003819282627949, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 14:55:43.376628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/10
 - 5s - loss: 3.8141 - acc: 0.2222 - val_loss: 3.3745 - val_acc: 0.1250
Epoch 2/10
 - 3s - loss: 2.1525 - acc: 0.3854 - val_loss: 1.5510 - val_acc: 0.5000
Epoch 3/10
 - 3s - loss: 1.0227 - acc: 0.7189 - val_loss: 1.5042 - val_acc: 0.5312
Epoch 4/10
 - 3s - loss: 0.9101 - acc: 0.7103 - val_loss: 0.9281 - val_acc: 0.7188
Epoch 5/10
 - 3s - loss: 0.4009 - acc: 0.9247 - val_loss: 1.5360 - val_acc: 0.4062
Epoch 6/10
 - 3s - loss: 0.2923 - acc: 0.9517 - val_loss: 0.8481 - val_acc: 0.7344
Epoch 7/10
 - 3s - loss: 0.1955 - acc: 0.9370 - val_loss: 1.3001 - val_acc: 0.6406
Epoch 8/10
 - 3s - loss: 0.1791 - acc: 0.9429 - val_loss: 0.8151 - val_acc: 0.7500
Epoch 9/10
 - 3s - loss: 0.1278 - acc: 0.9517 - val_loss: 0.9656 - val_acc: 0.7188
Epoch 10/10
 - 3s - loss: 0.0496 - acc: 1.0000 - val_loss: 0.8975 - val_acc: 0.7344
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
{'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002956101170379864, 'unfreeze_percentage': 0.2665666007241914, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 350, 'batch_size': 29, 'learning_rate': 0.003003819282627949, 'base_model': 'MobileNet', 'activation': 'tanh'}

 ****** MobileNet unfrozen 7 top blocks, cut_off after layer 60 ******
Epoch 1/54
 - 4s - loss: 0.0217 - acc: 1.0000 - val_loss: 0.7204 - val_acc: 0.7500
Epoch 2/54
 - 3s - loss: 0.0261 - acc: 1.0000 - val_loss: 0.8804 - val_acc: 0.7500
Epoch 3/54
 - 3s - loss: 0.0165 - acc: 1.0000 - val_loss: 0.9513 - val_acc: 0.7344
Epoch 4/54
 - 3s - loss: 0.0356 - acc: 0.9860 - val_loss: 0.7795 - val_acc: 0.7656
Epoch 5/54
 - 3s - loss: 0.0174 - acc: 1.0000 - val_loss: 0.8321 - val_acc: 0.7500
Epoch 6/54
 - 3s - loss: 0.0160 - acc: 1.0000 - val_loss: 0.8238 - val_acc: 0.7969
Epoch 7/54
 - 3s - loss: 0.0218 - acc: 1.0000 - val_loss: 0.7802 - val_acc: 0.7812
Epoch 8/54
 - 3s - loss: 0.0150 - acc: 1.0000 - val_loss: 0.8466 - val_acc: 0.7812
Epoch 9/54
 - 3s - loss: 0.0255 - acc: 1.0000 - val_loss: 0.8109 - val_acc: 0.7969
Epoch 10/54
 - 3s - loss: 0.0209 - acc: 1.0000 - val_loss: 0.7673 - val_acc: 0.7969
Epoch 11/54
 - 3s - loss: 0.0205 - acc: 1.0000 - val_loss: 1.0354 - val_acc: 0.7344
Epoch 12/54
 - 3s - loss: 0.0250 - acc: 1.0000 - val_loss: 0.6960 - val_acc: 0.7969
Epoch 13/54
 - 3s - loss: 0.0257 - acc: 1.0000 - val_loss: 1.0155 - val_acc: 0.7344
Epoch 14/54
 - 3s - loss: 0.0162 - acc: 1.0000 - val_loss: 0.8015 - val_acc: 0.7969
Epoch 15/54
 - 3s - loss: 0.0117 - acc: 1.0000 - val_loss: 0.9440 - val_acc: 0.7500
Epoch 16/54
 - 3s - loss: 0.0153 - acc: 1.0000 - val_loss: 1.0319 - val_acc: 0.7500
Epoch 17/54
 - 3s - loss: 0.0291 - acc: 1.0000 - val_loss: 0.9412 - val_acc: 0.7812
Epoch 18/54
 - 3s - loss: 0.0161 - acc: 1.0000 - val_loss: 0.8519 - val_acc: 0.7969
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 19/54
 - 3s - loss: 0.0165 - acc: 1.0000 - val_loss: 1.0256 - val_acc: 0.7500
Epoch 20/54
 - 3s - loss: 0.0225 - acc: 1.0000 - val_loss: 1.0873 - val_acc: 0.7656
Epoch 21/54
 - 3s - loss: 0.0177 - acc: 1.0000 - val_loss: 1.0185 - val_acc: 0.7656
Epoch 22/54
 - 3s - loss: 0.0269 - acc: 0.9889 - val_loss: 1.0880 - val_acc: 0.7500
Epoch 23/54
 - 3s - loss: 0.0137 - acc: 1.0000 - val_loss: 0.8902 - val_acc: 0.7812
Epoch 24/54
 - 3s - loss: 0.0264 - acc: 0.9889 - val_loss: 1.0688 - val_acc: 0.7656
Epoch 25/54
 - 3s - loss: 0.0139 - acc: 1.0000 - val_loss: 1.0888 - val_acc: 0.7656
Epoch 26/54
 - 3s - loss: 0.0119 - acc: 1.0000 - val_loss: 1.0614 - val_acc: 0.7812
Epoch 27/54
 - 3s - loss: 0.0133 - acc: 1.0000 - val_loss: 0.9147 - val_acc: 0.7969
Epoch 28/54
 - 3s - loss: 0.0126 - acc: 1.0000 - val_loss: 1.0288 - val_acc: 0.7969
Epoch 29/54
 - 3s - loss: 0.0139 - acc: 1.0000 - val_loss: 1.0323 - val_acc: 0.7656
Epoch 30/54
 - 3s - loss: 0.0126 - acc: 1.0000 - val_loss: 1.1176 - val_acc: 0.7500
Epoch 31/54
 - 3s - loss: 0.0127 - acc: 1.0000 - val_loss: 1.1005 - val_acc: 0.7812
Epoch 32/54
 - 3s - loss: 0.0137 - acc: 1.0000 - val_loss: 1.1256 - val_acc: 0.7656
Epoch 33/54
 - 3s - loss: 0.0123 - acc: 1.0000 - val_loss: 1.2138 - val_acc: 0.7344
Epoch 34/54
 - 3s - loss: 0.0120 - acc: 1.0000 - val_loss: 1.1178 - val_acc: 0.7656
Epoch 35/54
 - 3s - loss: 0.0138 - acc: 1.0000 - val_loss: 1.2470 - val_acc: 0.7656
Epoch 36/54
 - 3s - loss: 0.0204 - acc: 1.0000 - val_loss: 1.2155 - val_acc: 0.7656
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 37/54
 - 3s - loss: 0.0179 - acc: 1.0000 - val_loss: 1.1039 - val_acc: 0.7500
Epoch 38/54
 - 3s - loss: 0.0125 - acc: 1.0000 - val_loss: 1.1393 - val_acc: 0.7812
Epoch 39/54
 - 3s - loss: 0.0133 - acc: 1.0000 - val_loss: 1.4007 - val_acc: 0.6719
Epoch 40/54
 - 3s - loss: 0.0091 - acc: 1.0000 - val_loss: 1.3414 - val_acc: 0.7188
Epoch 41/54
 - 3s - loss: 0.0096 - acc: 1.0000 - val_loss: 1.1477 - val_acc: 0.7656
Epoch 42/54
 - 3s - loss: 0.0110 - acc: 1.0000 - val_loss: 1.3043 - val_acc: 0.7500
Epoch 43/54
 - 3s - loss: 0.0154 - acc: 1.0000 - val_loss: 1.1083 - val_acc: 0.7500
Epoch 44/54
 - 3s - loss: 0.0091 - acc: 1.0000 - val_loss: 1.2202 - val_acc: 0.7500
Epoch 45/54
 - 3s - loss: 0.0081 - acc: 1.0000 - val_loss: 1.2673 - val_acc: 0.7500
Epoch 46/54
 - 3s - loss: 0.0141 - acc: 1.0000 - val_loss: 1.2908 - val_acc: 0.7500
Epoch 47/54
 - 3s - loss: 0.0111 - acc: 1.0000 - val_loss: 1.2492 - val_acc: 0.7344
Epoch 48/54
 - 3s - loss: 0.0127 - acc: 1.0000 - val_loss: 1.1180 - val_acc: 0.7500
Epoch 49/54
 - 3s - loss: 0.0122 - acc: 1.0000 - val_loss: 1.1473 - val_acc: 0.7500
Epoch 50/54
 - 3s - loss: 0.0103 - acc: 1.0000 - val_loss: 1.1685 - val_acc: 0.7656
Epoch 51/54
 - 3s - loss: 0.0123 - acc: 1.0000 - val_loss: 1.2800 - val_acc: 0.7500
Epoch 52/54
 - 3s - loss: 0.0084 - acc: 1.0000 - val_loss: 1.2616 - val_acc: 0.7344
Epoch 53/54
 - 3s - loss: 0.0143 - acc: 1.0000 - val_loss: 1.1345 - val_acc: 0.7812
Epoch 54/54
 - 3s - loss: 0.0112 - acc: 1.0000 - val_loss: 1.2712 - val_acc: 0.7344
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (1, 0, 10), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (1, 0, 10) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (1, 0, 10)
args: ()
kwargs: {'budget': 64.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002956101170379864, 'unfreeze_percentage': 0.2665666007241914, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 350, 'batch_size': 29, 'learning_rate': 0.003003819282627949, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.265625, 'info': {'runtime': 220.28962349891663, 'histories': {'loss': [3.756005841090267, 2.140834243674027, 1.0596317348623634, 0.9101006031036377, 0.41584196120254263, 0.2922910571098328, 0.20344488417967818, 0.1593213355294744, 0.12775780782103538, 0.04767492093330573, 0.021720658615231515, 0.0248587732703602, 0.016502841003239156, 0.03638240762222979, 0.017310023104729958, 0.01664088681844392, 0.022836765151863034, 0.015311689228099539, 0.02547609619796276, 0.018707145670694963, 0.018450392585219744, 0.022507252059596822, 0.022515893661718172, 0.015872617616297158, 0.011700807232409715, 0.015119309172986593, 0.025696548192124618, 0.015309198822518041, 0.015531506424391628, 0.020283379178858342, 0.016334603162468375, 0.02251081271587234, 0.013735582679510116, 0.023052728713903212, 0.013280609895692285, 0.011935935914516449, 0.013026877968333477, 0.01262757945805788, 0.014182717169919782, 0.01262774709612131, 0.012718782837229563, 0.01328506108891583, 0.012262278422713279, 0.01180956717860654, 0.013798044532313383, 0.02025911507469819, 0.018457875159898197, 0.012230228492640015, 0.013324877806007862, 0.009001730962243295, 0.009624921709747243, 0.011271872634726359, 0.014242488981917836, 0.008606740672673498, 0.008086945675313473, 0.014378295700184833, 0.011321769519604015, 0.012224127643538597, 0.011699875193486985, 0.010101106942148138, 0.01228301848908116, 0.008430975675582885, 0.012621047913580012, 0.010718751593695995], 'val_loss': [3.374489665031433, 1.5510008335113525, 1.5042366981506348, 0.928119957447052, 1.5360333323478699, 0.8480879366397858, 1.300148606300354, 0.8151012063026428, 0.9655548930168152, 0.8974595069885254, 0.7203631401062012, 0.8803982138633728, 0.9512926340103149, 0.7795408666133881, 0.8320842683315277, 0.8237524628639221, 0.7802453339099884, 0.8465803265571594, 0.8108924031257629, 0.7672722339630127, 1.035359263420105, 0.6960084289312363, 1.015491396188736, 0.8014931380748749, 0.94400754570961, 1.0318974256515503, 0.9411830604076385, 0.851885586977005, 1.025645673274994, 1.0873267352581024, 1.0185025930404663, 1.087956041097641, 0.8902132213115692, 1.0688074231147766, 1.0887870788574219, 1.0614279210567474, 0.9146899282932281, 1.0288193821907043, 1.032274305820465, 1.1175748109817505, 1.1005201935768127, 1.125619888305664, 1.213826298713684, 1.1178452968597412, 1.2469877004623413, 1.2155485153198242, 1.1038575172424316, 1.1393133699893951, 1.4007350206375122, 1.3413726091384888, 1.147737443447113, 1.3043110370635986, 1.1082829535007477, 1.2201781868934631, 1.2673284709453583, 1.290793538093567, 1.24918732047081, 1.1180322766304016, 1.1472614407539368, 1.168514370918274, 1.2799784541130066, 1.2615922391414642, 1.1345344185829163, 1.2711644172668457], 'acc': [0.22556390876608684, 0.38345864280722197, 0.7067668989188689, 0.7103448271751404, 0.9173553610636183, 0.951724112033844, 0.932330816760099, 0.9473684147784585, 0.951724112033844, 1.0, 1.0, 1.0, 1.0, 0.9849623979482436, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9924812110743129, 1.0, 0.992481203455674, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], 'val_acc': [0.125, 0.5, 0.53125, 0.71875, 0.40625, 0.734375, 0.640625, 0.75, 0.71875, 0.734375, 0.75, 0.75, 0.734375, 0.765625, 0.75, 0.796875, 0.78125, 0.78125, 0.796875, 0.796875, 0.734375, 0.796875, 0.734375, 0.796875, 0.75, 0.75, 0.78125, 0.796875, 0.75, 0.765625, 0.765625, 0.75, 0.78125, 0.765625, 0.765625, 0.78125, 0.796875, 0.796875, 0.765625, 0.75, 0.78125, 0.765625, 0.734375, 0.765625, 0.765625, 0.765625, 0.75, 0.78125, 0.671875, 0.71875, 0.765625, 0.75, 0.75, 0.75, 0.75, 0.75, 0.734375, 0.75, 0.75, 0.765625, 0.75, 0.734375, 0.78125, 0.734375]}}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 10)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 5)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 5) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 5) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 6) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 5) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 5)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 157, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00044151715195395094, 'unfreeze_percentage': 0.2827179069484473, 'rotation_range': 0, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 150, 'batch_size': 25, 'learning_rate': 0.004025255190148221, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 14:59:29.969019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 7s - loss: 3.0165 - acc: 0.1396 - val_loss: 2.5500 - val_acc: 0.1688
Epoch 2/4
 - 6s - loss: 2.4423 - acc: 0.1267 - val_loss: 2.1786 - val_acc: 0.2857
Epoch 3/4
 - 6s - loss: 2.0841 - acc: 0.2905 - val_loss: 2.1580 - val_acc: 0.1948
Epoch 4/4
 - 6s - loss: 1.8875 - acc: 0.3232 - val_loss: 2.4976 - val_acc: 0.1558
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 5), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 5) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 5) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 5) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 5)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 157, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00044151715195395094, 'unfreeze_percentage': 0.2827179069484473, 'rotation_range': 0, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 150, 'batch_size': 25, 'learning_rate': 0.004025255190148221, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.8441558436720402, 'info': {'runtime': 38.02660131454468, 'histories': {'loss': [3.038673968210708, 2.4422775308291116, 2.0957346856594086, 1.8756879924857703], 'val_loss': [2.5499776276675137, 2.178582259586879, 2.1580479764319085, 2.4976381419541], 'acc': [0.1240875913496435, 0.12666666135191917, 0.2903225748769699, 0.335766416614073], 'val_acc': [0.16883116979877671, 0.2857142866818936, 0.19480519674041055, 0.15584415632795978]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 5)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 6)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 6) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 7) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 6)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 319, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004938968030176304, 'unfreeze_percentage': 0.09752594417265983, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 189, 'batch_size': 22, 'learning_rate': 0.0002821562915810712, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:00:01.374368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.2564 - acc: 0.2040 - val_loss: 2.1534 - val_acc: 0.2208
Epoch 2/4
 - 4s - loss: 1.5248 - acc: 0.5625 - val_loss: 2.1339 - val_acc: 0.1558
Epoch 3/4
 - 4s - loss: 1.1607 - acc: 0.7143 - val_loss: 1.7296 - val_acc: 0.3766
Epoch 4/4
 - 4s - loss: 0.9450 - acc: 0.7168 - val_loss: 1.6444 - val_acc: 0.4026
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 6), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 6) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 6)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 319, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004938968030176304, 'unfreeze_percentage': 0.09752594417265983, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 189, 'batch_size': 22, 'learning_rate': 0.0002821562915810712, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.5974025946932954, 'info': {'runtime': 21.150598526000977, 'histories': {'loss': [2.263274347782135, 1.541438799245017, 1.1607373101370675, 0.8845750876835414], 'val_loss': [2.153429935504864, 2.1339196013165758, 1.7296409436634608, 1.6444134619328883], 'acc': [0.20000000319310596, 0.5571428797074727, 0.7142857185431889, 0.7571428792817252], 'val_acc': [0.22077922174682865, 0.15584415681176372, 0.37662337778450605, 0.4025974053067046]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 6)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 7)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 7) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 7) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 8) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 7) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 7)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 542, 'zoom_range': 0.0, 'cnn_learning_rate': 2.543876222176325e-05, 'unfreeze_percentage': 0.10030229620036316, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 79, 'batch_size': 56, 'num_dense_units_2': 12, 'learning_rate': 0.00018309876075472162, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:00:23.250020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 7s - loss: 2.3134 - acc: 0.0665 - val_loss: 2.2736 - val_acc: 0.2188
Epoch 2/4
 - 4s - loss: 2.2596 - acc: 0.1429 - val_loss: 2.3072 - val_acc: 0.1562
Epoch 3/4
 - 4s - loss: 2.1624 - acc: 0.3123 - val_loss: 2.2182 - val_acc: 0.2812
Epoch 4/4
 - 4s - loss: 2.0828 - acc: 0.2879 - val_loss: 2.2840 - val_acc: 0.2188
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 7), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 7) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 7) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 7) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 7)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 542, 'zoom_range': 0.0, 'cnn_learning_rate': 2.543876222176325e-05, 'unfreeze_percentage': 0.10030229620036316, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 79, 'batch_size': 56, 'num_dense_units_2': 12, 'learning_rate': 0.00018309876075472162, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.78125, 'info': {'runtime': 24.784214973449707, 'histories': {'loss': [2.3124990283318287, 2.2596232891082764, 2.1634896566283026, 2.085450586282982], 'val_loss': [2.273630142211914, 2.3072030544281006, 2.2182493209838867, 2.284008741378784], 'acc': [0.06603773725482653, 0.1428571492433548, 0.31132074909390145, 0.2830188684868363], 'val_acc': [0.21875, 0.15625, 0.28125, 0.21875]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 7)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 8)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 8) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 9) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 8) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (2, 0, 8) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 8)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 182, 'zoom_range': 0.0, 'cnn_learning_rate': 1.684504354227868e-05, 'unfreeze_percentage': 0.09198940506589715, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 78, 'batch_size': 48, 'learning_rate': 0.0005364889439353017, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 15:00:49.083878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.9854 - acc: 0.0457 - val_loss: 2.5230 - val_acc: 0.1250
Epoch 2/4
 - 4s - loss: 2.1428 - acc: 0.2519 - val_loss: 2.1198 - val_acc: 0.2188
Epoch 3/4
 - 5s - loss: 1.6618 - acc: 0.4583 - val_loss: 1.9330 - val_acc: 0.4688
Epoch 4/4
 - 4s - loss: 1.3673 - acc: 0.6235 - val_loss: 1.9657 - val_acc: 0.3438
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 8), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 8) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 8) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 8) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 8)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 182, 'zoom_range': 0.0, 'cnn_learning_rate': 1.684504354227868e-05, 'unfreeze_percentage': 0.09198940506589715, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 78, 'batch_size': 48, 'learning_rate': 0.0005364889439353017, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.65625, 'info': {'runtime': 24.47868847846985, 'histories': {'loss': [3.0028197012449565, 2.1514310962275456, 1.661822994550069, 1.3954652610578036], 'val_loss': [2.52299165725708, 2.1197571754455566, 1.9330240488052368, 1.9656882286071777], 'acc': [0.04385965023385851, 0.2368421131058743, 0.4583333432674408, 0.60526316416891], 'val_acc': [0.125, 0.21875, 0.46875, 0.34375]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 8)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 9)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 9) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 9) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 10) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 9)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 280, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007344732739901397, 'unfreeze_percentage': 0.08944488947028582, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 119, 'batch_size': 17, 'num_dense_units_2': 10, 'learning_rate': 0.00023199646997601673, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:01:11.956472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.3362 - acc: 0.1446 - val_loss: 2.2856 - val_acc: 0.1651
Epoch 2/4
 - 4s - loss: 2.1220 - acc: 0.2300 - val_loss: 2.1130 - val_acc: 0.2385
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/4
 - 4s - loss: 1.9726 - acc: 0.3062 - val_loss: 2.1648 - val_acc: 0.1835
Epoch 4/4
 - 4s - loss: 1.8668 - acc: 0.2810 - val_loss: 2.0640 - val_acc: 0.2477
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 9), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 9) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 9)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 280, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007344732739901397, 'unfreeze_percentage': 0.08944488947028582, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 119, 'batch_size': 17, 'num_dense_units_2': 10, 'learning_rate': 0.00023199646997601673, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.7522935766145724, 'info': {'runtime': 20.242396116256714, 'histories': {'loss': [2.336107474359973, 2.113931685480578, 1.95544740331584, 1.8668272495269775], 'val_loss': [2.285623721026499, 2.1129866652532456, 2.1648353917883076, 2.064046626790948], 'acc': [0.1517241406800418, 0.2413793143013428, 0.310344831851022, 0.28104575930370224], 'val_acc': [0.1651376153624386, 0.23853211077528264, 0.1834862392156496, 0.24770642338542764]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 9)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 10)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 10) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 10) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 11) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 10) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 10)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 436, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007882592803150444, 'unfreeze_percentage': 0.0186508756909493, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 134, 'batch_size': 28, 'learning_rate': 0.0001069723359180758, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 15:01:39.130283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 8s - loss: 2.3983 - acc: 0.1128 - val_loss: 2.6073 - val_acc: 0.1406
Epoch 2/4
 - 5s - loss: 2.4081 - acc: 0.1144 - val_loss: 2.4770 - val_acc: 0.1094
Epoch 3/4
 - 5s - loss: 2.4559 - acc: 0.1000 - val_loss: 2.4795 - val_acc: 0.1094
Epoch 4/4
 - 5s - loss: 2.4167 - acc: 0.0929 - val_loss: 2.4442 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 10), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 10) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 10) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 10) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 10)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 436, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007882592803150444, 'unfreeze_percentage': 0.0186508756909493, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 134, 'batch_size': 28, 'learning_rate': 0.0001069723359180758, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 36.755146503448486, 'histories': {'loss': [2.3951628279330124, 2.406954843606522, 2.4568420701952123, 2.416688632965088], 'val_loss': [2.6073118448257446, 2.4770023822784424, 2.4795377254486084, 2.4442219734191895], 'acc': [0.1119403055132325, 0.1119403054020298, 0.09701493004364754, 0.09285714849829674], 'val_acc': [0.140625, 0.109375, 0.109375, 0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 10)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 11)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 11) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 11) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 12) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 11) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 11)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 717, 'zoom_range': 0.0, 'cnn_learning_rate': 1.1927334354314783e-05, 'unfreeze_percentage': 0.21190422901306152, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 165, 'batch_size': 35, 'learning_rate': 0.0024125677220158846, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:02:10.316813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 10.6338 - acc: 0.0857 - val_loss: 14.1033 - val_acc: 0.1250
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/4
 - 4s - loss: 13.7566 - acc: 0.1465 - val_loss: 13.5996 - val_acc: 0.1562
Epoch 3/4
 - 4s - loss: 13.8155 - acc: 0.1429 - val_loss: 13.8515 - val_acc: 0.1406
Epoch 4/4
 - 4s - loss: 14.0206 - acc: 0.1301 - val_loss: 13.8515 - val_acc: 0.1406
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 11), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 11) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 11) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 11) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 11)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 717, 'zoom_range': 0.0, 'cnn_learning_rate': 1.1927334354314783e-05, 'unfreeze_percentage': 0.21190422901306152, 'rotation_range': 0, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 165, 'batch_size': 35, 'learning_rate': 0.0024125677220158846, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.859375, 'info': {'runtime': 25.312721967697144, 'histories': {'loss': [10.633757174015045, 13.85590648651123, 13.815509796142578, 14.087468823110024], 'val_loss': [14.103333473205566, 13.599642753601074, 13.85148811340332, 13.851488590240479], 'acc': [0.08571428759023547, 0.14035088196396828, 0.14285714738070965, 0.12598425651511808], 'val_acc': [0.125, 0.15625, 0.140625, 0.140625]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 11)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 12)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 12) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 13) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 12) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 12)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 386, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00011991163360116281, 'unfreeze_percentage': 0.23065408421784245, 'rotation_range': 0, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 144, 'batch_size': 61, 'learning_rate': 0.004853429019338536, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:02:41.000210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 8s - loss: 3.3267 - acc: 0.0787 - val_loss: 3.0117 - val_acc: 0.1562
Epoch 2/4
 - 4s - loss: 3.4100 - acc: 0.1108 - val_loss: 2.6900 - val_acc: 0.2812
Epoch 3/4
 - 5s - loss: 3.1930 - acc: 0.2131 - val_loss: 3.0426 - val_acc: 0.0312
Epoch 4/4
 - 4s - loss: 2.5703 - acc: 0.2308 - val_loss: 2.0886 - val_acc: 0.2812
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 12), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 12) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 12)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 386, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00011991163360116281, 'unfreeze_percentage': 0.23065408421784245, 'rotation_range': 0, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 144, 'batch_size': 61, 'learning_rate': 0.004853429019338536, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.71875, 'info': {'runtime': 34.20139789581299, 'histories': {'loss': [3.1934123605784803, 3.459203852285253, 3.1929824352264404, 2.4996638793756465], 'val_loss': [3.0116937160491943, 2.6900086402893066, 3.042555570602417, 2.088555097579956], 'acc': [0.07920791695613673, 0.1089108877695433, 0.21311473101377487, 0.25742571764063127], 'val_acc': [0.15625, 0.28125, 0.03125, 0.28125]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 12)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 13)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 13) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 13) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 14) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 13) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 13)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 151, 'zoom_range': 0.0, 'cnn_learning_rate': 6.672898530718872e-05, 'unfreeze_percentage': 0.2849626808780365, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 189, 'batch_size': 28, 'num_dense_units_2': 21, 'learning_rate': 0.0034411205943998837, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 15:03:10.126776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.7295 - acc: 0.1295 - val_loss: 2.5712 - val_acc: 0.0938
Epoch 2/4
 - 4s - loss: 2.3012 - acc: 0.2047 - val_loss: 2.7043 - val_acc: 0.0625
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/4
 - 4s - loss: 2.0768 - acc: 0.2357 - val_loss: 2.7779 - val_acc: 0.0781
Epoch 4/4
 - 4s - loss: 1.9909 - acc: 0.2491 - val_loss: 3.2396 - val_acc: 0.0625
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 13), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 13) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 13) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 13) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 13)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 151, 'zoom_range': 0.0, 'cnn_learning_rate': 6.672898530718872e-05, 'unfreeze_percentage': 0.2849626808780365, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 189, 'batch_size': 28, 'num_dense_units_2': 21, 'learning_rate': 0.0034411205943998837, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.9375, 'info': {'runtime': 22.019529819488525, 'histories': {'loss': [2.732637170535415, 2.290680671805766, 2.076767611503601, 1.9823694787919521], 'val_loss': [2.571209669113159, 2.704336643218994, 2.7779160737991333, 3.239621639251709], 'acc': [0.1343283634354819, 0.20895523766973126, 0.23571430146694183, 0.2578125116415322], 'val_acc': [0.09375, 0.0625, 0.078125, 0.0625]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 13)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 14)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 14) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 14) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 15) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 14) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 14)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 158, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00024940230817252203, 'unfreeze_percentage': 0.24569339292037953, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 59, 'batch_size': 27, 'learning_rate': 0.00040695265496904203, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:03:33.092920: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.3448 - acc: 0.1358 - val_loss: 2.4176 - val_acc: 0.0938
Epoch 2/4
 - 5s - loss: 2.3589 - acc: 0.1173 - val_loss: 2.3998 - val_acc: 0.0938
Epoch 3/4
 - 5s - loss: 2.3524 - acc: 0.1296 - val_loss: 2.4367 - val_acc: 0.0781
Epoch 4/4
 - 5s - loss: 2.3494 - acc: 0.0988 - val_loss: 2.4053 - val_acc: 0.0781
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 14), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 14) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 14) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 14) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 14)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 158, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00024940230817252203, 'unfreeze_percentage': 0.24569339292037953, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 59, 'batch_size': 27, 'learning_rate': 0.00040695265496904203, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.921875, 'info': {'runtime': 26.430593967437744, 'histories': {'loss': [2.3448341290156045, 2.3588871161142984, 2.3524282773335776, 2.3493531942367554], 'val_loss': [2.4175705909729004, 2.399821639060974, 2.4367012977600098, 2.4053292274475098], 'acc': [0.13580247263113657, 0.1172839527328809, 0.1296296330789725, 0.09876543283462524], 'val_acc': [0.09375, 0.09375, 0.078125, 0.078125]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 14)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 15)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 15) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 15) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 0) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 15) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 15)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 370, 'zoom_range': 0.0, 'cnn_learning_rate': 1.1934326545868966e-05, 'unfreeze_percentage': 0.25350871881404513, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 386, 'batch_size': 34, 'num_dense_units_2': 22, 'learning_rate': 0.0002160317442591178, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 15:04:04.120617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 8s - loss: 2.6609 - acc: 0.1029 - val_loss: 2.3916 - val_acc: 0.1250
Epoch 2/4
 - 5s - loss: 2.1276 - acc: 0.2274 - val_loss: 2.2725 - val_acc: 0.1562
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/4
 - 5s - loss: 1.9941 - acc: 0.3309 - val_loss: 2.3288 - val_acc: 0.1875
Epoch 4/4
 - 5s - loss: 2.0261 - acc: 0.2901 - val_loss: 2.2148 - val_acc: 0.2188
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 15), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 15) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 15) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 15) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 15)
args: ()
kwargs: {'budget': 4.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 370, 'zoom_range': 0.0, 'cnn_learning_rate': 1.1934326545868966e-05, 'unfreeze_percentage': 0.25350871881404513, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 386, 'batch_size': 34, 'num_dense_units_2': 22, 'learning_rate': 0.0002160317442591178, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.78125, 'info': {'runtime': 35.84715294837952, 'histories': {'loss': [2.6609431505203247, 2.114877434571584, 1.9940854012966156, 2.018648562952876], 'val_loss': [2.3916159868240356, 2.2724521160125732, 2.328782320022583, 2.2148032188415527], 'acc': [0.10294117871671915, 0.22500000682969887, 0.33088236302137375, 0.2968750090803951], 'val_acc': [0.125, 0.15625, 0.1875, 0.21875]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 15)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 0) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 4) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (3, 0, 0) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (3, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 488, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00018754597271603137, 'unfreeze_percentage': 0.013099967173404147, 'rotation_range': 0, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 122, 'batch_size': 25, 'learning_rate': 0.0012140875401190161, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 15:04:40.370062: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 7s - loss: 3.2019 - acc: 0.1216 - val_loss: 2.3252 - val_acc: 0.2597
Epoch 2/8
 - 6s - loss: 1.9308 - acc: 0.3485 - val_loss: 2.1904 - val_acc: 0.2597
Epoch 3/8
 - 6s - loss: 1.4502 - acc: 0.6533 - val_loss: 2.0340 - val_acc: 0.2857
Epoch 4/8
 - 6s - loss: 1.1834 - acc: 0.6690 - val_loss: 2.1412 - val_acc: 0.2987
Epoch 5/8
 - 6s - loss: 0.9257 - acc: 0.7400 - val_loss: 2.4372 - val_acc: 0.2468
Epoch 6/8
 - 6s - loss: 0.8743 - acc: 0.6926 - val_loss: 1.9499 - val_acc: 0.3117
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 7/8
 - 6s - loss: 0.7652 - acc: 0.7523 - val_loss: 1.2962 - val_acc: 0.5974
Epoch 8/8
 - 6s - loss: 0.6452 - acc: 0.7917 - val_loss: 1.3861 - val_acc: 0.5325
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (3, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (3, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (3, 0, 0)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 488, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00018754597271603137, 'unfreeze_percentage': 0.013099967173404147, 'rotation_range': 0, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 122, 'batch_size': 25, 'learning_rate': 0.0012140875401190161, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.4675324655972518, 'info': {'runtime': 61.972572803497314, 'histories': {'loss': [3.1181279934235735, 1.9261346167891564, 1.4502033591270447, 1.1815126879561333, 0.9257314304510752, 0.8403860182657729, 0.755407886783572, 0.6432958649892877], 'val_loss': [2.3251587508560774, 2.190377579106913, 2.033985952278236, 2.1412068713795054, 2.4372274163481475, 1.949867025598303, 1.2961744193906908, 1.3861364482285141], 'acc': [0.1313868570175484, 0.34306568831857975, 0.6533333162466685, 0.6693548319801208, 0.7399999698003134, 0.7080291727163496, 0.7591240519154681, 0.7883211526557476], 'val_acc': [0.2597402616754755, 0.2597402609013892, 0.28571428619808964, 0.2987012996689066, 0.24675324946254878, 0.31168831362352745, 0.5974026097879781, 0.5324675344027482]}}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 0)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 4)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 4) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 8) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (2, 0, 4) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 4)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 359, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00029654204321131225, 'unfreeze_percentage': 0.20537550376366095, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 254, 'batch_size': 16, 'num_dense_units_2': 10, 'learning_rate': 0.0004652752273333024, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:05:35.950119: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 2.3162 - acc: 0.1687 - val_loss: 2.1732 - val_acc: 0.2752
Epoch 2/8
 - 4s - loss: 2.1323 - acc: 0.2819 - val_loss: 2.1181 - val_acc: 0.2844
Epoch 3/8
 - 4s - loss: 1.9823 - acc: 0.3062 - val_loss: 2.0050 - val_acc: 0.3303
Epoch 4/8
 - 4s - loss: 1.8841 - acc: 0.3392 - val_loss: 1.9553 - val_acc: 0.2294
Epoch 5/8
 - 4s - loss: 1.7092 - acc: 0.3865 - val_loss: 1.8928 - val_acc: 0.2477
Epoch 6/8
 - 4s - loss: 1.6376 - acc: 0.4062 - val_loss: 1.9861 - val_acc: 0.2661
Epoch 7/8
 - 4s - loss: 1.5974 - acc: 0.4363 - val_loss: 2.0190 - val_acc: 0.2661
Epoch 8/8
 - 4s - loss: 1.4185 - acc: 0.4562 - val_loss: 1.6777 - val_acc: 0.4128
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 4)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 359, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00029654204321131225, 'unfreeze_percentage': 0.20537550376366095, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 254, 'batch_size': 16, 'num_dense_units_2': 10, 'learning_rate': 0.0004652752273333024, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.5871559589280995, 'info': {'runtime': 34.74676847457886, 'histories': {'loss': [2.3162020444869995, 2.1450532295487146, 1.9823485970497132, 1.8082129124439124, 1.7252432091595375, 1.6375512957572937, 1.5950160008488279, 1.418534231185913], 'val_loss': [2.1731622765917296, 2.118124124107011, 2.0050153360454313, 1.955318765902738, 1.892815314301657, 1.9860972023885184, 2.0189756494049633, 1.6777433364763172], 'acc': [0.16875, 0.2878787878787879, 0.30625, 0.3560606060606061, 0.3767123287671233, 0.40625, 0.42424242424242425, 0.45625], 'val_acc': [0.2752293616259864, 0.28440367109184966, 0.3302752307248772, 0.22935779884867713, 0.24770642393225922, 0.26605505024621245, 0.26605504723863865, 0.41284404107190054]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 4)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 8)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 8) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 7) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 8) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (2, 0, 8) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 8)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 182, 'zoom_range': 0.0, 'cnn_learning_rate': 1.684504354227868e-05, 'unfreeze_percentage': 0.09198940506589715, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 78, 'batch_size': 48, 'learning_rate': 0.0005364889439353017, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 15:06:12.379962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 3.1792 - acc: 0.1692 - val_loss: 2.6712 - val_acc: 0.0938
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/8
 - 4s - loss: 2.3227 - acc: 0.2568 - val_loss: 2.0364 - val_acc: 0.3750
Epoch 3/8
 - 5s - loss: 1.7778 - acc: 0.5347 - val_loss: 1.9702 - val_acc: 0.2500
Epoch 4/8
 - 4s - loss: 1.5018 - acc: 0.5569 - val_loss: 2.0150 - val_acc: 0.1562
Epoch 5/8
 - 4s - loss: 1.1813 - acc: 0.7198 - val_loss: 1.9656 - val_acc: 0.3750
Epoch 6/8
 - 4s - loss: 1.1948 - acc: 0.6988 - val_loss: 1.9652 - val_acc: 0.4062
Epoch 7/8
 - 5s - loss: 0.9269 - acc: 0.8194 - val_loss: 1.9344 - val_acc: 0.2188
Epoch 8/8
 - 4s - loss: 0.9156 - acc: 0.8099 - val_loss: 1.9491 - val_acc: 0.2500
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 8), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 8) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 8) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 8) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 8)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 182, 'zoom_range': 0.0, 'cnn_learning_rate': 1.684504354227868e-05, 'unfreeze_percentage': 0.09198940506589715, 'rotation_range': 0, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 78, 'batch_size': 48, 'learning_rate': 0.0005364889439353017, 'base_model': 'Xception', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.75, 'info': {'runtime': 41.6469783782959, 'histories': {'loss': [3.3517050241169177, 2.375269889831543, 1.7777820030848186, 1.5104492024371499, 1.1917552195097272, 1.2091271626321893, 0.9269022544225057, 0.8775298469945004], 'val_loss': [2.6712160110473633, 2.0363590717315674, 1.9702363014221191, 2.0149998664855957, 1.9656141996383667, 1.9651566743850708, 1.9344382286071777, 1.9490673542022705], 'acc': [0.14912281538310804, 0.26315789708965703, 0.5347222685813904, 0.5263157957478574, 0.7192982686193365, 0.6842105451383089, 0.819444457689921, 0.8157894925067299], 'val_acc': [0.09375, 0.375, 0.25, 0.15625, 0.375, 0.40625, 0.21875, 0.25]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 8)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 7)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 7) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 12) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 7) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (2, 0, 7) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 7)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 542, 'zoom_range': 0.0, 'cnn_learning_rate': 2.543876222176325e-05, 'unfreeze_percentage': 0.10030229620036316, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 79, 'batch_size': 56, 'num_dense_units_2': 12, 'learning_rate': 0.00018309876075472162, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:06:53.142431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 2.2730 - acc: 0.1800 - val_loss: 2.2440 - val_acc: 0.0938
Epoch 2/8
 - 5s - loss: 2.2101 - acc: 0.1964 - val_loss: 2.2817 - val_acc: 0.1562
Epoch 3/8
 - 4s - loss: 2.1046 - acc: 0.3363 - val_loss: 2.2332 - val_acc: 0.2188
Epoch 4/8
 - 4s - loss: 1.9128 - acc: 0.5141 - val_loss: 2.2397 - val_acc: 0.2500
Epoch 5/8
 - 4s - loss: 1.8478 - acc: 0.4196 - val_loss: 2.1855 - val_acc: 0.2188
Epoch 6/8
 - 4s - loss: 1.7245 - acc: 0.6044 - val_loss: 2.1373 - val_acc: 0.2500
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 7/8
 - 4s - loss: 1.6259 - acc: 0.5455 - val_loss: 2.2515 - val_acc: 0.1875
Epoch 8/8
 - 4s - loss: 1.5652 - acc: 0.6639 - val_loss: 2.1765 - val_acc: 0.2500
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 7), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 7) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 7) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 7) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 7)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 542, 'zoom_range': 0.0, 'cnn_learning_rate': 2.543876222176325e-05, 'unfreeze_percentage': 0.10030229620036316, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 79, 'batch_size': 56, 'num_dense_units_2': 12, 'learning_rate': 0.00018309876075472162, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.75, 'info': {'runtime': 40.36080813407898, 'histories': {'loss': [2.273255564131827, 2.2101343870162964, 2.106938699506364, 1.914774903711283, 1.8478108644485474, 1.7263669315374122, 1.6249864438794694, 1.5685420418685336], 'val_loss': [2.2439918518066406, 2.2816524505615234, 2.2331600189208984, 2.2396926879882812, 2.185462713241577, 2.1373209953308105, 2.2514994144439697, 2.1764583587646484], 'acc': [0.1792452762711723, 0.1964285746216774, 0.3301886814945149, 0.5094339510179916, 0.4196428805589676, 0.6037735961518198, 0.5471698203176822, 0.6603773674874935], 'val_acc': [0.09375, 0.15625, 0.21875, 0.25, 0.21875, 0.25, 0.1875, 0.25]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 7)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 12)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 12) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 6) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 12) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 12)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 386, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00011991163360116281, 'unfreeze_percentage': 0.23065408421784245, 'rotation_range': 0, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 144, 'batch_size': 61, 'learning_rate': 0.004853429019338536, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:07:39.278335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 8s - loss: 2.4251 - acc: 0.1398 - val_loss: 3.1929 - val_acc: 0.1250
Epoch 2/8
 - 4s - loss: 3.2256 - acc: 0.1605 - val_loss: 2.6450 - val_acc: 0.2188
Epoch 3/8
 - 5s - loss: 2.8264 - acc: 0.1475 - val_loss: 3.1205 - val_acc: 0.0938
Epoch 4/8
 - 4s - loss: 2.2899 - acc: 0.3149 - val_loss: 2.2818 - val_acc: 0.2188
Epoch 5/8
 - 4s - loss: 1.9772 - acc: 0.3903 - val_loss: 2.0733 - val_acc: 0.2812
Epoch 6/8
 - 5s - loss: 1.7606 - acc: 0.4344 - val_loss: 2.2414 - val_acc: 0.1562
Epoch 7/8
 - 4s - loss: 1.5562 - acc: 0.5249 - val_loss: 2.2877 - val_acc: 0.1875
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/8
 - 4s - loss: 1.3482 - acc: 0.5653 - val_loss: 2.1904 - val_acc: 0.2188
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 12), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 12) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 12)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 386, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00011991163360116281, 'unfreeze_percentage': 0.23065408421784245, 'rotation_range': 0, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 144, 'batch_size': 61, 'learning_rate': 0.004853429019338536, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.78125, 'info': {'runtime': 54.14132285118103, 'histories': {'loss': [2.4144394232494997, 3.1847974239009442, 2.8264098167419434, 2.282716434780914, 2.0098758522826845, 1.7606117725372314, 1.5438782578647727, 1.3699263487711992], 'val_loss': [3.1929478645324707, 2.6449990272521973, 3.1205005645751953, 2.281778335571289, 2.073324203491211, 2.2414026260375977, 2.2877206802368164, 2.1904404163360596], 'acc': [0.12871287261495495, 0.16831682283099336, 0.14754097163677216, 0.3168316678245469, 0.36633661669669765, 0.4344262182712555, 0.5346534317082697, 0.5445544460032246], 'val_acc': [0.125, 0.21875, 0.09375, 0.21875, 0.28125, 0.15625, 0.1875, 0.21875]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 12)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 6)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 6) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 15) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 6)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 319, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004938968030176304, 'unfreeze_percentage': 0.09752594417265983, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 189, 'batch_size': 22, 'learning_rate': 0.0002821562915810712, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:08:27.231827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 2.2246 - acc: 0.2631 - val_loss: 2.0835 - val_acc: 0.4286
Epoch 2/8
 - 3s - loss: 1.5320 - acc: 0.5519 - val_loss: 1.8949 - val_acc: 0.2987
Epoch 3/8
 - 3s - loss: 1.1268 - acc: 0.6667 - val_loss: 1.4929 - val_acc: 0.6234
Epoch 4/8
 - 3s - loss: 0.9327 - acc: 0.7795 - val_loss: 1.5038 - val_acc: 0.4805
Epoch 5/8
 - 3s - loss: 0.6803 - acc: 0.8506 - val_loss: 1.2758 - val_acc: 0.5065
Epoch 6/8
 - 3s - loss: 0.7478 - acc: 0.8067 - val_loss: 1.6045 - val_acc: 0.4805
Epoch 7/8
 - 3s - loss: 0.5802 - acc: 0.8896 - val_loss: 1.0088 - val_acc: 0.6494
Epoch 8/8
 - 3s - loss: 0.3381 - acc: 0.9572 - val_loss: 1.3369 - val_acc: 0.5844
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 6), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 6) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 6)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 319, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004938968030176304, 'unfreeze_percentage': 0.09752594417265983, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 189, 'batch_size': 22, 'learning_rate': 0.0002821562915810712, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.41558441093989784, 'info': {'runtime': 31.83592200279236, 'histories': {'loss': [2.207344390664782, 1.531982694353376, 1.127276825526404, 0.9142599437917982, 0.6803362667560577, 0.7283526999609811, 0.5802438088825771, 0.3288836457899639], 'val_loss': [2.083501184141481, 1.8949336448273102, 1.49289811121953, 1.503776548744796, 1.2758054919057078, 1.604501618967428, 1.0088174048956338, 1.336918778233714], 'acc': [0.2642857217362949, 0.551948070526123, 0.6746031897408622, 0.7928571607385363, 0.8506493653569903, 0.8174603363824269, 0.8896104097366333, 0.9642857415335518], 'val_acc': [0.42857143399003267, 0.2987012987012987, 0.6233766373101767, 0.480519484389912, 0.506493510363938, 0.4805194859380846, 0.6493506617360301, 0.5844155890601022]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 6)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 15)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 15) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 0) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 15) on hpbandster.run_0.worker.tfpool20.27905140655330039552
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 15)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 370, 'zoom_range': 0.0, 'cnn_learning_rate': 1.1934326545868966e-05, 'unfreeze_percentage': 0.25350871881404513, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 386, 'batch_size': 34, 'num_dense_units_2': 22, 'learning_rate': 0.0002160317442591178, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
DEBUG:hpbandster:DISPATCHER: job (2, 0, 15) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
2018-02-08 15:09:06.335195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 7s - loss: 2.6745 - acc: 0.1004 - val_loss: 2.4125 - val_acc: 0.1250
Epoch 2/8
 - 5s - loss: 2.1966 - acc: 0.2602 - val_loss: 2.2140 - val_acc: 0.2188
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/8
 - 5s - loss: 2.0514 - acc: 0.2137 - val_loss: 2.2771 - val_acc: 0.2812
Epoch 4/8
 - 5s - loss: 1.7409 - acc: 0.4338 - val_loss: 2.1504 - val_acc: 0.2344
Epoch 5/8
 - 5s - loss: 1.6857 - acc: 0.5147 - val_loss: 2.4952 - val_acc: 0.2344
Epoch 6/8
 - 6s - loss: 1.5531 - acc: 0.5294 - val_loss: 1.9790 - val_acc: 0.3125
Epoch 7/8
 - 5s - loss: 1.3883 - acc: 0.6877 - val_loss: 1.9778 - val_acc: 0.2812
Epoch 8/8
 - 5s - loss: 1.2475 - acc: 0.6543 - val_loss: 1.8850 - val_acc: 0.3281
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 15), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 15) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 15) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 15) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 15)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 370, 'zoom_range': 0.0, 'cnn_learning_rate': 1.1934326545868966e-05, 'unfreeze_percentage': 0.25350871881404513, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 386, 'batch_size': 34, 'num_dense_units_2': 22, 'learning_rate': 0.0002160317442591178, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.671875, 'info': {'runtime': 57.20596957206726, 'histories': {'loss': [2.6649260260164738, 2.1906860005110502, 2.0582355447113514, 1.7409420311450958, 1.7007116954773664, 1.5530522465705872, 1.3839119412004948, 1.2420440057913462], 'val_loss': [2.4124808311462402, 2.2139575481414795, 2.2770912647247314, 2.150389075279236, 2.4951839447021484, 1.9789881110191345, 1.9778491258621216, 1.88498193025589], 'acc': [0.10156250387080945, 0.25781251455191523, 0.2109375053551048, 0.4338235482573509, 0.5078125155996531, 0.5294118076562881, 0.6875000027939677, 0.6583333452542622], 'val_acc': [0.125, 0.21875, 0.28125, 0.234375, 0.234375, 0.3125, 0.28125, 0.328125]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 15)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 0) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 9) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (2, 0, 0) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 151, 'zoom_range': 0.0, 'cnn_learning_rate': 4.5115076711316286e-05, 'unfreeze_percentage': 0.12578119934472562, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 233, 'batch_size': 20, 'learning_rate': 0.0018919149581356326, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:09:57.430496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 6s - loss: 3.8537 - acc: 0.1204 - val_loss: 2.0332 - val_acc: 0.3117
Epoch 2/8
 - 4s - loss: 1.7355 - acc: 0.4239 - val_loss: 3.7176 - val_acc: 0.1818
Epoch 3/8
 - 4s - loss: 1.4569 - acc: 0.6000 - val_loss: 1.5759 - val_acc: 0.4935
Epoch 4/8
 - 3s - loss: 1.7840 - acc: 0.4565 - val_loss: 1.3626 - val_acc: 0.6494
Epoch 5/8
 - 4s - loss: 0.5995 - acc: 0.8437 - val_loss: 1.3025 - val_acc: 0.5455
Epoch 6/8
 - 3s - loss: 2.0836 - acc: 0.5065 - val_loss: 1.5101 - val_acc: 0.4805
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 7/8
 - 4s - loss: 0.5421 - acc: 0.8313 - val_loss: 1.4210 - val_acc: 0.5455
Epoch 8/8
 - 4s - loss: 0.6681 - acc: 0.8099 - val_loss: 0.9929 - val_acc: 0.6623
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 0)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 151, 'zoom_range': 0.0, 'cnn_learning_rate': 4.5115076711316286e-05, 'unfreeze_percentage': 0.12578119934472562, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 233, 'batch_size': 20, 'learning_rate': 0.0018919149581356326, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.33766232527695694, 'info': {'runtime': 35.02847218513489, 'histories': {'loss': [3.7494995560444577, 1.6896517008123264, 1.456907719373703, 1.6265925611219099, 0.5994948223233223, 1.8668324764697783, 0.5421071574091911, 0.7074413333140629], 'val_loss': [2.0332066176773664, 3.7175888148221103, 1.5759455275225949, 1.3626276440434641, 1.3025092242600083, 1.5101295817982068, 1.4209519702118714, 0.9928945844823663], 'acc': [0.13380282151866968, 0.4154929669810013, 0.6000000182539225, 0.5080645211761997, 0.8437499925494194, 0.5080645282662684, 0.8312500044703484, 0.7887323943661971], 'val_acc': [0.31168831710691575, 0.18181818278578968, 0.4935064981510113, 0.6493506539951671, 0.545454549324977, 0.480519484389912, 0.5454545500990632, 0.6623376747230431]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 0)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 9)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 9) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 9) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 1) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 9)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 280, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007344732739901397, 'unfreeze_percentage': 0.08944488947028582, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 119, 'batch_size': 17, 'num_dense_units_2': 10, 'learning_rate': 0.00023199646997601673, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:10:31.632819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 2.3886 - acc: 0.1222 - val_loss: 2.1881 - val_acc: 0.1927
Epoch 2/8
 - 4s - loss: 2.0706 - acc: 0.2838 - val_loss: 2.1153 - val_acc: 0.3028
Epoch 3/8
 - 4s - loss: 1.9857 - acc: 0.2917 - val_loss: 2.0327 - val_acc: 0.3119
Epoch 4/8
 - 4s - loss: 1.7225 - acc: 0.4248 - val_loss: 1.8804 - val_acc: 0.3670
Epoch 5/8
 - 4s - loss: 1.4364 - acc: 0.5979 - val_loss: 1.7282 - val_acc: 0.5321
Epoch 6/8
 - 4s - loss: 1.2226 - acc: 0.6294 - val_loss: 1.7875 - val_acc: 0.3761
Epoch 7/8
 - 4s - loss: 1.2293 - acc: 0.6399 - val_loss: 1.6599 - val_acc: 0.4771
Epoch 8/8
 - 4s - loss: 0.9278 - acc: 0.7910 - val_loss: 1.3825 - val_acc: 0.5413
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 9), trying to register it.
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 9)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 280, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007344732739901397, 'unfreeze_percentage': 0.08944488947028582, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 119, 'batch_size': 17, 'num_dense_units_2': 10, 'learning_rate': 0.00023199646997601673, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.45871559359611724, 'info': {'runtime': 35.2521538734436, 'histories': {'loss': [2.389729327168958, 2.08120735267113, 1.9785602166734892, 1.7225319809383817, 1.4379059290063791, 1.2298617700050618, 1.2422061887280695, 0.9250857221669164], 'val_loss': [2.188065432627267, 2.1153145317637594, 2.032691314679767, 1.880388231452452, 1.7281855268215915, 1.7875175388581162, 1.6599103988857444, 1.382495582650561], 'acc': [0.11724138110876084, 0.2758620744635319, 0.2896551762161584, 0.4248366128239367, 0.6000000203477925, 0.6275862256000782, 0.6275862290941435, 0.7862069269706463], 'val_acc': [0.1926605504587156, 0.3027522949450607, 0.31192660741849776, 0.3669724803452098, 0.5321100950241089, 0.37614679281864694, 0.47706422346447586, 0.5412844064038828]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 9)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 9) with dispatcher
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 1)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 1) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 4) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 1) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (3, 0, 1) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (3, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 460, 'zoom_range': 0.0, 'cnn_learning_rate': 3.822232483478204e-05, 'unfreeze_percentage': 0.2790147253057443, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 476, 'batch_size': 42, 'learning_rate': 0.0028159105602947286, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:11:09.555798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 3.2743 - acc: 0.1349 - val_loss: 2.3591 - val_acc: 0.0938
Epoch 2/8
 - 4s - loss: 3.1288 - acc: 0.2068 - val_loss: 2.6003 - val_acc: 0.1875
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/8
 - 4s - loss: 1.9840 - acc: 0.4299 - val_loss: 2.2302 - val_acc: 0.2188
Epoch 4/8
 - 4s - loss: 1.7475 - acc: 0.4127 - val_loss: 2.1500 - val_acc: 0.1562
Epoch 5/8
 - 4s - loss: 1.3218 - acc: 0.5973 - val_loss: 2.1711 - val_acc: 0.2500
Epoch 6/8
 - 4s - loss: 1.2878 - acc: 0.5503 - val_loss: 1.8476 - val_acc: 0.3750
Epoch 7/8
 - 4s - loss: 0.7640 - acc: 0.8413 - val_loss: 2.2189 - val_acc: 0.4062
Epoch 8/8
 - 4s - loss: 0.8754 - acc: 0.6887 - val_loss: 1.8432 - val_acc: 0.3750
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (3, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (3, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 1) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (3, 0, 1)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 460, 'zoom_range': 0.0, 'cnn_learning_rate': 3.822232483478204e-05, 'unfreeze_percentage': 0.2790147253057443, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 476, 'batch_size': 42, 'learning_rate': 0.0028159105602947286, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.625, 'info': {'runtime': 40.111884355545044, 'histories': {'loss': [3.2743143240610757, 3.131691908836365, 1.9847152107640316, 1.7474900881449382, 1.3291894257068635, 1.273053628206253, 0.7640151381492615, 0.8858921647071838], 'val_loss': [2.3590967655181885, 2.600295066833496, 2.230240821838379, 2.149965763092041, 2.171077251434326, 1.8476306200027466, 2.218858003616333, 1.8431599140167236], 'acc': [0.1349206417798996, 0.2083333410322666, 0.4298245797031804, 0.4126984179019928, 0.5916666865348816, 0.558333370089531, 0.841269870599111, 0.6833333641290664], 'val_acc': [0.09375, 0.1875, 0.21875, 0.15625, 0.25, 0.375, 0.40625, 0.375]}}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 1)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 4)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 4) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 6) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (2, 0, 4) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 4)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 359, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00029654204321131225, 'unfreeze_percentage': 0.20537550376366095, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 254, 'batch_size': 16, 'num_dense_units_2': 10, 'learning_rate': 0.0004652752273333024, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:11:47.145748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 5s - loss: 2.3252 - acc: 0.1135 - val_loss: 2.2079 - val_acc: 0.1560
Epoch 2/16
 - 4s - loss: 2.1936 - acc: 0.2080 - val_loss: 2.2907 - val_acc: 0.1651
Epoch 3/16
 - 4s - loss: 2.1060 - acc: 0.3188 - val_loss: 2.1560 - val_acc: 0.2294
Epoch 4/16
 - 4s - loss: 2.0054 - acc: 0.2994 - val_loss: 2.2577 - val_acc: 0.2936
Epoch 5/16
 - 4s - loss: 2.0457 - acc: 0.2900 - val_loss: 2.0899 - val_acc: 0.2569
Epoch 6/16
 - 4s - loss: 1.8749 - acc: 0.4098 - val_loss: 2.2772 - val_acc: 0.3028
Epoch 7/16
 - 4s - loss: 1.7766 - acc: 0.4250 - val_loss: 1.8690 - val_acc: 0.2477
Epoch 8/16
 - 4s - loss: 1.8629 - acc: 0.3392 - val_loss: 1.9674 - val_acc: 0.2752
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 9/16
 - 4s - loss: 1.6780 - acc: 0.4688 - val_loss: 2.2772 - val_acc: 0.1835
Epoch 10/16
 - 4s - loss: 1.7220 - acc: 0.3909 - val_loss: 1.7401 - val_acc: 0.3394
Epoch 11/16
 - 4s - loss: 1.4687 - acc: 0.4830 - val_loss: 1.8519 - val_acc: 0.3303
Epoch 12/16
 - 4s - loss: 1.2919 - acc: 0.4893 - val_loss: 1.7542 - val_acc: 0.3761
Epoch 13/16
 - 4s - loss: 1.3514 - acc: 0.4287 - val_loss: 1.9241 - val_acc: 0.3578
Epoch 14/16
 - 4s - loss: 1.3262 - acc: 0.4500 - val_loss: 1.8110 - val_acc: 0.3119
Epoch 15/16
 - 4s - loss: 1.3769 - acc: 0.4476 - val_loss: 1.5451 - val_acc: 0.4128
Epoch 16/16
 - 4s - loss: 1.2398 - acc: 0.5239 - val_loss: 1.9276 - val_acc: 0.3394
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 4)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 359, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00029654204321131225, 'unfreeze_percentage': 0.20537550376366095, 'rotation_range': 0, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 254, 'batch_size': 16, 'num_dense_units_2': 10, 'learning_rate': 0.0004652752273333024, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.6605504548877751, 'info': {'runtime': 64.19793224334717, 'histories': {'loss': [2.340608289797012, 2.204905392372445, 2.1059999465942383, 2.005252000057336, 1.9864256088047811, 1.8512587090061134, 1.7765960335731505, 1.6473146640893184, 1.6780058145523071, 1.6428956005671254, 1.507411295420503, 1.3454368196121633, 1.2977861672231596, 1.326177990436554, 1.3120253184070325, 1.208152640949596], 'val_loss': [2.207944974986785, 2.2906744698865698, 2.156000176700977, 2.2576678433549513, 2.0898573595449466, 2.2771609945034763, 1.8690210154297155, 1.9673899816810538, 2.2771619744257094, 1.7401404052699379, 1.851905635737498, 1.754170378413769, 1.9240512126082674, 1.8110022949516227, 1.5450982752196285, 1.9276163020265211], 'acc': [0.1232876712328767, 0.22602739726027396, 0.31875, 0.3560606060606061, 0.3150684931506849, 0.4452054794520548, 0.425, 0.3560606060606061, 0.46875, 0.4246575342465753, 0.4383561643835616, 0.4452054794520548, 0.4657534246575342, 0.45, 0.4863013698630137, 0.5757575757575758], 'val_acc': [0.1559633046662042, 0.1651376153624386, 0.22935779953221663, 0.2935779819931459, 0.25688073428672387, 0.3027522974058029, 0.24770642393225922, 0.2752293586184125, 0.18348623887387985, 0.3394495456590565, 0.330275233732451, 0.3761467909047363, 0.3577981665046937, 0.3119266068716662, 0.41284403806432673, 0.3394495451122249]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 4)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 6)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 6) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 0) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 6)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 319, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004938968030176304, 'unfreeze_percentage': 0.09752594417265983, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 189, 'batch_size': 22, 'learning_rate': 0.0002821562915810712, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:12:51.377429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 5s - loss: 2.2755 - acc: 0.2662 - val_loss: 2.0511 - val_acc: 0.2727
Epoch 2/16
 - 4s - loss: 1.3548 - acc: 0.6531 - val_loss: 1.8806 - val_acc: 0.4156
Epoch 3/16
 - 4s - loss: 1.1346 - acc: 0.6875 - val_loss: 1.9285 - val_acc: 0.2987
Epoch 4/16
 - 4s - loss: 0.7805 - acc: 0.8291 - val_loss: 1.3789 - val_acc: 0.5714
Epoch 5/16
 - 4s - loss: 0.8891 - acc: 0.7763 - val_loss: 1.4919 - val_acc: 0.4675
Epoch 6/16
 - 4s - loss: 0.4876 - acc: 0.9243 - val_loss: 1.3117 - val_acc: 0.5714
Epoch 7/16
 - 4s - loss: 0.3928 - acc: 0.9545 - val_loss: 1.3504 - val_acc: 0.5325
Epoch 8/16
 - 4s - loss: 0.3423 - acc: 0.9572 - val_loss: 1.2221 - val_acc: 0.5714
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 9/16
 - 4s - loss: 0.3297 - acc: 0.9078 - val_loss: 1.3494 - val_acc: 0.5195
Epoch 10/16
 - 4s - loss: 0.2140 - acc: 0.9805 - val_loss: 1.0954 - val_acc: 0.6494
Epoch 11/16
 - 4s - loss: 0.2064 - acc: 0.9572 - val_loss: 1.1948 - val_acc: 0.5974
Epoch 12/16
 - 4s - loss: 0.1729 - acc: 0.9933 - val_loss: 1.2483 - val_acc: 0.5584
Epoch 13/16
 - 4s - loss: 0.1362 - acc: 0.9869 - val_loss: 1.0278 - val_acc: 0.6104
Epoch 14/16
 - 4s - loss: 0.1260 - acc: 0.9870 - val_loss: 0.9876 - val_acc: 0.7403
Epoch 15/16
 - 4s - loss: 0.1553 - acc: 0.9671 - val_loss: 1.0705 - val_acc: 0.6494
Epoch 16/16
 - 4s - loss: 0.0934 - acc: 0.9737 - val_loss: 0.9681 - val_acc: 0.7143
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 6), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 6) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 6)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 319, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004938968030176304, 'unfreeze_percentage': 0.09752594417265983, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 189, 'batch_size': 22, 'learning_rate': 0.0002821562915810712, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.285714273328905, 'info': {'runtime': 62.270304918289185, 'histories': {'loss': [2.275495478085109, 1.4199459250011142, 1.1383850106171198, 0.8095972967999322, 0.8890426635742188, 0.4738886092390333, 0.39275019296578, 0.3437357723712921, 0.3041955253907612, 0.2140101534979684, 0.19328928802694592, 0.1660717929166461, 0.14105830884405546, 0.12602943288428442, 0.14885154238768986, 0.09838175470275538], 'val_loss': [2.0511485880071465, 1.8805979319981165, 1.9285113563785306, 1.3789296986220718, 1.4918568351052024, 1.3116805011575872, 1.350378935987299, 1.2220558067420861, 1.3494177251667172, 1.0954270409299183, 1.1948068637352485, 1.2483220177811463, 1.0278243677956718, 0.9876224267018305, 1.070503398969576, 0.9680705782654998], 'acc': [0.2662337677819388, 0.6111111130033221, 0.6928571624415262, 0.8142857321671078, 0.7785714481558118, 0.9285714524132865, 0.9545454808643886, 0.9642857228006635, 0.9214285952704293, 0.9805194990975517, 0.9642857228006635, 0.9920634996323359, 0.9857142993382045, 0.9870129993983677, 0.9642857296126229, 0.9714285893099649], 'val_acc': [0.2727272746624885, 0.4155844175196313, 0.29870130063651446, 0.5714285745249166, 0.467532471402899, 0.5714285776212618, 0.5324675378861365, 0.5714285760730892, 0.519480520641649, 0.6493506524469945, 0.5974026012730289, 0.5584415611508605, 0.6103896243231637, 0.7402597433560855, 0.6493506617360301, 0.714285726671095]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 6)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 0) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 9) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (2, 0, 0) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 151, 'zoom_range': 0.0, 'cnn_learning_rate': 4.5115076711316286e-05, 'unfreeze_percentage': 0.12578119934472562, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 233, 'batch_size': 20, 'learning_rate': 0.0018919149581356326, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:13:54.516551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 5s - loss: 3.0747 - acc: 0.0887 - val_loss: 2.7012 - val_acc: 0.0649
Epoch 2/16
 - 4s - loss: 1.9124 - acc: 0.3359 - val_loss: 2.1164 - val_acc: 0.1818
Epoch 3/16
 - 4s - loss: 1.4592 - acc: 0.4873 - val_loss: 2.9880 - val_acc: 0.1558
Epoch 4/16
 - 4s - loss: 1.5944 - acc: 0.4875 - val_loss: 1.4975 - val_acc: 0.4935
Epoch 5/16
 - 4s - loss: 1.2369 - acc: 0.5768 - val_loss: 1.0721 - val_acc: 0.6104
Epoch 6/16
 - 4s - loss: 1.8205 - acc: 0.5081 - val_loss: 1.3954 - val_acc: 0.5195
Epoch 7/16
 - 4s - loss: 0.4812 - acc: 0.9000 - val_loss: 0.9287 - val_acc: 0.7143
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/16
 - 4s - loss: 1.1160 - acc: 0.7479 - val_loss: 0.9051 - val_acc: 0.7403
Epoch 9/16
 - 4s - loss: 1.0401 - acc: 0.6782 - val_loss: 1.0144 - val_acc: 0.6753
Epoch 10/16
 - 4s - loss: 0.5981 - acc: 0.7796 - val_loss: 0.9227 - val_acc: 0.7143
Epoch 11/16
 - 4s - loss: 0.7154 - acc: 0.8415 - val_loss: 1.2129 - val_acc: 0.6494
Epoch 12/16
 - 4s - loss: 0.1978 - acc: 0.9250 - val_loss: 0.7322 - val_acc: 0.7662
Epoch 13/16
 - 4s - loss: 0.9961 - acc: 0.7225 - val_loss: 0.9461 - val_acc: 0.7013
Epoch 14/16
 - 4s - loss: 0.2544 - acc: 0.9239 - val_loss: 0.9481 - val_acc: 0.7403
Epoch 15/16
 - 4s - loss: 0.9845 - acc: 0.8796 - val_loss: 0.9022 - val_acc: 0.7792
Epoch 16/16
 - 4s - loss: 0.8711 - acc: 0.7403 - val_loss: 5.7044 - val_acc: 0.1429
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 0)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 151, 'zoom_range': 0.0, 'cnn_learning_rate': 4.5115076711316286e-05, 'unfreeze_percentage': 0.12578119934472562, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 233, 'batch_size': 20, 'learning_rate': 0.0018919149581356326, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8571428552076414, 'info': {'runtime': 62.42189168930054, 'histories': {'loss': [3.095853604061503, 1.889750944056981, 1.5129511902030086, 1.5944412499666214, 1.0632614787195769, 1.7419211950994307, 0.48117790184915066, 0.9134343207721979, 0.9671750933351652, 0.5069648284517544, 0.6970335634451517, 0.1978129604831338, 0.6693488011057948, 0.2598220703887268, 1.0393664996388932, 0.604934980792384], 'val_loss': [2.7012070835410773, 2.116447569487931, 2.9880309786115373, 1.497470278244514, 1.0721339018313916, 1.3953595471072506, 0.9286588856152126, 0.9050581331376906, 1.0144459179469518, 0.9227062912730427, 1.2128667599195009, 0.7322169031415667, 0.946124538198694, 0.9480659512730388, 0.9021716195267516, 5.704398687783774], 'acc': [0.09859155076490321, 0.3732394437554856, 0.48591548959973835, 0.48750000447034836, 0.6408450804965596, 0.5725806559766492, 0.8999999910593033, 0.8309859121349495, 0.7535211343160817, 0.8661971839380936, 0.823943661971831, 0.9249999970197678, 0.8028168913344262, 0.9154929543884707, 0.8661971805800854, 0.862903227729182], 'val_acc': [0.06493506541886887, 0.18181818278578968, 0.15584415584415584, 0.4935064981510113, 0.6103896243231637, 0.519480523350951, 0.714285726671095, 0.7402597433560855, 0.6753246784210205, 0.7142857173820595, 0.6493506539951671, 0.7662337778450606, 0.701298713684082, 0.7402597441301717, 0.7792207900579874, 0.1428571447923586]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 0)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 9)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 9) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 9) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 9)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 280, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007344732739901397, 'unfreeze_percentage': 0.08944488947028582, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 119, 'batch_size': 17, 'num_dense_units_2': 10, 'learning_rate': 0.00023199646997601673, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:14:56.179454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 5s - loss: 2.2695 - acc: 0.1734 - val_loss: 2.2611 - val_acc: 0.1284
Epoch 2/16
 - 4s - loss: 2.0436 - acc: 0.2326 - val_loss: 2.2228 - val_acc: 0.1927
Epoch 3/16
 - 4s - loss: 1.9114 - acc: 0.2366 - val_loss: 2.1432 - val_acc: 0.2018
Epoch 4/16
 - 4s - loss: 1.7532 - acc: 0.3114 - val_loss: 2.0826 - val_acc: 0.2477
Epoch 5/16
 - 4s - loss: 1.6901 - acc: 0.2931 - val_loss: 1.9686 - val_acc: 0.2661
Epoch 6/16
 - 4s - loss: 1.5610 - acc: 0.3399 - val_loss: 2.0245 - val_acc: 0.2844
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 7/16
 - 4s - loss: 1.5878 - acc: 0.2983 - val_loss: 1.8824 - val_acc: 0.3119
Epoch 8/16
 - 4s - loss: 1.3817 - acc: 0.4205 - val_loss: 1.8493 - val_acc: 0.3394
Epoch 9/16
 - 4s - loss: 1.3914 - acc: 0.3889 - val_loss: 1.9013 - val_acc: 0.3303
Epoch 10/16
 - 4s - loss: 1.3595 - acc: 0.4178 - val_loss: 1.7060 - val_acc: 0.3853
Epoch 11/16
 - 4s - loss: 1.3798 - acc: 0.3601 - val_loss: 1.9879 - val_acc: 0.2661
Epoch 12/16
 - 4s - loss: 1.2590 - acc: 0.4114 - val_loss: 1.7252 - val_acc: 0.3761
Epoch 13/16
 - 4s - loss: 1.2757 - acc: 0.4166 - val_loss: 1.7249 - val_acc: 0.4037
Epoch 14/16
 - 4s - loss: 1.0726 - acc: 0.5256 - val_loss: 1.8805 - val_acc: 0.3578
Epoch 15/16
 - 4s - loss: 1.1349 - acc: 0.5359 - val_loss: 1.8555 - val_acc: 0.4220
Epoch 16/16
 - 4s - loss: 1.0683 - acc: 0.5322 - val_loss: 1.7218 - val_acc: 0.4128
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 9), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 9) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 9)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 280, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007344732739901397, 'unfreeze_percentage': 0.08944488947028582, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 119, 'batch_size': 17, 'num_dense_units_2': 10, 'learning_rate': 0.00023199646997601673, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.5871559600217626, 'info': {'runtime': 63.76120901107788, 'histories': {'loss': [2.2736276379947005, 2.0540441307528265, 1.8993006032088706, 1.7530009804100826, 1.6780848314022196, 1.5609566105736628, 1.5809650248494642, 1.3771418522144185, 1.39234063707549, 1.3686328164462385, 1.3628948195227262, 1.2401713124636946, 1.273473962422075, 1.0809568594241965, 1.1349032057656183, 1.0648779067499885], 'val_loss': [2.2610986735842644, 2.2227573438521917, 2.1431974927219777, 2.082642743346888, 1.968634008267604, 2.0245284334235234, 1.8823506154051615, 1.8492752237057468, 1.9012668132781982, 1.7060399777298674, 1.9878578710993495, 1.7251749224619035, 1.724850925830526, 1.8804500496715582, 1.8554535437067714, 1.7217864946487846], 'acc': [0.16551724384570943, 0.22758621090445025, 0.2482758673614469, 0.3103448353964707, 0.2965517335924609, 0.33986929141812855, 0.29655173451736055, 0.4137931174245374, 0.38620690682838704, 0.4000000095572965, 0.3724138028148947, 0.42068966596290985, 0.4206896686348422, 0.5241379524099415, 0.535947733455234, 0.531034503723013], 'val_acc': [0.12844036731424682, 0.1926605504587156, 0.20183486429923173, 0.24770642270188814, 0.26605504723863865, 0.28440367040831016, 0.3119266061881267, 0.3394495451122249, 0.3302752307248772, 0.3853211022845102, 0.26605504655509915, 0.3761467903579047, 0.40366972914529503, 0.3577981670515253, 0.4220183505377638, 0.4128440399782373]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 9)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 2)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 2) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 6) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (3, 0, 2) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (3, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 141, 'zoom_range': 0.0, 'cnn_learning_rate': 1.7938792937166343e-05, 'unfreeze_percentage': 0.07754453826440352, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 147, 'batch_size': 18, 'num_dense_units_2': 135, 'learning_rate': 0.001267398270091293, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:16:01.766196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 2.4573 - acc: 0.1975 - val_loss: 2.3087 - val_acc: 0.0917
Epoch 2/8
 - 4s - loss: 1.8358 - acc: 0.3765 - val_loss: 2.4478 - val_acc: 0.0826
Epoch 3/8
 - 4s - loss: 1.1302 - acc: 0.6790 - val_loss: 2.4714 - val_acc: 0.1193
Epoch 4/8
 - 4s - loss: 0.9202 - acc: 0.6914 - val_loss: 2.4966 - val_acc: 0.0917
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 5/8
 - 4s - loss: 0.8719 - acc: 0.7099 - val_loss: 2.5451 - val_acc: 0.1193
Epoch 6/8
 - 4s - loss: 0.6844 - acc: 0.7654 - val_loss: 2.6479 - val_acc: 0.1193
Epoch 7/8
 - 4s - loss: 0.3713 - acc: 0.9136 - val_loss: 2.8350 - val_acc: 0.1009
Epoch 8/8
 - 4s - loss: 0.2914 - acc: 0.9198 - val_loss: 3.2540 - val_acc: 0.1101
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (3, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (3, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (3, 0, 2)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 141, 'zoom_range': 0.0, 'cnn_learning_rate': 1.7938792937166343e-05, 'unfreeze_percentage': 0.07754453826440352, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 147, 'batch_size': 18, 'num_dense_units_2': 135, 'learning_rate': 0.001267398270091293, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.8899082561971945, 'info': {'runtime': 40.63888168334961, 'histories': {'loss': [2.4573470221625433, 1.8357916010750666, 1.1302135520511203, 0.9202078862322701, 0.8719136052661471, 0.6843739814228482, 0.3713022453917397, 0.291357374853558], 'val_loss': [2.3086645821912573, 2.4478128918814, 2.4714025904279238, 2.4965503653255077, 2.5450736470178725, 2.647852167077021, 2.83498057094189, 3.2539790923442315], 'acc': [0.19753086691101393, 0.37654321847690475, 0.6790123614999983, 0.6913580364651151, 0.7098765638139513, 0.7654321061240302, 0.9135802454418607, 0.9197530945142111], 'val_acc': [0.09174311926605505, 0.0825688076812193, 0.11926605572941107, 0.0917431196078248, 0.11926605572941107, 0.11926605695978217, 0.10091743153443031, 0.11009174380280556]}}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 6)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 6) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 9) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 6)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 319, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004938968030176304, 'unfreeze_percentage': 0.09752594417265983, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 189, 'batch_size': 22, 'learning_rate': 0.0002821562915810712, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:16:40.688941: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/22
 - 5s - loss: 2.2032 - acc: 0.2832 - val_loss: 2.1189 - val_acc: 0.2338
Epoch 2/22
 - 4s - loss: 1.4478 - acc: 0.6055 - val_loss: 1.8414 - val_acc: 0.2597
Epoch 3/22
 - 4s - loss: 1.1364 - acc: 0.7273 - val_loss: 1.5472 - val_acc: 0.4545
Epoch 4/22
 - 4s - loss: 0.8500 - acc: 0.7832 - val_loss: 1.5308 - val_acc: 0.4545
Epoch 5/22
 - 4s - loss: 0.7121 - acc: 0.8651 - val_loss: 1.4676 - val_acc: 0.4675
Epoch 6/22
 - 4s - loss: 0.5262 - acc: 0.9351 - val_loss: 1.1059 - val_acc: 0.6623
Epoch 7/22
 - 4s - loss: 0.5257 - acc: 0.9112 - val_loss: 0.9964 - val_acc: 0.6623
Epoch 8/22
 - 4s - loss: 0.3546 - acc: 0.9538 - val_loss: 1.0273 - val_acc: 0.6364
Epoch 9/22
 - 4s - loss: 0.3615 - acc: 0.9078 - val_loss: 0.9194 - val_acc: 0.6883
Epoch 10/22
 - 4s - loss: 0.2606 - acc: 0.9538 - val_loss: 0.8467 - val_acc: 0.7403
Epoch 11/22
 - 4s - loss: 0.1561 - acc: 0.9935 - val_loss: 0.9389 - val_acc: 0.6494
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 12/22
 - 4s - loss: 0.1257 - acc: 1.0000 - val_loss: 0.8881 - val_acc: 0.6883
Epoch 13/22
 - 4s - loss: 0.1028 - acc: 1.0000 - val_loss: 0.7643 - val_acc: 0.6883
Epoch 14/22
 - 4s - loss: 0.1484 - acc: 0.9933 - val_loss: 0.9459 - val_acc: 0.6753
Epoch 15/22
 - 4s - loss: 0.0979 - acc: 0.9934 - val_loss: 0.8075 - val_acc: 0.7143
Epoch 16/22
 - 4s - loss: 0.1272 - acc: 0.9870 - val_loss: 0.7404 - val_acc: 0.7532
Epoch 17/22
 - 4s - loss: 0.0850 - acc: 0.9934 - val_loss: 0.6341 - val_acc: 0.7143
Epoch 18/22
 - 4s - loss: 0.0732 - acc: 1.0000 - val_loss: 0.7787 - val_acc: 0.6883
Epoch 19/22
 - 4s - loss: 0.0501 - acc: 1.0000 - val_loss: 0.7597 - val_acc: 0.7403
Epoch 20/22
 - 4s - loss: 0.0609 - acc: 0.9935 - val_loss: 0.7388 - val_acc: 0.7273
Epoch 21/22
 - 4s - loss: 0.0241 - acc: 1.0000 - val_loss: 0.7876 - val_acc: 0.6623
Epoch 22/22
 - 4s - loss: 0.0599 - acc: 0.9869 - val_loss: 0.7839 - val_acc: 0.7403
{'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 319, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004938968030176304, 'unfreeze_percentage': 0.09752594417265983, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 189, 'batch_size': 22, 'learning_rate': 0.0002821562915810712, 'base_model': 'MobileNet', 'activation': 'relu'}

 ****** MobileNet unfrozen 2 top blocks, cut_off after layer 75 ******
Epoch 1/10
 - 5s - loss: 0.0236 - acc: 1.0000 - val_loss: 0.7968 - val_acc: 0.7403
Epoch 2/10
 - 4s - loss: 0.0158 - acc: 1.0000 - val_loss: 0.7249 - val_acc: 0.7532
Epoch 3/10
 - 4s - loss: 0.0127 - acc: 1.0000 - val_loss: 0.6553 - val_acc: 0.7662
Epoch 4/10
 - 4s - loss: 0.0226 - acc: 1.0000 - val_loss: 0.8590 - val_acc: 0.6753
Epoch 5/10
 - 4s - loss: 0.0202 - acc: 1.0000 - val_loss: 0.6946 - val_acc: 0.7532
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 6/10
 - 4s - loss: 0.0134 - acc: 1.0000 - val_loss: 0.6733 - val_acc: 0.7662
Epoch 7/10
 - 4s - loss: 0.0147 - acc: 1.0000 - val_loss: 0.7199 - val_acc: 0.7662
Epoch 8/10
 - 4s - loss: 0.0130 - acc: 1.0000 - val_loss: 0.8208 - val_acc: 0.7273
Epoch 9/10
 - 4s - loss: 0.0262 - acc: 1.0000 - val_loss: 0.8110 - val_acc: 0.7403
Epoch 10/10
 - 4s - loss: 0.0105 - acc: 1.0000 - val_loss: 0.9005 - val_acc: 0.7273
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 6), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 6) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 6)
args: ()
kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 319, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004938968030176304, 'unfreeze_percentage': 0.09752594417265983, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 189, 'batch_size': 22, 'learning_rate': 0.0002821562915810712, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.2727272688568413, 'info': {'runtime': 120.95934247970581, 'histories': {'loss': [2.2567251988819668, 1.502945876121521, 1.1364299825259618, 0.8946436719288902, 0.7079498316560473, 0.5261963350432259, 0.5062653618199485, 0.3197371904339109, 0.33046937521014896, 0.22846900671720505, 0.1560806365949767, 0.12302440064293997, 0.104287922169481, 0.14765155185309667, 0.09148075192102365, 0.1271996604544776, 0.07989579314099891, 0.06923188721495015, 0.04386387493993555, 0.06086845602840185, 0.02470030106071915, 0.05896801742325936, 0.01746100176657949, 0.014193395551826273, 0.011089313608993377, 0.022551745043269227, 0.018012024166565093, 0.013363108304994447, 0.014204610990626471, 0.012358482966997793, 0.01811237238081438, 0.01049860447113003], 'val_loss': [2.118858987634832, 1.8414418883137889, 1.547234163655863, 1.5308257991617376, 1.4675942581969421, 1.1059268759442615, 0.9963853483076219, 1.0272556589795399, 0.9193734635006298, 0.8467393401381257, 0.9389081434770064, 0.8880593366437144, 0.7643253648435915, 0.9459448665767521, 0.8074817657470703, 0.7403530699092072, 0.634063006221474, 0.7787180179125303, 0.7596857907710137, 0.7388227496828351, 0.7876184915567374, 0.7838778913795174, 0.7968273604070986, 0.7249176293224483, 0.6552652662450617, 0.8589913287720123, 0.6946347851257819, 0.6733496328452965, 0.7198835479748713, 0.8208277101640578, 0.81102463022455, 0.9005121968009255], 'acc': [0.24285714881760734, 0.5714285867554801, 0.7272727404321943, 0.753968252076043, 0.8642857526029859, 0.9350649544170925, 0.9142857330186026, 0.9714285850524902, 0.9214285952704293, 0.9714285850524902, 0.9935064996991839, 1.0, 1.0, 0.9920634996323359, 0.9928571496691022, 0.9870129993983677, 0.9928571496691022, 1.0, 1.0, 0.9935064996991839, 1.0, 0.9857142899717604, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], 'val_acc': [0.2337662357014495, 0.2597402616754755, 0.4545454599640586, 0.454545455706584, 0.4675324729510716, 0.6623376662080939, 0.6623376739489568, 0.6363636417822405, 0.6883117022452416, 0.740259744904258, 0.6493506539951671, 0.6883117022452416, 0.6883116921821197, 0.675324687710056, 0.7142857251229224, 0.7532467648580476, 0.7142857181561457, 0.6883116929562061, 0.7402597510969484, 0.7272727303690725, 0.6623376677562665, 0.7402597441301717, 0.7402597441301717, 0.7532467648580476, 0.7662337770709744, 0.6753246799691931, 0.7532467547949259, 0.766233770878284, 0.766233778619147, 0.727272739658108, 0.740259752645121, 0.7272727311431587]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 6)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 9)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 9) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 9) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 3) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 9)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 280, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007344732739901397, 'unfreeze_percentage': 0.08944488947028582, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 119, 'batch_size': 17, 'num_dense_units_2': 10, 'learning_rate': 0.00023199646997601673, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:18:41.732666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/21
 - 5s - loss: 2.3315 - acc: 0.0512 - val_loss: 2.2835 - val_acc: 0.0734
Epoch 2/21
 - 4s - loss: 2.0740 - acc: 0.2246 - val_loss: 2.2305 - val_acc: 0.1376
Epoch 3/21
 - 4s - loss: 1.9435 - acc: 0.2654 - val_loss: 2.2221 - val_acc: 0.1835
Epoch 4/21
 - 4s - loss: 1.6960 - acc: 0.4100 - val_loss: 2.0139 - val_acc: 0.2752
Epoch 5/21
 - 4s - loss: 1.4777 - acc: 0.5335 - val_loss: 1.8772 - val_acc: 0.3303
Epoch 6/21
 - 4s - loss: 1.1771 - acc: 0.6597 - val_loss: 1.7406 - val_acc: 0.3486
Epoch 7/21
 - 4s - loss: 1.0426 - acc: 0.7386 - val_loss: 1.7225 - val_acc: 0.3761
Epoch 8/21
 - 4s - loss: 0.8946 - acc: 0.7779 - val_loss: 1.5982 - val_acc: 0.4587
Epoch 9/21
 - 4s - loss: 0.8024 - acc: 0.7976 - val_loss: 1.5874 - val_acc: 0.4679
Epoch 10/21
 - 4s - loss: 0.7129 - acc: 0.8345 - val_loss: 1.5051 - val_acc: 0.4312
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 11/21
 - 4s - loss: 0.5531 - acc: 0.8758 - val_loss: 1.5533 - val_acc: 0.5505
Epoch 12/21
 - 4s - loss: 0.6500 - acc: 0.8568 - val_loss: 1.4508 - val_acc: 0.5138
Epoch 13/21
 - 4s - loss: 0.5100 - acc: 0.8712 - val_loss: 1.4516 - val_acc: 0.5229
Epoch 14/21
 - 4s - loss: 0.4848 - acc: 0.9207 - val_loss: 1.3918 - val_acc: 0.5963
Epoch 15/21
 - 4s - loss: 0.3387 - acc: 0.8989 - val_loss: 1.3151 - val_acc: 0.5872
Epoch 16/21
 - 4s - loss: 0.2720 - acc: 0.9608 - val_loss: 1.5270 - val_acc: 0.5505
Epoch 17/21
 - 4s - loss: 0.2568 - acc: 0.9422 - val_loss: 1.2145 - val_acc: 0.6697
Epoch 18/21
 - 4s - loss: 0.3396 - acc: 0.9286 - val_loss: 1.2810 - val_acc: 0.6422
Epoch 19/21
 - 4s - loss: 0.2211 - acc: 0.9739 - val_loss: 1.3465 - val_acc: 0.6239
Epoch 20/21
 - 4s - loss: 0.1695 - acc: 0.9934 - val_loss: 1.3514 - val_acc: 0.6422
Epoch 21/21
 - 4s - loss: 0.1733 - acc: 0.9869 - val_loss: 1.2718 - val_acc: 0.6239
{'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 280, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007344732739901397, 'unfreeze_percentage': 0.08944488947028582, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 119, 'batch_size': 17, 'num_dense_units_2': 10, 'learning_rate': 0.00023199646997601673, 'base_model': 'MobileNet', 'activation': 'relu'}

 ****** MobileNet unfrozen 2 top blocks, cut_off after layer 75 ******
Epoch 1/11
 - 5s - loss: 0.1445 - acc: 0.9882 - val_loss: 1.1364 - val_acc: 0.6697
Epoch 2/11
 - 4s - loss: 0.1480 - acc: 0.9685 - val_loss: 1.3377 - val_acc: 0.6239
Epoch 3/11
 - 4s - loss: 0.1298 - acc: 0.9869 - val_loss: 1.2678 - val_acc: 0.6514
Epoch 4/11
 - 4s - loss: 0.1499 - acc: 0.9869 - val_loss: 1.4653 - val_acc: 0.5963
Epoch 5/11
 - 4s - loss: 0.1203 - acc: 1.0000 - val_loss: 1.1899 - val_acc: 0.6422
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 6/11
 - 4s - loss: 0.1126 - acc: 0.9882 - val_loss: 1.1815 - val_acc: 0.6239
Epoch 7/11
 - 4s - loss: 0.1036 - acc: 0.9935 - val_loss: 1.3040 - val_acc: 0.6422
Epoch 8/11
 - 4s - loss: 0.1017 - acc: 0.9869 - val_loss: 1.3414 - val_acc: 0.6055
Epoch 9/11
 - 4s - loss: 0.0810 - acc: 1.0000 - val_loss: 1.2655 - val_acc: 0.6055
Epoch 10/11
 - 4s - loss: 0.1378 - acc: 0.9698 - val_loss: 1.0802 - val_acc: 0.6881
Epoch 11/11
 - 4s - loss: 0.1073 - acc: 0.9869 - val_loss: 1.2939 - val_acc: 0.6330
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 9), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 9) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 9)
args: ()
kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 3, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 280, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007344732739901397, 'unfreeze_percentage': 0.08944488947028582, 'rotation_range': 0, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 119, 'batch_size': 17, 'num_dense_units_2': 10, 'learning_rate': 0.00023199646997601673, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.3669724748768938, 'info': {'runtime': 124.5634036064148, 'histories': {'loss': [2.3350622160681365, 2.0851949552009845, 1.9477033434243038, 1.684958499053429, 1.4710602941184208, 1.157677054816279, 1.0426154202885098, 0.893207679123714, 0.8005647942937654, 0.6836115154726752, 0.5530969334973229, 0.6443255235408915, 0.499057720652942, 0.4755275155941065, 0.3281259362039895, 0.27198799947897595, 0.2525135253010125, 0.34496749752629413, 0.2211158432894283, 0.16750471710131087, 0.1654638267282782, 0.14282614187947634, 0.1481757935778848, 0.13315773750173635, 0.15073197535399732, 0.12047215247976369, 0.10280619196850678, 0.1035753343668249, 0.10053663854968958, 0.08094395190991205, 0.12256775976255022, 0.10733653191063139], 'val_loss': [2.283486173787248, 2.230490581704936, 2.2220743993006713, 2.0139217376708984, 1.8771977544924534, 1.7406389582047768, 1.7225307499596831, 1.5981740721868813, 1.5874031224382033, 1.505073372377168, 1.5533088248804074, 1.450834633013524, 1.4516375053913222, 1.3917739128847735, 1.315054637576462, 1.5270299955245552, 1.2144693048722153, 1.2809880293837381, 1.3465324191872132, 1.3513614989201956, 1.271800975187109, 1.1364159966827532, 1.3376988172531128, 1.2677644961470858, 1.4652775143264631, 1.1898760598733884, 1.1815034927578147, 1.3040275879956167, 1.3414495975599376, 1.2654948825136236, 1.0801686562529398, 1.2938940645357884], 'acc': [0.048275862274498774, 0.21379310915182376, 0.26206897009035635, 0.4137931155747381, 0.5379310496922197, 0.675862093423975, 0.7385621070861816, 0.7724138243445035, 0.7931034643074562, 0.8482758920768212, 0.8758170074886746, 0.8551724261250989, 0.8758620903409761, 0.9124087643449323, 0.9103448399182024, 0.9607843293084039, 0.9448275964835594, 0.927007329725001, 0.9738562371995714, 0.9931034556750593, 0.9862068973738571, 0.9931034486869286, 0.9724138017358451, 0.986206904361988, 0.9862068973738571, 1.0, 0.9931034486869286, 0.9934640526771545, 0.9862069113501187, 1.0, 0.9793103530489166, 0.9869281185997857], 'val_acc': [0.07339449575461379, 0.13761467924085233, 0.18348624044602072, 0.27522935916524416, 0.330275233732451, 0.3486238545780882, 0.3761467909047363, 0.45871560070492806, 0.46788991017079135, 0.43119266191753775, 0.5504587188773199, 0.5137614706240663, 0.5229357820038402, 0.5963302774166842, 0.5871559654900788, 0.5504587199709831, 0.6697247733763598, 0.6422018425180278, 0.6238532123762534, 0.6422018375965434, 0.6238532142901639, 0.6697247804851707, 0.6238532142901639, 0.6513761506168121, 0.5963302785103474, 0.6422018370497118, 0.6238532137433324, 0.6422018375965434, 0.6055045893432898, 0.6055045893432898, 0.6880733966827393, 0.6330275251231062]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 9)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 3)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 3) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 6) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (3, 0, 3) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (3, 0, 3)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 2.1515347899531767e-05, 'unfreeze_percentage': 0.08351197676342967, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 71, 'batch_size': 24, 'learning_rate': 0.0013104844753106392, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:20:47.033190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 7s - loss: 2.4098 - acc: 0.1787 - val_loss: 2.2162 - val_acc: 0.1429
Epoch 2/8
 - 5s - loss: 1.8625 - acc: 0.4591 - val_loss: 2.0259 - val_acc: 0.3117
Epoch 3/8
 - 5s - loss: 1.3557 - acc: 0.6108 - val_loss: 1.9486 - val_acc: 0.3117
Epoch 4/8
 - 5s - loss: 0.9794 - acc: 0.7834 - val_loss: 1.6996 - val_acc: 0.3766
Epoch 5/8
 - 5s - loss: 0.6984 - acc: 0.8163 - val_loss: 1.8508 - val_acc: 0.3766
Epoch 6/8
 - 5s - loss: 0.6554 - acc: 0.8472 - val_loss: 1.6121 - val_acc: 0.4286
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 7/8
 - 5s - loss: 0.4169 - acc: 0.9062 - val_loss: 1.4448 - val_acc: 0.4416
Epoch 8/8
 - 5s - loss: 0.3056 - acc: 0.9561 - val_loss: 1.3385 - val_acc: 0.4805
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (3, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (3, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (3, 0, 3)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 2.1515347899531767e-05, 'unfreeze_percentage': 0.08351197676342967, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 71, 'batch_size': 24, 'learning_rate': 0.0013104844753106392, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.5194805055469662, 'info': {'runtime': 49.49743175506592, 'histories': {'loss': [2.4109229315882144, 1.8551922466443933, 1.3599945565928584, 0.987910446913346, 0.7098849286203799, 0.655398964881897, 0.39866506016772724, 0.30124084327531897], 'val_loss': [2.2162385234585056, 2.0258741626491794, 1.9486208333597554, 1.6996370228854092, 1.8507520564190754, 1.6120932597618598, 1.4447997359486369, 1.3384512508070314], 'acc': [0.18115942471701166, 0.4637681362421616, 0.6086956754974697, 0.7753623464833135, 0.8115942244944365, 0.8472222487131754, 0.9130434834438822, 0.95652174949646], 'val_acc': [0.1428571447923586, 0.31168831362352745, 0.31168831439761374, 0.37662337933267864, 0.37662337778450605, 0.42857143399003267, 0.4415584469770456, 0.4805194944530338]}}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 3)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 6)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 6) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 4) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (2, 0, 6)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 64.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 319, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004938968030176304, 'unfreeze_percentage': 0.09752594417265983, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 189, 'batch_size': 22, 'learning_rate': 0.0002821562915810712, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:21:35.936816: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/22
 - 5s - loss: 2.2155 - acc: 0.2434 - val_loss: 2.0149 - val_acc: 0.3636
Epoch 2/22
 - 4s - loss: 1.4015 - acc: 0.6169 - val_loss: 1.6703 - val_acc: 0.5065
Epoch 3/22
 - 4s - loss: 1.0165 - acc: 0.7500 - val_loss: 1.5880 - val_acc: 0.4675
Epoch 4/22
 - 3s - loss: 0.7678 - acc: 0.8156 - val_loss: 1.2797 - val_acc: 0.6623
Epoch 5/22
 - 4s - loss: 0.5564 - acc: 0.9067 - val_loss: 1.2113 - val_acc: 0.7013
Epoch 6/22
 - 4s - loss: 0.5059 - acc: 0.9080 - val_loss: 1.2359 - val_acc: 0.6104
Epoch 7/22
 - 4s - loss: 0.4551 - acc: 0.9026 - val_loss: 1.1519 - val_acc: 0.7013
Epoch 8/22
 - 4s - loss: 0.2587 - acc: 0.9803 - val_loss: 0.9908 - val_acc: 0.6883
Epoch 9/22
 - 4s - loss: 0.2052 - acc: 0.9869 - val_loss: 1.1235 - val_acc: 0.6494
Epoch 10/22
 - 4s - loss: 0.1703 - acc: 0.9869 - val_loss: 1.0326 - val_acc: 0.6883
Epoch 11/22
 - 4s - loss: 0.1290 - acc: 1.0000 - val_loss: 1.2834 - val_acc: 0.6104
Epoch 12/22
 - 4s - loss: 0.1209 - acc: 0.9803 - val_loss: 1.1343 - val_acc: 0.6104
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 13/22
 - 4s - loss: 0.1784 - acc: 0.9671 - val_loss: 0.8942 - val_acc: 0.6753
Epoch 14/22
 - 4s - loss: 0.1287 - acc: 0.9870 - val_loss: 1.0335 - val_acc: 0.6883
Epoch 15/22
 - 4s - loss: 0.0514 - acc: 1.0000 - val_loss: 1.0808 - val_acc: 0.7013
Epoch 16/22
 - 4s - loss: 0.0618 - acc: 1.0000 - val_loss: 1.2650 - val_acc: 0.6234
Epoch 17/22
 - 4s - loss: 0.0284 - acc: 1.0000 - val_loss: 1.0073 - val_acc: 0.6883
Epoch 18/22
 - 4s - loss: 0.1093 - acc: 0.9867 - val_loss: 1.1890 - val_acc: 0.6623
Epoch 19/22
 - 4s - loss: 0.0214 - acc: 1.0000 - val_loss: 1.0548 - val_acc: 0.6623
Epoch 20/22
 - 4s - loss: 0.0490 - acc: 0.9835 - val_loss: 1.0239 - val_acc: 0.6753
Epoch 21/22
 - 4s - loss: 0.0191 - acc: 1.0000 - val_loss: 0.8492 - val_acc: 0.7273
Epoch 22/22
 - 4s - loss: 0.2056 - acc: 0.9177 - val_loss: 1.0079 - val_acc: 0.6623
{'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 319, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004938968030176304, 'unfreeze_percentage': 0.09752594417265983, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 189, 'batch_size': 22, 'learning_rate': 0.0002821562915810712, 'base_model': 'MobileNet', 'activation': 'relu'}

 ****** MobileNet unfrozen 2 top blocks, cut_off after layer 75 ******
Epoch 1/42
 - 4s - loss: 0.0653 - acc: 0.9934 - val_loss: 1.1114 - val_acc: 0.6623
Epoch 2/42
 - 4s - loss: 0.0643 - acc: 0.9869 - val_loss: 1.0881 - val_acc: 0.7013
Epoch 3/42
 - 4s - loss: 0.0181 - acc: 1.0000 - val_loss: 1.0051 - val_acc: 0.7013
Epoch 4/42
 - 4s - loss: 0.0132 - acc: 1.0000 - val_loss: 0.9042 - val_acc: 0.7403
Epoch 5/42
 - 4s - loss: 0.0122 - acc: 1.0000 - val_loss: 1.2523 - val_acc: 0.6494
Epoch 6/42
 - 4s - loss: 0.0208 - acc: 1.0000 - val_loss: 0.9317 - val_acc: 0.7273
Epoch 7/42
 - 4s - loss: 0.0119 - acc: 1.0000 - val_loss: 0.9839 - val_acc: 0.7143
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/42
 - 4s - loss: 0.0110 - acc: 1.0000 - val_loss: 1.0133 - val_acc: 0.7143
Epoch 9/42
 - 4s - loss: 0.0124 - acc: 1.0000 - val_loss: 1.1471 - val_acc: 0.6623
Epoch 10/42
 - 4s - loss: 0.0105 - acc: 1.0000 - val_loss: 1.1142 - val_acc: 0.6883
Epoch 11/42
 - 4s - loss: 0.0156 - acc: 1.0000 - val_loss: 0.9891 - val_acc: 0.7143
Epoch 12/42
 - 4s - loss: 0.0122 - acc: 1.0000 - val_loss: 1.1062 - val_acc: 0.6623
Epoch 13/42
 - 4s - loss: 0.0073 - acc: 1.0000 - val_loss: 1.1540 - val_acc: 0.6753
Epoch 14/42
 - 4s - loss: 0.0101 - acc: 1.0000 - val_loss: 1.0220 - val_acc: 0.7013
Epoch 15/42
 - 4s - loss: 0.0159 - acc: 1.0000 - val_loss: 1.1664 - val_acc: 0.6234
Epoch 16/42
 - 4s - loss: 0.0132 - acc: 1.0000 - val_loss: 1.2311 - val_acc: 0.6234
Epoch 17/42
 - 4s - loss: 0.0126 - acc: 1.0000 - val_loss: 1.0223 - val_acc: 0.6883
Epoch 18/42
 - 4s - loss: 0.0208 - acc: 1.0000 - val_loss: 1.1179 - val_acc: 0.6364
Epoch 19/42
 - 4s - loss: 0.0064 - acc: 1.0000 - val_loss: 1.2762 - val_acc: 0.6364
Epoch 20/42
 - 4s - loss: 0.0239 - acc: 1.0000 - val_loss: 1.1102 - val_acc: 0.6753
Epoch 21/42
 - 4s - loss: 0.0069 - acc: 1.0000 - val_loss: 1.4939 - val_acc: 0.6234
Epoch 22/42
 - 4s - loss: 0.0107 - acc: 1.0000 - val_loss: 1.0578 - val_acc: 0.6494
Epoch 23/42
 - 4s - loss: 0.0140 - acc: 1.0000 - val_loss: 1.2723 - val_acc: 0.6364
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 24/42
 - 4s - loss: 0.0316 - acc: 0.9835 - val_loss: 1.3751 - val_acc: 0.6364
Epoch 25/42
 - 4s - loss: 0.0072 - acc: 1.0000 - val_loss: 1.3422 - val_acc: 0.6623
Epoch 26/42
 - 4s - loss: 0.0409 - acc: 1.0000 - val_loss: 1.2036 - val_acc: 0.6883
Epoch 27/42
 - 4s - loss: 0.0200 - acc: 1.0000 - val_loss: 1.1786 - val_acc: 0.6494
Epoch 28/42
 - 4s - loss: 0.0100 - acc: 1.0000 - val_loss: 1.2792 - val_acc: 0.6234
Epoch 29/42
 - 4s - loss: 0.0103 - acc: 1.0000 - val_loss: 1.3698 - val_acc: 0.6494
Epoch 30/42
 - 4s - loss: 0.0149 - acc: 1.0000 - val_loss: 1.2689 - val_acc: 0.6753
Epoch 31/42
 - 4s - loss: 0.0141 - acc: 1.0000 - val_loss: 1.0224 - val_acc: 0.6883
Epoch 32/42
 - 4s - loss: 0.0084 - acc: 1.0000 - val_loss: 1.5070 - val_acc: 0.6494
Epoch 33/42
 - 4s - loss: 0.0114 - acc: 1.0000 - val_loss: 1.3294 - val_acc: 0.6623
Epoch 34/42
 - 4s - loss: 0.0131 - acc: 1.0000 - val_loss: 0.9575 - val_acc: 0.7013
Epoch 35/42
 - 4s - loss: 0.0067 - acc: 1.0000 - val_loss: 1.3499 - val_acc: 0.6234
Epoch 36/42
 - 4s - loss: 0.0307 - acc: 1.0000 - val_loss: 1.2776 - val_acc: 0.6364
Epoch 37/42
 - 4s - loss: 0.0187 - acc: 1.0000 - val_loss: 1.4330 - val_acc: 0.5974
Epoch 38/42
 - 4s - loss: 0.0087 - acc: 1.0000 - val_loss: 1.5597 - val_acc: 0.5584
Epoch 39/42
 - 4s - loss: 0.0303 - acc: 1.0000 - val_loss: 1.4778 - val_acc: 0.5714
Epoch 40/42
 - 4s - loss: 0.0174 - acc: 1.0000 - val_loss: 1.3823 - val_acc: 0.5974
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 41/42
 - 4s - loss: 0.0138 - acc: 1.0000 - val_loss: 1.2988 - val_acc: 0.5974
Epoch 42/42
 - 4s - loss: 0.0098 - acc: 1.0000 - val_loss: 1.3162 - val_acc: 0.6234
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (2, 0, 6), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (2, 0, 6) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (2, 0, 6)
args: ()
kwargs: {'budget': 64.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 319, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004938968030176304, 'unfreeze_percentage': 0.09752594417265983, 'rotation_range': 0, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 189, 'batch_size': 22, 'learning_rate': 0.0002821562915810712, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.3766233727529451, 'info': {'runtime': 234.2376823425293, 'histories': {'loss': [2.20765985080174, 1.401483314377921, 0.9993180394172668, 0.7256789258548192, 0.5516360298035636, 0.5180727430752345, 0.4551310326371874, 0.2633146053978375, 0.20825583232300623, 0.1790341197379998, 0.12222854846290179, 0.12518584063010557, 0.18925567514130048, 0.1287234782108239, 0.04724139137459653, 0.0645042851035084, 0.028420172099556242, 0.11887493250625474, 0.02137844224593469, 0.0411986202533756, 0.019529918168804474, 0.20407914370298386, 0.06783342619559594, 0.06516389260068536, 0.016821847423645002, 0.013161855217601572, 0.011637777888349124, 0.017601584616516317, 0.011422442837751337, 0.00986754384024867, 0.010307600868067571, 0.010495176073163748, 0.011066352327664694, 0.010201766488275357, 0.0073783256645713535, 0.010135274047830276, 0.011863608032997165, 0.011074450651982001, 0.010890074413535851, 0.013281346079228179, 0.006411892561508077, 0.0194012052749121, 0.006907129061541387, 0.008470926067924925, 0.011205576440053327, 0.018414669763296844, 0.007167527452111244, 0.02366366513842155, 0.012661964103712568, 0.009993437877190965, 0.009432306034224375, 0.013734416976304991, 0.010984175498523409, 0.008381668079112257, 0.009617768673758421, 0.00968182817700186, 0.006705913958804948, 0.015984640343646918, 0.012119694074083651, 0.00806196991221181, 0.016945612972735294, 0.012274210900068283, 0.012541524986071246, 0.008293026825413108], 'val_loss': [2.014881381740818, 1.670326195754014, 1.587970911682426, 1.2796617421236904, 1.2112810178236528, 1.2358505989049937, 1.1518556553047974, 0.9908094901543159, 1.1235297066824776, 1.0326425827942884, 1.2833609101060148, 1.1342838151114327, 0.8942469079773148, 1.03348915453081, 1.0808156434591714, 1.265032478741237, 1.0072595097801902, 1.1889601373053216, 1.0547818719566642, 1.0239084633913906, 0.8491608554666693, 1.0078971927816218, 1.1113710062844413, 1.088090304430429, 1.0050583117968077, 0.9042080309870956, 1.2522783836761078, 0.9317289753393694, 0.9838920367228521, 1.0132685458505308, 1.1471495930250588, 1.114226465101366, 0.9890695794836267, 1.1061599471352317, 1.1539799083362927, 1.0220245285467668, 1.1664349614799796, 1.2310845325519513, 1.022328992942711, 1.1178761875474608, 1.2762367926634752, 1.1102314606889503, 1.4938886877778288, 1.0578068974730257, 1.2722926294648802, 1.3750588382993425, 1.3422200478516615, 1.2036240147305775, 1.1785760134845584, 1.2792034582658247, 1.369804877739448, 1.2688531055078878, 1.02244800406617, 1.5069761988404509, 1.3293806515730822, 0.9574973722556969, 1.3498651083413657, 1.2775839536220996, 1.4330247315493496, 1.5596642122640239, 1.4778106924775358, 1.3822756912801173, 1.2988366863944314, 1.3162066270778705], 'acc': [0.24285714966910227, 0.6168831246239799, 0.7500000093664442, 0.8428571718079704, 0.9126984495965261, 0.9000000204358782, 0.9025974273681641, 0.9785714490073067, 0.9857142993382045, 0.9857142899717604, 1.0, 0.9785714302744184, 0.9642857296126229, 0.9870129908834185, 1.0, 1.0, 1.0, 0.9841269888575115, 1.0, 0.9928571428571429, 1.0, 0.9214285739830562, 0.9928571496691022, 0.9857142899717604, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9928571428571429, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], 'val_acc': [0.36363636634566565, 0.5064935084287222, 0.467532468693597, 0.6623376654340075, 0.7012987051691327, 0.6103896243231637, 0.701298713684082, 0.6883117022452416, 0.6493506617360301, 0.688311700697069, 0.6103896142600419, 0.6103896165823007, 0.6753246869359698, 0.6883116929562061, 0.7012987129099957, 0.6233766280211411, 0.6883116914080335, 0.6623376747230431, 0.6623376654340075, 0.675324687710056, 0.7272727388840217, 0.6623376654340075, 0.6623376669821801, 0.701298713684082, 0.701298713684082, 0.7402597510969484, 0.6493506547692535, 0.7272727381099354, 0.7142857251229224, 0.7142857258970087, 0.6623376747230431, 0.6883117022452416, 0.7142857173820595, 0.6623376747230431, 0.6753246784210205, 0.7012987121359094, 0.6233766373101767, 0.6233766280211411, 0.688311700697069, 0.6363636417822405, 0.6363636394599815, 0.6753246791951069, 0.6233766287952275, 0.6493506524469945, 0.6363636417822405, 0.6363636410081541, 0.6623376654340075, 0.6883116914080335, 0.6493506524469945, 0.6233766287952275, 0.6493506539951671, 0.6753246791951069, 0.6883116914080335, 0.6493506524469945, 0.6623376654340075, 0.7012987121359094, 0.6233766287952275, 0.6363636502971897, 0.5974026020471151, 0.5584415603767742, 0.5714285760730892, 0.5974026028212015, 0.5974026012730289, 0.6233766272470549]}}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 6)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 4)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 4) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 5) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (3, 0, 4) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (3, 0, 4)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 231, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00019617278771447301, 'unfreeze_percentage': 0.135499822220912, 'rotation_range': 0, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 80, 'batch_size': 29, 'learning_rate': 0.0016697798575034067, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:25:32.056156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 4.4131 - acc: 0.1603 - val_loss: 2.5801 - val_acc: 0.0625
Epoch 2/8
 - 4s - loss: 2.1117 - acc: 0.3224 - val_loss: 2.7638 - val_acc: 0.0781
Epoch 3/8
 - 4s - loss: 1.3670 - acc: 0.5517 - val_loss: 2.4873 - val_acc: 0.0781
Epoch 4/8
 - 4s - loss: 0.9023 - acc: 0.6693 - val_loss: 2.5057 - val_acc: 0.1094
Epoch 5/8
 - 4s - loss: 1.3554 - acc: 0.6138 - val_loss: 2.4161 - val_acc: 0.1094
Epoch 6/8
 - 4s - loss: 0.8572 - acc: 0.6746 - val_loss: 2.6944 - val_acc: 0.1250
Epoch 7/8
 - 4s - loss: 0.4969 - acc: 0.8276 - val_loss: 2.6079 - val_acc: 0.0938
Epoch 8/8
 - 4s - loss: 0.3071 - acc: 0.9349 - val_loss: 2.7919 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (3, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (3, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (3, 0, 4)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 231, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00019617278771447301, 'unfreeze_percentage': 0.135499822220912, 'rotation_range': 0, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 80, 'batch_size': 29, 'learning_rate': 0.0016697798575034067, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.890625, 'info': {'runtime': 36.98325538635254, 'histories': {'loss': [4.490229056293803, 2.134853318221587, 1.366999351978302, 0.9486129549909229, 1.355414342880249, 0.8545824253469482, 0.4969405770301819, 0.3093326838055918], 'val_loss': [2.580090641975403, 2.7637816667556763, 2.4873034954071045, 2.5057311058044434, 2.416098117828369, 2.6943607330322266, 2.6078827381134033, 2.7918699979782104], 'acc': [0.15037593856117779, 0.3157894693146971, 0.5517241299152374, 0.6446281095181615, 0.6137930929660798, 0.6766917257380665, 0.8275861978530884, 0.9338842861908526], 'val_acc': [0.0625, 0.078125, 0.078125, 0.109375, 0.109375, 0.125, 0.09375, 0.109375]}}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 4)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 5)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 5) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 6) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 5) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (3, 0, 5) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (3, 0, 5)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 164, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0006829789747829218, 'unfreeze_percentage': 0.06839046497247302, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 243, 'batch_size': 47, 'num_dense_units_2': 36, 'learning_rate': 0.0017843056249211683, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:26:09.917143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 6s - loss: 2.3517 - acc: 0.0824 - val_loss: 2.3687 - val_acc: 0.1250
Epoch 2/8
 - 4s - loss: 2.3146 - acc: 0.1228 - val_loss: 2.3437 - val_acc: 0.0312
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/8
 - 4s - loss: 2.3146 - acc: 0.1453 - val_loss: 2.3389 - val_acc: 0.1250
Epoch 4/8
 - 4s - loss: 2.3238 - acc: 0.1064 - val_loss: 2.3289 - val_acc: 0.0938
Epoch 5/8
 - 4s - loss: 2.3058 - acc: 0.1453 - val_loss: 2.2947 - val_acc: 0.0625
Epoch 6/8
 - 4s - loss: 2.2996 - acc: 0.1135 - val_loss: 2.3663 - val_acc: 0.0312
Epoch 7/8
 - 4s - loss: 2.3115 - acc: 0.1546 - val_loss: 2.3198 - val_acc: 0.0312
Epoch 8/8
 - 4s - loss: 2.3125 - acc: 0.1406 - val_loss: 2.3390 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (3, 0, 5), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (3, 0, 5) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 5) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 5) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (3, 0, 5)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 164, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0006829789747829218, 'unfreeze_percentage': 0.06839046497247302, 'rotation_range': 0, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 243, 'batch_size': 47, 'num_dense_units_2': 36, 'learning_rate': 0.0017843056249211683, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 39.185218334198, 'histories': {'loss': [2.329514117862867, 2.3196515021116837, 2.3204211877739946, 2.3238348166147866, 2.311032674623572, 2.2995553016662598, 2.3063266360241435, 2.306096058306487], 'val_loss': [2.3686869144439697, 2.343749523162842, 2.3389434814453125, 2.3288698196411133, 2.2946953773498535, 2.3663039207458496, 2.3197672367095947, 2.3389573097229004], 'acc': [0.09565217469049536, 0.10434782929394557, 0.13043478879591694, 0.10638298218448956, 0.13043478879591694, 0.1134751761953036, 0.15652173692765442, 0.14782609000154165], 'val_acc': [0.125, 0.03125, 0.125, 0.09375, 0.0625, 0.03125, 0.03125, 0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 5)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 6)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 6) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 7) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (3, 0, 6) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (3, 0, 6)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 508, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004365917628587319, 'unfreeze_percentage': 0.18961087843354732, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 358, 'batch_size': 53, 'learning_rate': 0.008056993996710215, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 15:26:53.647567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 8s - loss: 6.4408 - acc: 0.2343 - val_loss: 14.0738 - val_acc: 0.0938
Epoch 2/8
 - 5s - loss: 10.3802 - acc: 0.1768 - val_loss: 13.3341 - val_acc: 0.0625
Epoch 3/8
 - 5s - loss: 13.4407 - acc: 0.0629 - val_loss: 12.9388 - val_acc: 0.0938
Epoch 4/8
 - 5s - loss: 12.0790 - acc: 0.0701 - val_loss: 11.6070 - val_acc: 0.0625
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 5/8
 - 5s - loss: 11.1872 - acc: 0.1195 - val_loss: 16.1181 - val_acc: 0.0000e+00
Epoch 6/8
 - 4s - loss: 11.3016 - acc: 0.1323 - val_loss: 11.6393 - val_acc: 0.0938
Epoch 7/8
 - 5s - loss: 10.8865 - acc: 0.0491 - val_loss: 11.2710 - val_acc: 0.1562
Epoch 8/8
 - 5s - loss: 10.8630 - acc: 0.1132 - val_loss: 10.1736 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (3, 0, 6), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (3, 0, 6) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 6) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (3, 0, 6)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 508, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004365917628587319, 'unfreeze_percentage': 0.18961087843354732, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 358, 'batch_size': 53, 'learning_rate': 0.008056993996710215, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.875, 'info': {'runtime': 54.675748348236084, 'histories': {'loss': [8.221611096771484, 12.719098915747546, 13.440662701924643, 10.832381659691487, 11.187159538269043, 11.138547072976323, 10.751298790677971, 10.862993876139322], 'val_loss': [14.073808670043945, 13.334131240844727, 12.938821792602539, 11.606979370117188, 16.11809539794922, 11.639276504516602, 11.271001815795898, 10.173633575439453], 'acc': [0.10091743296986326, 0.12844036902309558, 0.06289308269818623, 0.09174312063313406, 0.11949685712655385, 0.10169491702217166, 0.06422018444319384, 0.11320754885673523], 'val_acc': [0.09375, 0.0625, 0.09375, 0.0625, 0.0, 0.09375, 0.15625, 0.125]}}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 6)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 7)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 7) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 7) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 0) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (3, 0, 7) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (3, 0, 7)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 653, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0003346610085836167, 'unfreeze_percentage': 0.10477312005979701, 'rotation_range': 0, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 345, 'batch_size': 23, 'num_dense_units_2': 139, 'learning_rate': 0.008828482867237364, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:27:43.663458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 12.9211 - acc: 0.0760 - val_loss: 14.6528 - val_acc: 0.0909
Epoch 2/8
 - 4s - loss: 14.9951 - acc: 0.0697 - val_loss: 14.2342 - val_acc: 0.1169
Epoch 3/8
 - 4s - loss: 14.7165 - acc: 0.0870 - val_loss: 14.6528 - val_acc: 0.0909
Epoch 4/8
 - 4s - loss: 15.1747 - acc: 0.0585 - val_loss: 14.6528 - val_acc: 0.0909
Epoch 5/8
 - 4s - loss: 14.7165 - acc: 0.0870 - val_loss: 15.0715 - val_acc: 0.0649
Epoch 6/8
 - 4s - loss: 15.0972 - acc: 0.0633 - val_loss: 14.8621 - val_acc: 0.0779
Epoch 7/8
 - 4s - loss: 14.7909 - acc: 0.0823 - val_loss: 13.8155 - val_acc: 0.1429
Epoch 8/8
 - 4s - loss: 14.6888 - acc: 0.0887 - val_loss: 14.8621 - val_acc: 0.0779
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (3, 0, 7), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (3, 0, 7) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 7) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 7) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (3, 0, 7)
args: ()
kwargs: {'budget': 8.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 653, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0003346610085836167, 'unfreeze_percentage': 0.10477312005979701, 'rotation_range': 0, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 345, 'batch_size': 23, 'num_dense_units_2': 139, 'learning_rate': 0.008828482867237364, 'base_model': 'ResNet50', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.9220779211103142, 'info': {'runtime': 39.52272152900696, 'histories': {'loss': [12.486885516763591, 14.842562970497625, 14.716522216796875, 14.87824219923753, 14.716522216796875, 14.958520463902316, 14.61064782588602, 14.494690490283554], 'val_loss': [14.652813738042658, 14.23416230585668, 14.652813341710475, 14.6528140972187, 15.07146572757077, 14.862139912394735, 13.815510440182376, 14.862139553218693], 'acc': [0.08633093501059272, 0.0791366915051028, 0.08695652282663754, 0.07692307762355886, 0.08695652282663754, 0.07194244615036807, 0.09352517851608262, 0.10071942695289207], 'val_acc': [0.09090909139289484, 0.11688311785072475, 0.09090909139289484, 0.09090909090909091, 0.06493506493506493, 0.07792207840588186, 0.14285714285714285, 0.07792207888968579]}}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 7)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 0) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 0) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (4, 0, 0) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (4, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 118, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00020406519848999814, 'unfreeze_percentage': 0.20903848439021575, 'rotation_range': 0, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 166, 'batch_size': 34, 'learning_rate': 0.0008879745137915533, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 15:28:21.067703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 5s - loss: 2.5839 - acc: 0.0781 - val_loss: 2.4993 - val_acc: 0.0625
Epoch 2/16
 - 3s - loss: 2.5713 - acc: 0.0930 - val_loss: 2.4802 - val_acc: 0.0625
Epoch 3/16
 - 3s - loss: 2.5158 - acc: 0.0809 - val_loss: 2.4944 - val_acc: 0.0469
Epoch 4/16
 - 3s - loss: 2.5582 - acc: 0.0706 - val_loss: 2.4677 - val_acc: 0.0625
Epoch 5/16
 - 3s - loss: 2.4419 - acc: 0.0596 - val_loss: 2.4650 - val_acc: 0.0938
Epoch 6/16
 - 3s - loss: 2.4688 - acc: 0.1135 - val_loss: 2.4450 - val_acc: 0.0781
Epoch 7/16
 - 3s - loss: 2.5037 - acc: 0.0882 - val_loss: 2.4000 - val_acc: 0.0938
Epoch 8/16
 - 3s - loss: 2.4910 - acc: 0.1022 - val_loss: 2.4152 - val_acc: 0.0938
Epoch 9/16
 - 3s - loss: 2.3373 - acc: 0.1486 - val_loss: 2.4165 - val_acc: 0.0781
Epoch 10/16
 - 3s - loss: 2.3449 - acc: 0.0956 - val_loss: 2.3270 - val_acc: 0.1094
Epoch 11/16
 - 3s - loss: 2.3764 - acc: 0.1135 - val_loss: 2.3528 - val_acc: 0.0938
Epoch 12/16
 - 3s - loss: 2.2830 - acc: 0.1579 - val_loss: 2.3943 - val_acc: 0.1094
Epoch 13/16
 - 3s - loss: 2.2395 - acc: 0.1912 - val_loss: 2.3200 - val_acc: 0.0938
Epoch 14/16
 - 3s - loss: 2.2801 - acc: 0.1543 - val_loss: 2.3060 - val_acc: 0.1250
Epoch 15/16
 - 3s - loss: 2.2724 - acc: 0.1525 - val_loss: 2.3158 - val_acc: 0.1094
Epoch 16/16
 - 3s - loss: 2.2690 - acc: 0.1656 - val_loss: 2.2994 - val_acc: 0.1406
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (4, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (4, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (4, 0, 0)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 118, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00020406519848999814, 'unfreeze_percentage': 0.20903848439021575, 'rotation_range': 0, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 166, 'batch_size': 34, 'learning_rate': 0.0008879745137915533, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.859375, 'info': {'runtime': 56.27544164657593, 'histories': {'loss': [2.5794491060078144, 2.5688823834061623, 2.5157554149627686, 2.556818064302206, 2.4370103739202023, 2.465649578720331, 2.503680169582367, 2.489613015204668, 2.325150509675344, 2.344876766204834, 2.368429407477379, 2.282595105469227, 2.239529848098755, 2.2854399755597115, 2.2728468999266624, 2.267796128988266], 'val_loss': [2.499290943145752, 2.4802359342575073, 2.49437415599823, 2.4677261114120483, 2.465009927749634, 2.4449957609176636, 2.4000290632247925, 2.41523015499115, 2.4164806604385376, 2.327047824859619, 2.35282826423645, 2.3942928314208984, 2.319962501525879, 2.3060247898101807, 2.315795063972473, 2.2994112968444824], 'acc': [0.07812500081490725, 0.09375000186264515, 0.08088235463947058, 0.07031250128056854, 0.06250000072759576, 0.11718750168802217, 0.0882352963089943, 0.10156250291038305, 0.15000000596046448, 0.0955882384441793, 0.1171875026775524, 0.15625000663567334, 0.19117647223174572, 0.15625000558793545, 0.15625000407453626, 0.1718750023865141], 'val_acc': [0.0625, 0.0625, 0.046875, 0.0625, 0.09375, 0.078125, 0.09375, 0.09375, 0.078125, 0.109375, 0.09375, 0.109375, 0.09375, 0.125, 0.109375, 0.140625]}}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 0)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 0) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 3) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (3, 0, 0) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (3, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 488, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00018754597271603137, 'unfreeze_percentage': 0.013099967173404147, 'rotation_range': 0, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 122, 'batch_size': 25, 'learning_rate': 0.0012140875401190161, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 15:29:24.420651: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 7s - loss: 3.1637 - acc: 0.1149 - val_loss: 2.4308 - val_acc: 0.1299
Epoch 2/16
 - 6s - loss: 2.0318 - acc: 0.3221 - val_loss: 2.1422 - val_acc: 0.1169
Epoch 3/16
 - 6s - loss: 1.6881 - acc: 0.4549 - val_loss: 1.9764 - val_acc: 0.2468
Epoch 4/16
 - 6s - loss: 1.3840 - acc: 0.6047 - val_loss: 1.6845 - val_acc: 0.5195
Epoch 5/16
 - 6s - loss: 1.0950 - acc: 0.6650 - val_loss: 2.0522 - val_acc: 0.3766
Epoch 6/16
 - 6s - loss: 0.8857 - acc: 0.7867 - val_loss: 1.5084 - val_acc: 0.5325
Epoch 7/16
 - 6s - loss: 0.7409 - acc: 0.8322 - val_loss: 1.9997 - val_acc: 0.4156
Epoch 8/16
 - 6s - loss: 0.7461 - acc: 0.7855 - val_loss: 1.3542 - val_acc: 0.5584
Epoch 9/16
 - 6s - loss: 0.6174 - acc: 0.8131 - val_loss: 1.4064 - val_acc: 0.5325
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 10/16
 - 6s - loss: 0.4684 - acc: 0.8874 - val_loss: 1.1520 - val_acc: 0.6623
Epoch 11/16
 - 6s - loss: 0.2739 - acc: 0.9533 - val_loss: 1.1829 - val_acc: 0.6104
Epoch 12/16
 - 6s - loss: 0.2792 - acc: 0.9533 - val_loss: 1.5109 - val_acc: 0.5584
Epoch 13/16
 - 6s - loss: 0.3330 - acc: 0.9257 - val_loss: 1.0010 - val_acc: 0.6883
Epoch 14/16
 - 6s - loss: 0.1849 - acc: 0.9533 - val_loss: 1.2055 - val_acc: 0.6364
Epoch 15/16
 - 6s - loss: 0.1870 - acc: 0.9533 - val_loss: 1.0261 - val_acc: 0.7403
Epoch 16/16
 - 6s - loss: 0.1937 - acc: 0.9533 - val_loss: 0.8389 - val_acc: 0.7403
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (3, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (3, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (3, 0, 0)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 488, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00018754597271603137, 'unfreeze_percentage': 0.013099967173404147, 'rotation_range': 0, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 122, 'batch_size': 25, 'learning_rate': 0.0012140875401190161, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.259740247354879, 'info': {'runtime': 108.55369639396667, 'histories': {'loss': [3.1024763288289092, 2.0518214641696346, 1.7162388850302592, 1.3634726922877514, 1.0802959543075004, 0.8856715758641561, 0.7308260759297949, 0.7420492328866555, 0.5977655370740125, 0.44239683982229583, 0.27387400964895886, 0.2703103501431263, 0.3479691103209544, 0.1783006539309982, 0.18700137113531431, 0.18992775977745543], 'val_loss': [2.430774267617758, 2.1422184999887044, 1.9763568361084183, 1.684501313543939, 2.0521720477512906, 1.5083828994206019, 1.9997441675755885, 1.354239195972294, 1.4063895336993328, 1.1519581079483032, 1.1828817461992238, 1.5108924902878798, 1.0009518304428497, 1.2055286912174967, 1.0260609876025806, 0.838943160973586], 'acc': [0.12408758846730211, 0.32116786667900366, 0.43795618675921083, 0.6131386815631477, 0.6715328186532877, 0.7866666515668234, 0.8321167639572254, 0.7883211422140581, 0.8248175069363448, 0.9051094664274341, 0.95333331823349, 0.9562043617241573, 0.9197080187553907, 0.9562043617241573, 0.95333331823349, 0.9562043617241573], 'val_acc': [0.1298701303539338, 0.11688311736692082, 0.2467532472370507, 0.5194805248991236, 0.376623382816067, 0.5324675464010858, 0.4155844175196313, 0.5584415623119899, 0.5324675371120502, 0.6623376654340075, 0.6103896227749911, 0.5584415638601625, 0.6883116991488964, 0.6363636487490171, 0.7402597433560855, 0.740259752645121]}}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 0)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 3)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 3) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 1) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (3, 0, 3) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (3, 0, 3)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 2.1515347899531767e-05, 'unfreeze_percentage': 0.08351197676342967, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 71, 'batch_size': 24, 'learning_rate': 0.0013104844753106392, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:31:06.838885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 6s - loss: 2.3280 - acc: 0.1756 - val_loss: 2.2053 - val_acc: 0.2338
Epoch 2/16
 - 6s - loss: 1.8788 - acc: 0.3722 - val_loss: 2.0959 - val_acc: 0.2597
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/16
 - 6s - loss: 1.3979 - acc: 0.5549 - val_loss: 2.0563 - val_acc: 0.2078
Epoch 4/16
 - 5s - loss: 1.0237 - acc: 0.7195 - val_loss: 1.8740 - val_acc: 0.2727
Epoch 5/16
 - 6s - loss: 0.6285 - acc: 0.8194 - val_loss: 1.4154 - val_acc: 0.5455
Epoch 6/16
 - 6s - loss: 0.4686 - acc: 0.8583 - val_loss: 1.2750 - val_acc: 0.5325
Epoch 7/16
 - 5s - loss: 0.3783 - acc: 0.9161 - val_loss: 1.2010 - val_acc: 0.5844
Epoch 8/16
 - 6s - loss: 0.2898 - acc: 0.9421 - val_loss: 1.1142 - val_acc: 0.6364
Epoch 9/16
 - 6s - loss: 0.1936 - acc: 0.9651 - val_loss: 1.0812 - val_acc: 0.6234
Epoch 10/16
 - 5s - loss: 0.1148 - acc: 0.9860 - val_loss: 0.8994 - val_acc: 0.6753
Epoch 11/16
 - 6s - loss: 0.0634 - acc: 1.0000 - val_loss: 0.8456 - val_acc: 0.7013
Epoch 12/16
 - 6s - loss: 0.0613 - acc: 1.0000 - val_loss: 0.9475 - val_acc: 0.6753
Epoch 13/16
 - 5s - loss: 0.0605 - acc: 0.9910 - val_loss: 0.8835 - val_acc: 0.6623
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 14/16
 - 5s - loss: 0.0531 - acc: 0.9930 - val_loss: 0.8902 - val_acc: 0.6883
Epoch 15/16
 - 6s - loss: 0.0249 - acc: 1.0000 - val_loss: 0.7750 - val_acc: 0.7662
Epoch 16/16
 - 6s - loss: 0.0488 - acc: 0.9931 - val_loss: 0.8268 - val_acc: 0.6883
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (3, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (3, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (3, 0, 3)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 2.1515347899531767e-05, 'unfreeze_percentage': 0.08351197676342967, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 71, 'batch_size': 24, 'learning_rate': 0.0013104844753106392, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.31168829930293096, 'info': {'runtime': 93.9244921207428, 'histories': {'loss': [2.3292045178620713, 1.8793210413144983, 1.40728265306224, 1.0296585352524468, 0.6284669438997904, 0.46983507405156677, 0.38556811731794605, 0.2910477985506472, 0.19251009757104126, 0.11487838431544926, 0.06205803155899048, 0.06133077604075273, 0.057004848576110344, 0.05414974900043529, 0.024900843105886295, 0.048782621199886], 'val_loss': [2.2052876515821977, 2.09592452296963, 2.0562728101556953, 1.8740011051103667, 1.4154061218360803, 1.2750052786492683, 1.2009610851089676, 1.1142359290804182, 1.0811944797441557, 0.8994274418075363, 0.8455924740085354, 0.9474958042045692, 0.8834595463492654, 0.8902202039570003, 0.7749739010612686, 0.8267780147589646], 'acc': [0.17391304412613745, 0.3695652290530827, 0.5507246437280074, 0.7173913095308386, 0.8194444676240286, 0.8550724853640017, 0.9130434886268948, 0.9420289967371069, 0.9637681297633959, 0.9855072601981785, 1.0, 1.0, 0.9927536197330641, 0.9927536300990892, 1.0, 0.9930555621782938], 'val_acc': [0.23376623918483783, 0.2597402624495618, 0.2077922077922078, 0.27272727891996307, 0.5454545466156749, 0.5324675378861365, 0.5844155890601022, 0.6363636402340679, 0.6233766264729685, 0.6753246784210205, 0.7012987059432191, 0.6753246784210205, 0.6623376762712156, 0.688311700697069, 0.766233778619147, 0.688311700697069]}}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 3)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 1)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 1) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 6) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 1) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (3, 0, 1) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (3, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 460, 'zoom_range': 0.0, 'cnn_learning_rate': 3.822232483478204e-05, 'unfreeze_percentage': 0.2790147253057443, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 476, 'batch_size': 42, 'learning_rate': 0.0028159105602947286, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:32:43.144739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/11
 - 5s - loss: 3.3483 - acc: 0.1145 - val_loss: 3.5222 - val_acc: 0.0625
Epoch 2/11
 - 4s - loss: 3.0116 - acc: 0.1746 - val_loss: 2.3866 - val_acc: 0.1875
Epoch 3/11
 - 4s - loss: 2.2817 - acc: 0.2531 - val_loss: 2.3740 - val_acc: 0.1250
Epoch 4/11
 - 4s - loss: 2.0635 - acc: 0.2962 - val_loss: 2.0304 - val_acc: 0.3125
Epoch 5/11
 - 4s - loss: 1.6430 - acc: 0.5476 - val_loss: 2.0875 - val_acc: 0.1875
Epoch 6/11
 - 4s - loss: 1.4067 - acc: 0.6437 - val_loss: 1.8860 - val_acc: 0.3438
Epoch 7/11
 - 4s - loss: 1.2647 - acc: 0.6315 - val_loss: 1.8588 - val_acc: 0.2500
Epoch 8/11
 - 4s - loss: 0.8522 - acc: 0.8192 - val_loss: 1.7837 - val_acc: 0.4062
Epoch 9/11
 - 4s - loss: 0.8766 - acc: 0.7319 - val_loss: 1.6312 - val_acc: 0.5000
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 10/11
 - 4s - loss: 0.6271 - acc: 0.8095 - val_loss: 1.5009 - val_acc: 0.5625
Epoch 11/11
 - 4s - loss: 0.4125 - acc: 0.9267 - val_loss: 1.8722 - val_acc: 0.4062
{'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 460, 'zoom_range': 0.0, 'cnn_learning_rate': 3.822232483478204e-05, 'unfreeze_percentage': 0.2790147253057443, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 476, 'batch_size': 42, 'learning_rate': 0.0028159105602947286, 'base_model': 'InceptionV3', 'activation': 'relu'}

 ****** InceptionV3 unfrozen 3 top blocks, cut_off after layer 228 ******
Epoch 1/5
 - 6s - loss: 0.2894 - acc: 0.9488 - val_loss: 1.6630 - val_acc: 0.4375
Epoch 2/5
 - 4s - loss: 0.3689 - acc: 0.9127 - val_loss: 1.7157 - val_acc: 0.4688
Epoch 3/5
 - 4s - loss: 0.4025 - acc: 0.9472 - val_loss: 1.5251 - val_acc: 0.5312
Epoch 4/5
 - 4s - loss: 0.3277 - acc: 0.9683 - val_loss: 1.5952 - val_acc: 0.4375
Epoch 5/5
 - 4s - loss: 0.3019 - acc: 0.9749 - val_loss: 1.4358 - val_acc: 0.5312
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (3, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (3, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 1) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (3, 0, 1)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 460, 'zoom_range': 0.0, 'cnn_learning_rate': 3.822232483478204e-05, 'unfreeze_percentage': 0.2790147253057443, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 476, 'batch_size': 42, 'learning_rate': 0.0028159105602947286, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.46875, 'info': {'runtime': 75.88958048820496, 'histories': {'loss': [3.3249909400939943, 3.011622349421183, 2.2687805891036987, 2.063339447975159, 1.642979343732198, 1.3948057651519776, 1.2655231833457947, 0.85438012778759, 0.8759970903396607, 0.6271120111147562, 0.42105990648269653, 0.2859628364443779, 0.36890728771686554, 0.404014085468493, 0.3276735842227936, 0.2996923178434372], 'val_loss': [3.5222058296203613, 2.3866147994995117, 2.3739519119262695, 2.0304110050201416, 2.0874924659729004, 1.8860092163085938, 1.8588213920593262, 1.7837249040603638, 1.6312158107757568, 1.5009284019470215, 1.8721966743469238, 1.663036584854126, 1.715682029724121, 1.525122880935669, 1.5952377319335938, 1.4357879161834717], 'acc': [0.11666666865348815, 0.1746031865477562, 0.25833334103226663, 0.3000000074505806, 0.5476190646489462, 0.6500000059604645, 0.6333333522081375, 0.8166666984558105, 0.7333333641290665, 0.8095238407452902, 0.9210526253047743, 0.9500000596046447, 0.9126984675725301, 0.9473684649718436, 0.968254009882609, 0.9750000357627868], 'val_acc': [0.0625, 0.1875, 0.125, 0.3125, 0.1875, 0.34375, 0.25, 0.40625, 0.5, 0.5625, 0.40625, 0.4375, 0.46875, 0.53125, 0.4375, 0.53125]}}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 1)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 6)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 6) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 1) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (3, 0, 6) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (3, 0, 6)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 508, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004365917628587319, 'unfreeze_percentage': 0.18961087843354732, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 358, 'batch_size': 53, 'learning_rate': 0.008056993996710215, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 15:34:03.349561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/11
 - 7s - loss: 7.7805 - acc: 0.0351 - val_loss: 7.6891 - val_acc: 0.0625
Epoch 2/11
 - 5s - loss: 6.0938 - acc: 0.0881 - val_loss: 5.9798 - val_acc: 0.0938
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/11
 - 5s - loss: 5.2811 - acc: 0.1277 - val_loss: 4.5856 - val_acc: 0.1250
Epoch 4/11
 - 5s - loss: 3.9237 - acc: 0.2118 - val_loss: 5.1942 - val_acc: 0.0625
Epoch 5/11
 - 5s - loss: 5.0092 - acc: 0.1006 - val_loss: 3.7165 - val_acc: 0.1250
Epoch 6/11
 - 5s - loss: 3.7855 - acc: 0.1627 - val_loss: 3.7213 - val_acc: 0.0938
Epoch 7/11
 - 5s - loss: 4.1857 - acc: 0.1698 - val_loss: 5.4699 - val_acc: 0.0938
Epoch 8/11
 - 5s - loss: 3.5384 - acc: 0.0771 - val_loss: 7.2099 - val_acc: 0.0000e+00
Epoch 9/11
 - 5s - loss: 4.6150 - acc: 0.0943 - val_loss: 3.9783 - val_acc: 0.0312
Epoch 10/11
 - 5s - loss: 5.1714 - acc: 0.0421 - val_loss: 5.3445 - val_acc: 0.1250
Epoch 11/11
 - 5s - loss: 3.9343 - acc: 0.0771 - val_loss: 4.9157 - val_acc: 0.0625
{'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 508, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004365917628587319, 'unfreeze_percentage': 0.18961087843354732, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 358, 'batch_size': 53, 'learning_rate': 0.008056993996710215, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}

 ****** InceptionResNetV2 unfrozen 8 top blocks, cut_off after layer 648 ******
Epoch 1/5
 - 8s - loss: 4.1563 - acc: 0.0421 - val_loss: 3.8556 - val_acc: 0.0938
Epoch 2/5
 - 6s - loss: 4.6612 - acc: 0.1006 - val_loss: 4.6969 - val_acc: 0.1250
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/5
 - 5s - loss: 3.6006 - acc: 0.2624 - val_loss: 5.5109 - val_acc: 0.0938
Epoch 4/5
 - 5s - loss: 5.3912 - acc: 0.0911 - val_loss: 4.1754 - val_acc: 0.0625
Epoch 5/5
 - 5s - loss: 5.0554 - acc: 0.0491 - val_loss: 4.1809 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (3, 0, 6), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (3, 0, 6) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 6) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (3, 0, 6)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 508, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0004365917628587319, 'unfreeze_percentage': 0.18961087843354732, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 358, 'batch_size': 53, 'learning_rate': 0.008056993996710215, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.875, 'info': {'runtime': 100.49519658088684, 'histories': {'loss': [6.6008565054027315, 6.093788146972656, 5.591817269631482, 4.361575973143271, 5.009195645650228, 4.432446821020283, 4.883061102770884, 3.8858593910112296, 4.615021626154582, 4.729690433642186, 4.378516118460839, 4.82396804083378, 4.66119368871053, 4.2075710012278424, 4.637677437668547, 4.257459889858141], 'val_loss': [7.689146995544434, 5.979799747467041, 4.5855607986450195, 5.194173336029053, 3.7164931297302246, 3.72133731842041, 5.4699296951293945, 7.2098588943481445, 3.9782752990722656, 5.3444929122924805, 4.915673732757568, 3.855553150177002, 4.696874141693115, 5.510934352874756, 4.175449371337891, 4.180916786193848], 'acc': [0.04587156031656703, 0.08805031577746074, 0.06422018457990174, 0.1743119293396626, 0.10062893231709798, 0.11009174489646877, 0.11926605695978217, 0.10091743269644746, 0.09433962404727936, 0.055045872379880435, 0.10091743269644746, 0.055045872379880435, 0.10062893231709798, 0.13761468122311687, 0.11926605682307427, 0.06422018444319384], 'val_acc': [0.0625, 0.09375, 0.125, 0.0625, 0.125, 0.09375, 0.09375, 0.0, 0.03125, 0.125, 0.0625, 0.09375, 0.125, 0.09375, 0.0625, 0.125]}}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 6)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 1)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 1) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 0) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 1) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (4, 0, 1) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (4, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 467, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005344690889043314, 'unfreeze_percentage': 0.21318420520138404, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 69, 'batch_size': 21, 'learning_rate': 0.0001510374918024039, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:35:40.123504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/11
 - 7s - loss: 2.3417 - acc: 0.1299 - val_loss: 2.2857 - val_acc: 0.1039
Epoch 2/11
 - 5s - loss: 2.1286 - acc: 0.2420 - val_loss: 2.2274 - val_acc: 0.1688
Epoch 3/11
 - 5s - loss: 1.9097 - acc: 0.3634 - val_loss: 2.1499 - val_acc: 0.2468
Epoch 4/11
 - 5s - loss: 1.7315 - acc: 0.5170 - val_loss: 2.0323 - val_acc: 0.2987
Epoch 5/11
 - 5s - loss: 1.7572 - acc: 0.4930 - val_loss: 1.9747 - val_acc: 0.3506
Epoch 6/11
 - 5s - loss: 1.4713 - acc: 0.7101 - val_loss: 1.8567 - val_acc: 0.3636
Epoch 7/11
 - 5s - loss: 1.3904 - acc: 0.7122 - val_loss: 1.7049 - val_acc: 0.4675
Epoch 8/11
 - 5s - loss: 1.1949 - acc: 0.7535 - val_loss: 1.6352 - val_acc: 0.4416
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 9/11
 - 5s - loss: 1.1237 - acc: 0.8424 - val_loss: 1.5734 - val_acc: 0.4545
Epoch 10/11
 - 5s - loss: 1.0027 - acc: 0.8561 - val_loss: 1.4871 - val_acc: 0.4545
Epoch 11/11
 - 5s - loss: 0.8595 - acc: 0.8492 - val_loss: 1.4104 - val_acc: 0.4675
{'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 467, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005344690889043314, 'unfreeze_percentage': 0.21318420520138404, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 69, 'batch_size': 21, 'learning_rate': 0.0001510374918024039, 'base_model': 'InceptionV3', 'activation': 'relu'}

 ****** InceptionV3 unfrozen 2 top blocks, cut_off after layer 248 ******
Epoch 1/5
 - 6s - loss: 0.7494 - acc: 0.9087 - val_loss: 1.3859 - val_acc: 0.4935
Epoch 2/5
 - 5s - loss: 0.6608 - acc: 0.9453 - val_loss: 1.3395 - val_acc: 0.5325
Epoch 3/5
 - 5s - loss: 0.5839 - acc: 0.9524 - val_loss: 1.2890 - val_acc: 0.5455
Epoch 4/5
 - 5s - loss: 0.5852 - acc: 0.9677 - val_loss: 1.2409 - val_acc: 0.5325
Epoch 5/5
 - 5s - loss: 0.5428 - acc: 0.9405 - val_loss: 1.1990 - val_acc: 0.5974
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (4, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (4, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 1) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (4, 0, 1)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 467, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005344690889043314, 'unfreeze_percentage': 0.21318420520138404, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 69, 'batch_size': 21, 'learning_rate': 0.0001510374918024039, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.40259739640471226, 'info': {'runtime': 89.05001330375671, 'histories': {'loss': [2.3420641472999084, 2.129122800015389, 1.9168767624713006, 1.7314743314470564, 1.7519801525359457, 1.4697174544030047, 1.3861343327988969, 1.2001783365898944, 1.116930959072519, 1.004047487644439, 0.8610499133454993, 0.750287931016151, 0.6644347842703474, 0.5839391563619886, 0.5840562648243375, 0.5417369210973699], 'val_loss': [2.2856941254107985, 2.2274019006010772, 2.149878662902039, 2.032342598035738, 1.9746640254924823, 1.856673203505479, 1.7048835181570672, 1.6351760842583396, 1.573387455630612, 1.4871284760438002, 1.4103981674491586, 1.3858545941191833, 1.3394729765978726, 1.2890181711741857, 1.2408661904273095, 1.1989904053799518], 'acc': [0.13475177944340605, 0.241134763873638, 0.3546099453530413, 0.5170068272522518, 0.49645392850358433, 0.7092199109970255, 0.7163121002785703, 0.751773106290939, 0.843971682355759, 0.8581560875507112, 0.8510638716373038, 0.9078014657852498, 0.9432624502384916, 0.9523809892790658, 0.9703704039255778, 0.9432624565794113], 'val_acc': [0.1038961038961039, 0.16883116979877671, 0.24675324946254878, 0.29870130489398905, 0.3506493560679547, 0.3636363690549677, 0.4675324737251579, 0.4415584469770456, 0.4545454572547566, 0.4545454599640586, 0.4675324694676833, 0.493506494667623, 0.5324675378861365, 0.5454545485508906, 0.5324675378861365, 0.5974026035952877]}}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 1)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 0) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 3) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (3, 0, 0) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (3, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 488, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00018754597271603137, 'unfreeze_percentage': 0.013099967173404147, 'rotation_range': 0, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 122, 'batch_size': 25, 'learning_rate': 0.0012140875401190161, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 15:37:13.436945: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/28
 - 9s - loss: 3.1890 - acc: 0.1008 - val_loss: 2.1678 - val_acc: 0.1688
Epoch 2/28
 - 6s - loss: 1.9988 - acc: 0.3632 - val_loss: 2.1269 - val_acc: 0.1948
Epoch 3/28
 - 6s - loss: 1.6566 - acc: 0.5428 - val_loss: 1.8925 - val_acc: 0.3377
Epoch 4/28
 - 6s - loss: 1.3718 - acc: 0.5667 - val_loss: 2.0126 - val_acc: 0.2857
Epoch 5/28
 - 5s - loss: 1.2668 - acc: 0.5913 - val_loss: 1.8301 - val_acc: 0.3636
Epoch 6/28
 - 6s - loss: 0.8250 - acc: 0.8067 - val_loss: 1.7216 - val_acc: 0.4805
Epoch 7/28
 - 6s - loss: 0.6644 - acc: 0.8255 - val_loss: 1.8080 - val_acc: 0.4156
Epoch 8/28
 - 6s - loss: 0.5848 - acc: 0.8384 - val_loss: 1.3322 - val_acc: 0.5325
Epoch 9/28
 - 6s - loss: 0.4724 - acc: 0.8925 - val_loss: 1.8559 - val_acc: 0.3896
Epoch 10/28
 - 6s - loss: 0.5302 - acc: 0.8722 - val_loss: 1.2605 - val_acc: 0.6104
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 11/28
 - 6s - loss: 0.3203 - acc: 0.9262 - val_loss: 1.1949 - val_acc: 0.5844
Epoch 12/28
 - 6s - loss: 0.2311 - acc: 0.9533 - val_loss: 1.3465 - val_acc: 0.5584
Epoch 13/28
 - 6s - loss: 0.1565 - acc: 0.9662 - val_loss: 1.1231 - val_acc: 0.6623
Epoch 14/28
 - 6s - loss: 0.1842 - acc: 0.9730 - val_loss: 1.3050 - val_acc: 0.6104
Epoch 15/28
 - 6s - loss: 0.1265 - acc: 0.9932 - val_loss: 1.2276 - val_acc: 0.5974
Epoch 16/28
 - 6s - loss: 0.1547 - acc: 0.9662 - val_loss: 0.9659 - val_acc: 0.6753
Epoch 17/28
 - 6s - loss: 0.1154 - acc: 0.9800 - val_loss: 1.0144 - val_acc: 0.7143
Epoch 18/28
 - 6s - loss: 0.1419 - acc: 0.9797 - val_loss: 1.1737 - val_acc: 0.6234
Epoch 19/28
 - 5s - loss: 0.1315 - acc: 0.9657 - val_loss: 1.1314 - val_acc: 0.6494
Epoch 20/28
 - 6s - loss: 0.0928 - acc: 1.0000 - val_loss: 0.9902 - val_acc: 0.6623
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 21/28
 - 6s - loss: 0.0737 - acc: 0.9932 - val_loss: 0.9535 - val_acc: 0.7143
Epoch 22/28
 - 6s - loss: 0.0588 - acc: 0.9933 - val_loss: 1.1318 - val_acc: 0.6234
Epoch 23/28
 - 6s - loss: 0.0624 - acc: 1.0000 - val_loss: 0.9417 - val_acc: 0.7013
Epoch 24/28
 - 5s - loss: 0.1139 - acc: 0.9801 - val_loss: 1.2195 - val_acc: 0.7273
Epoch 25/28
 - 6s - loss: 0.0381 - acc: 1.0000 - val_loss: 1.1893 - val_acc: 0.6234
Epoch 26/28
 - 6s - loss: 0.0421 - acc: 0.9933 - val_loss: 1.1632 - val_acc: 0.6623
Epoch 27/28
 - 6s - loss: 0.0561 - acc: 0.9865 - val_loss: 1.1009 - val_acc: 0.6494
Epoch 28/28
 - 6s - loss: 0.2215 - acc: 0.9403 - val_loss: 2.1969 - val_acc: 0.4416
{'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 488, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00018754597271603137, 'unfreeze_percentage': 0.013099967173404147, 'rotation_range': 0, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 122, 'batch_size': 25, 'learning_rate': 0.0012140875401190161, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}

 ****** InceptionResNetV2 no layers unfrozen
Epoch 1/4
 - 6s - loss: 0.2714 - acc: 0.9067 - val_loss: 1.1113 - val_acc: 0.6883
Epoch 2/4
 - 6s - loss: 0.1438 - acc: 0.9657 - val_loss: 1.0091 - val_acc: 0.6753
Epoch 3/4
 - 6s - loss: 0.1113 - acc: 0.9797 - val_loss: 1.0045 - val_acc: 0.7403
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/4
 - 6s - loss: 0.0563 - acc: 0.9865 - val_loss: 1.2031 - val_acc: 0.6883
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (3, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (3, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (3, 0, 0)
args: ()
kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 488, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00018754597271603137, 'unfreeze_percentage': 0.013099967173404147, 'rotation_range': 0, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 122, 'batch_size': 25, 'learning_rate': 0.0012140875401190161, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.31168830781788026, 'info': {'runtime': 204.3950855731964, 'histories': {'loss': [3.170594852336132, 2.0059441171423362, 1.6778157383856112, 1.371775249640147, 1.2181554922173101, 0.8249562879403433, 0.6592792255164933, 0.5892649501779653, 0.47594141960144043, 0.513866167869011, 0.30792447848476634, 0.23105392108360925, 0.16229771605155763, 0.17920131502795394, 0.1294926241801603, 0.15868344038289828, 0.11543594611187775, 0.13242842964012258, 0.13615237912463565, 0.09281647329529126, 0.0736917174373665, 0.058769116178154945, 0.06258399469138932, 0.10189744445585436, 0.03785453682398274, 0.042054311372339725, 0.055142781771991375, 0.17782703874102473, 0.2713844844450553, 0.14794405339465988, 0.1093156532975879, 0.057955547623390696], 'val_loss': [2.167794060397458, 2.126857754472014, 1.8925484434350746, 2.0126228115775366, 1.8301318434925822, 1.721560001373291, 1.8079617255693907, 1.3322157720466712, 1.8559223537321214, 1.2604904608293013, 1.1949238219818512, 1.3465090773322366, 1.123068593926244, 1.3050056246968058, 1.2275548368305356, 0.9659274274652655, 1.0143916421122365, 1.1737303888642943, 1.1314022819717209, 0.9902482621081463, 0.9534653626479112, 1.1318041364867966, 0.9417487731227627, 1.2195193860437963, 1.1893122567758931, 1.163219326502317, 1.100884146504588, 2.1968820683367842, 1.111346706167444, 1.0090962958026242, 1.0044770116929884, 1.203102984985748], 'acc': [0.10218977775886981, 0.37226276317217055, 0.5328466996659328, 0.5666666477918625, 0.6290322441247201, 0.8066666424274445, 0.8248175008453592, 0.8321167691780703, 0.8905109284568007, 0.8686131173676818, 0.9270072875231722, 0.95333331823349, 0.9635036300568685, 0.9708029040454949, 0.9927007260113737, 0.9635036409336285, 0.9799999892711639, 0.9781021780341211, 0.9596774097411863, 1.0, 0.9927007260113737, 0.9933333297570547, 1.0, 0.9838709653385224, 1.0, 0.9933333297570547, 0.9854014520227474, 0.9489051042682063, 0.9066666464010874, 0.9596773977241209, 0.9781021780341211, 0.9854014520227474], 'val_acc': [0.16883117154047086, 0.19480519577280267, 0.33766233959755343, 0.28571429113288976, 0.3636363690549677, 0.480519484389912, 0.4155844194548471, 0.5324675378861365, 0.38961039580308, 0.6103896158082145, 0.5844155875119296, 0.5584415646342488, 0.6623376731748705, 0.6103896142600419, 0.5974026004989426, 0.6753246892582286, 0.7142857173820595, 0.6233766295693137, 0.6493506539951671, 0.6623376739489568, 0.714285726671095, 0.6233766349879178, 0.701298713684082, 0.7272727303690725, 0.6233766272470549, 0.6623376654340075, 0.6493506539951671, 0.4415584469770456, 0.6883116999229828, 0.6753246784210205, 0.740259744904258, 0.6883116921821197]}}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 0)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 3)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 3) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (3, 0, 3) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (3, 0, 3)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 2.1515347899531767e-05, 'unfreeze_percentage': 0.08351197676342967, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 71, 'batch_size': 24, 'learning_rate': 0.0013104844753106392, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:40:31.803593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/24
 - 6s - loss: 2.2878 - acc: 0.1389 - val_loss: 2.0686 - val_acc: 0.3506
Epoch 2/24
 - 5s - loss: 1.5611 - acc: 0.4921 - val_loss: 2.1679 - val_acc: 0.2468
Epoch 3/24
 - 5s - loss: 1.0251 - acc: 0.7195 - val_loss: 1.7004 - val_acc: 0.4545
Epoch 4/24
 - 5s - loss: 0.5489 - acc: 0.8772 - val_loss: 2.2712 - val_acc: 0.3377
Epoch 5/24
 - 5s - loss: 0.5441 - acc: 0.8303 - val_loss: 1.2796 - val_acc: 0.5844
Epoch 6/24
 - 5s - loss: 0.2797 - acc: 0.9581 - val_loss: 1.9653 - val_acc: 0.4026
Epoch 7/24
 - 5s - loss: 0.3302 - acc: 0.8932 - val_loss: 1.3181 - val_acc: 0.6104
Epoch 8/24
 - 5s - loss: 0.2023 - acc: 0.9331 - val_loss: 1.1919 - val_acc: 0.6364
Epoch 9/24
 - 5s - loss: 0.0800 - acc: 0.9930 - val_loss: 1.4859 - val_acc: 0.5974
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 10/24
 - 5s - loss: 0.0785 - acc: 0.9931 - val_loss: 1.2926 - val_acc: 0.6623
Epoch 11/24
 - 5s - loss: 0.0776 - acc: 0.9860 - val_loss: 1.1308 - val_acc: 0.6234
Epoch 12/24
 - 5s - loss: 0.0717 - acc: 0.9860 - val_loss: 1.1279 - val_acc: 0.7273
Epoch 13/24
 - 5s - loss: 0.0474 - acc: 1.0000 - val_loss: 1.0910 - val_acc: 0.7403
Epoch 14/24
 - 5s - loss: 0.0422 - acc: 0.9930 - val_loss: 1.0487 - val_acc: 0.6753
Epoch 15/24
 - 5s - loss: 0.0471 - acc: 0.9860 - val_loss: 1.0855 - val_acc: 0.6883
Epoch 16/24
 - 5s - loss: 0.0295 - acc: 1.0000 - val_loss: 0.9537 - val_acc: 0.7662
Epoch 17/24
 - 5s - loss: 0.0198 - acc: 1.0000 - val_loss: 1.0767 - val_acc: 0.6494
Epoch 18/24
 - 5s - loss: 0.0221 - acc: 1.0000 - val_loss: 0.8532 - val_acc: 0.7403
Epoch 19/24
 - 5s - loss: 0.0143 - acc: 1.0000 - val_loss: 0.8249 - val_acc: 0.8052
Epoch 20/24
 - 5s - loss: 0.0276 - acc: 0.9930 - val_loss: 0.7735 - val_acc: 0.7532
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 21/24
 - 5s - loss: 0.0415 - acc: 0.9910 - val_loss: 0.8622 - val_acc: 0.7662
Epoch 22/24
 - 5s - loss: 0.0098 - acc: 1.0000 - val_loss: 1.3225 - val_acc: 0.6623
Epoch 23/24
 - 5s - loss: 0.0326 - acc: 0.9930 - val_loss: 0.9721 - val_acc: 0.7792
Epoch 24/24
 - 5s - loss: 0.0336 - acc: 1.0000 - val_loss: 0.8665 - val_acc: 0.7662
{'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 2.1515347899531767e-05, 'unfreeze_percentage': 0.08351197676342967, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 71, 'batch_size': 24, 'learning_rate': 0.0013104844753106392, 'base_model': 'Xception', 'activation': 'relu'}

 ****** Xception unfrozen 1 top blocks, cut_off after layer 125 ******
Epoch 1/8
 - 6s - loss: 0.0118 - acc: 1.0000 - val_loss: 0.8760 - val_acc: 0.7662
Epoch 2/8
 - 5s - loss: 0.0165 - acc: 1.0000 - val_loss: 0.8844 - val_acc: 0.7662
Epoch 3/8
 - 6s - loss: 0.0096 - acc: 1.0000 - val_loss: 0.8899 - val_acc: 0.7662
Epoch 4/8
 - 6s - loss: 0.0116 - acc: 1.0000 - val_loss: 0.8957 - val_acc: 0.7532
Epoch 5/8
 - 5s - loss: 0.0281 - acc: 0.9930 - val_loss: 0.8994 - val_acc: 0.7532
Epoch 6/8
 - 5s - loss: 0.0110 - acc: 1.0000 - val_loss: 0.9058 - val_acc: 0.7403
Epoch 7/8
 - 6s - loss: 0.0129 - acc: 1.0000 - val_loss: 0.9145 - val_acc: 0.7403
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/8
 - 6s - loss: 0.0163 - acc: 1.0000 - val_loss: 0.9212 - val_acc: 0.7403
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (3, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (3, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (3, 0, 3)
args: ()
kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 2.1515347899531767e-05, 'unfreeze_percentage': 0.08351197676342967, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 71, 'batch_size': 24, 'learning_rate': 0.0013104844753106392, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.259740247354879, 'info': {'runtime': 178.7660949230194, 'histories': {'loss': [2.2878061135609946, 1.5460918260657268, 1.0245241548704065, 0.5476607602575551, 0.5484470815762229, 0.27758656377377716, 0.33223443834677985, 0.1992916685083638, 0.07981556783551755, 0.07848474321266015, 0.07719388668951781, 0.07334474992492925, 0.047961032099050026, 0.04170861192371534, 0.04670327383538951, 0.029498173166876255, 0.020215101054181225, 0.022342680022120476, 0.014344115741550922, 0.02703212128709192, 0.038181412803090134, 0.00960684106077837, 0.033184557505275894, 0.03357955813407898, 0.011836041579954326, 0.017010440795936367, 0.00951228298894737, 0.011577387417977055, 0.026260691006546436, 0.011185701146883808, 0.012513717393512312, 0.016520927943613217], 'val_loss': [2.068638639016585, 2.1679133594810187, 1.7004371432514933, 2.2712266228415747, 1.2795765647640476, 1.9652589698890588, 1.3180512019566126, 1.1919309628474248, 1.4859474169743525, 1.2926167636722714, 1.1307868493067754, 1.1279062791304155, 1.091026332471278, 1.0486780854014608, 1.0854556839187424, 0.9536687259550218, 1.076661009293098, 0.8532483314538931, 0.8249449188059027, 0.773516113881941, 0.8621921763791667, 1.3225178617935676, 0.9721086009756311, 0.8664649477252713, 0.8760147079244837, 0.8843711119193536, 0.8898733180838746, 0.8957214339987024, 0.8993934474208138, 0.9058426223792039, 0.914533435524284, 0.9212215132527537], 'acc': [0.1388888948907455, 0.5000000207320504, 0.7173913198968639, 0.8768116235733032, 0.8260869565217391, 0.95652174949646, 0.8913043478260869, 0.9347826242446899, 0.9927536300990892, 0.9930555621782938, 0.9855072601981785, 0.9855072601981785, 1.0, 0.9927536300990892, 0.9855072498321533, 1.0, 1.0, 1.0, 1.0, 0.9927536300990892, 0.9927536197330641, 1.0, 0.9927536300990892, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9927536300990892, 1.0, 1.0, 1.0], 'val_acc': [0.35064935451978213, 0.2467532529459371, 0.45454545502925847, 0.3376623403716397, 0.5844155898341885, 0.40259740453261833, 0.6103896227749911, 0.6363636410081541, 0.5974026020471151, 0.6623376739489568, 0.6233766272470549, 0.727272739658108, 0.740259752645121, 0.6753246892582286, 0.6883117022452416, 0.7662337770709744, 0.6493506539951671, 0.7402597433560855, 0.8051948067429778, 0.7532467640839614, 0.766233778619147, 0.6623376669821801, 0.7792207908320736, 0.7662337801673196, 0.766233778619147, 0.766233778619147, 0.7662337693301114, 0.7532467640839614, 0.753246765632134, 0.740259752645121, 0.7402597433560855, 0.740259752645121]}}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 3)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 2)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 2) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 3) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (4, 0, 2) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (4, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 114, 'zoom_range': 0.0, 'cnn_learning_rate': 3.295786960481046e-05, 'unfreeze_percentage': 0.09463829058832203, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 332, 'batch_size': 22, 'learning_rate': 0.0009790460179349596, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 15:43:37.244116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 8s - loss: 2.3816 - acc: 0.0823 - val_loss: 2.3334 - val_acc: 0.1299
Epoch 2/16
 - 6s - loss: 2.3577 - acc: 0.0954 - val_loss: 2.3278 - val_acc: 0.1299
Epoch 3/16
 - 6s - loss: 2.3903 - acc: 0.0526 - val_loss: 2.3182 - val_acc: 0.1299
Epoch 4/16
 - 6s - loss: 2.3797 - acc: 0.0779 - val_loss: 2.3063 - val_acc: 0.1299
Epoch 5/16
 - 6s - loss: 2.3444 - acc: 0.0823 - val_loss: 2.2944 - val_acc: 0.1169
Epoch 6/16
 - 6s - loss: 2.3630 - acc: 0.0868 - val_loss: 2.2880 - val_acc: 0.1299
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 7/16
 - 6s - loss: 2.3129 - acc: 0.0519 - val_loss: 2.2820 - val_acc: 0.1299
Epoch 8/16
 - 6s - loss: 2.3058 - acc: 0.1317 - val_loss: 2.2769 - val_acc: 0.1299
Epoch 9/16
 - 6s - loss: 2.2935 - acc: 0.1118 - val_loss: 2.2698 - val_acc: 0.1299
Epoch 10/16
 - 6s - loss: 2.3024 - acc: 0.0954 - val_loss: 2.2620 - val_acc: 0.1429
Epoch 11/16
 - 6s - loss: 2.3106 - acc: 0.0789 - val_loss: 2.2576 - val_acc: 0.1299
Epoch 12/16
 - 6s - loss: 2.2871 - acc: 0.1429 - val_loss: 2.2550 - val_acc: 0.1429
Epoch 13/16
 - 6s - loss: 2.3302 - acc: 0.1086 - val_loss: 2.2570 - val_acc: 0.1299
Epoch 14/16
 - 6s - loss: 2.2768 - acc: 0.1633 - val_loss: 2.2572 - val_acc: 0.1429
Epoch 15/16
 - 6s - loss: 2.2912 - acc: 0.1448 - val_loss: 2.2558 - val_acc: 0.1688
Epoch 16/16
 - 6s - loss: 2.2692 - acc: 0.1039 - val_loss: 2.2549 - val_acc: 0.1558
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (4, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (4, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (4, 0, 2)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 114, 'zoom_range': 0.0, 'cnn_learning_rate': 3.295786960481046e-05, 'unfreeze_percentage': 0.09463829058832203, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 332, 'batch_size': 22, 'learning_rate': 0.0009790460179349596, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.8441558431882363, 'info': {'runtime': 109.32982397079468, 'histories': {'loss': [2.3879187447684154, 2.363276365825108, 2.3932614088058473, 2.379675967352731, 2.3394789831978935, 2.3331199827648343, 2.3128770078931535, 2.315065288543701, 2.2967227356774464, 2.3023496082850863, 2.3143079893929617, 2.287057706287929, 2.3303845473698206, 2.274981441951933, 2.288830246244158, 2.269184044429234], 'val_loss': [2.3334308971058237, 2.327810912937313, 2.318169949890731, 2.3063046220061065, 2.294421883372517, 2.2879685271870005, 2.2819563413595225, 2.2769405377375613, 2.2697640394235585, 2.261988534555807, 2.257616563276811, 2.254968497660253, 2.257022191951801, 2.2571727919888187, 2.2558269903257298, 2.2548672347873837], 'acc': [0.07857143070016588, 0.09285714541162764, 0.057142858845846994, 0.0779220802443368, 0.07857143070016588, 0.10317460624944597, 0.05194805349622454, 0.1214285746216774, 0.12142857504742487, 0.09285714541162764, 0.08571428826877049, 0.14285714711461747, 0.10714286012308938, 0.15873016014931693, 0.13571428933313914, 0.10389610486371177], 'val_acc': [0.12987012987012986, 0.1298701303539338, 0.12987013180534562, 0.1298701303539338, 0.11688311959241891, 0.12987013083773774, 0.12987013257943192, 0.12987012987012986, 0.12987013083773774, 0.1428571433409468, 0.1298701303539338, 0.1428571447923586, 0.12987013083773774, 0.14285714285714285, 0.16883116883116883, 0.15584415681176372]}}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 3)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 3) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 3) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (3, 0, 3) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (3, 0, 3)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 64.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 2.1515347899531767e-05, 'unfreeze_percentage': 0.08351197676342967, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 71, 'batch_size': 24, 'learning_rate': 0.0013104844753106392, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:45:20.005459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/24
 - 6s - loss: 2.2419 - acc: 0.1886 - val_loss: 2.1865 - val_acc: 0.2078
Epoch 2/24
 - 5s - loss: 1.6592 - acc: 0.4583 - val_loss: 2.1640 - val_acc: 0.1299
Epoch 3/24
 - 5s - loss: 1.0736 - acc: 0.7359 - val_loss: 1.6880 - val_acc: 0.3247
Epoch 4/24
 - 5s - loss: 0.8072 - acc: 0.8194 - val_loss: 1.6999 - val_acc: 0.3247
Epoch 5/24
 - 5s - loss: 0.6196 - acc: 0.8611 - val_loss: 1.6114 - val_acc: 0.3896
Epoch 6/24
 - 5s - loss: 0.4686 - acc: 0.8892 - val_loss: 1.2280 - val_acc: 0.5455
Epoch 7/24
 - 5s - loss: 0.4430 - acc: 0.8563 - val_loss: 1.4750 - val_acc: 0.4416
Epoch 8/24
 - 5s - loss: 0.2764 - acc: 0.9421 - val_loss: 1.0069 - val_acc: 0.6883
Epoch 9/24
 - 5s - loss: 0.1884 - acc: 0.9790 - val_loss: 1.1020 - val_acc: 0.5714
Epoch 10/24
 - 5s - loss: 0.1582 - acc: 0.9722 - val_loss: 0.9485 - val_acc: 0.6494
Epoch 11/24
 - 5s - loss: 0.1371 - acc: 0.9719 - val_loss: 0.8976 - val_acc: 0.6623
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 12/24
 - 5s - loss: 0.0994 - acc: 0.9930 - val_loss: 0.9226 - val_acc: 0.6623
Epoch 13/24
 - 5s - loss: 0.1004 - acc: 1.0000 - val_loss: 0.8436 - val_acc: 0.7403
Epoch 14/24
 - 5s - loss: 0.1538 - acc: 0.9511 - val_loss: 0.6643 - val_acc: 0.7662
Epoch 15/24
 - 5s - loss: 0.0933 - acc: 0.9591 - val_loss: 0.7749 - val_acc: 0.7403
Epoch 16/24
 - 5s - loss: 0.1092 - acc: 0.9860 - val_loss: 0.8048 - val_acc: 0.7143
Epoch 17/24
 - 5s - loss: 0.0655 - acc: 1.0000 - val_loss: 0.6709 - val_acc: 0.7792
Epoch 18/24
 - 5s - loss: 0.0246 - acc: 1.0000 - val_loss: 0.7579 - val_acc: 0.7662
Epoch 19/24
 - 5s - loss: 0.0271 - acc: 1.0000 - val_loss: 0.6414 - val_acc: 0.7532
Epoch 20/24
 - 5s - loss: 0.0316 - acc: 1.0000 - val_loss: 0.6232 - val_acc: 0.7922
Epoch 21/24
 - 5s - loss: 0.0208 - acc: 1.0000 - val_loss: 0.6051 - val_acc: 0.7792
Epoch 22/24
 - 5s - loss: 0.0175 - acc: 1.0000 - val_loss: 0.5967 - val_acc: 0.7922
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 23/24
 - 5s - loss: 0.0106 - acc: 1.0000 - val_loss: 0.5640 - val_acc: 0.7792
Epoch 24/24
 - 5s - loss: 0.0247 - acc: 1.0000 - val_loss: 0.6915 - val_acc: 0.7792
{'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 2.1515347899531767e-05, 'unfreeze_percentage': 0.08351197676342967, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 71, 'batch_size': 24, 'learning_rate': 0.0013104844753106392, 'base_model': 'Xception', 'activation': 'relu'}

 ****** Xception unfrozen 1 top blocks, cut_off after layer 125 ******
Epoch 1/40
 - 6s - loss: 0.0338 - acc: 0.9930 - val_loss: 0.6881 - val_acc: 0.7662
Epoch 2/40
 - 6s - loss: 0.0139 - acc: 1.0000 - val_loss: 0.6862 - val_acc: 0.7662
Epoch 3/40
 - 6s - loss: 0.0145 - acc: 1.0000 - val_loss: 0.6833 - val_acc: 0.7662
Epoch 4/40
 - 5s - loss: 0.0162 - acc: 1.0000 - val_loss: 0.6820 - val_acc: 0.7532
Epoch 5/40
 - 6s - loss: 0.0228 - acc: 1.0000 - val_loss: 0.6800 - val_acc: 0.7532
Epoch 6/40
 - 6s - loss: 0.0221 - acc: 1.0000 - val_loss: 0.6777 - val_acc: 0.7532
Epoch 7/40
 - 5s - loss: 0.0499 - acc: 0.9860 - val_loss: 0.6771 - val_acc: 0.7662
Epoch 8/40
 - 6s - loss: 0.0285 - acc: 1.0000 - val_loss: 0.6766 - val_acc: 0.7662
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 9/40
 - 6s - loss: 0.0175 - acc: 1.0000 - val_loss: 0.6775 - val_acc: 0.7662
Epoch 10/40
 - 6s - loss: 0.0280 - acc: 1.0000 - val_loss: 0.6791 - val_acc: 0.7662
Epoch 11/40
 - 6s - loss: 0.0207 - acc: 1.0000 - val_loss: 0.6811 - val_acc: 0.7792
Epoch 12/40
 - 6s - loss: 0.0147 - acc: 1.0000 - val_loss: 0.6838 - val_acc: 0.7792
Epoch 13/40
 - 5s - loss: 0.0208 - acc: 1.0000 - val_loss: 0.6839 - val_acc: 0.7792
Epoch 14/40
 - 5s - loss: 0.0237 - acc: 1.0000 - val_loss: 0.6876 - val_acc: 0.7792
Epoch 15/40
 - 6s - loss: 0.0242 - acc: 1.0000 - val_loss: 0.6909 - val_acc: 0.7792
Epoch 16/40
 - 6s - loss: 0.0218 - acc: 1.0000 - val_loss: 0.6915 - val_acc: 0.7662
Epoch 17/40
 - 6s - loss: 0.0231 - acc: 1.0000 - val_loss: 0.6934 - val_acc: 0.7662
Epoch 18/40
 - 6s - loss: 0.0154 - acc: 1.0000 - val_loss: 0.6930 - val_acc: 0.7662
Epoch 19/40
 - 6s - loss: 0.0184 - acc: 1.0000 - val_loss: 0.7004 - val_acc: 0.7662
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 20/40
 - 6s - loss: 0.0154 - acc: 1.0000 - val_loss: 0.7052 - val_acc: 0.7662
Epoch 21/40
 - 6s - loss: 0.0194 - acc: 1.0000 - val_loss: 0.7067 - val_acc: 0.7662
Epoch 22/40
 - 5s - loss: 0.0202 - acc: 1.0000 - val_loss: 0.7090 - val_acc: 0.7662
Epoch 23/40
 - 6s - loss: 0.0235 - acc: 0.9930 - val_loss: 0.7128 - val_acc: 0.7662
Epoch 24/40
 - 6s - loss: 0.0131 - acc: 1.0000 - val_loss: 0.7140 - val_acc: 0.7662
Epoch 25/40
 - 6s - loss: 0.0194 - acc: 1.0000 - val_loss: 0.7177 - val_acc: 0.7662
Epoch 26/40
 - 5s - loss: 0.0263 - acc: 0.9910 - val_loss: 0.7207 - val_acc: 0.7792
Epoch 27/40
 - 6s - loss: 0.0150 - acc: 1.0000 - val_loss: 0.7273 - val_acc: 0.7662
Epoch 28/40
 - 6s - loss: 0.0174 - acc: 1.0000 - val_loss: 0.7256 - val_acc: 0.7662
Epoch 29/40
 - 6s - loss: 0.0170 - acc: 1.0000 - val_loss: 0.7257 - val_acc: 0.7662
Epoch 30/40
 - 5s - loss: 0.0193 - acc: 1.0000 - val_loss: 0.7310 - val_acc: 0.7403
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 31/40
 - 6s - loss: 0.0352 - acc: 0.9930 - val_loss: 0.7351 - val_acc: 0.7403
Epoch 32/40
 - 6s - loss: 0.0172 - acc: 1.0000 - val_loss: 0.7312 - val_acc: 0.7403
Epoch 33/40
 - 6s - loss: 0.0146 - acc: 1.0000 - val_loss: 0.7341 - val_acc: 0.7403
Epoch 34/40
 - 6s - loss: 0.0134 - acc: 1.0000 - val_loss: 0.7330 - val_acc: 0.7403
Epoch 35/40
 - 6s - loss: 0.0432 - acc: 0.9930 - val_loss: 0.7358 - val_acc: 0.7403
Epoch 36/40
 - 6s - loss: 0.0157 - acc: 1.0000 - val_loss: 0.7392 - val_acc: 0.7273
Epoch 37/40
 - 5s - loss: 0.0220 - acc: 1.0000 - val_loss: 0.7405 - val_acc: 0.7403
Epoch 38/40
 - 6s - loss: 0.0179 - acc: 1.0000 - val_loss: 0.7409 - val_acc: 0.7403
Epoch 39/40
 - 6s - loss: 0.0166 - acc: 1.0000 - val_loss: 0.7411 - val_acc: 0.7403
Epoch 40/40
 - 5s - loss: 0.0218 - acc: 1.0000 - val_loss: 0.7413 - val_acc: 0.7532
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (3, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (3, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (3, 0, 3)
args: ()
kwargs: {'budget': 64.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 736, 'zoom_range': 0.0, 'cnn_learning_rate': 2.1515347899531767e-05, 'unfreeze_percentage': 0.08351197676342967, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 71, 'batch_size': 24, 'learning_rate': 0.0013104844753106392, 'base_model': 'Xception', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.2467532359160386, 'info': {'runtime': 357.4676625728607, 'histories': {'loss': [2.249261534732321, 1.6591699322064717, 1.074739846316251, 0.8081410086673239, 0.6195577482382456, 0.4625169194262961, 0.4450555029122726, 0.2750489517398503, 0.19221295351567474, 0.15818360323707262, 0.13765441998839378, 0.0991543032552885, 0.10037477562824886, 0.15575206538905267, 0.08835116806237595, 0.11200154945254326, 0.06518167127733646, 0.02457528638963898, 0.027475719947529877, 0.030865939576988636, 0.020371959747179695, 0.01749776878758617, 0.010573038598522544, 0.022961387326094238, 0.033166678055473, 0.013813948096788448, 0.014516443635026613, 0.01617354383184151, 0.022789760182301205, 0.02096917269670445, 0.05017986820767755, 0.027813422372159752, 0.017566260679260544, 0.026756804760383522, 0.020725857311238844, 0.014870253391563892, 0.020866241475397892, 0.023676240195830662, 0.02443137424795524, 0.02221277825858282, 0.02307644761774851, 0.015407708939164877, 0.018586813836641933, 0.01552253398720337, 0.018460618574982105, 0.019780978236509407, 0.0229762664631657, 0.01308590266853571, 0.0185780329224856, 0.024458324028687042, 0.015048756264150143, 0.016770659095567207, 0.016950460461278755, 0.01930712629109621, 0.03504411714232486, 0.017576769723192505, 0.014645275349418322, 0.013397957724721535, 0.043120130248691727, 0.015676433382474857, 0.020685648950545685, 0.01779378286522368, 0.016607863673319418, 0.020439858611842446], 'val_loss': [2.1865134517867846, 2.1639997339867927, 1.6880418789851201, 1.699937919517616, 1.6114156153294947, 1.22801952393024, 1.4749578067234583, 1.0069084949307627, 1.1019760308327613, 0.948456216168094, 0.897597880719544, 0.9226426582831841, 0.8435832680045784, 0.6642553450225236, 0.7749048417264764, 0.8048345732998539, 0.6708964124902502, 0.7579457376684461, 0.6414327799499809, 0.6231962628178782, 0.6051460113618281, 0.5967039365273017, 0.5639691399289416, 0.6915335376541336, 0.6881377124167108, 0.6862207457616731, 0.6832879379198149, 0.6820339784993754, 0.6800444296428135, 0.677746311410681, 0.67710229638335, 0.6766415935058099, 0.6775261426900888, 0.679086781941451, 0.6810802985708435, 0.683791851068472, 0.6839450303610269, 0.6875805460013352, 0.6909092324120658, 0.6915285556347339, 0.6933670740622979, 0.6930005937427669, 0.7004418651778976, 0.7052324638738261, 0.7066535020803476, 0.7089819257909601, 0.7127623821233774, 0.7140252512770814, 0.7176931167577768, 0.7207132237298148, 0.7272703152198297, 0.7256447692196091, 0.7257273367473057, 0.7309692943250978, 0.7351337528073942, 0.7311670021577314, 0.7340818179118169, 0.7330191758545962, 0.7357978820800781, 0.739214858451447, 0.7404885121754238, 0.7409337449383426, 0.7410712009900576, 0.7412896543354183], 'acc': [0.1811594263367031, 0.4583333407839139, 0.7348484884608876, 0.818840591803841, 0.8611111342906952, 0.8913043737411499, 0.8550724931385206, 0.9420289993286133, 0.9782608799312426, 0.9722222288449606, 0.9696969769217751, 0.9927536300990892, 1.0, 0.949275369229524, 0.9637681245803833, 0.9855072601981785, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9927536300990892, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9855072498321533, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9927536300990892, 1.0, 1.0, 0.9924242469397458, 1.0, 1.0, 1.0, 1.0, 0.9927536300990892, 1.0, 1.0, 1.0, 0.9927536300990892, 1.0, 1.0, 1.0, 1.0, 1.0], 'val_acc': [0.20779221050150984, 0.12987013257943192, 0.32467532661054044, 0.32467533086801503, 0.38961039231969163, 0.5454545500990632, 0.4415584469770456, 0.688311700697069, 0.5714285760730892, 0.6493506547692535, 0.6623376739489568, 0.6623376677562665, 0.7402597541932936, 0.766233778619147, 0.740259752645121, 0.7142857282192676, 0.7792207830912107, 0.7662337770709744, 0.7532467563430985, 0.7922077937559648, 0.7792207908320736, 0.7922077960782237, 0.7792207823171244, 0.7792207908320736, 0.7662337801673196, 0.7662337662337663, 0.7662337693301114, 0.7532467547949259, 0.7532467563430985, 0.7532467571171847, 0.766233778619147, 0.7662337801673196, 0.7662337677819389, 0.7662337677819389, 0.7792207792207793, 0.77922079160616, 0.77922079160616, 0.7792207908320736, 0.779220783865297, 0.766233778619147, 0.766233778619147, 0.7662337778450606, 0.766233778619147, 0.766233778619147, 0.766233778619147, 0.7662337693301114, 0.7662337778450606, 0.7662337693301114, 0.7662337778450606, 0.7792207823171244, 0.7662337693301114, 0.7662337662337663, 0.766233778619147, 0.7402597433560855, 0.7402597518710347, 0.7402597433560855, 0.7402597433560855, 0.7402597510969484, 0.740259752645121, 0.7272727303690725, 0.7402597418079129, 0.7402597518710347, 0.7402597433560855, 0.7532467640839614]}}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 3)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 3)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 3) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 4) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (4, 0, 3) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (4, 0, 3)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 112, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007188225912027243, 'unfreeze_percentage': 0.17797060122558875, 'rotation_range': 0, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 56, 'batch_size': 21, 'num_dense_units_2': 290, 'learning_rate': 0.0008234432258420813, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 15:51:23.348254: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/14
 - 7s - loss: 2.2825 - acc: 0.1210 - val_loss: 2.3176 - val_acc: 0.0909
Epoch 2/14
 - 6s - loss: 2.2702 - acc: 0.1347 - val_loss: 2.3199 - val_acc: 0.0909
Epoch 3/14
 - 6s - loss: 2.2752 - acc: 0.1361 - val_loss: 2.3231 - val_acc: 0.0909
Epoch 4/14
 - 6s - loss: 2.2716 - acc: 0.1262 - val_loss: 2.3275 - val_acc: 0.0909
Epoch 5/14
 - 6s - loss: 2.2570 - acc: 0.1737 - val_loss: 2.3284 - val_acc: 0.0909
Epoch 6/14
 - 6s - loss: 2.2739 - acc: 0.1156 - val_loss: 2.3289 - val_acc: 0.0779
Epoch 7/14
 - 6s - loss: 2.2753 - acc: 0.1850 - val_loss: 2.3279 - val_acc: 0.0909
Epoch 8/14
 - 6s - loss: 2.2588 - acc: 0.1552 - val_loss: 2.3275 - val_acc: 0.0909
Epoch 9/14
 - 6s - loss: 2.2466 - acc: 0.1692 - val_loss: 2.3227 - val_acc: 0.0779
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 10/14
 - 6s - loss: 2.2484 - acc: 0.1837 - val_loss: 2.3178 - val_acc: 0.1169
Epoch 11/14
 - 6s - loss: 2.2493 - acc: 0.1850 - val_loss: 2.3122 - val_acc: 0.1429
Epoch 12/14
 - 6s - loss: 2.2539 - acc: 0.1624 - val_loss: 2.3057 - val_acc: 0.1299
Epoch 13/14
 - 6s - loss: 2.2231 - acc: 0.1931 - val_loss: 2.3018 - val_acc: 0.1169
Epoch 14/14
 - 6s - loss: 2.2505 - acc: 0.1905 - val_loss: 2.2960 - val_acc: 0.1299
{'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 112, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007188225912027243, 'unfreeze_percentage': 0.17797060122558875, 'rotation_range': 0, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 56, 'batch_size': 21, 'num_dense_units_2': 290, 'learning_rate': 0.0008234432258420813, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}

 ****** InceptionResNetV2 unfrozen 7 top blocks, cut_off after layer 664 ******
Epoch 1/2
 - 9s - loss: 2.2218 - acc: 0.1805 - val_loss: 2.2807 - val_acc: 0.1039
Epoch 2/2
 - 6s - loss: 2.1742 - acc: 0.2557 - val_loss: 2.2497 - val_acc: 0.1299
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (4, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (4, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (4, 0, 3)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 112, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007188225912027243, 'unfreeze_percentage': 0.17797060122558875, 'rotation_range': 0, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 56, 'batch_size': 21, 'num_dense_units_2': 290, 'learning_rate': 0.0008234432258420813, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.8701298696460662, 'info': {'runtime': 114.30527400970459, 'histories': {'loss': [2.283241642282364, 2.2707225566214704, 2.2751899787357877, 2.2669321113162573, 2.259817787941466, 2.273915869849069, 2.2767914558978792, 2.263024218538974, 2.2501720012502466, 2.2484391757420132, 2.250193885032167, 2.256277693078873, 2.228502538469103, 2.250521421432495, 2.222584785299098, 2.175389234055864], 'val_loss': [2.3176174473452877, 2.319945025753665, 2.3230897668120147, 2.3275296037847344, 2.328439724909795, 2.3288691074817214, 2.3279071101894626, 2.327451043314748, 2.322725735701524, 2.3178311973423154, 2.3121962361521535, 2.305713223172473, 2.301830118352717, 2.2960037441996786, 2.280742069343468, 2.2496811012168982], 'acc': [0.12056737916266665, 0.1347517765899922, 0.13605442643165588, 0.1333333378036817, 0.1702127700790446, 0.11564626172184944, 0.18439717083535295, 0.156028373285811, 0.16312057398101118, 0.18367347866296768, 0.1843971719450139, 0.1560283769318398, 0.1925926051206059, 0.19047619934592927, 0.17730497045719879, 0.25531915908164166], 'val_acc': [0.09090909139289484, 0.09090909090909091, 0.09090909139289484, 0.09090909090909091, 0.09090909139289484, 0.07792207840588186, 0.09090909139289484, 0.09090909139289484, 0.07792207792207792, 0.11688311736692082, 0.14285714382475073, 0.12987012987012986, 0.11688311785072475, 0.1298701303539338, 0.10389610437990783, 0.1298701303539338]}}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 3)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 4)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 4) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 5) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (4, 0, 4) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (4, 0, 4)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 650, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001378479121671591, 'unfreeze_percentage': 0.21669903137384586, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 61, 'batch_size': 16, 'num_dense_units_2': 79, 'learning_rate': 0.0018855918373312658, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:53:11.577282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 5s - loss: 4.7394 - acc: 0.1198 - val_loss: 2.2474 - val_acc: 0.2294
Epoch 2/16
 - 4s - loss: 2.3766 - acc: 0.2604 - val_loss: 2.0931 - val_acc: 0.3853
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/16
 - 4s - loss: 1.8940 - acc: 0.3152 - val_loss: 2.0328 - val_acc: 0.2477
Epoch 4/16
 - 4s - loss: 1.5930 - acc: 0.4370 - val_loss: 2.3900 - val_acc: 0.2294
Epoch 5/16
 - 4s - loss: 2.1365 - acc: 0.4476 - val_loss: 1.6048 - val_acc: 0.5596
Epoch 6/16
 - 4s - loss: 1.3613 - acc: 0.5625 - val_loss: 1.3405 - val_acc: 0.5229
Epoch 7/16
 - 4s - loss: 1.6412 - acc: 0.4791 - val_loss: 0.9766 - val_acc: 0.7615
Epoch 8/16
 - 4s - loss: 1.1148 - acc: 0.5611 - val_loss: 0.7808 - val_acc: 0.7706
Epoch 9/16
 - 4s - loss: 1.2608 - acc: 0.5255 - val_loss: 0.6981 - val_acc: 0.7890
Epoch 10/16
 - 4s - loss: 0.7846 - acc: 0.7648 - val_loss: 3.4051 - val_acc: 0.2752
Epoch 11/16
 - 4s - loss: 0.9847 - acc: 0.7688 - val_loss: 0.6828 - val_acc: 0.8165
Epoch 12/16
 - 4s - loss: 0.6639 - acc: 0.8235 - val_loss: 0.8692 - val_acc: 0.6789
Epoch 13/16
 - 4s - loss: 0.6240 - acc: 0.7963 - val_loss: 1.9811 - val_acc: 0.5229
Epoch 14/16
 - 4s - loss: 0.9410 - acc: 0.6935 - val_loss: 0.8847 - val_acc: 0.7248
Epoch 15/16
 - 4s - loss: 0.4403 - acc: 0.8487 - val_loss: 0.8531 - val_acc: 0.6697
Epoch 16/16
 - 4s - loss: 0.8048 - acc: 0.7881 - val_loss: 4.5792 - val_acc: 0.2569
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (4, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (4, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (4, 0, 4)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 650, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001378479121671591, 'unfreeze_percentage': 0.21669903137384586, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 61, 'batch_size': 16, 'num_dense_units_2': 79, 'learning_rate': 0.0018855918373312658, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.743119261680393, 'info': {'runtime': 64.54851961135864, 'histories': {'loss': [4.874270034162966, 2.434374691688851, 1.8647799295921847, 1.6112857093549755, 2.1494497713977343, 1.361339521408081, 1.4688305593516728, 1.0548703376560995, 1.2217783991134528, 0.643744364176711, 0.9847316920757294, 0.6995086665839365, 0.6026984330725996, 0.7829512765962784, 0.4688943128471505, 0.451137025878854], 'val_loss': [2.2473602557401047, 2.0931477218592933, 2.0328343614525752, 2.3900315302227617, 1.604804811127689, 1.3405265381576819, 0.9765525520394701, 0.7807783194638174, 0.698113884400884, 3.4051356315612793, 0.682766016470183, 0.8692442309965781, 1.9810849089141285, 0.8846955498970976, 0.8531472994646895, 4.579219148793352], 'acc': [0.13013698630136986, 0.23972602739726026, 0.3424657534246575, 0.4315068493150685, 0.4863013698630137, 0.5625, 0.5205479452054794, 0.6095890410958904, 0.5303030303030303, 0.7876712328767124, 0.76875, 0.8082191780821918, 0.821917808219178, 0.7534246575342466, 0.8356164383561644, 0.8561643835616438], 'val_acc': [0.22935779816513763, 0.38532110474525244, 0.24770642270188814, 0.22935779884867713, 0.559633028616599, 0.5229357820038402, 0.7614678920955833, 0.7706422040221887, 0.7889908333437159, 0.27522935971207574, 0.8165137702171955, 0.6788990853029654, 0.5229357830975034, 0.7247706504043089, 0.6697247788446758, 0.25688073831960695]}}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 4)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 5)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 5) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 5) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 6) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (4, 0, 5) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (4, 0, 5)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 116, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0003908549705268679, 'unfreeze_percentage': 0.14212476663533763, 'rotation_range': 0, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 74, 'batch_size': 21, 'num_dense_units_2': 10, 'learning_rate': 0.0004510573834244099, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 15:54:23.651479: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 7s - loss: 2.4251 - acc: 0.0571 - val_loss: 2.3705 - val_acc: 0.1039
Epoch 2/16
 - 6s - loss: 2.4314 - acc: 0.0776 - val_loss: 2.3656 - val_acc: 0.0909
Epoch 3/16
 - 6s - loss: 2.3327 - acc: 0.1020 - val_loss: 2.3567 - val_acc: 0.1169
Epoch 4/16
 - 6s - loss: 2.3743 - acc: 0.1103 - val_loss: 2.3489 - val_acc: 0.1299
Epoch 5/16
 - 6s - loss: 2.4309 - acc: 0.0272 - val_loss: 2.3405 - val_acc: 0.1169
Epoch 6/16
 - 6s - loss: 2.4045 - acc: 0.0824 - val_loss: 2.3360 - val_acc: 0.1299
Epoch 7/16
 - 6s - loss: 2.3707 - acc: 0.0616 - val_loss: 2.3351 - val_acc: 0.0909
Epoch 8/16
 - 6s - loss: 2.3538 - acc: 0.1415 - val_loss: 2.3351 - val_acc: 0.0909
Epoch 9/16
 - 6s - loss: 2.3590 - acc: 0.0824 - val_loss: 2.3368 - val_acc: 0.1169
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 10/16
 - 6s - loss: 2.3694 - acc: 0.1073 - val_loss: 2.3417 - val_acc: 0.1429
Epoch 11/16
 - 6s - loss: 2.3493 - acc: 0.1005 - val_loss: 2.3468 - val_acc: 0.1299
Epoch 12/16
 - 6s - loss: 2.3273 - acc: 0.1347 - val_loss: 2.3542 - val_acc: 0.1299
Epoch 13/16
 - 6s - loss: 2.3506 - acc: 0.0884 - val_loss: 2.3621 - val_acc: 0.1169
Epoch 14/16
 - 6s - loss: 2.3344 - acc: 0.1826 - val_loss: 2.3664 - val_acc: 0.1169
Epoch 15/16
 - 6s - loss: 2.3246 - acc: 0.0913 - val_loss: 2.3704 - val_acc: 0.1169
Epoch 16/16
 - 6s - loss: 2.3307 - acc: 0.1528 - val_loss: 2.3703 - val_acc: 0.1169
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (4, 0, 5), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (4, 0, 5) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 5) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 5) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (4, 0, 5)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 116, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0003908549705268679, 'unfreeze_percentage': 0.14212476663533763, 'rotation_range': 0, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 74, 'batch_size': 21, 'num_dense_units_2': 10, 'learning_rate': 0.0004510573834244099, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.8831168831168831, 'info': {'runtime': 107.8243203163147, 'histories': {'loss': [2.419558438848942, 2.4265979908882302, 2.3326925550188338, 2.3729604880015054, 2.4308556147984097, 2.402862619846425, 2.3721891565525786, 2.3618091471651765, 2.3596453818869083, 2.3704849557673677, 2.347127092645523, 2.3251045612578696, 2.35055559022086, 2.329723652372969, 2.3240018296749034, 2.3304938509109174], 'val_loss': [2.3704552588524757, 2.365611946427977, 2.3567433790727095, 2.3489104215200847, 2.3405373932479265, 2.336015119181051, 2.3350902408748477, 2.3350818312013306, 2.3367547090951497, 2.3417197326561072, 2.3467874650831346, 2.3542320294813677, 2.3621348777374664, 2.366369408446473, 2.3703521072090448, 2.3703399199944037], 'acc': [0.05673759105674764, 0.07801418719773597, 0.10204082035592624, 0.1111111150847541, 0.02721088539276804, 0.07801418791108942, 0.063829788422965, 0.14184397752297687, 0.07801418735625897, 0.10638298118051062, 0.09929078357650879, 0.1347517765899922, 0.0884353763290814, 0.18439717035978398, 0.09219858407023106, 0.15602837471251793], 'val_acc': [0.10389610437990783, 0.09090909090909091, 0.11688311785072475, 0.12987013083773774, 0.11688311785072475, 0.1298701303539338, 0.09090909139289484, 0.09090909139289484, 0.11688311688311688, 0.14285714556644488, 0.12987013083773774, 0.12987013180534562, 0.11688311736692082, 0.11688311688311688, 0.11688311785072475, 0.11688311688311688]}}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 5)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 6)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 6) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 7) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (4, 0, 6) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (4, 0, 6)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 325, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001874418740072862, 'unfreeze_percentage': 0.05687047334882823, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 93, 'batch_size': 53, 'num_dense_units_2': 111, 'learning_rate': 0.00012637358558451002, 'base_model': 'InceptionV3', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 15:56:07.110518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 6s - loss: 2.4572 - acc: 0.1069 - val_loss: 2.3005 - val_acc: 0.1250
Epoch 2/16
 - 3s - loss: 2.1084 - acc: 0.3881 - val_loss: 2.3150 - val_acc: 0.1250
Epoch 3/16
 - 4s - loss: 2.0897 - acc: 0.3019 - val_loss: 2.2387 - val_acc: 0.1250
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/16
 - 4s - loss: 1.8247 - acc: 0.5303 - val_loss: 2.2080 - val_acc: 0.0625
Epoch 5/16
 - 4s - loss: 1.9493 - acc: 0.4587 - val_loss: 2.1561 - val_acc: 0.1875
Epoch 6/16
 - 4s - loss: 1.6464 - acc: 0.6284 - val_loss: 2.3769 - val_acc: 0.1250
Epoch 7/16
 - 4s - loss: 1.7766 - acc: 0.4214 - val_loss: 2.0392 - val_acc: 0.2500
Epoch 8/16
 - 4s - loss: 1.8863 - acc: 0.4111 - val_loss: 2.1182 - val_acc: 0.2500
Epoch 9/16
 - 4s - loss: 1.7247 - acc: 0.3365 - val_loss: 2.0235 - val_acc: 0.3125
Epoch 10/16
 - 4s - loss: 1.5120 - acc: 0.7044 - val_loss: 2.0063 - val_acc: 0.2812
Epoch 11/16
 - 4s - loss: 1.7776 - acc: 0.2734 - val_loss: 2.1070 - val_acc: 0.1562
Epoch 12/16
 - 4s - loss: 1.6093 - acc: 0.5468 - val_loss: 2.2989 - val_acc: 0.0312
Epoch 13/16
 - 4s - loss: 1.6521 - acc: 0.5078 - val_loss: 2.4707 - val_acc: 0.0938
Epoch 14/16
 - 4s - loss: 2.0066 - acc: 0.1192 - val_loss: 2.0397 - val_acc: 0.2812
Epoch 15/16
 - 4s - loss: 1.3370 - acc: 0.7358 - val_loss: 1.7769 - val_acc: 0.4688
Epoch 16/16
 - 4s - loss: 1.5337 - acc: 0.5889 - val_loss: 2.1982 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (4, 0, 6), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (4, 0, 6) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 6) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 6) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (4, 0, 6)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 325, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001874418740072862, 'unfreeze_percentage': 0.05687047334882823, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 93, 'batch_size': 53, 'num_dense_units_2': 111, 'learning_rate': 0.00012637358558451002, 'base_model': 'InceptionV3', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.875, 'info': {'runtime': 68.90606474876404, 'histories': {'loss': [2.457158168156942, 2.305592488434355, 2.089707533518473, 1.9826863490113424, 1.9389985526373628, 1.760300896583347, 1.7766478856404622, 1.908871069960638, 1.6916923599505642, 1.5120325883229573, 1.7308590477759684, 1.4380422797771768, 1.5909669224275362, 1.9197526109327965, 1.3369944890340169, 1.3015475295005587], 'val_loss': [2.30051851272583, 2.315031051635742, 2.238651990890503, 2.2080202102661133, 2.156064510345459, 2.376906633377075, 2.0392231941223145, 2.118218421936035, 2.0234670639038086, 2.006345272064209, 2.1070003509521484, 2.298877239227295, 2.470677614212036, 2.039701461791992, 1.7768810987472534, 2.198249578475952], 'acc': [0.10691824058691661, 0.28813559675620776, 0.30188679695129395, 0.3853210990035206, 0.394495426241411, 0.5137614678899083, 0.42138364414374035, 0.22935780841823017, 0.44036700802111844, 0.704402506351471, 0.3577981704692228, 0.7155963264474081, 0.4587156106846048, 0.15596331232184663, 0.7358490626017252, 0.770642213318326], 'val_acc': [0.125, 0.125, 0.125, 0.0625, 0.1875, 0.125, 0.25, 0.25, 0.3125, 0.28125, 0.15625, 0.03125, 0.09375, 0.28125, 0.46875, 0.125]}}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 6)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 7)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 7) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 7) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 5
DEBUG:hpbandster:HBMASTER: submitting job (5, 0, 0) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (4, 0, 7) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (4, 0, 7)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 821, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007256153050693646, 'unfreeze_percentage': 0.21959544578054416, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 74, 'batch_size': 41, 'learning_rate': 0.0032548066508563326, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:57:15.151914: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/10
 - 6s - loss: 3.5168 - acc: 0.1325 - val_loss: 3.8307 - val_acc: 0.1562
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/10
 - 4s - loss: 3.4682 - acc: 0.2641 - val_loss: 3.9549 - val_acc: 0.0625
Epoch 3/10
 - 4s - loss: 3.5279 - acc: 0.2602 - val_loss: 3.5453 - val_acc: 0.1250
Epoch 4/10
 - 4s - loss: 2.5122 - acc: 0.2396 - val_loss: 2.5341 - val_acc: 0.1250
Epoch 5/10
 - 4s - loss: 1.8038 - acc: 0.3407 - val_loss: 2.1681 - val_acc: 0.2500
Epoch 6/10
 - 4s - loss: 1.3966 - acc: 0.4959 - val_loss: 2.5942 - val_acc: 0.2188
Epoch 7/10
 - 4s - loss: 1.4099 - acc: 0.5105 - val_loss: 2.2264 - val_acc: 0.2500
Epoch 8/10
 - 4s - loss: 1.3973 - acc: 0.5209 - val_loss: 2.1450 - val_acc: 0.2812
Epoch 9/10
 - 4s - loss: 0.9441 - acc: 0.7154 - val_loss: 2.0304 - val_acc: 0.2812
Epoch 10/10
 - 4s - loss: 0.9161 - acc: 0.7256 - val_loss: 1.9618 - val_acc: 0.2500
{'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 821, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007256153050693646, 'unfreeze_percentage': 0.21959544578054416, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 74, 'batch_size': 41, 'learning_rate': 0.0032548066508563326, 'base_model': 'InceptionV3', 'activation': 'relu'}

 ****** InceptionV3 unfrozen 2 top blocks, cut_off after layer 248 ******
Epoch 1/6
 - 6s - loss: 0.5913 - acc: 0.9002 - val_loss: 1.8479 - val_acc: 0.3438
Epoch 2/6
 - 4s - loss: 0.5203 - acc: 0.9507 - val_loss: 1.8677 - val_acc: 0.3125
Epoch 3/6
 - 4s - loss: 0.6080 - acc: 0.8943 - val_loss: 1.5350 - val_acc: 0.4688
Epoch 4/6
 - 4s - loss: 0.5061 - acc: 0.9416 - val_loss: 1.6698 - val_acc: 0.4062
Epoch 5/6
 - 4s - loss: 0.4405 - acc: 1.0000 - val_loss: 1.6716 - val_acc: 0.3125
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 6/6
 - 4s - loss: 0.4045 - acc: 0.9660 - val_loss: 1.4959 - val_acc: 0.4062
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (4, 0, 7), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (4, 0, 7) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 7) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 7) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (4, 0, 7)
args: ()
kwargs: {'budget': 16.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 821, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007256153050693646, 'unfreeze_percentage': 0.21959544578054416, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 74, 'batch_size': 41, 'learning_rate': 0.0032548066508563326, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.59375, 'info': {'runtime': 76.1962890625, 'histories': {'loss': [3.531735081317996, 3.4708364600977624, 3.52787717183431, 2.5077677206559614, 1.804982410974739, 1.3965732256571453, 1.4068057152850568, 1.3985551832136043, 0.9440736571947733, 0.9128820832110633, 0.5902334712753611, 0.5203114481996899, 0.6080496509869894, 0.5056891589125326, 0.4405398865540822, 0.40357934652256366], 'val_loss': [3.830730676651001, 3.954906463623047, 3.5453124046325684, 2.534062623977661, 2.16811203956604, 2.5942277908325195, 2.2264037132263184, 2.1449813842773438, 2.030433177947998, 1.961756706237793, 1.847858190536499, 1.8676544427871704, 1.5349533557891846, 1.6698412895202637, 1.6716188192367554, 1.4958679676055908], 'acc': [0.13223140372717676, 0.26446279563194464, 0.2601625919342041, 0.23966942050240256, 0.3388429732362101, 0.49593496322631836, 0.5123966720478594, 0.5206611580099941, 0.7154471278190613, 0.7272727075687124, 0.900826435936384, 0.9504131822546652, 0.894308884938558, 0.9421487455525674, 1.0, 0.9663865566253662], 'val_acc': [0.15625, 0.0625, 0.125, 0.125, 0.25, 0.21875, 0.25, 0.28125, 0.28125, 0.25, 0.34375, 0.3125, 0.46875, 0.40625, 0.3125, 0.40625]}}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 7)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (5, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (5, 0, 0) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 1) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (5, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (5, 0, 0) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (5, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 642, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0006528266186253754, 'unfreeze_percentage': 0.02079087942910288, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 206, 'batch_size': 48, 'num_dense_units_2': 84, 'learning_rate': 0.00285146286413988, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 15:58:31.545173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/25
 - 6s - loss: 9.0945 - acc: 0.0975 - val_loss: 15.1107 - val_acc: 0.0625
Epoch 2/25
 - 4s - loss: 14.8869 - acc: 0.0764 - val_loss: 14.6070 - val_acc: 0.0938
Epoch 3/25
 - 4s - loss: 14.9045 - acc: 0.0753 - val_loss: 14.6070 - val_acc: 0.0938
Epoch 4/25
 - 4s - loss: 14.6659 - acc: 0.0901 - val_loss: 15.6144 - val_acc: 0.0312
Epoch 5/25
 - 4s - loss: 14.6659 - acc: 0.0901 - val_loss: 14.1033 - val_acc: 0.1250
Epoch 6/25
 - 4s - loss: 14.7646 - acc: 0.0840 - val_loss: 16.1181 - val_acc: 0.0000e+00
Epoch 7/25
 - 4s - loss: 14.9251 - acc: 0.0740 - val_loss: 15.1107 - val_acc: 0.0625
Epoch 8/25
 - 4s - loss: 14.4391 - acc: 0.1042 - val_loss: 14.1033 - val_acc: 0.1250
Epoch 9/25
 - 4s - loss: 14.5511 - acc: 0.0972 - val_loss: 14.6070 - val_acc: 0.0938
Epoch 10/25
 - 4s - loss: 15.8463 - acc: 0.0169 - val_loss: 14.6070 - val_acc: 0.0938
Epoch 11/25
 - 4s - loss: 13.8795 - acc: 0.1389 - val_loss: 15.6144 - val_acc: 0.0312
Epoch 12/25
 - 4s - loss: 14.9251 - acc: 0.0740 - val_loss: 15.6144 - val_acc: 0.0312
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 13/25
 - 4s - loss: 14.0076 - acc: 0.1309 - val_loss: 15.1107 - val_acc: 0.0625
Epoch 14/25
 - 4s - loss: 15.4023 - acc: 0.0444 - val_loss: 15.1107 - val_acc: 0.0625
Epoch 15/25
 - 4s - loss: 14.2153 - acc: 0.1181 - val_loss: 15.1107 - val_acc: 0.0625
Epoch 16/25
 - 4s - loss: 14.9045 - acc: 0.0753 - val_loss: 15.6144 - val_acc: 0.0312
Epoch 17/25
 - 4s - loss: 14.6453 - acc: 0.0914 - val_loss: 14.6070 - val_acc: 0.0938
Epoch 18/25
 - 4s - loss: 14.5466 - acc: 0.0975 - val_loss: 15.1107 - val_acc: 0.0625
Epoch 19/25
 - 4s - loss: 14.3861 - acc: 0.1075 - val_loss: 15.1107 - val_acc: 0.0625
Epoch 20/25
 - 4s - loss: 14.7749 - acc: 0.0833 - val_loss: 15.1107 - val_acc: 0.0625
Epoch 21/25
 - 4s - loss: 14.5511 - acc: 0.0972 - val_loss: 14.1033 - val_acc: 0.1250
Epoch 22/25
 - 4s - loss: 14.5466 - acc: 0.0975 - val_loss: 14.6070 - val_acc: 0.0938
Epoch 23/25
 - 4s - loss: 15.0238 - acc: 0.0679 - val_loss: 13.5996 - val_acc: 0.1562
Epoch 24/25
 - 4s - loss: 14.3861 - acc: 0.1075 - val_loss: 14.1033 - val_acc: 0.1250
Epoch 25/25
 - 4s - loss: 14.4067 - acc: 0.1062 - val_loss: 13.5996 - val_acc: 0.1562
{'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 642, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0006528266186253754, 'unfreeze_percentage': 0.02079087942910288, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 206, 'batch_size': 48, 'num_dense_units_2': 84, 'learning_rate': 0.00285146286413988, 'base_model': 'InceptionV3', 'activation': 'relu'}

 ****** InceptionV3 no layers unfrozen
Epoch 1/7
 - 4s - loss: 14.9045 - acc: 0.0753 - val_loss: 14.6070 - val_acc: 0.0938
Epoch 2/7
 - 4s - loss: 14.3272 - acc: 0.1111 - val_loss: 15.6144 - val_acc: 0.0312
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/7
 - 4s - loss: 14.6453 - acc: 0.0914 - val_loss: 14.1033 - val_acc: 0.1250
Epoch 4/7
 - 4s - loss: 14.7646 - acc: 0.0840 - val_loss: 13.5996 - val_acc: 0.1562
Epoch 5/7
 - 4s - loss: 14.6453 - acc: 0.0914 - val_loss: 15.1107 - val_acc: 0.0625
Epoch 6/7
 - 4s - loss: 14.3861 - acc: 0.1075 - val_loss: 14.6070 - val_acc: 0.0938
Epoch 7/7
 - 4s - loss: 14.7749 - acc: 0.0833 - val_loss: 15.6144 - val_acc: 0.0312
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (5, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (5, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (5, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (5, 0, 0) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (5, 0, 0)
args: ()
kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 642, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0006528266186253754, 'unfreeze_percentage': 0.02079087942910288, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 206, 'batch_size': 48, 'num_dense_units_2': 84, 'learning_rate': 0.00285146286413988, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.96875, 'info': {'runtime': 133.87087512016296, 'histories': {'loss': [8.536480953818874, 14.886852900187174, 14.84561488502904, 14.562841415405273, 14.562841415405273, 14.84561508580258, 14.704228049830386, 14.439127286275228, 14.551059087117514, 15.926213536943708, 13.87947146097819, 14.704227648283306, 14.280067644621196, 15.269775390625, 14.215265591939291, 14.84561488502904, 14.704227949443617, 14.42145468059339, 14.562841315018503, 14.774921099344889, 14.551058451334635, 14.42145427904631, 14.987002021388003, 14.562841565985428, 14.421455031947085, 14.845615135995965, 14.327196756998697, 14.704228350990697, 14.84561508580258, 14.704228350990697, 14.562841164438348, 14.774921735127768], 'val_loss': [15.110713958740234, 14.607023239135742, 14.607023239135742, 15.614404678344727, 14.103333473205566, 16.11809539794922, 15.110713958740234, 14.103333473205566, 14.607023239135742, 14.607023239135742, 15.614404678344727, 15.614404678344727, 15.110713958740234, 15.110713958740234, 15.110713958740234, 15.614404678344727, 14.607023239135742, 15.110713958740234, 15.110713958740234, 15.110713958740234, 14.103333473205566, 14.607023239135742, 13.59964370727539, 14.103333473205566, 13.59964370727539, 14.607024192810059, 15.614404678344727, 14.103333473205566, 13.59964370727539, 15.110713958740234, 14.607023239135742, 15.614404678344727], 'acc': [0.10526316005148385, 0.0763888917863369, 0.07894737057779964, 0.09649122918122693, 0.09649122918122693, 0.0789473695974601, 0.08771929929130956, 0.10416666915019353, 0.09722222636143367, 0.011904761993459292, 0.1388888955116272, 0.08771929929130956, 0.11403509268635198, 0.052631580515911706, 0.118055559694767, 0.07894737057779964, 0.08771930282053195, 0.10526316005148385, 0.09649123094583813, 0.08333333457509677, 0.09722222636143367, 0.10526316318857043, 0.07017543970754272, 0.09649123094583813, 0.10526316220823087, 0.07894736900925636, 0.11111111442248027, 0.08771929889917374, 0.07894737116600338, 0.08771929889917374, 0.09649123094583813, 0.08333333457509677], 'val_acc': [0.0625, 0.09375, 0.09375, 0.03125, 0.125, 0.0, 0.0625, 0.125, 0.09375, 0.09375, 0.03125, 0.03125, 0.0625, 0.0625, 0.0625, 0.03125, 0.09375, 0.0625, 0.0625, 0.0625, 0.125, 0.09375, 0.15625, 0.125, 0.15625, 0.09375, 0.03125, 0.125, 0.15625, 0.0625, 0.09375, 0.03125]}}}
exception: None

DEBUG:hpbandster:job_callback for (5, 0, 0)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 1)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 1) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 4) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 1) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (4, 0, 1) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (4, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 467, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005344690889043314, 'unfreeze_percentage': 0.21318420520138404, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 69, 'batch_size': 21, 'learning_rate': 0.0001510374918024039, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 16:00:45.524705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/11
 - 6s - loss: 2.3365 - acc: 0.1497 - val_loss: 2.2982 - val_acc: 0.0909
Epoch 2/11
 - 5s - loss: 2.1218 - acc: 0.2574 - val_loss: 2.2521 - val_acc: 0.1299
Epoch 3/11
 - 5s - loss: 1.9832 - acc: 0.4044 - val_loss: 2.1686 - val_acc: 0.2468
Epoch 4/11
 - 5s - loss: 1.8489 - acc: 0.5067 - val_loss: 2.1377 - val_acc: 0.2597
Epoch 5/11
 - 5s - loss: 1.6526 - acc: 0.7007 - val_loss: 2.0445 - val_acc: 0.2597
Epoch 6/11
 - 5s - loss: 1.6056 - acc: 0.5932 - val_loss: 1.9577 - val_acc: 0.3636
Epoch 7/11
 - 5s - loss: 1.3982 - acc: 0.7966 - val_loss: 1.8628 - val_acc: 0.4026
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/11
 - 5s - loss: 1.2955 - acc: 0.7693 - val_loss: 1.7835 - val_acc: 0.4545
Epoch 9/11
 - 5s - loss: 1.1590 - acc: 0.8058 - val_loss: 1.6925 - val_acc: 0.4416
Epoch 10/11
 - 5s - loss: 1.0347 - acc: 0.8503 - val_loss: 1.7031 - val_acc: 0.4416
Epoch 11/11
 - 5s - loss: 0.9810 - acc: 0.8629 - val_loss: 1.5096 - val_acc: 0.5195
{'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 467, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005344690889043314, 'unfreeze_percentage': 0.21318420520138404, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 69, 'batch_size': 21, 'learning_rate': 0.0001510374918024039, 'base_model': 'InceptionV3', 'activation': 'relu'}

 ****** InceptionV3 unfrozen 2 top blocks, cut_off after layer 248 ******
Epoch 1/21
 - 6s - loss: 0.8743 - acc: 0.8837 - val_loss: 1.4457 - val_acc: 0.5714
Epoch 2/21
 - 5s - loss: 0.7813 - acc: 0.9292 - val_loss: 1.4524 - val_acc: 0.5455
Epoch 3/21
 - 5s - loss: 0.7117 - acc: 0.9388 - val_loss: 1.4413 - val_acc: 0.5325
Epoch 4/21
 - 5s - loss: 0.6026 - acc: 0.9770 - val_loss: 1.3695 - val_acc: 0.5714
Epoch 5/21
 - 5s - loss: 0.5572 - acc: 0.9592 - val_loss: 1.3109 - val_acc: 0.6104
Epoch 6/21
 - 5s - loss: 0.4829 - acc: 0.9677 - val_loss: 1.2759 - val_acc: 0.6364
Epoch 7/21
 - 5s - loss: 0.3944 - acc: 0.9932 - val_loss: 1.2571 - val_acc: 0.6234
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/21
 - 5s - loss: 0.4133 - acc: 0.9795 - val_loss: 1.2266 - val_acc: 0.6494
Epoch 9/21
 - 5s - loss: 0.3327 - acc: 0.9932 - val_loss: 1.2044 - val_acc: 0.6883
Epoch 10/21
 - 5s - loss: 0.2818 - acc: 0.9932 - val_loss: 1.1975 - val_acc: 0.6883
Epoch 11/21
 - 5s - loss: 0.2471 - acc: 0.9931 - val_loss: 1.1863 - val_acc: 0.6883
Epoch 12/21
 - 5s - loss: 0.2547 - acc: 0.9932 - val_loss: 1.1573 - val_acc: 0.6753
Epoch 13/21
 - 5s - loss: 0.1938 - acc: 1.0000 - val_loss: 1.1491 - val_acc: 0.6883
Epoch 14/21
 - 5s - loss: 0.1972 - acc: 1.0000 - val_loss: 1.1380 - val_acc: 0.6753
Epoch 15/21
 - 5s - loss: 0.1576 - acc: 1.0000 - val_loss: 1.1384 - val_acc: 0.7143
Epoch 16/21
 - 5s - loss: 0.1675 - acc: 1.0000 - val_loss: 1.1367 - val_acc: 0.7013
Epoch 17/21
 - 5s - loss: 0.1567 - acc: 1.0000 - val_loss: 1.1294 - val_acc: 0.6883
Epoch 18/21
 - 5s - loss: 0.1257 - acc: 1.0000 - val_loss: 1.1277 - val_acc: 0.6883
Epoch 19/21
 - 5s - loss: 0.1566 - acc: 0.9907 - val_loss: 1.1208 - val_acc: 0.7013
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 20/21
 - 5s - loss: 0.1129 - acc: 1.0000 - val_loss: 1.1211 - val_acc: 0.7143
Epoch 21/21
 - 5s - loss: 0.1012 - acc: 1.0000 - val_loss: 1.1201 - val_acc: 0.7013
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (4, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (4, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 1) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (4, 0, 1)
args: ()
kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 467, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005344690889043314, 'unfreeze_percentage': 0.21318420520138404, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 69, 'batch_size': 21, 'learning_rate': 0.0001510374918024039, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.29870128631591797, 'info': {'runtime': 169.08493995666504, 'histories': {'loss': [2.3364801747458324, 2.116679726706611, 1.9892566204071045, 1.8460765924859555, 1.6525639636175973, 1.599192459532555, 1.3966267007462523, 1.2889208844367495, 1.1487299711146253, 1.0346991760390145, 0.9759961036925621, 0.877294400905041, 0.7742946858101702, 0.7116567151887077, 0.600572301281823, 0.5572403456483569, 0.4816188229454888, 0.3944486996957234, 0.414201613119308, 0.3307968276612302, 0.2817758002451488, 0.24254830181598663, 0.25470079481601715, 0.19285061749372076, 0.1948545473687192, 0.1554522048285667, 0.16413360707303312, 0.1539454235041395, 0.1256549826690129, 0.15134359267022873, 0.11288000856127058, 0.1001281497326303], 'val_loss': [2.2982322581402665, 2.2521175904707476, 2.1686180133324164, 2.137721365148371, 2.0445272984442773, 1.9576535596475972, 1.8627683404204134, 1.7834866882918716, 1.692486100382619, 1.7031496020106527, 1.5095811493985065, 1.4457330394100834, 1.4523609505071269, 1.4413387806384594, 1.36951875377011, 1.3108958114277234, 1.275875710821771, 1.2570856360646037, 1.2265601560666963, 1.2043822214200899, 1.1975154505147563, 1.1862728688623998, 1.1573312390934338, 1.149110664020885, 1.1380011168393223, 1.1384091160514138, 1.1366738351908596, 1.1293961583793937, 1.1276934595851156, 1.1207881500194599, 1.1211118465894228, 1.1200792541751614], 'acc': [0.1496598677975791, 0.2592592712905672, 0.3971631409640008, 0.5106383270405709, 0.7006803154945374, 0.6028369208599659, 0.8014184934027652, 0.773049700767436, 0.8085107093161725, 0.8503401620047433, 0.8652482768322559, 0.8794326579317133, 0.9290780513844592, 0.9387755564280919, 0.9777778042687311, 0.9591837014470782, 0.9703703946537442, 0.9931972878319877, 0.9787234321553656, 0.9929078107184552, 0.9931972878319877, 0.9925926023059422, 0.9931972878319877, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9925925996568468, 1.0, 1.0], 'val_acc': [0.09090909139289484, 0.12987013083773774, 0.24675324946254878, 0.2597402616754755, 0.2597402616754755, 0.36363636557157936, 0.4025974053067046, 0.4545454599640586, 0.4415584462029593, 0.4415584469770456, 0.5194805221898215, 0.5714285776212618, 0.5454545500990632, 0.532467533628662, 0.5714285768471755, 0.6103896150341281, 0.6363636410081541, 0.6233766264729685, 0.6493506524469945, 0.6883116921821197, 0.6883116937302923, 0.6883116914080335, 0.6753246784210205, 0.6883116937302923, 0.675324687710056, 0.7142857173820595, 0.7012987121359094, 0.688311700697069, 0.6883116991488964, 0.7012987043950465, 0.7142857173820595, 0.701298713684082]}}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 1)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 4)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 4) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (4, 0, 4) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (4, 0, 4)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 650, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001378479121671591, 'unfreeze_percentage': 0.21669903137384586, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 61, 'batch_size': 16, 'num_dense_units_2': 79, 'learning_rate': 0.0018855918373312658, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 16:03:32.826098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/24
 - 5s - loss: 4.6083 - acc: 0.1596 - val_loss: 2.2639 - val_acc: 0.1009
Epoch 2/24
 - 4s - loss: 2.2440 - acc: 0.2289 - val_loss: 2.4959 - val_acc: 0.1009
Epoch 3/24
 - 4s - loss: 2.1471 - acc: 0.3026 - val_loss: 2.1383 - val_acc: 0.2202
Epoch 4/24
 - 4s - loss: 1.8010 - acc: 0.2963 - val_loss: 2.0157 - val_acc: 0.3578
Epoch 5/24
 - 4s - loss: 2.0041 - acc: 0.3972 - val_loss: 1.7076 - val_acc: 0.3486
Epoch 6/24
 - 4s - loss: 1.2295 - acc: 0.5875 - val_loss: 1.5046 - val_acc: 0.3761
Epoch 7/24
 - 4s - loss: 1.5188 - acc: 0.4728 - val_loss: 2.2743 - val_acc: 0.2844
Epoch 8/24
 - 4s - loss: 0.8419 - acc: 0.7415 - val_loss: 1.0770 - val_acc: 0.6697
Epoch 9/24
 - 4s - loss: 0.6963 - acc: 0.7856 - val_loss: 1.5228 - val_acc: 0.5596
Epoch 10/24
 - 4s - loss: 1.0876 - acc: 0.6557 - val_loss: 2.0280 - val_acc: 0.4128
Epoch 11/24
 - 4s - loss: 1.4215 - acc: 0.6368 - val_loss: 1.0418 - val_acc: 0.7156
Epoch 12/24
 - 4s - loss: 0.4399 - acc: 0.8750 - val_loss: 1.5757 - val_acc: 0.5780
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 13/24
 - 4s - loss: 1.8186 - acc: 0.6975 - val_loss: 3.4306 - val_acc: 0.4587
Epoch 14/24
 - 4s - loss: 0.5357 - acc: 0.8487 - val_loss: 1.1917 - val_acc: 0.7064
Epoch 15/24
 - 4s - loss: 0.7819 - acc: 0.8089 - val_loss: 1.3586 - val_acc: 0.6606
Epoch 16/24
 - 4s - loss: 0.2219 - acc: 0.9559 - val_loss: 1.5281 - val_acc: 0.7248
Epoch 17/24
 - 4s - loss: 0.1535 - acc: 0.9688 - val_loss: 1.7410 - val_acc: 0.6239
Epoch 18/24
 - 4s - loss: 0.7500 - acc: 0.8487 - val_loss: 1.6169 - val_acc: 0.6697
Epoch 19/24
 - 4s - loss: 1.2457 - acc: 0.6746 - val_loss: 1.3639 - val_acc: 0.6697
Epoch 20/24
 - 4s - loss: 0.6868 - acc: 0.8404 - val_loss: 2.3471 - val_acc: 0.5321
Epoch 21/24
 - 4s - loss: 0.9191 - acc: 0.7262 - val_loss: 5.4114 - val_acc: 0.3486
Epoch 22/24
 - 4s - loss: 0.3352 - acc: 0.9125 - val_loss: 1.9994 - val_acc: 0.6147
Epoch 23/24
 - 4s - loss: 0.4208 - acc: 0.8467 - val_loss: 1.4102 - val_acc: 0.7156
Epoch 24/24
 - 5s - loss: 0.8988 - acc: 0.8322 - val_loss: 1.5679 - val_acc: 0.6881
{'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 650, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001378479121671591, 'unfreeze_percentage': 0.21669903137384586, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 61, 'batch_size': 16, 'num_dense_units_2': 79, 'learning_rate': 0.0018855918373312658, 'base_model': 'MobileNet', 'activation': 'relu'}

 ****** MobileNet unfrozen 5 top blocks, cut_off after layer 66 ******
Epoch 1/8
 - 5s - loss: 0.0666 - acc: 1.0000 - val_loss: 1.6134 - val_acc: 0.6330
Epoch 2/8
 - 4s - loss: 0.0172 - acc: 1.0000 - val_loss: 1.2792 - val_acc: 0.6972
Epoch 3/8
 - 4s - loss: 0.5019 - acc: 0.9013 - val_loss: 1.6103 - val_acc: 0.6422
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/8
 - 4s - loss: 0.0470 - acc: 0.9938 - val_loss: 1.4048 - val_acc: 0.6514
Epoch 5/8
 - 4s - loss: 0.1057 - acc: 1.0000 - val_loss: 1.2847 - val_acc: 0.6697
Epoch 6/8
 - 4s - loss: 0.0752 - acc: 1.0000 - val_loss: 1.2680 - val_acc: 0.6697
Epoch 7/8
 - 4s - loss: 0.0809 - acc: 0.9539 - val_loss: 1.4256 - val_acc: 0.6514
Epoch 8/8
 - 4s - loss: 0.0320 - acc: 1.0000 - val_loss: 1.3779 - val_acc: 0.6697
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (4, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (4, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (4, 0, 4)
args: ()
kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 650, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001378479121671591, 'unfreeze_percentage': 0.21669903137384586, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 61, 'batch_size': 16, 'num_dense_units_2': 79, 'learning_rate': 0.0018855918373312658, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.33027522060849246, 'info': {'runtime': 131.13737678527832, 'histories': {'loss': [4.706309550429044, 2.2664912138899713, 2.064444554995184, 1.7631935093500843, 1.809376109136294, 1.229497367143631, 1.4737124279753802, 0.9013097927178422, 0.7209820379949596, 0.9789889675297149, 1.1769363161635726, 0.4398700289428234, 1.8007428339033416, 0.5415394379668039, 0.6182489133860967, 0.2016528842792119, 0.15349711254239082, 0.7816142276541828, 1.0415540108942005, 0.6362743336860448, 0.6734836117336245, 0.33517846204340457, 0.4011765207125716, 0.4114750648198062, 0.025565262475650604, 0.017223165114410223, 0.10392119049687278, 0.0469879494048655, 0.03849404958421237, 0.02321394041857936, 0.028061052095400146, 0.03196717498358339], 'val_loss': [2.2639016842623367, 2.4958541108927594, 2.1383118410722926, 2.0156704438935726, 1.7075993883500404, 1.5045956963792853, 2.274268172202854, 1.0770246829461614, 1.5228331449928634, 2.0279973625043115, 1.0418017271461837, 1.5757215416759527, 3.4305548361682017, 1.191730863457426, 1.358605764327793, 1.5280773617805692, 1.7410029883778424, 1.6168927369861428, 1.3638602068664831, 2.347094732687014, 5.411431688781178, 1.999376480732489, 1.4102098198111999, 1.5679384327809744, 1.6133670631898653, 1.2792132491365484, 1.6102514737242952, 1.404794248965902, 1.2846749178860166, 1.268036907965984, 1.4256105029254877, 1.3779153736359482], 'acc': [0.13013698630136986, 0.2054794520547945, 0.3287671232876712, 0.3219178082191781, 0.4315068493150685, 0.5875, 0.5136986301369864, 0.7191780821917808, 0.7671232876712328, 0.7123287671232876, 0.6917808219178082, 0.875, 0.7348484848484849, 0.8356164383561644, 0.8356164383561644, 0.952054794520548, 0.96875, 0.8356164383561644, 0.7328767123287672, 0.8698630136986302, 0.8636363636363636, 0.9125, 0.8767123287671232, 0.9041095890410958, 1.0, 1.0, 0.9772727272727273, 0.99375, 1.0, 1.0, 0.9931506849315068, 1.0], 'val_acc': [0.10091743310657117, 0.10091743187620006, 0.22018348760561113, 0.3577981684186043, 0.3486238545780882, 0.37614679281864694, 0.2844036735525919, 0.6697247728295282, 0.5596330297102622, 0.4128440388845741, 0.715596333556219, 0.5779816541103048, 0.4587156001580964, 0.7064220270979296, 0.6605504609029228, 0.7247706509511406, 0.6238532142901639, 0.6697247728295282, 0.6697247728295282, 0.5321100931101983, 0.3486238570388304, 0.6146789012698952, 0.7155963324625557, 0.6880733966827393, 0.6330275251231062, 0.6972477091561764, 0.642201843611691, 0.6513761506168121, 0.6697247739231914, 0.6697247744700231, 0.6513761495231488, 0.6697247793915075]}}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 4)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 2)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 2) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 7) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (4, 0, 2) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (4, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 114, 'zoom_range': 0.0, 'cnn_learning_rate': 3.295786960481046e-05, 'unfreeze_percentage': 0.09463829058832203, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 332, 'batch_size': 22, 'learning_rate': 0.0009790460179349596, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 16:05:51.326317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/23
 - 8s - loss: 2.3622 - acc: 0.1217 - val_loss: 2.3864 - val_acc: 0.1039
Epoch 2/23
 - 6s - loss: 2.3659 - acc: 0.1020 - val_loss: 2.3677 - val_acc: 0.1039
Epoch 3/23
 - 6s - loss: 2.3781 - acc: 0.0723 - val_loss: 2.3472 - val_acc: 0.1039
Epoch 4/23
 - 6s - loss: 2.3497 - acc: 0.0789 - val_loss: 2.3317 - val_acc: 0.1039
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 5/23
 - 6s - loss: 2.2851 - acc: 0.1234 - val_loss: 2.3227 - val_acc: 0.1039
Epoch 6/23
 - 6s - loss: 2.2935 - acc: 0.0888 - val_loss: 2.3131 - val_acc: 0.1039
Epoch 7/23
 - 6s - loss: 2.2796 - acc: 0.1020 - val_loss: 2.3031 - val_acc: 0.1039
Epoch 8/23
 - 6s - loss: 2.2625 - acc: 0.1183 - val_loss: 2.2939 - val_acc: 0.1169
Epoch 9/23
 - 6s - loss: 2.2573 - acc: 0.1217 - val_loss: 2.2838 - val_acc: 0.1169
Epoch 10/23
 - 6s - loss: 2.2811 - acc: 0.1482 - val_loss: 2.2726 - val_acc: 0.1299
Epoch 11/23
 - 6s - loss: 2.2466 - acc: 0.1315 - val_loss: 2.2607 - val_acc: 0.1299
Epoch 12/23
 - 6s - loss: 2.2820 - acc: 0.1677 - val_loss: 2.2513 - val_acc: 0.1688
Epoch 13/23
 - 6s - loss: 2.2468 - acc: 0.1644 - val_loss: 2.2423 - val_acc: 0.1558
Epoch 14/23
 - 6s - loss: 2.2386 - acc: 0.1753 - val_loss: 2.2335 - val_acc: 0.1818
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 15/23
 - 6s - loss: 2.2363 - acc: 0.2271 - val_loss: 2.2251 - val_acc: 0.2078
Epoch 16/23
 - 6s - loss: 2.2247 - acc: 0.2138 - val_loss: 2.2184 - val_acc: 0.1948
Epoch 17/23
 - 6s - loss: 2.2112 - acc: 0.1875 - val_loss: 2.2134 - val_acc: 0.1948
Epoch 18/23
 - 6s - loss: 2.2206 - acc: 0.2468 - val_loss: 2.2075 - val_acc: 0.2208
Epoch 19/23
 - 6s - loss: 2.2281 - acc: 0.1942 - val_loss: 2.2053 - val_acc: 0.2208
Epoch 20/23
 - 6s - loss: 2.2049 - acc: 0.2273 - val_loss: 2.2013 - val_acc: 0.2338
Epoch 21/23
 - 6s - loss: 2.1813 - acc: 0.2502 - val_loss: 2.1982 - val_acc: 0.2338
Epoch 22/23
 - 6s - loss: 2.1958 - acc: 0.2143 - val_loss: 2.1943 - val_acc: 0.2338
Epoch 23/23
 - 6s - loss: 2.1895 - acc: 0.2830 - val_loss: 2.1935 - val_acc: 0.2468
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
{'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 114, 'zoom_range': 0.0, 'cnn_learning_rate': 3.295786960481046e-05, 'unfreeze_percentage': 0.09463829058832203, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 332, 'batch_size': 22, 'learning_rate': 0.0009790460179349596, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}

 ****** InceptionResNetV2 unfrozen 4 top blocks, cut_off after layer 712 ******
Epoch 1/9
 - 8s - loss: 2.2184 - acc: 0.2401 - val_loss: 2.1945 - val_acc: 0.2597
Epoch 2/9
 - 6s - loss: 2.2091 - acc: 0.2729 - val_loss: 2.1960 - val_acc: 0.2338
Epoch 3/9
 - 6s - loss: 2.1955 - acc: 0.2338 - val_loss: 2.1958 - val_acc: 0.2338
Epoch 4/9
 - 6s - loss: 2.2074 - acc: 0.2102 - val_loss: 2.1966 - val_acc: 0.2338
Epoch 5/9
 - 6s - loss: 2.1682 - acc: 0.2795 - val_loss: 2.1967 - val_acc: 0.2338
Epoch 6/9
 - 6s - loss: 2.1769 - acc: 0.2369 - val_loss: 2.1963 - val_acc: 0.2338
Epoch 7/9
 - 7s - loss: 2.1793 - acc: 0.2662 - val_loss: 2.1975 - val_acc: 0.2338
Epoch 8/9
 - 6s - loss: 2.1864 - acc: 0.2598 - val_loss: 2.1990 - val_acc: 0.2208
Epoch 9/9
 - 6s - loss: 2.1790 - acc: 0.2369 - val_loss: 2.2004 - val_acc: 0.2208
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (4, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (4, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (4, 0, 2)
args: ()
kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 114, 'zoom_range': 0.0, 'cnn_learning_rate': 3.295786960481046e-05, 'unfreeze_percentage': 0.09463829058832203, 'rotation_range': 0, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 332, 'batch_size': 22, 'learning_rate': 0.0009790460179349596, 'base_model': 'InceptionResNetV2', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.7792207772855635, 'info': {'runtime': 212.26604342460632, 'histories': {'loss': [2.3533802032470703, 2.360564729145595, 2.372703416006906, 2.333141619818551, 2.2850721904209683, 2.3054376363754274, 2.273032668658665, 2.264678839274815, 2.2690672976630073, 2.289294944490705, 2.241692055974688, 2.268118255478995, 2.2318313326154438, 2.238562447684152, 2.2465681655066354, 2.2213083846228465, 2.2099708216530938, 2.2322706597191946, 2.2399308511189053, 2.2048813615526472, 2.178214534880623, 2.1958112716674805, 2.198056731905256, 2.202324560710362, 2.192869128499712, 2.1954779624938965, 2.1830495652698336, 2.1689650194985526, 2.181716755458287, 2.1792916570390974, 2.173147065298898, 2.178588226863316], 'val_loss': [2.3864027679740607, 2.367735664565842, 2.347186868840998, 2.3316821463696367, 2.322661053050648, 2.3131132156817946, 2.3030795989098487, 2.293937806959276, 2.2838129068349864, 2.2726026943751743, 2.2606759009423194, 2.2513293352994053, 2.242304836000715, 2.2335054719602905, 2.2250504772384447, 2.218439374651228, 2.213372496815471, 2.207527430026562, 2.205253065406502, 2.2013263330831156, 2.1982363601783654, 2.1942535406583317, 2.1934510206247304, 2.1944557350951355, 2.196013679752102, 2.1957705237648706, 2.196627746928822, 2.1966587072843082, 2.196345059902637, 2.197542004771047, 2.199028575575197, 2.200380839310683], 'acc': [0.12142857483455113, 0.1000000027673585, 0.07857143091303961, 0.08571428826877049, 0.12337662705353328, 0.08571428805589676, 0.1000000027673585, 0.12857143240315574, 0.12142857483455113, 0.12857143176453453, 0.14285714711461747, 0.17142857632466724, 0.1785714315516608, 0.17532468054975783, 0.21428572003330504, 0.22142857781478337, 0.19285714839185988, 0.23571429210049766, 0.17857143325465066, 0.22727273191724504, 0.2857142887891285, 0.2142857164144516, 0.2642857213105474, 0.2500000048960958, 0.2857142963579723, 0.23376624073301042, 0.23809524495450277, 0.2928571513720921, 0.23571429231337138, 0.2662337677819388, 0.2714285699384553, 0.23571429231337138], 'val_acc': [0.1038961038961039, 0.1038961038961039, 0.1038961038961039, 0.10389610486371177, 0.10389610660540594, 0.10389610486371177, 0.10389610437990783, 0.11688311736692082, 0.11688311785072475, 0.12987013083773774, 0.1298701303539338, 0.16883117154047086, 0.15584415681176372, 0.18181818278578968, 0.20779221050150984, 0.19480519577280267, 0.19480519528899873, 0.2207792227144365, 0.2207792212630247, 0.2337662364755358, 0.2337662357014495, 0.23376623473384164, 0.2467532472370507, 0.2597402609013892, 0.2337662364755358, 0.23376623473384164, 0.23376623376623376, 0.23376623473384164, 0.23376623995892412, 0.23376623473384164, 0.22077922697191116, 0.2207792227144365]}}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 7)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 7) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 7) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 5
DEBUG:hpbandster:HBMASTER: submitting job (5, 0, 1) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (4, 0, 7) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (4, 0, 7)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 821, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007256153050693646, 'unfreeze_percentage': 0.21959544578054416, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 74, 'batch_size': 41, 'learning_rate': 0.0032548066508563326, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 16:09:18.588155: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/10
 - 5s - loss: 4.9845 - acc: 0.0835 - val_loss: 5.4145 - val_acc: 0.0938
Epoch 2/10
 - 4s - loss: 4.6857 - acc: 0.0735 - val_loss: 2.9242 - val_acc: 0.0938
Epoch 3/10
 - 4s - loss: 2.7661 - acc: 0.1707 - val_loss: 3.3448 - val_acc: 0.0312
Epoch 4/10
 - 4s - loss: 2.5900 - acc: 0.1655 - val_loss: 2.4357 - val_acc: 0.1250
Epoch 5/10
 - 4s - loss: 2.4526 - acc: 0.1061 - val_loss: 2.4183 - val_acc: 0.1562
Epoch 6/10
 - 4s - loss: 2.2642 - acc: 0.1545 - val_loss: 2.2899 - val_acc: 0.0938
Epoch 7/10
 - 4s - loss: 2.2023 - acc: 0.3083 - val_loss: 2.3249 - val_acc: 0.1562
Epoch 8/10
 - 4s - loss: 2.2046 - acc: 0.1382 - val_loss: 2.2672 - val_acc: 0.2188
Epoch 9/10
 - 4s - loss: 2.1452 - acc: 0.2226 - val_loss: 2.2496 - val_acc: 0.0938
Epoch 10/10
 - 4s - loss: 2.1075 - acc: 0.1997 - val_loss: 2.2067 - val_acc: 0.0938
{'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 821, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007256153050693646, 'unfreeze_percentage': 0.21959544578054416, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 74, 'batch_size': 41, 'learning_rate': 0.0032548066508563326, 'base_model': 'InceptionV3', 'activation': 'relu'}

 ****** InceptionV3 unfrozen 2 top blocks, cut_off after layer 248 ******
Epoch 1/22
 - 6s - loss: 2.0634 - acc: 0.1915 - val_loss: 2.3180 - val_acc: 0.0312
Epoch 2/22
 - 4s - loss: 2.0484 - acc: 0.1301 - val_loss: 2.2570 - val_acc: 0.0938
Epoch 3/22
 - 4s - loss: 2.0133 - acc: 0.1736 - val_loss: 2.1987 - val_acc: 0.1875
Epoch 4/22
 - 4s - loss: 2.0283 - acc: 0.1815 - val_loss: 2.1813 - val_acc: 0.1250
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 5/22
 - 4s - loss: 1.9865 - acc: 0.1733 - val_loss: 2.1809 - val_acc: 0.1562
Epoch 6/22
 - 4s - loss: 2.0016 - acc: 0.1951 - val_loss: 2.1706 - val_acc: 0.0938
Epoch 7/22
 - 4s - loss: 1.9991 - acc: 0.1978 - val_loss: 2.2362 - val_acc: 0.0625
Epoch 8/22
 - 4s - loss: 2.0091 - acc: 0.1560 - val_loss: 2.1593 - val_acc: 0.1562
Epoch 9/22
 - 4s - loss: 2.0049 - acc: 0.1545 - val_loss: 2.1363 - val_acc: 0.1562
Epoch 10/22
 - 4s - loss: 1.9376 - acc: 0.2850 - val_loss: 2.1041 - val_acc: 0.1562
Epoch 11/22
 - 4s - loss: 1.9253 - acc: 0.1870 - val_loss: 1.9553 - val_acc: 0.1875
Epoch 12/22
 - 4s - loss: 1.9340 - acc: 0.1721 - val_loss: 2.1457 - val_acc: 0.1875
Epoch 13/22
 - 4s - loss: 1.8893 - acc: 0.3328 - val_loss: 2.2171 - val_acc: 0.0938
Epoch 14/22
 - 4s - loss: 1.9506 - acc: 0.1870 - val_loss: 2.0566 - val_acc: 0.2500
Epoch 15/22
 - 4s - loss: 1.8006 - acc: 0.2575 - val_loss: 2.1735 - val_acc: 0.1250
Epoch 16/22
 - 4s - loss: 1.9007 - acc: 0.1645 - val_loss: 2.1363 - val_acc: 0.1562
Epoch 17/22
 - 4s - loss: 1.8510 - acc: 0.2650 - val_loss: 2.2240 - val_acc: 0.1562
Epoch 18/22
 - 4s - loss: 1.7962 - acc: 0.3485 - val_loss: 2.3052 - val_acc: 0.0625
Epoch 19/22
 - 4s - loss: 1.8808 - acc: 0.1789 - val_loss: 2.1377 - val_acc: 0.1875
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 20/22
 - 4s - loss: 1.7918 - acc: 0.3639 - val_loss: 2.1280 - val_acc: 0.2188
Epoch 21/22
 - 4s - loss: 1.7960 - acc: 0.3124 - val_loss: 2.0612 - val_acc: 0.2188
Epoch 22/22
 - 4s - loss: 1.7249 - acc: 0.3049 - val_loss: 2.1718 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (4, 0, 7), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (4, 0, 7) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 7) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 7) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (4, 0, 7)
args: ()
kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 821, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0007256153050693646, 'unfreeze_percentage': 0.21959544578054416, 'rotation_range': 0, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 74, 'batch_size': 41, 'learning_rate': 0.0032548066508563326, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.84375, 'info': {'runtime': 138.24600648880005, 'histories': {'loss': [4.968044206130603, 4.695813104140857, 2.7660881678263345, 2.589536456037159, 2.45377979987909, 2.2641809781392417, 2.2024270085727466, 2.204573472340902, 2.1445137390420457, 2.108611908825961, 2.0642693988547838, 2.0484498341878257, 2.0129925761341063, 2.0283012705400956, 1.98614532592868, 2.0015543699264526, 1.9986226105492961, 2.0068027047086354, 2.0048637787501016, 1.936626885117603, 1.9253179629643757, 1.9325975278192316, 1.889873997239042, 1.950595736503601, 1.8013796146250953, 1.9003022672716252, 1.851286071391145, 1.7970216018109282, 1.880765477816264, 1.791523172835673, 1.794753105187219, 1.7243912554969472], 'val_loss': [5.414535999298096, 2.9242353439331055, 3.3447794914245605, 2.4356818199157715, 2.418311595916748, 2.289856195449829, 2.3249154090881348, 2.267151355743408, 2.249610662460327, 2.206653118133545, 2.3180065155029297, 2.2570343017578125, 2.198704242706299, 2.18125057220459, 2.180914878845215, 2.170630931854248, 2.2361958026885986, 2.1593055725097656, 2.136338710784912, 2.1041336059570312, 1.9552903175354004, 2.145671844482422, 2.217111587524414, 2.0566487312316895, 2.1734585762023926, 2.1362862586975098, 2.224032402038574, 2.3052000999450684, 2.1376774311065674, 2.1279971599578857, 2.061159133911133, 2.1718363761901855], 'acc': [0.08264462871492402, 0.07438016251837912, 0.17073169350624084, 0.16528925355062013, 0.10743801252654761, 0.15447153647740683, 0.310924367493942, 0.13821137448151907, 0.22314049863864568, 0.19834710743801653, 0.1900826424113975, 0.13008129596710205, 0.17355372110181602, 0.1818181762148526, 0.17355371371281048, 0.19512194891770682, 0.19834710879266754, 0.15702478938605174, 0.15447153399387994, 0.2857142910987389, 0.18699186046918234, 0.17355371084957083, 0.33057851559859663, 0.1869918629527092, 0.25619834205828423, 0.16528925170336872, 0.2644628074543535, 0.34710744097213114, 0.17886177698771158, 0.3636363594492605, 0.31404959625941664, 0.3057851205187396], 'val_acc': [0.09375, 0.09375, 0.03125, 0.125, 0.15625, 0.09375, 0.15625, 0.21875, 0.09375, 0.09375, 0.03125, 0.09375, 0.1875, 0.125, 0.15625, 0.09375, 0.0625, 0.15625, 0.15625, 0.15625, 0.1875, 0.1875, 0.09375, 0.25, 0.125, 0.15625, 0.15625, 0.0625, 0.1875, 0.21875, 0.21875, 0.15625]}}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 7)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (5, 0, 1)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (5, 0, 1) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 1) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (5, 0, 1) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (5, 0, 1) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (5, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 193, 'zoom_range': 0.0, 'cnn_learning_rate': 8.310083602628246e-05, 'unfreeze_percentage': 0.035977391591720566, 'rotation_range': 0, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 123, 'batch_size': 18, 'num_dense_units_2': 12, 'learning_rate': 0.004392935055617135, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 16:11:35.069038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/13
 - 5s - loss: 2.5779 - acc: 0.1049 - val_loss: 2.3437 - val_acc: 0.1193
Epoch 2/13
 - 4s - loss: 2.3540 - acc: 0.1049 - val_loss: 2.2995 - val_acc: 0.1193
Epoch 3/13
 - 4s - loss: 2.2677 - acc: 0.1173 - val_loss: 2.2780 - val_acc: 0.0917
Epoch 4/13
 - 4s - loss: 2.2178 - acc: 0.1790 - val_loss: 2.2359 - val_acc: 0.1284
Epoch 5/13
 - 4s - loss: 2.1989 - acc: 0.1975 - val_loss: 2.2472 - val_acc: 0.1284
Epoch 6/13
 - 4s - loss: 2.1783 - acc: 0.1852 - val_loss: 2.1963 - val_acc: 0.1468
Epoch 7/13
 - 4s - loss: 2.1418 - acc: 0.2099 - val_loss: 2.1967 - val_acc: 0.1835
Epoch 8/13
 - 4s - loss: 2.1178 - acc: 0.1914 - val_loss: 2.1989 - val_acc: 0.1376
Epoch 9/13
 - 4s - loss: 2.0578 - acc: 0.2531 - val_loss: 2.1510 - val_acc: 0.1376
Epoch 10/13
 - 4s - loss: 2.0030 - acc: 0.2778 - val_loss: 2.1213 - val_acc: 0.1651
Epoch 11/13
 - 4s - loss: 1.9625 - acc: 0.2778 - val_loss: 2.0910 - val_acc: 0.1560
Epoch 12/13
 - 4s - loss: 1.9857 - acc: 0.2901 - val_loss: 2.0426 - val_acc: 0.2202
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 13/13
 - 4s - loss: 1.8882 - acc: 0.3395 - val_loss: 2.0045 - val_acc: 0.2110
{'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 193, 'zoom_range': 0.0, 'cnn_learning_rate': 8.310083602628246e-05, 'unfreeze_percentage': 0.035977391591720566, 'rotation_range': 0, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 123, 'batch_size': 18, 'num_dense_units_2': 12, 'learning_rate': 0.004392935055617135, 'base_model': 'MobileNet', 'activation': 'relu'}

 ****** MobileNet no layers unfrozen
Epoch 1/19
 - 5s - loss: 1.8679 - acc: 0.3272 - val_loss: 2.0533 - val_acc: 0.2018
Epoch 2/19
 - 4s - loss: 1.8372 - acc: 0.3519 - val_loss: 2.0063 - val_acc: 0.2661
Epoch 3/19
 - 4s - loss: 1.7544 - acc: 0.3704 - val_loss: 2.0154 - val_acc: 0.2752
Epoch 4/19
 - 4s - loss: 1.7534 - acc: 0.4074 - val_loss: 1.9787 - val_acc: 0.2936
Epoch 5/19
 - 4s - loss: 1.6438 - acc: 0.4753 - val_loss: 1.9387 - val_acc: 0.3578
Epoch 6/19
 - 4s - loss: 1.6499 - acc: 0.4630 - val_loss: 1.8507 - val_acc: 0.3303
Epoch 7/19
 - 4s - loss: 1.6302 - acc: 0.4321 - val_loss: 1.9005 - val_acc: 0.4128
Epoch 8/19
 - 4s - loss: 1.5832 - acc: 0.4444 - val_loss: 1.9511 - val_acc: 0.3578
Epoch 9/19
 - 4s - loss: 1.5522 - acc: 0.5000 - val_loss: 1.9388 - val_acc: 0.3578
Epoch 10/19
 - 4s - loss: 1.5360 - acc: 0.4938 - val_loss: 1.8437 - val_acc: 0.4128
Epoch 11/19
 - 4s - loss: 1.4236 - acc: 0.5617 - val_loss: 1.9439 - val_acc: 0.3486
Epoch 12/19
 - 4s - loss: 1.4716 - acc: 0.5432 - val_loss: 1.8748 - val_acc: 0.4128
Epoch 13/19
 - 4s - loss: 1.4263 - acc: 0.5000 - val_loss: 1.7704 - val_acc: 0.4587
Epoch 14/19
 - 4s - loss: 1.3729 - acc: 0.5617 - val_loss: 1.7448 - val_acc: 0.4220
Epoch 15/19
 - 4s - loss: 1.4866 - acc: 0.4938 - val_loss: 1.9514 - val_acc: 0.3761
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 16/19
 - 4s - loss: 1.3267 - acc: 0.5617 - val_loss: 1.8321 - val_acc: 0.3670
Epoch 17/19
 - 4s - loss: 1.3244 - acc: 0.5556 - val_loss: 1.7197 - val_acc: 0.4312
Epoch 18/19
 - 4s - loss: 1.2378 - acc: 0.6173 - val_loss: 1.8457 - val_acc: 0.3486
Epoch 19/19
 - 4s - loss: 1.1962 - acc: 0.6111 - val_loss: 1.7402 - val_acc: 0.4587
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (5, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (5, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (5, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (5, 0, 1) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (5, 0, 1)
args: ()
kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 193, 'zoom_range': 0.0, 'cnn_learning_rate': 8.310083602628246e-05, 'unfreeze_percentage': 0.035977391591720566, 'rotation_range': 0, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 123, 'batch_size': 18, 'num_dense_units_2': 12, 'learning_rate': 0.004392935055617135, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.5412844003887352, 'info': {'runtime': 125.5694649219513, 'histories': {'loss': [2.5778833760155573, 2.3540411790211997, 2.2676688300238714, 2.2177574899461536, 2.198931852976481, 2.1783448590172663, 2.1417629188961453, 2.117762486139933, 2.0578085051642523, 2.0029755698310003, 1.9625134997897677, 1.9857057862811618, 1.888169871436225, 1.867905444569058, 1.837216854095459, 1.7544354465272691, 1.7534154388639662, 1.6437928279240925, 1.6498727136188083, 1.6301855113771226, 1.5831923882166545, 1.5522440804375544, 1.535957309934828, 1.423610766728719, 1.471634414460924, 1.426322513156467, 1.3728528287675645, 1.486610558297899, 1.3266949653625488, 1.3244324922561646, 1.237768703036838, 1.1962219344245062], 'val_loss': [2.343678190073836, 2.299519869165683, 2.2780343764418856, 2.235943208047009, 2.2471874788266804, 2.196346665741107, 2.196744288873235, 2.1988756809759575, 2.150980813787618, 2.1212829099882633, 2.0910369256220824, 2.042612968234841, 2.004470562716143, 2.053325082183978, 2.0062626042497267, 2.015365101875515, 1.9786553032901308, 1.9386579727907793, 1.8507338641980373, 1.9004929962508175, 1.9511062213040273, 1.9387778842121088, 1.8437343562414887, 1.9439497190877932, 1.874804719872431, 1.770411987917139, 1.74480368019244, 1.9513512663884993, 1.8320535672913998, 1.7196781329058726, 1.8457186965767396, 1.740187332170819], 'acc': [0.1049382740424739, 0.10493827321463162, 0.11728395231895977, 0.17901234908236396, 0.19753086898061964, 0.18518518987629148, 0.20987655056847465, 0.19135802818669212, 0.25308642784754437, 0.2777777852283584, 0.2777777827448315, 0.29012346764405567, 0.33950618240568375, 0.3271604999899864, 0.3518518681327502, 0.37037038140826756, 0.40740741789340973, 0.47530866000387406, 0.4629629850387573, 0.43209877610206604, 0.4444444610012902, 0.500000019868215, 0.4938271741072337, 0.5617284079392751, 0.5432098905245463, 0.5000000099341074, 0.5617284145620134, 0.4938271774186028, 0.5617284112506442, 0.5555555754237704, 0.6172839535607232, 0.6111111376020644], 'val_acc': [0.11926605695978217, 0.11926605695978217, 0.0917431196078248, 0.12844036888638768, 0.12844036833955608, 0.14678899150922758, 0.18348623887387985, 0.13761467889908258, 0.13761467958262208, 0.1651376153624386, 0.15596330309406334, 0.22018348658030187, 0.21100917499546612, 0.20183486306886061, 0.26605504655509915, 0.27522935971207574, 0.2935779819931459, 0.3577981695122675, 0.3302752307248772, 0.41284403738078723, 0.3577981665046937, 0.3577981695122675, 0.41284403806432673, 0.3486238570388304, 0.41284404107190054, 0.45871559906443327, 0.4220183519048428, 0.3761467903579047, 0.366972481438873, 0.43119266383144833, 0.3486238570388304, 0.45871559961126485]}}}
exception: None

DEBUG:hpbandster:job_callback for (5, 0, 1)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 1)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 1) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 4) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 1) on hpbandster.run_0.worker.tfpool20.27905140655330039552
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (4, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 64.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 467, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005344690889043314, 'unfreeze_percentage': 0.21318420520138404, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 69, 'batch_size': 21, 'learning_rate': 0.0001510374918024039, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
DEBUG:hpbandster:DISPATCHER: job (4, 0, 1) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
2018-02-08 16:13:43.491301: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/11
 - 6s - loss: 2.2977 - acc: 0.1368 - val_loss: 2.2456 - val_acc: 0.1039
Epoch 2/11
 - 5s - loss: 2.0853 - acc: 0.2968 - val_loss: 2.1778 - val_acc: 0.2727
Epoch 3/11
 - 5s - loss: 1.9399 - acc: 0.4407 - val_loss: 2.1733 - val_acc: 0.1948
Epoch 4/11
 - 5s - loss: 1.7479 - acc: 0.5254 - val_loss: 2.0531 - val_acc: 0.3506
Epoch 5/11
 - 5s - loss: 1.6168 - acc: 0.6007 - val_loss: 1.9960 - val_acc: 0.3247
Epoch 6/11
 - 5s - loss: 1.4568 - acc: 0.7007 - val_loss: 1.8997 - val_acc: 0.3766
Epoch 7/11
 - 5s - loss: 1.2925 - acc: 0.7737 - val_loss: 1.7915 - val_acc: 0.4286
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/11
 - 5s - loss: 1.1661 - acc: 0.8266 - val_loss: 1.7486 - val_acc: 0.4026
Epoch 9/11
 - 5s - loss: 1.0357 - acc: 0.8492 - val_loss: 1.6746 - val_acc: 0.3636
Epoch 10/11
 - 5s - loss: 0.9226 - acc: 0.8912 - val_loss: 1.5782 - val_acc: 0.4416
Epoch 11/11
 - 5s - loss: 0.7923 - acc: 0.9132 - val_loss: 1.5476 - val_acc: 0.4286
{'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 467, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005344690889043314, 'unfreeze_percentage': 0.21318420520138404, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 69, 'batch_size': 21, 'learning_rate': 0.0001510374918024039, 'base_model': 'InceptionV3', 'activation': 'relu'}

 ****** InceptionV3 unfrozen 2 top blocks, cut_off after layer 248 ******
Epoch 1/53
 - 6s - loss: 0.7505 - acc: 0.9108 - val_loss: 1.4965 - val_acc: 0.5195
Epoch 2/53
 - 5s - loss: 0.6395 - acc: 0.9497 - val_loss: 1.4471 - val_acc: 0.4935
Epoch 3/53
 - 5s - loss: 0.7052 - acc: 0.8971 - val_loss: 1.4419 - val_acc: 0.4805
Epoch 4/53
 - 5s - loss: 0.5233 - acc: 0.9932 - val_loss: 1.3975 - val_acc: 0.5065
Epoch 5/53
 - 5s - loss: 0.4396 - acc: 0.9796 - val_loss: 1.3320 - val_acc: 0.5714
Epoch 6/53
 - 5s - loss: 0.3909 - acc: 1.0000 - val_loss: 1.2703 - val_acc: 0.6104
Epoch 7/53
 - 5s - loss: 0.3282 - acc: 0.9932 - val_loss: 1.2346 - val_acc: 0.6234
Epoch 8/53
 - 5s - loss: 0.3075 - acc: 0.9839 - val_loss: 1.2234 - val_acc: 0.6104
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 9/53
 - 5s - loss: 0.2690 - acc: 1.0000 - val_loss: 1.2071 - val_acc: 0.6234
Epoch 10/53
 - 5s - loss: 0.2191 - acc: 1.0000 - val_loss: 1.1881 - val_acc: 0.5714
Epoch 11/53
 - 5s - loss: 0.1946 - acc: 1.0000 - val_loss: 1.1697 - val_acc: 0.5974
Epoch 12/53
 - 5s - loss: 0.2110 - acc: 0.9863 - val_loss: 1.1419 - val_acc: 0.6623
Epoch 13/53
 - 5s - loss: 0.1513 - acc: 1.0000 - val_loss: 1.1239 - val_acc: 0.6623
Epoch 14/53
 - 5s - loss: 0.1783 - acc: 1.0000 - val_loss: 1.1096 - val_acc: 0.6883
Epoch 15/53
 - 5s - loss: 0.1309 - acc: 1.0000 - val_loss: 1.1074 - val_acc: 0.7013
Epoch 16/53
 - 5s - loss: 0.1165 - acc: 1.0000 - val_loss: 1.0999 - val_acc: 0.7403
Epoch 17/53
 - 5s - loss: 0.1384 - acc: 1.0000 - val_loss: 1.0926 - val_acc: 0.7273
Epoch 18/53
 - 5s - loss: 0.1345 - acc: 1.0000 - val_loss: 1.0822 - val_acc: 0.7143
Epoch 19/53
 - 5s - loss: 0.1262 - acc: 1.0000 - val_loss: 1.0659 - val_acc: 0.7143
Epoch 20/53
 - 5s - loss: 0.0961 - acc: 1.0000 - val_loss: 1.0619 - val_acc: 0.7273
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 21/53
 - 5s - loss: 0.0858 - acc: 1.0000 - val_loss: 1.0580 - val_acc: 0.7013
Epoch 22/53
 - 5s - loss: 0.0848 - acc: 1.0000 - val_loss: 1.0601 - val_acc: 0.7013
Epoch 23/53
 - 5s - loss: 0.0711 - acc: 1.0000 - val_loss: 1.0648 - val_acc: 0.6753
Epoch 24/53
 - 5s - loss: 0.1031 - acc: 1.0000 - val_loss: 1.0602 - val_acc: 0.6753
Epoch 25/53
 - 5s - loss: 0.0757 - acc: 1.0000 - val_loss: 1.0629 - val_acc: 0.7013
Epoch 26/53
 - 5s - loss: 0.0612 - acc: 1.0000 - val_loss: 1.0607 - val_acc: 0.6883
Epoch 27/53
 - 5s - loss: 0.0746 - acc: 1.0000 - val_loss: 1.0570 - val_acc: 0.7013
Epoch 28/53
 - 5s - loss: 0.0710 - acc: 1.0000 - val_loss: 1.0513 - val_acc: 0.7013
Epoch 29/53
 - 5s - loss: 0.0727 - acc: 1.0000 - val_loss: 1.0478 - val_acc: 0.7013
Epoch 30/53
 - 5s - loss: 0.0629 - acc: 1.0000 - val_loss: 1.0417 - val_acc: 0.7013
Epoch 31/53
 - 5s - loss: 0.0475 - acc: 1.0000 - val_loss: 1.0427 - val_acc: 0.6753
Epoch 32/53
 - 5s - loss: 0.0528 - acc: 1.0000 - val_loss: 1.0490 - val_acc: 0.7013
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 33/53
 - 5s - loss: 0.0395 - acc: 1.0000 - val_loss: 1.0519 - val_acc: 0.6883
Epoch 34/53
 - 5s - loss: 0.0435 - acc: 1.0000 - val_loss: 1.0540 - val_acc: 0.6883
Epoch 35/53
 - 5s - loss: 0.0412 - acc: 1.0000 - val_loss: 1.0566 - val_acc: 0.6883
Epoch 36/53
 - 5s - loss: 0.0423 - acc: 1.0000 - val_loss: 1.0602 - val_acc: 0.6883
Epoch 37/53
 - 5s - loss: 0.0436 - acc: 1.0000 - val_loss: 1.0590 - val_acc: 0.6883
Epoch 38/53
 - 5s - loss: 0.0443 - acc: 1.0000 - val_loss: 1.0574 - val_acc: 0.6883
Epoch 39/53
 - 5s - loss: 0.0470 - acc: 1.0000 - val_loss: 1.0557 - val_acc: 0.6753
Epoch 40/53
 - 5s - loss: 0.0645 - acc: 1.0000 - val_loss: 1.0454 - val_acc: 0.6883
Epoch 41/53
 - 5s - loss: 0.0464 - acc: 1.0000 - val_loss: 1.0397 - val_acc: 0.6883
Epoch 42/53
 - 5s - loss: 0.0386 - acc: 1.0000 - val_loss: 1.0394 - val_acc: 0.6753
Epoch 43/53
 - 5s - loss: 0.0469 - acc: 1.0000 - val_loss: 1.0348 - val_acc: 0.6753
Epoch 44/53
 - 5s - loss: 0.0373 - acc: 1.0000 - val_loss: 1.0375 - val_acc: 0.6883
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 45/53
 - 5s - loss: 0.0356 - acc: 1.0000 - val_loss: 1.0417 - val_acc: 0.6883
Epoch 46/53
 - 5s - loss: 0.0410 - acc: 1.0000 - val_loss: 1.0388 - val_acc: 0.6883
Epoch 47/53
 - 5s - loss: 0.0446 - acc: 1.0000 - val_loss: 1.0372 - val_acc: 0.6883
Epoch 48/53
 - 5s - loss: 0.0342 - acc: 1.0000 - val_loss: 1.0383 - val_acc: 0.6753
Epoch 49/53
 - 5s - loss: 0.0311 - acc: 1.0000 - val_loss: 1.0394 - val_acc: 0.6753
Epoch 50/53
 - 5s - loss: 0.0293 - acc: 1.0000 - val_loss: 1.0394 - val_acc: 0.6753
Epoch 51/53
 - 5s - loss: 0.0389 - acc: 1.0000 - val_loss: 1.0368 - val_acc: 0.6753
Epoch 52/53
 - 5s - loss: 0.0315 - acc: 1.0000 - val_loss: 1.0368 - val_acc: 0.6883
Epoch 53/53
 - 5s - loss: 0.0250 - acc: 1.0000 - val_loss: 1.0351 - val_acc: 0.7013
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (4, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (4, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 1) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (4, 0, 1)
args: ()
kwargs: {'budget': 64.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 467, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0005344690889043314, 'unfreeze_percentage': 0.21318420520138404, 'rotation_range': 0, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 69, 'batch_size': 21, 'learning_rate': 0.0001510374918024039, 'base_model': 'InceptionV3', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.2987012956049535, 'info': {'runtime': 325.26498103141785, 'histories': {'loss': [2.297908696722477, 2.0836294813359038, 1.9416062426059804, 1.7507801613909133, 1.6218064034238775, 1.4568262951714652, 1.2902174224244787, 1.169383853039843, 1.0319549048200567, 0.9226464714322772, 0.7858518932728057, 0.7463748480411286, 0.6366076000193333, 0.7042761178726845, 0.5230318777104641, 0.4396168291568756, 0.38747762044270834, 0.32816999512059347, 0.3013269581059192, 0.2689770460128784, 0.2150205006202062, 0.19597457888278555, 0.21153027928890067, 0.15246316632057758, 0.17834266594478063, 0.13074877287479156, 0.11594829565667092, 0.13920554169949065, 0.13261439413466353, 0.12620371473687036, 0.09638595485940893, 0.08521187242041244, 0.08465652068456014, 0.07107749102371079, 0.10117507551578765, 0.07437093540074978, 0.06003414260897231, 0.07464088499546051, 0.06654686480760574, 0.0711392990135132, 0.06285021188003677, 0.04698640060551623, 0.05283118835947615, 0.03945013242108481, 0.04295866485271189, 0.040667769756722955, 0.04183425821680972, 0.04357515275478363, 0.044671030992523154, 0.045791375388701754, 0.06446983505572591, 0.04414266898752527, 0.03855855097728116, 0.04505170643963712, 0.03713483779512821, 0.035322614925655915, 0.04050983230959862, 0.04391222593790673, 0.03380290442641745, 0.031139136957270757, 0.0282549147390657, 0.03581558064894473, 0.029946757817363487, 0.02502274193934032], 'val_loss': [2.2456474613833737, 2.177815071948163, 2.173258050695642, 2.05309356652297, 1.9960326405314657, 1.8997292178017753, 1.7914815243188438, 1.748631560957277, 1.674599630492074, 1.5782141747412743, 1.5475617662652748, 1.496497123272388, 1.4471350196120027, 1.4418528683773884, 1.3974925000946243, 1.3320437685235755, 1.2702658052568312, 1.2345549626783892, 1.2234033299730969, 1.2071084883305934, 1.1881419745358555, 1.1696878617460078, 1.1418567415955778, 1.1238504717876385, 1.1096167874026608, 1.1074188220036494, 1.0998793662368478, 1.0926192333171894, 1.0822496189699544, 1.0658895520420817, 1.0618562380988876, 1.0579577947591807, 1.0601202326935608, 1.0648304858765045, 1.0602242451209527, 1.0628620711239902, 1.0607444883941055, 1.0569639058856222, 1.051277513627882, 1.0477767455113398, 1.0417042970657349, 1.0427449430738176, 1.0489602832051066, 1.0519072421185383, 1.053984522819519, 1.056557718809549, 1.0602357155316835, 1.0590352083181407, 1.0573771526287128, 1.055686665819837, 1.0454352846393338, 1.039685303514654, 1.0394010087112329, 1.034826743138301, 1.0374653122641824, 1.0416586306188014, 1.038807393668534, 1.0371812907132236, 1.0382992122080419, 1.0394033007807546, 1.0393688787113537, 1.0367715002654434, 1.036785042131102, 1.0351453260941939], 'acc': [0.14184397760223835, 0.29787235580226207, 0.4397163387942821, 0.5177305315403228, 0.5957447049465585, 0.700680306979588, 0.7801418925853486, 0.822695070124687, 0.8510638982691663, 0.89115652016231, 0.9148936550667945, 0.9148936728213696, 0.9503546547382435, 0.9007092765037049, 0.9929078107184552, 0.9795918549810138, 1.0, 0.9931972878319877, 0.9858156189005426, 1.0, 1.0, 1.0, 0.9858156214369104, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], 'val_acc': [0.1038961038961039, 0.2727272736948806, 0.19480519577280267, 0.3506493560679547, 0.32467532661054044, 0.3766233820419807, 0.42857143399003267, 0.40259740356501045, 0.3636363675067951, 0.4415584434936573, 0.42857143244186, 0.5194805225768646, 0.49350649969918386, 0.4805194867121709, 0.5064935095898517, 0.5714285760730892, 0.6103896227749911, 0.6233766287952275, 0.6103896150341281, 0.6233766287952275, 0.5714285760730892, 0.5974026097879781, 0.6623376662080939, 0.6623376654340075, 0.6883116929562061, 0.7012987043950465, 0.7402597518710347, 0.727272739658108, 0.7142857251229224, 0.7142857173820595, 0.727272739658108, 0.7012987043950465, 0.7012987059432191, 0.6753246869359698, 0.6753246784210205, 0.701298713684082, 0.6883116914080335, 0.7012987028468739, 0.7012987051691327, 0.7012987043950465, 0.701298713684082, 0.6753246791951069, 0.701298713684082, 0.6883116929562061, 0.6883116937302923, 0.6883116914080335, 0.6883116929562061, 0.6883116914080335, 0.6883116921821197, 0.675324687710056, 0.6883116999229828, 0.688311700697069, 0.6753246869359698, 0.6753246784210205, 0.6883116894728177, 0.6883116898598609, 0.6883116937302923, 0.6883116914080335, 0.6753246799691931, 0.675324687710056, 0.6753246861618835, 0.6753246791951069, 0.6883116929562061, 0.7012987043950465]}}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 1)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 4)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 4) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 5
DEBUG:hpbandster:HBMASTER: submitting job (5, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (4, 0, 4) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (4, 0, 4)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 64.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 650, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001378479121671591, 'unfreeze_percentage': 0.21669903137384586, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 61, 'batch_size': 16, 'num_dense_units_2': 79, 'learning_rate': 0.0018855918373312658, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 16:19:06.962172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/24
 - 5s - loss: 4.5716 - acc: 0.0687 - val_loss: 2.2103 - val_acc: 0.1651
Epoch 2/24
 - 4s - loss: 2.3289 - acc: 0.2054 - val_loss: 2.1802 - val_acc: 0.2018
Epoch 3/24
 - 4s - loss: 2.3976 - acc: 0.1261 - val_loss: 2.2734 - val_acc: 0.2477
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/24
 - 4s - loss: 2.3176 - acc: 0.1625 - val_loss: 2.1235 - val_acc: 0.2752
Epoch 5/24
 - 4s - loss: 2.2382 - acc: 0.1863 - val_loss: 2.2431 - val_acc: 0.2385
Epoch 6/24
 - 4s - loss: 2.1627 - acc: 0.2563 - val_loss: 2.1041 - val_acc: 0.2385
Epoch 7/24
 - 4s - loss: 2.0045 - acc: 0.2856 - val_loss: 1.9169 - val_acc: 0.2844
Epoch 8/24
 - 4s - loss: 2.0522 - acc: 0.2564 - val_loss: 2.0389 - val_acc: 0.2661
Epoch 9/24
 - 4s - loss: 1.6334 - acc: 0.4688 - val_loss: 1.5094 - val_acc: 0.5872
Epoch 10/24
 - 4s - loss: 1.6646 - acc: 0.5441 - val_loss: 1.3495 - val_acc: 0.6147
Epoch 11/24
 - 4s - loss: 1.5569 - acc: 0.5170 - val_loss: 1.4468 - val_acc: 0.5505
Epoch 12/24
 - 4s - loss: 1.2714 - acc: 0.5233 - val_loss: 1.6308 - val_acc: 0.4679
Epoch 13/24
 - 4s - loss: 0.9826 - acc: 0.6261 - val_loss: 1.6178 - val_acc: 0.5138
Epoch 14/24
 - 4s - loss: 1.3025 - acc: 0.6848 - val_loss: 1.2835 - val_acc: 0.5505
Epoch 15/24
 - 4s - loss: 0.4280 - acc: 0.8688 - val_loss: 1.4932 - val_acc: 0.6239
Epoch 16/24
 - 4s - loss: 1.6867 - acc: 0.5303 - val_loss: 1.1853 - val_acc: 0.7064
Epoch 17/24
 - 4s - loss: 0.7805 - acc: 0.7900 - val_loss: 1.1028 - val_acc: 0.6422
Epoch 18/24
 - 4s - loss: 0.5286 - acc: 0.8250 - val_loss: 1.1217 - val_acc: 0.6881
Epoch 19/24
 - 4s - loss: 0.8928 - acc: 0.7502 - val_loss: 1.6694 - val_acc: 0.5963
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 20/24
 - 4s - loss: 0.4745 - acc: 0.8404 - val_loss: 2.3817 - val_acc: 0.3945
Epoch 21/24
 - 4s - loss: 0.5423 - acc: 0.8467 - val_loss: 1.2795 - val_acc: 0.6789
Epoch 22/24
 - 4s - loss: 0.8841 - acc: 0.8467 - val_loss: 1.7222 - val_acc: 0.5963
Epoch 23/24
 - 4s - loss: 0.5906 - acc: 0.8235 - val_loss: 1.5463 - val_acc: 0.5780
Epoch 24/24
 - 4s - loss: 0.4145 - acc: 0.8550 - val_loss: 2.2076 - val_acc: 0.5872
{'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 650, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001378479121671591, 'unfreeze_percentage': 0.21669903137384586, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 61, 'batch_size': 16, 'num_dense_units_2': 79, 'learning_rate': 0.0018855918373312658, 'base_model': 'MobileNet', 'activation': 'relu'}

 ****** MobileNet unfrozen 5 top blocks, cut_off after layer 66 ******
Epoch 1/40
 - 5s - loss: 0.6097 - acc: 0.8341 - val_loss: 2.2467 - val_acc: 0.5780
Epoch 2/40
 - 4s - loss: 0.2438 - acc: 0.9307 - val_loss: 1.7572 - val_acc: 0.6422
Epoch 3/40
 - 4s - loss: 0.1898 - acc: 0.9437 - val_loss: 1.7575 - val_acc: 0.5963
Epoch 4/40
 - 4s - loss: 0.5895 - acc: 0.8361 - val_loss: 1.5418 - val_acc: 0.6422
Epoch 5/40
 - 4s - loss: 0.0916 - acc: 0.9875 - val_loss: 1.5393 - val_acc: 0.6606
Epoch 6/40
 - 4s - loss: 0.2245 - acc: 0.9413 - val_loss: 1.2868 - val_acc: 0.6697
Epoch 7/40
 - 4s - loss: 0.1608 - acc: 0.9475 - val_loss: 1.3829 - val_acc: 0.6422
Epoch 8/40
 - 4s - loss: 0.0871 - acc: 0.9937 - val_loss: 1.4483 - val_acc: 0.6606
Epoch 9/40
 - 4s - loss: 0.0908 - acc: 0.9874 - val_loss: 1.5144 - val_acc: 0.6422
Epoch 10/40
 - 4s - loss: 0.0518 - acc: 1.0000 - val_loss: 1.6096 - val_acc: 0.6422
Epoch 11/40
 - 4s - loss: 0.2415 - acc: 0.9413 - val_loss: 1.6142 - val_acc: 0.6055
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 12/40
 - 4s - loss: 0.1372 - acc: 0.9476 - val_loss: 1.4188 - val_acc: 0.6330
Epoch 13/40
 - 4s - loss: 0.1231 - acc: 0.9476 - val_loss: 1.4348 - val_acc: 0.6422
Epoch 14/40
 - 4s - loss: 0.0490 - acc: 0.9938 - val_loss: 1.4448 - val_acc: 0.6422
Epoch 15/40
 - 4s - loss: 0.1239 - acc: 0.9873 - val_loss: 1.6560 - val_acc: 0.5780
Epoch 16/40
 - 4s - loss: 0.0455 - acc: 1.0000 - val_loss: 1.3135 - val_acc: 0.6972
Epoch 17/40
 - 4s - loss: 0.0786 - acc: 0.9937 - val_loss: 1.5474 - val_acc: 0.6422
Epoch 18/40
 - 4s - loss: 0.1188 - acc: 0.9539 - val_loss: 1.3994 - val_acc: 0.6422
Epoch 19/40
 - 4s - loss: 0.0551 - acc: 0.9938 - val_loss: 1.5574 - val_acc: 0.6147
Epoch 20/40
 - 4s - loss: 0.2287 - acc: 0.9476 - val_loss: 1.3385 - val_acc: 0.6514
Epoch 21/40
 - 4s - loss: 0.0975 - acc: 0.9874 - val_loss: 1.2498 - val_acc: 0.6606
Epoch 22/40
 - 4s - loss: 0.0877 - acc: 0.9937 - val_loss: 1.4802 - val_acc: 0.6697
Epoch 23/40
 - 4s - loss: 0.1185 - acc: 0.9476 - val_loss: 1.4224 - val_acc: 0.6697
Epoch 24/40
 - 4s - loss: 0.1385 - acc: 1.0000 - val_loss: 1.4518 - val_acc: 0.6239
Epoch 25/40
 - 4s - loss: 0.0445 - acc: 0.9938 - val_loss: 1.4573 - val_acc: 0.6422
Epoch 26/40
 - 4s - loss: 0.4213 - acc: 0.9077 - val_loss: 1.4093 - val_acc: 0.6514
Epoch 27/40
 - 4s - loss: 0.2020 - acc: 0.9539 - val_loss: 1.5114 - val_acc: 0.6514
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 28/40
 - 4s - loss: 0.3900 - acc: 0.9078 - val_loss: 1.5381 - val_acc: 0.6147
Epoch 29/40
 - 4s - loss: 0.0530 - acc: 0.9875 - val_loss: 1.6295 - val_acc: 0.6055
Epoch 30/40
 - 4s - loss: 0.0944 - acc: 0.9937 - val_loss: 1.8197 - val_acc: 0.5688
Epoch 31/40
 - 4s - loss: 0.5287 - acc: 0.9539 - val_loss: 1.5047 - val_acc: 0.6330
Epoch 32/40
 - 4s - loss: 0.3661 - acc: 0.9078 - val_loss: 1.5748 - val_acc: 0.6055
Epoch 33/40
 - 4s - loss: 0.3122 - acc: 0.9539 - val_loss: 1.4514 - val_acc: 0.6422
Epoch 34/40
 - 4s - loss: 0.0886 - acc: 0.9539 - val_loss: 1.4999 - val_acc: 0.6239
Epoch 35/40
 - 4s - loss: 0.0263 - acc: 1.0000 - val_loss: 1.1775 - val_acc: 0.6881
Epoch 36/40
 - 4s - loss: 0.4216 - acc: 0.8425 - val_loss: 1.3577 - val_acc: 0.6422
Epoch 37/40
 - 4s - loss: 0.4766 - acc: 0.9078 - val_loss: 1.5898 - val_acc: 0.5872
Epoch 38/40
 - 4s - loss: 0.0679 - acc: 1.0000 - val_loss: 1.4216 - val_acc: 0.6330
Epoch 39/40
 - 4s - loss: 0.0312 - acc: 1.0000 - val_loss: 1.4389 - val_acc: 0.6239
Epoch 40/40
 - 4s - loss: 0.0434 - acc: 0.9937 - val_loss: 1.6232 - val_acc: 0.6055
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (4, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (4, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (4, 0, 4)
args: ()
kwargs: {'budget': 64.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 650, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0001378479121671591, 'unfreeze_percentage': 0.21669903137384586, 'rotation_range': 0, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 61, 'batch_size': 16, 'num_dense_units_2': 79, 'learning_rate': 0.0018855918373312658, 'base_model': 'MobileNet', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.39449540409473105, 'info': {'runtime': 247.29706358909607, 'histories': {'loss': [4.571566390991211, 2.374121499784065, 2.3460663540722573, 2.31761839389801, 2.2766255646040947, 2.162732493877411, 2.005922206460613, 2.044312679406368, 1.6333574891090392, 1.6308469053817123, 1.5377591407462343, 1.2447951035956815, 0.9971745830692657, 1.3679346376902437, 0.4280124641954899, 1.5256795323256291, 0.694411428007361, 0.5286082059144974, 0.7719034879174951, 0.42275100864776194, 0.42466181026746147, 0.7846717622182141, 0.6142769962140958, 0.4067360236220164, 0.4379772078501035, 0.2119204705096271, 0.18982096649706365, 0.18735751419356375, 0.09158413782715798, 0.11713752477136377, 0.07597082480788231, 0.09103453536964443, 0.06985651324056599, 0.051801330968737604, 0.11461615439963667, 0.07445604394968242, 0.07470492753264023, 0.04896326251327991, 0.06999447851470023, 0.04550444865599275, 0.041092611849308014, 0.05477220260284164, 0.05508895441889763, 0.07442298592769936, 0.05985579200803417, 0.050212334280144676, 0.05153185333291145, 0.06143453145680362, 0.044511782564222814, 0.1042374957239989, 0.06511020088849002, 0.09403835257438764, 0.05298461448401213, 0.04814258615856301, 0.10550436285668857, 0.08765270377266897, 0.07601165281583185, 0.03844061299954375, 0.026250550150871278, 0.12620333469275272, 0.09144167949075568, 0.036962141321129995, 0.03123538298532367, 0.03914288155836602], 'val_loss': [2.210279963432102, 2.1802394324486407, 2.273382473429409, 2.1234943429264455, 2.2431211777783315, 2.104074362221114, 1.9168699575126718, 2.0388903136647074, 1.509416964075981, 1.3495418609829124, 1.4467710344069595, 1.6307998600356075, 1.6177667434062433, 1.283507718952424, 1.493243128881542, 1.1853050988748532, 1.1027949939080335, 1.1217113186460022, 1.6693605501717383, 2.381661839441422, 1.2795059538762503, 1.7222014053152241, 1.5462838673810346, 2.2076019737698616, 2.246699075086401, 1.7571825609294647, 1.7575278741504075, 1.5418407982642497, 1.5392903045776787, 1.2868284544813524, 1.382936452506879, 1.4483235560425924, 1.514350250226642, 1.6096253121664765, 1.6142486454149998, 1.4188334252856194, 1.4348220868941841, 1.4448370408574376, 1.656012594153028, 1.313496285622273, 1.5474001858212532, 1.3993786835889204, 1.5574169924499792, 1.3385230335620566, 1.2498375270344795, 1.4801775227992906, 1.422367774018454, 1.4517826016889799, 1.457258040751886, 1.4092999051470276, 1.5113506273392143, 1.5381134846888551, 1.6294923069280223, 1.819727543297164, 1.5047169541000227, 1.574769895011132, 1.4514096625354311, 1.4998549780714403, 1.177481322113527, 1.3576833162832698, 1.5898428291355797, 1.4216434736864283, 1.4389196688975763, 1.6232092221942516], 'acc': [0.06875, 0.19696969696969696, 0.136986301369863, 0.1625, 0.17424242424242425, 0.25625, 0.2671232876712329, 0.25757575757575757, 0.46875, 0.547945205479452, 0.5616438356164384, 0.5684931506849316, 0.636986301369863, 0.6575342465753424, 0.86875, 0.5833333333333334, 0.815068493150685, 0.825, 0.815068493150685, 0.8698630136986302, 0.8767123287671232, 0.8767123287671232, 0.8082191780821918, 0.8424657534246576, 0.863013698630137, 0.9246575342465754, 0.94375, 0.946969696969697, 0.9875, 0.9794520547945206, 0.9848484848484849, 0.9931506849315068, 0.9863013698630136, 1.0, 0.9794520547945206, 0.9863013698630136, 0.9863013698630136, 0.99375, 0.9848484848484849, 1.0, 0.9931506849315068, 0.9924242424242424, 0.99375, 0.9863013698630136, 0.9863013698630136, 0.9931506849315068, 0.9863013698630136, 1.0, 0.99375, 0.9848484848484849, 0.9931506849315068, 0.9863013698630136, 0.9875, 0.9931506849315068, 0.9931506849315068, 0.9863013698630136, 0.9931506849315068, 0.9931506849315068, 1.0, 0.9545454545454546, 0.9863013698630136, 1.0, 1.0, 0.9931506849315068], 'val_acc': [0.1651376190535519, 0.20183486306886061, 0.24770642393225922, 0.27522935971207574, 0.23853211145882214, 0.23853211200565372, 0.28440367163868124, 0.26605504655509915, 0.5871559671305735, 0.6146789012698952, 0.5504587194241515, 0.46788991208470193, 0.5137614700772347, 0.5504587183304883, 0.6238532131965008, 0.7064220205359503, 0.642201838143375, 0.6880733972295708, 0.5963302779635158, 0.39449541667185795, 0.678899091318113, 0.5963302774166842, 0.5779816612191156, 0.5871559665837419, 0.5779816541103048, 0.6422018370497118, 0.5963302790571791, 0.6422018370497118, 0.6605504614497544, 0.6697247733763598, 0.642201838143375, 0.660550467464902, 0.6422018375965434, 0.6422018370497118, 0.6055045898901213, 0.6330275327787487, 0.6422018370497118, 0.6422018370497118, 0.5779816541103048, 0.6972477086093447, 0.642201838143375, 0.642201843611691, 0.6146789089255377, 0.6513761489763172, 0.6605504669180704, 0.6697247788446758, 0.6697247739231914, 0.6238532142901639, 0.6422018386902065, 0.6513761500699804, 0.6513761555382965, 0.6146789018167268, 0.6055045898901213, 0.5688073427305309, 0.6330275327787487, 0.605504595905269, 0.642201838143375, 0.6238532131965008, 0.6880734032447186, 0.642201838143375, 0.5871559731457212, 0.6330275327787487, 0.6238532131965008, 0.605504595905269]}}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 4)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (5, 0, 2)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (5, 0, 2) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (5, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 5
DEBUG:hpbandster:HBMASTER: submitting job (5, 0, 3) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (5, 0, 2) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (5, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 163, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002430120578229517, 'unfreeze_percentage': 0.2954511240277776, 'rotation_range': 0, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 68, 'batch_size': 33, 'num_dense_units_2': 166, 'learning_rate': 0.0003748303920848836, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 16:23:13.487960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/20
 - 4s - loss: 2.3947 - acc: 0.1598 - val_loss: 2.0306 - val_acc: 0.3438
Epoch 2/20
 - 3s - loss: 1.7227 - acc: 0.5303 - val_loss: 1.8820 - val_acc: 0.5156
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/20
 - 3s - loss: 1.4226 - acc: 0.6764 - val_loss: 1.7851 - val_acc: 0.4688
Epoch 4/20
 - 3s - loss: 1.2460 - acc: 0.6901 - val_loss: 1.7110 - val_acc: 0.4844
Epoch 5/20
 - 3s - loss: 1.0291 - acc: 0.8454 - val_loss: 1.4787 - val_acc: 0.6094
Epoch 6/20
 - 3s - loss: 0.9390 - acc: 0.8694 - val_loss: 1.4540 - val_acc: 0.6406
Epoch 7/20
 - 3s - loss: 0.7865 - acc: 0.9068 - val_loss: 1.4587 - val_acc: 0.5469
Epoch 8/20
 - 3s - loss: 0.6488 - acc: 0.9318 - val_loss: 1.3694 - val_acc: 0.5469
Epoch 9/20
 - 3s - loss: 0.6392 - acc: 0.9147 - val_loss: 1.2478 - val_acc: 0.5938
Epoch 10/20
 - 3s - loss: 0.4943 - acc: 0.9697 - val_loss: 1.1438 - val_acc: 0.7344
Epoch 11/20
 - 3s - loss: 0.4572 - acc: 0.9689 - val_loss: 1.1402 - val_acc: 0.7188
Epoch 12/20
 - 3s - loss: 0.3449 - acc: 0.9773 - val_loss: 1.2099 - val_acc: 0.6719
Epoch 13/20
 - 3s - loss: 0.2539 - acc: 1.0000 - val_loss: 1.0965 - val_acc: 0.7188
Epoch 14/20
 - 3s - loss: 0.2839 - acc: 0.9924 - val_loss: 1.0713 - val_acc: 0.7500
Epoch 15/20
 - 3s - loss: 0.2851 - acc: 0.9848 - val_loss: 1.1540 - val_acc: 0.6406
Epoch 16/20
 - 3s - loss: 0.1935 - acc: 1.0000 - val_loss: 0.9773 - val_acc: 0.7656
Epoch 17/20
 - 3s - loss: 0.1726 - acc: 0.9924 - val_loss: 0.9708 - val_acc: 0.6875
Epoch 18/20
 - 3s - loss: 0.1423 - acc: 1.0000 - val_loss: 1.0660 - val_acc: 0.6875
Epoch 19/20
 - 3s - loss: 0.1334 - acc: 1.0000 - val_loss: 1.0308 - val_acc: 0.7500
Epoch 20/20
 - 3s - loss: 0.0935 - acc: 1.0000 - val_loss: 1.0239 - val_acc: 0.7656
{'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 163, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002430120578229517, 'unfreeze_percentage': 0.2954511240277776, 'rotation_range': 0, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 68, 'batch_size': 33, 'num_dense_units_2': 166, 'learning_rate': 0.0003748303920848836, 'base_model': 'MobileNet', 'activation': 'tanh'}

 ****** MobileNet unfrozen 7 top blocks, cut_off after layer 60 ******
Epoch 1/12
 - 4s - loss: 0.0964 - acc: 1.0000 - val_loss: 0.9628 - val_acc: 0.7656
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/12
 - 3s - loss: 0.0940 - acc: 1.0000 - val_loss: 0.8971 - val_acc: 0.7969
Epoch 3/12
 - 3s - loss: 0.0916 - acc: 1.0000 - val_loss: 0.9549 - val_acc: 0.7812
Epoch 4/12
 - 3s - loss: 0.0905 - acc: 1.0000 - val_loss: 0.8781 - val_acc: 0.8125
Epoch 5/12
 - 3s - loss: 0.0912 - acc: 1.0000 - val_loss: 0.8847 - val_acc: 0.7812
Epoch 6/12
 - 3s - loss: 0.0825 - acc: 1.0000 - val_loss: 0.8489 - val_acc: 0.7969
Epoch 7/12
 - 3s - loss: 0.0754 - acc: 1.0000 - val_loss: 0.9549 - val_acc: 0.7500
Epoch 8/12
 - 3s - loss: 0.0814 - acc: 1.0000 - val_loss: 0.9645 - val_acc: 0.7500
Epoch 9/12
 - 3s - loss: 0.0640 - acc: 1.0000 - val_loss: 0.8351 - val_acc: 0.7812
Epoch 10/12
 - 3s - loss: 0.0833 - acc: 1.0000 - val_loss: 0.9952 - val_acc: 0.7188
Epoch 11/12
 - 3s - loss: 0.0855 - acc: 1.0000 - val_loss: 1.0530 - val_acc: 0.7031
Epoch 12/12
 - 3s - loss: 0.0699 - acc: 1.0000 - val_loss: 1.0036 - val_acc: 0.7188
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (5, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (5, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (5, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (5, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (5, 0, 2)
args: ()
kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 163, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002430120578229517, 'unfreeze_percentage': 0.2954511240277776, 'rotation_range': 0, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 68, 'batch_size': 33, 'num_dense_units_2': 166, 'learning_rate': 0.0003748303920848836, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.28125, 'info': {'runtime': 105.88686323165894, 'histories': {'loss': [2.385760506918264, 1.722749650478363, 1.4178706906562628, 1.2455248084179191, 1.0297038873960807, 0.9378593259079512, 0.7869015807329223, 0.6487590372562408, 0.6419776933533805, 0.49427303671836853, 0.4558833768201429, 0.3448770120739937, 0.25411557086876463, 0.2838577702641487, 0.2862999071908552, 0.19353588618511378, 0.17290305121000424, 0.14225325919687748, 0.13282382297654485, 0.0931433153360389, 0.09653443150049032, 0.09412623508725056, 0.09157127141952515, 0.0905991985007774, 0.09068479787471682, 0.08213393372851749, 0.07539431564509869, 0.08160040199401833, 0.06403349619358778, 0.08360886227252871, 0.08538565221567486, 0.06992082204669714], 'val_loss': [2.0305869579315186, 1.8819992542266846, 1.7850950360298157, 1.7110022902488708, 1.4786938428878784, 1.4540475010871887, 1.4586568474769592, 1.369426429271698, 1.24777352809906, 1.1437567472457886, 1.140151858329773, 1.2099286317825317, 1.0964929163455963, 1.071313738822937, 1.1539652347564697, 0.9773344993591309, 0.97077876329422, 1.0660054683685303, 1.0308294594287872, 1.0239148437976837, 0.9628122448921204, 0.8971406817436218, 0.9548690319061279, 0.8780831098556519, 0.8847310543060303, 0.8488527536392212, 0.9548591375350952, 0.9644675552845001, 0.8351450264453888, 0.9952256381511688, 1.0530125498771667, 1.003598004579544], 'acc': [0.16279070252595945, 0.5303030461072922, 0.6821705685105435, 0.6899225074191426, 0.8449612828188164, 0.8682170884553776, 0.9069767580475918, 0.9318181872367859, 0.912698433512733, 0.9696969836950302, 0.9689922471379124, 0.9772727489471436, 1.0, 0.9924242496490479, 0.9844961388166561, 1.0, 0.992248069408328, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], 'val_acc': [0.34375, 0.515625, 0.46875, 0.484375, 0.609375, 0.640625, 0.546875, 0.546875, 0.59375, 0.734375, 0.71875, 0.671875, 0.71875, 0.75, 0.640625, 0.765625, 0.6875, 0.6875, 0.75, 0.765625, 0.765625, 0.796875, 0.78125, 0.8125, 0.78125, 0.796875, 0.75, 0.75, 0.78125, 0.71875, 0.703125, 0.71875]}}}
exception: None

DEBUG:hpbandster:job_callback for (5, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (5, 0, 3)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (5, 0, 3) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (5, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 5
DEBUG:hpbandster:HBMASTER: submitting job (5, 0, 4) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (5, 0, 3) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (5, 0, 3)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 714, 'zoom_range': 0.0, 'cnn_learning_rate': 3.103991913207938e-05, 'unfreeze_percentage': 0.048290585195785975, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 258, 'batch_size': 29, 'learning_rate': 0.00039780199789041145, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 16:25:05.928134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/17
 - 7s - loss: 2.2547 - acc: 0.1890 - val_loss: 2.2640 - val_acc: 0.1094
Epoch 2/17
 - 5s - loss: 2.0088 - acc: 0.3044 - val_loss: 2.2396 - val_acc: 0.1406
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/17
 - 5s - loss: 1.7403 - acc: 0.5453 - val_loss: 2.2965 - val_acc: 0.1875
Epoch 4/17
 - 5s - loss: 1.3639 - acc: 0.6897 - val_loss: 1.9740 - val_acc: 0.3281
Epoch 5/17
 - 5s - loss: 1.3381 - acc: 0.5674 - val_loss: 1.8554 - val_acc: 0.3438
Epoch 6/17
 - 5s - loss: 1.1598 - acc: 0.6868 - val_loss: 1.9932 - val_acc: 0.3438
Epoch 7/17
 - 5s - loss: 0.8623 - acc: 0.7988 - val_loss: 1.7339 - val_acc: 0.5000
Epoch 8/17
 - 5s - loss: 0.7908 - acc: 0.7931 - val_loss: 1.5831 - val_acc: 0.4219
Epoch 9/17
 - 5s - loss: 0.6916 - acc: 0.8688 - val_loss: 2.1785 - val_acc: 0.4219
Epoch 10/17
 - 5s - loss: 0.5885 - acc: 0.8909 - val_loss: 1.6277 - val_acc: 0.4375
Epoch 11/17
 - 5s - loss: 0.5157 - acc: 0.9034 - val_loss: 1.6448 - val_acc: 0.4375
Epoch 12/17
 - 5s - loss: 0.4764 - acc: 0.8909 - val_loss: 1.5396 - val_acc: 0.5156
Epoch 13/17
 - 5s - loss: 0.3479 - acc: 0.9399 - val_loss: 1.4749 - val_acc: 0.4531
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 14/17
 - 5s - loss: 0.3282 - acc: 0.9539 - val_loss: 1.5996 - val_acc: 0.5625
Epoch 15/17
 - 5s - loss: 0.2979 - acc: 0.9655 - val_loss: 1.3955 - val_acc: 0.5938
Epoch 16/17
 - 5s - loss: 0.2648 - acc: 0.9679 - val_loss: 1.0148 - val_acc: 0.6250
Epoch 17/17
 - 5s - loss: 0.2873 - acc: 0.9499 - val_loss: 1.4448 - val_acc: 0.5938
{'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 714, 'zoom_range': 0.0, 'cnn_learning_rate': 3.103991913207938e-05, 'unfreeze_percentage': 0.048290585195785975, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 258, 'batch_size': 29, 'learning_rate': 0.00039780199789041145, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}

 ****** InceptionResNetV2 unfrozen 2 top blocks, cut_off after layer 744 ******
Epoch 1/15
 - 7s - loss: 0.2418 - acc: 0.9517 - val_loss: 1.2653 - val_acc: 0.6094
Epoch 2/15
 - 5s - loss: 0.2615 - acc: 0.9679 - val_loss: 1.5057 - val_acc: 0.5781
Epoch 3/15
 - 5s - loss: 0.2637 - acc: 0.9429 - val_loss: 1.3418 - val_acc: 0.6719
Epoch 4/15
 - 5s - loss: 0.2973 - acc: 0.9499 - val_loss: 1.3980 - val_acc: 0.5938
Epoch 5/15
 - 6s - loss: 0.2286 - acc: 0.9819 - val_loss: 1.3566 - val_acc: 0.6094
Epoch 6/15
 - 5s - loss: 0.1927 - acc: 0.9790 - val_loss: 1.1714 - val_acc: 0.6562
Epoch 7/15
 - 5s - loss: 0.2234 - acc: 0.9749 - val_loss: 1.2418 - val_acc: 0.6406
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/15
 - 6s - loss: 0.1921 - acc: 0.9931 - val_loss: 1.1449 - val_acc: 0.6719
Epoch 9/15
 - 5s - loss: 0.2054 - acc: 0.9746 - val_loss: 1.1388 - val_acc: 0.6719
Epoch 10/15
 - 5s - loss: 0.1703 - acc: 0.9930 - val_loss: 1.2317 - val_acc: 0.6562
Epoch 11/15
 - 6s - loss: 0.1579 - acc: 1.0000 - val_loss: 1.1355 - val_acc: 0.6719
Epoch 12/15
 - 5s - loss: 0.1984 - acc: 0.9860 - val_loss: 1.1318 - val_acc: 0.6406
Epoch 13/15
 - 6s - loss: 0.1700 - acc: 0.9862 - val_loss: 1.1312 - val_acc: 0.6562
Epoch 14/15
 - 5s - loss: 0.1588 - acc: 1.0000 - val_loss: 1.2588 - val_acc: 0.6250
Epoch 15/15
 - 5s - loss: 0.1814 - acc: 1.0000 - val_loss: 1.2304 - val_acc: 0.6250
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (5, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (5, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (5, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (5, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (5, 0, 3)
args: ()
kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 714, 'zoom_range': 0.0, 'cnn_learning_rate': 3.103991913207938e-05, 'unfreeze_percentage': 0.048290585195785975, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 258, 'batch_size': 29, 'learning_rate': 0.00039780199789041145, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.375, 'info': {'runtime': 189.37921452522278, 'histories': {'loss': [2.252576057175945, 2.0013961343836963, 1.7398061752319336, 1.363878560066223, 1.3065377312495297, 1.161167541840919, 0.8712056108883449, 0.7907853960990906, 0.6800240637842289, 0.5964759361923189, 0.5157214939594269, 0.4862616427410814, 0.35023321984405803, 0.3252532881005366, 0.29790603220462797, 0.25684005627058504, 0.2758111243409322, 0.2417529433965683, 0.2600246938995849, 0.25795975125821907, 0.29452472857962875, 0.21778520975345955, 0.19407049280808383, 0.21801257727289558, 0.1920989364385605, 0.19943485427493893, 0.16583178500483806, 0.15794744342565536, 0.2038860060554698, 0.169998961687088, 0.15659466884414056, 0.1743010940753724], 'val_loss': [2.2640295028686523, 2.239588737487793, 2.2964746952056885, 1.9740199446678162, 1.855420708656311, 1.9932444095611572, 1.733862578868866, 1.583057165145874, 2.1785354614257812, 1.627707600593567, 1.6448141932487488, 1.5395875573158264, 1.4748827815055847, 1.5995553135871887, 1.3954721093177795, 1.0148190557956696, 1.4448034167289734, 1.2653341889381409, 1.5057326555252075, 1.3418418169021606, 1.3980318307876587, 1.35658597946167, 1.1714009642601013, 1.2417635917663574, 1.1449163854122162, 1.138831079006195, 1.2316749095916748, 1.1355087161064148, 1.1317990124225616, 1.1311756372451782, 1.2588024139404297, 1.2303541600704193], 'acc': [0.20300751560388652, 0.3007518717444929, 0.5639097724193917, 0.6896551609039306, 0.5789473655080437, 0.6766917329085501, 0.7969924713435926, 0.7931034326553345, 0.8760330494770334, 0.8872180357015222, 0.9034482479095459, 0.8872180486980238, 0.9398496168896668, 0.9548872189414233, 0.965517234802246, 0.9699248079966781, 0.9548872158043367, 0.9517241239547729, 0.9699248003780394, 0.9473684147784585, 0.9548872158043367, 0.9849624100484347, 0.9774436099188668, 0.9774436014039176, 0.9931034445762634, 0.9752066115702479, 0.9924811989741218, 1.0, 0.9849623979482436, 0.9862068891525269, 1.0, 1.0], 'val_acc': [0.109375, 0.140625, 0.1875, 0.328125, 0.34375, 0.34375, 0.5, 0.421875, 0.421875, 0.4375, 0.4375, 0.515625, 0.453125, 0.5625, 0.59375, 0.625, 0.59375, 0.609375, 0.578125, 0.671875, 0.59375, 0.609375, 0.65625, 0.640625, 0.671875, 0.671875, 0.65625, 0.671875, 0.640625, 0.65625, 0.625, 0.625]}}}
exception: None

DEBUG:hpbandster:job_callback for (5, 0, 3)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (5, 0, 4)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (5, 0, 4) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (5, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 5
DEBUG:hpbandster:HBMASTER: submitting job (5, 0, 5) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (5, 0, 4) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (5, 0, 4)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 310, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017921154316209609, 'unfreeze_percentage': 0.0074029937794173216, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 245, 'batch_size': 20, 'learning_rate': 0.00012058155440967232, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 16:28:15.918907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/12
 - 8s - loss: 2.2955 - acc: 0.0951 - val_loss: 2.3043 - val_acc: 0.1169
Epoch 2/12
 - 6s - loss: 2.1115 - acc: 0.3282 - val_loss: 2.2968 - val_acc: 0.1169
Epoch 3/12
 - 6s - loss: 2.1306 - acc: 0.2875 - val_loss: 2.2601 - val_acc: 0.1558
Epoch 4/12
 - 6s - loss: 2.0676 - acc: 0.3352 - val_loss: 2.1578 - val_acc: 0.2597
Epoch 5/12
 - 6s - loss: 1.9766 - acc: 0.2585 - val_loss: 2.0880 - val_acc: 0.2727
Epoch 6/12
 - 6s - loss: 2.0258 - acc: 0.2952 - val_loss: 2.0051 - val_acc: 0.3247
Epoch 7/12
 - 6s - loss: 2.0044 - acc: 0.3296 - val_loss: 2.0136 - val_acc: 0.3766
Epoch 8/12
 - 6s - loss: 1.8076 - acc: 0.4688 - val_loss: 1.9579 - val_acc: 0.2987
Epoch 9/12
 - 6s - loss: 1.8360 - acc: 0.4627 - val_loss: 1.8631 - val_acc: 0.4935
Epoch 10/12
 - 6s - loss: 1.7864 - acc: 0.5451 - val_loss: 1.9133 - val_acc: 0.3247
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 11/12
 - 6s - loss: 1.6720 - acc: 0.6268 - val_loss: 1.7182 - val_acc: 0.4935
Epoch 12/12
 - 6s - loss: 1.6883 - acc: 0.5007 - val_loss: 1.6688 - val_acc: 0.5065
{'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 310, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017921154316209609, 'unfreeze_percentage': 0.0074029937794173216, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 245, 'batch_size': 20, 'learning_rate': 0.00012058155440967232, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}

 ****** InceptionResNetV2 no layers unfrozen
Epoch 1/20
 - 6s - loss: 1.5688 - acc: 0.6401 - val_loss: 1.7178 - val_acc: 0.3766
Epoch 2/20
 - 6s - loss: 1.4445 - acc: 0.7562 - val_loss: 1.5729 - val_acc: 0.4935
Epoch 3/20
 - 6s - loss: 1.4485 - acc: 0.7789 - val_loss: 1.5255 - val_acc: 0.5325
Epoch 4/20
 - 6s - loss: 1.3622 - acc: 0.7387 - val_loss: 1.5625 - val_acc: 0.5195
Epoch 5/20
 - 6s - loss: 1.2985 - acc: 0.7000 - val_loss: 1.5588 - val_acc: 0.4935
Epoch 6/20
 - 6s - loss: 1.3663 - acc: 0.7016 - val_loss: 1.5344 - val_acc: 0.5195
Epoch 7/20
 - 6s - loss: 1.1476 - acc: 0.7875 - val_loss: 1.4743 - val_acc: 0.5065
Epoch 8/20
 - 6s - loss: 1.2021 - acc: 0.8289 - val_loss: 1.4496 - val_acc: 0.5714
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 9/20
 - 6s - loss: 1.1919 - acc: 0.6655 - val_loss: 1.4687 - val_acc: 0.5714
Epoch 10/20
 - 6s - loss: 1.1564 - acc: 0.7162 - val_loss: 1.5084 - val_acc: 0.5455
Epoch 11/20
 - 6s - loss: 1.2068 - acc: 0.6845 - val_loss: 1.4885 - val_acc: 0.5325
Epoch 12/20
 - 6s - loss: 0.9473 - acc: 0.8000 - val_loss: 1.4215 - val_acc: 0.5584
Epoch 13/20
 - 6s - loss: 1.0358 - acc: 0.7852 - val_loss: 1.4871 - val_acc: 0.5584
Epoch 14/20
 - 6s - loss: 1.0623 - acc: 0.7645 - val_loss: 1.4059 - val_acc: 0.6104
Epoch 15/20
 - 6s - loss: 1.0066 - acc: 0.7789 - val_loss: 1.4349 - val_acc: 0.6104
Epoch 16/20
 - 6s - loss: 0.8531 - acc: 0.8625 - val_loss: 1.4725 - val_acc: 0.5455
Epoch 17/20
 - 6s - loss: 0.8196 - acc: 0.8986 - val_loss: 1.4653 - val_acc: 0.5455
Epoch 18/20
 - 6s - loss: 1.0527 - acc: 0.7352 - val_loss: 1.4600 - val_acc: 0.5195
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 19/20
 - 6s - loss: 0.9103 - acc: 0.7542 - val_loss: 1.5387 - val_acc: 0.4805
Epoch 20/20
 - 6s - loss: 0.7308 - acc: 0.8625 - val_loss: 1.4536 - val_acc: 0.5195
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (5, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (5, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (5, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (5, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (5, 0, 4)
args: ()
kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 310, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017921154316209609, 'unfreeze_percentage': 0.0074029937794173216, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 245, 'batch_size': 20, 'learning_rate': 0.00012058155440967232, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.48051946658592715, 'info': {'runtime': 207.55941891670227, 'histories': {'loss': [2.3061552920811614, 2.1812846257653034, 2.130602777004242, 2.079034466139028, 2.0418152171121515, 1.9474887367217772, 1.9594356845801986, 1.8076171875, 1.762529175046464, 1.7159846366291316, 1.648426331264872, 1.6116043480349258, 1.5217331832563374, 1.4445155411958694, 1.3981847847011728, 1.2809625248755179, 1.2984917908906937, 1.241123422499626, 1.1476468443870544, 1.1657320294581668, 1.0979106023278036, 1.0744986785969264, 1.0584779977798462, 0.9472818374633789, 0.9905419937321838, 0.9133886944863104, 0.8737320043671299, 0.8531458154320717, 0.7766123976505978, 0.8925186630705713, 0.7664236804129372, 0.7307682633399963], 'val_loss': [2.3042520300134437, 2.2968480029663483, 2.260113604657062, 2.157808310025698, 2.0880291585798387, 2.0050837312425887, 2.0136244622143833, 1.957914971686029, 1.8630825420478723, 1.9133086932169927, 1.7181651329065297, 1.6688211428654658, 1.7177964123812588, 1.572874066117522, 1.525527421530191, 1.5624681602824817, 1.558812509883534, 1.5344120372425427, 1.4742732884047867, 1.44963750127074, 1.4686881752757284, 1.5083820169622248, 1.4885382621319263, 1.4215039123188367, 1.4871388844081335, 1.4058747291564941, 1.43493922964319, 1.472481631613397, 1.4653201846333292, 1.4599939011908196, 1.5386785857089154, 1.4535704897595692], 'acc': [0.10563380439096773, 0.25352113452595726, 0.2875000052154064, 0.3169014120185879, 0.17605634254049246, 0.30645161795039333, 0.3661971948516201, 0.4687500111758709, 0.514084516276776, 0.6056338296809667, 0.6408450788175556, 0.5563380432800508, 0.7112676073128069, 0.7562499940395355, 0.8098591532505733, 0.7983870910060021, 0.7000000141561031, 0.8145161290322581, 0.7875000163912773, 0.8098591683616101, 0.7394366365083507, 0.7957746697143769, 0.7605633937137227, 0.800000011920929, 0.8169014084507042, 0.830645163213053, 0.8098591532505733, 0.8624999970197678, 0.8873239419829677, 0.8169014185247286, 0.83802815894006, 0.8625000044703484], 'val_acc': [0.11688311785072475, 0.11688311736692082, 0.15584415681176372, 0.25974026022406366, 0.27272727543657477, 0.32467532661054044, 0.3766233812678944, 0.29870130489398905, 0.49350649969918386, 0.32467532777166985, 0.493506494667623, 0.5064935126861969, 0.37662337933267864, 0.493506494667623, 0.5324675386602228, 0.5194805256732098, 0.49350649969918386, 0.5194805256732098, 0.5064935111380243, 0.5714285760730892, 0.5714285760730892, 0.5454545508731495, 0.5324675448529133, 0.5584415723751117, 0.5584415700528529, 0.6103896142600419, 0.6103896212268185, 0.5454545485508906, 0.5454545508731495, 0.5194805241250372, 0.4805194867121709, 0.5194805334140729]}}}
exception: None

DEBUG:hpbandster:job_callback for (5, 0, 4)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (5, 0, 5)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (5, 0, 5) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (5, 0, 5) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (5, 0, 5) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (5, 0, 5)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 331, 'zoom_range': 0.0, 'cnn_learning_rate': 7.407320852121033e-05, 'unfreeze_percentage': 0.1677111577470082, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 68, 'batch_size': 43, 'num_dense_units_2': 249, 'learning_rate': 0.008220722803225538, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 16:31:57.244034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/25
 - 33s - loss: 2.3526 - acc: 0.0853 - val_loss: 2.2992 - val_acc: 0.0938
Epoch 2/25
 - 19s - loss: 2.2679 - acc: 0.1557 - val_loss: 2.2991 - val_acc: 0.1562
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/25
 - 19s - loss: 2.2266 - acc: 0.1653 - val_loss: 2.3143 - val_acc: 0.0312
Epoch 4/25
 - 19s - loss: 2.1035 - acc: 0.2326 - val_loss: 2.2928 - val_acc: 0.1250
Epoch 5/25
 - 19s - loss: 2.0659 - acc: 0.3069 - val_loss: 2.2600 - val_acc: 0.0938
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 6/25
 - 19s - loss: 1.9187 - acc: 0.3694 - val_loss: 2.3069 - val_acc: 0.0625
Epoch 7/25
 - 19s - loss: 1.8991 - acc: 0.4031 - val_loss: 2.2903 - val_acc: 0.0000e+00
Epoch 8/25
 - 19s - loss: 1.8559 - acc: 0.4556 - val_loss: 2.3460 - val_acc: 0.0938
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 9/25
 - 19s - loss: 1.7855 - acc: 0.4943 - val_loss: 2.3081 - val_acc: 0.1562
Epoch 10/25
 - 19s - loss: 1.7242 - acc: 0.5180 - val_loss: 2.3862 - val_acc: 0.0625
Epoch 11/25
 - 19s - loss: 1.7035 - acc: 0.5426 - val_loss: 2.3940 - val_acc: 0.0625
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 12/25
 - 19s - loss: 1.6381 - acc: 0.5937 - val_loss: 2.3048 - val_acc: 0.0938
Epoch 13/25
 - 19s - loss: 1.5441 - acc: 0.6799 - val_loss: 2.3902 - val_acc: 0.0938
Epoch 14/25
 - 19s - loss: 1.5677 - acc: 0.6491 - val_loss: 2.2923 - val_acc: 0.1250
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 15/25
 - 19s - loss: 1.3954 - acc: 0.7907 - val_loss: 2.3887 - val_acc: 0.0625
Epoch 16/25
 - 19s - loss: 1.4637 - acc: 0.7071 - val_loss: 2.4143 - val_acc: 0.0938
Epoch 17/25
 - 19s - loss: 1.3769 - acc: 0.7287 - val_loss: 2.3726 - val_acc: 0.0938
Epoch 18/25
 - 19s - loss: 1.3286 - acc: 0.7696 - val_loss: 2.3773 - val_acc: 0.0938
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 19/25
 - 19s - loss: 1.2578 - acc: 0.8566 - val_loss: 2.3306 - val_acc: 0.0625
Epoch 20/25
 - 19s - loss: 1.2271 - acc: 0.8285 - val_loss: 2.4345 - val_acc: 0.0938
Epoch 21/25
 - 19s - loss: 1.1574 - acc: 0.8584 - val_loss: 2.5118 - val_acc: 0.0312
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 22/25
 - 19s - loss: 1.1110 - acc: 0.8527 - val_loss: 2.3497 - val_acc: 0.1250
Epoch 23/25
 - 19s - loss: 1.1626 - acc: 0.8250 - val_loss: 2.4218 - val_acc: 0.0938
Epoch 24/25
 - 19s - loss: 1.0709 - acc: 0.8610 - val_loss: 2.4456 - val_acc: 0.0938
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 25/25
 - 19s - loss: 1.0553 - acc: 0.8602 - val_loss: 2.2901 - val_acc: 0.1250
{'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 331, 'zoom_range': 0.0, 'cnn_learning_rate': 7.407320852121033e-05, 'unfreeze_percentage': 0.1677111577470082, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 68, 'batch_size': 43, 'num_dense_units_2': 249, 'learning_rate': 0.008220722803225538, 'base_model': 'ResNet50', 'activation': 'tanh'}

 ****** ResNet50 unfrozen 2 top blocks, cut_off after layer 151 ******
Epoch 1/7
 - 30s - loss: 0.9830 - acc: 0.9006 - val_loss: 2.3523 - val_acc: 0.0938
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/7
 - 19s - loss: 1.0807 - acc: 0.8725 - val_loss: 2.4487 - val_acc: 0.0312
Epoch 3/7
 - 19s - loss: 0.9547 - acc: 0.9147 - val_loss: 2.4529 - val_acc: 0.0625
Epoch 4/7
 - 19s - loss: 1.0032 - acc: 0.9094 - val_loss: 2.2979 - val_acc: 0.0938
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 5/7
 - 19s - loss: 0.9787 - acc: 0.8936 - val_loss: 2.4793 - val_acc: 0.0938
Epoch 6/7
 - 19s - loss: 0.9840 - acc: 0.8915 - val_loss: 2.5396 - val_acc: 0.0938
Epoch 7/7
 - 19s - loss: 0.9944 - acc: 0.9138 - val_loss: 2.4974 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (5, 0, 5), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (5, 0, 5) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (5, 0, 5) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (5, 0, 5) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (5, 0, 5)
args: ()
kwargs: {'budget': 32.0, 'config': {'num_dense_layers': 3, 'optimizer': 'SGD', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 331, 'zoom_range': 0.0, 'cnn_learning_rate': 7.407320852121033e-05, 'unfreeze_percentage': 0.1677111577470082, 'rotation_range': 0, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 68, 'batch_size': 43, 'num_dense_units_2': 249, 'learning_rate': 0.008220722803225538, 'base_model': 'ResNet50', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.90625, 'info': {'runtime': 693.0898749828339, 'histories': {'loss': [2.3525943756103516, 2.263404211076368, 2.227263457184538, 2.103450059890747, 2.062644415542859, 1.9153995253458744, 1.8991231520970662, 1.8550899589762968, 1.7875720943723405, 1.7306761090495006, 1.703515887260437, 1.6351313901548625, 1.5406595738995976, 1.5633154286056006, 1.3953922192255657, 1.4593021939782536, 1.376905878384908, 1.330729771061104, 1.2591829089557423, 1.2280108107238257, 1.1614262466671086, 1.1109904050827026, 1.1618373874856645, 1.0669449367443054, 1.0566837056344296, 0.9753819608888706, 1.0756170409066337, 0.9546554883321127, 1.0022880675412025, 0.9769810888947559, 0.9839555025100708, 0.9930716011704517], 'val_loss': [2.2991623878479004, 2.299131155014038, 2.3143157958984375, 2.2927603721618652, 2.260010242462158, 2.3068761825561523, 2.290337085723877, 2.345959424972534, 2.3080828189849854, 2.3862199783325195, 2.394042491912842, 2.3047938346862793, 2.390242576599121, 2.2922542095184326, 2.388669013977051, 2.4142673015594482, 2.372579574584961, 2.3772716522216797, 2.330625534057617, 2.4345147609710693, 2.511800765991211, 2.3497447967529297, 2.4218244552612305, 2.445603370666504, 2.290070056915283, 2.3523175716400146, 2.4487009048461914, 2.452885150909424, 2.297917127609253, 2.479271650314331, 2.53956937789917, 2.4973528385162354], 'acc': [0.08527132123708725, 0.1596638711811114, 0.165137618916844, 0.232558141152064, 0.3109243802663659, 0.36974790116318135, 0.40310077865918476, 0.45378151811471507, 0.4873949752635315, 0.5126050390115305, 0.5426356792449951, 0.5966386785026357, 0.6806722573873376, 0.6554621928880194, 0.7906976739565531, 0.7058823624578845, 0.7286821802457174, 0.7647059048925128, 0.8571428591463747, 0.8235294167734996, 0.8571428471252698, 0.8527131875356039, 0.8235294408157092, 0.8655462154821187, 0.8571428781797906, 0.9075629991643569, 0.8739495898495201, 0.9147286613782247, 0.9075630697883478, 0.8907563390852022, 0.8914728959401449, 0.9159663615106535], 'val_acc': [0.09375, 0.15625, 0.03125, 0.125, 0.09375, 0.0625, 0.0, 0.09375, 0.15625, 0.0625, 0.0625, 0.09375, 0.09375, 0.125, 0.0625, 0.09375, 0.09375, 0.09375, 0.0625, 0.09375, 0.03125, 0.125, 0.09375, 0.09375, 0.125, 0.09375, 0.03125, 0.0625, 0.09375, 0.09375, 0.09375, 0.09375]}}}
exception: None

DEBUG:hpbandster:job_callback for (5, 0, 5)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 5
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:HBMASTER: submitting job (5, 0, 4) to dispatcher
DEBUG:hpbandster:DISPATCHER: trying to submit job (5, 0, 4)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (5, 0, 4) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 5
DEBUG:hpbandster:HBMASTER: submitting job (5, 0, 3) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (5, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (5, 0, 4) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (5, 0, 4)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 64.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 310, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017921154316209609, 'unfreeze_percentage': 0.0074029937794173216, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 245, 'batch_size': 20, 'learning_rate': 0.00012058155440967232, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 16:43:17.864928: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/12
 - 7s - loss: 2.3165 - acc: 0.1331 - val_loss: 2.3464 - val_acc: 0.1429
Epoch 2/12
 - 6s - loss: 2.2084 - acc: 0.2500 - val_loss: 2.2670 - val_acc: 0.1558
Epoch 3/12
 - 5s - loss: 2.1141 - acc: 0.3258 - val_loss: 2.2352 - val_acc: 0.1948
Epoch 4/12
 - 6s - loss: 2.0727 - acc: 0.3375 - val_loss: 2.1812 - val_acc: 0.2468
Epoch 5/12
 - 6s - loss: 2.0700 - acc: 0.3677 - val_loss: 2.1612 - val_acc: 0.2208
Epoch 6/12
 - 6s - loss: 1.9800 - acc: 0.3313 - val_loss: 2.1098 - val_acc: 0.2338
Epoch 7/12
 - 6s - loss: 1.8272 - acc: 0.5761 - val_loss: 1.9766 - val_acc: 0.4416
Epoch 8/12
 - 6s - loss: 1.9045 - acc: 0.4437 - val_loss: 1.9321 - val_acc: 0.4026
Epoch 9/12
 - 6s - loss: 1.7702 - acc: 0.6134 - val_loss: 1.9987 - val_acc: 0.3247
Epoch 10/12
 - 6s - loss: 1.6960 - acc: 0.5704 - val_loss: 1.8142 - val_acc: 0.3896
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 11/12
 - 6s - loss: 1.5883 - acc: 0.5375 - val_loss: 1.6973 - val_acc: 0.4935
Epoch 12/12
 - 6s - loss: 1.6787 - acc: 0.5677 - val_loss: 1.6908 - val_acc: 0.4805
{'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 310, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017921154316209609, 'unfreeze_percentage': 0.0074029937794173216, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 245, 'batch_size': 20, 'learning_rate': 0.00012058155440967232, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}

 ****** InceptionResNetV2 no layers unfrozen
Epoch 1/52
 - 6s - loss: 1.6122 - acc: 0.6338 - val_loss: 1.6449 - val_acc: 0.4935
Epoch 2/52
 - 6s - loss: 1.4672 - acc: 0.6331 - val_loss: 1.8761 - val_acc: 0.3247
Epoch 3/52
 - 6s - loss: 1.3563 - acc: 0.5938 - val_loss: 1.5535 - val_acc: 0.5195
Epoch 4/52
 - 6s - loss: 1.3666 - acc: 0.7099 - val_loss: 1.5009 - val_acc: 0.5714
Epoch 5/52
 - 6s - loss: 1.3534 - acc: 0.7774 - val_loss: 1.4543 - val_acc: 0.5844
Epoch 6/52
 - 6s - loss: 1.2198 - acc: 0.7313 - val_loss: 1.4251 - val_acc: 0.5844
Epoch 7/52
 - 6s - loss: 1.1624 - acc: 0.8289 - val_loss: 1.4551 - val_acc: 0.5325
Epoch 8/52
 - 6s - loss: 1.1185 - acc: 0.7782 - val_loss: 1.4854 - val_acc: 0.5714
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 9/52
 - 6s - loss: 1.1570 - acc: 0.6972 - val_loss: 1.3972 - val_acc: 0.5195
Epoch 10/52
 - 6s - loss: 1.1215 - acc: 0.7852 - val_loss: 1.3583 - val_acc: 0.5714
Epoch 11/52
 - 6s - loss: 0.9878 - acc: 0.8859 - val_loss: 1.4470 - val_acc: 0.5065
Epoch 12/52
 - 6s - loss: 1.0352 - acc: 0.7915 - val_loss: 1.4509 - val_acc: 0.5065
Epoch 13/52
 - 6s - loss: 1.1506 - acc: 0.6782 - val_loss: 1.4359 - val_acc: 0.5065
Epoch 14/52
 - 6s - loss: 0.8339 - acc: 0.8500 - val_loss: 1.3472 - val_acc: 0.5584
Epoch 15/52
 - 6s - loss: 0.9975 - acc: 0.7710 - val_loss: 1.3581 - val_acc: 0.5195
Epoch 16/52
 - 6s - loss: 0.7713 - acc: 0.8250 - val_loss: 1.3897 - val_acc: 0.5195
Epoch 17/52
 - 6s - loss: 0.8841 - acc: 0.8296 - val_loss: 1.3853 - val_acc: 0.5325
Epoch 18/52
 - 6s - loss: 0.8484 - acc: 0.7852 - val_loss: 1.3963 - val_acc: 0.5455
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 19/52
 - 6s - loss: 0.8369 - acc: 0.8613 - val_loss: 1.4844 - val_acc: 0.4675
Epoch 20/52
 - 6s - loss: 0.8316 - acc: 0.8796 - val_loss: 1.4219 - val_acc: 0.5844
Epoch 21/52
 - 6s - loss: 0.8023 - acc: 0.7923 - val_loss: 1.3291 - val_acc: 0.5844
Epoch 22/52
 - 6s - loss: 0.6432 - acc: 0.9000 - val_loss: 1.3717 - val_acc: 0.5455
Epoch 23/52
 - 6s - loss: 0.6750 - acc: 0.8930 - val_loss: 1.2950 - val_acc: 0.5974
Epoch 24/52
 - 6s - loss: 0.6387 - acc: 0.9239 - val_loss: 1.3643 - val_acc: 0.5584
Epoch 25/52
 - 6s - loss: 0.8144 - acc: 0.7859 - val_loss: 1.3677 - val_acc: 0.5844
Epoch 26/52
 - 6s - loss: 0.7759 - acc: 0.7986 - val_loss: 1.5789 - val_acc: 0.4675
Epoch 27/52
 - 6s - loss: 0.7021 - acc: 0.8423 - val_loss: 1.3870 - val_acc: 0.5325
Epoch 28/52
 - 6s - loss: 0.6542 - acc: 0.8739 - val_loss: 1.3729 - val_acc: 0.5195
Epoch 29/52
 - 6s - loss: 0.5137 - acc: 0.9056 - val_loss: 1.3657 - val_acc: 0.5195
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 30/52
 - 6s - loss: 0.5369 - acc: 0.9063 - val_loss: 1.3856 - val_acc: 0.5714
Epoch 31/52
 - 6s - loss: 0.6617 - acc: 0.8796 - val_loss: 1.4270 - val_acc: 0.5325
Epoch 32/52
 - 6s - loss: 0.5437 - acc: 0.9303 - val_loss: 1.3596 - val_acc: 0.5455
Epoch 33/52
 - 6s - loss: 0.5533 - acc: 0.8866 - val_loss: 1.3429 - val_acc: 0.5844
Epoch 34/52
 - 6s - loss: 0.5390 - acc: 0.8803 - val_loss: 1.3108 - val_acc: 0.6364
Epoch 35/52
 - 6s - loss: 0.7427 - acc: 0.7419 - val_loss: 1.4717 - val_acc: 0.5195
Epoch 36/52
 - 6s - loss: 0.4981 - acc: 0.9187 - val_loss: 1.4992 - val_acc: 0.5065
Epoch 37/52
 - 6s - loss: 0.6276 - acc: 0.8239 - val_loss: 1.4702 - val_acc: 0.4675
Epoch 38/52
 - 6s - loss: 0.5535 - acc: 0.8549 - val_loss: 1.3073 - val_acc: 0.5714
Epoch 39/52
 - 6s - loss: 0.7030 - acc: 0.8113 - val_loss: 1.2765 - val_acc: 0.5974
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 40/52
 - 6s - loss: 0.5310 - acc: 0.8375 - val_loss: 1.6202 - val_acc: 0.4286
Epoch 41/52
 - 6s - loss: 0.4832 - acc: 0.9113 - val_loss: 1.3301 - val_acc: 0.5974
Epoch 42/52
 - 6s - loss: 0.7082 - acc: 0.8355 - val_loss: 1.6322 - val_acc: 0.4675
Epoch 43/52
 - 6s - loss: 0.3788 - acc: 0.9125 - val_loss: 1.3291 - val_acc: 0.5584
Epoch 44/52
 - 6s - loss: 0.4354 - acc: 0.9183 - val_loss: 1.3012 - val_acc: 0.6234
Epoch 45/52
 - 6s - loss: 0.4068 - acc: 0.9493 - val_loss: 1.3486 - val_acc: 0.6234
Epoch 46/52
 - 6s - loss: 0.4365 - acc: 0.9556 - val_loss: 1.3321 - val_acc: 0.5844
Epoch 47/52
 - 6s - loss: 0.5690 - acc: 0.8303 - val_loss: 1.3711 - val_acc: 0.5325
Epoch 48/52
 - 6s - loss: 0.4329 - acc: 0.9056 - val_loss: 1.3598 - val_acc: 0.5195
Epoch 49/52
 - 6s - loss: 0.3303 - acc: 0.9562 - val_loss: 1.3234 - val_acc: 0.5455
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 50/52
 - 6s - loss: 0.3794 - acc: 0.9871 - val_loss: 1.4712 - val_acc: 0.5065
Epoch 51/52
 - 6s - loss: 0.3727 - acc: 0.9250 - val_loss: 1.4415 - val_acc: 0.5584
Epoch 52/52
 - 6s - loss: 0.3444 - acc: 0.9548 - val_loss: 1.3478 - val_acc: 0.5714
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (5, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (5, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (5, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (5, 0, 4) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (5, 0, 4)
args: ()
kwargs: {'budget': 64.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 310, 'zoom_range': 0.0, 'cnn_learning_rate': 0.00017921154316209609, 'unfreeze_percentage': 0.0074029937794173216, 'rotation_range': 0, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 245, 'batch_size': 20, 'learning_rate': 0.00012058155440967232, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.42857142237873824, 'info': {'runtime': 394.1144742965698, 'histories': {'loss': [2.313461223118742, 2.208403915166855, 2.119191062065863, 2.0726557970046997, 1.984942740009677, 1.9799775183200836, 1.8081278431583458, 1.8423153245952768, 1.7683222629654576, 1.675597973272834, 1.5883042514324188, 1.5336779317548197, 1.5048173682790407, 1.4462157706139793, 1.3563019335269928, 1.2683004392704493, 1.2115781807130384, 1.219803661108017, 1.1037287241976026, 1.1132793795894569, 1.0693939773129746, 1.0341674005481558, 0.93856714980703, 0.9219539501297642, 0.9639626691039179, 0.8339265137910843, 0.8323669856594454, 0.7713375017046928, 0.7649666876860068, 0.8048001242355561, 0.6863235058918805, 0.7882293546703499, 0.6422393372361089, 0.6432072669267654, 0.5909834831533297, 0.5611710514820797, 0.6994197838742968, 0.6003513000380825, 0.5825773863725259, 0.5440390168781012, 0.44717713560856565, 0.536869253963232, 0.5655421698597115, 0.4868520657781144, 0.4703990791884946, 0.48550301118635797, 0.4468254336426335, 0.4980965442955494, 0.42427566731479804, 0.488254683957973, 0.4382467765203664, 0.5310458838939667, 0.46314372227225503, 0.45239069481049815, 0.3787800073623657, 0.32624801069917814, 0.36987104382313474, 0.3625551017237381, 0.38452083543992377, 0.3627166068050223, 0.3303184174001217, 0.27891044270607734, 0.3727046474814415, 0.30010347693197187], 'val_loss': [2.3464063049910906, 2.2669889864983497, 2.2352203734509355, 2.181238233269035, 2.1611950118820387, 2.109817684470833, 1.9766334124973841, 1.9320692071666965, 1.9987273804553143, 1.8141761569233683, 1.6973359275173832, 1.6907998834337508, 1.644925397711915, 1.8760732427819984, 1.5535061669040036, 1.50087313063733, 1.4542623309345988, 1.425149951662336, 1.4551105777938644, 1.4853621318742827, 1.3972043774344705, 1.3583307219790173, 1.4469708142342506, 1.4509252031128128, 1.4358557725881602, 1.3472056295964625, 1.3581172893573712, 1.389732720015885, 1.3852682547135786, 1.3962957781630676, 1.4843842271086458, 1.4219149087930654, 1.3290899186939389, 1.371734035479558, 1.2949981472708962, 1.3643100292651684, 1.3676957526764313, 1.578898306016798, 1.386992392601905, 1.3728947639465332, 1.3656899774229372, 1.3855969394956316, 1.427007668978208, 1.359602147882635, 1.3428632624737629, 1.3107692266439464, 1.4717087544404066, 1.499216042555772, 1.470224597237327, 1.3073067572209742, 1.2764693359275916, 1.6201657521260249, 1.330064998044596, 1.632193263474997, 1.3291386783897103, 1.3011965503940335, 1.3485824040004186, 1.3321074897592717, 1.3711409971311495, 1.3598407615314831, 1.323430516503074, 1.4712315008237764, 1.4414587918814126, 1.34781796901257], 'acc': [0.14788732614735484, 0.25000000558793545, 0.2822580630740812, 0.3375000022351742, 0.45967742800712585, 0.33125000819563866, 0.5845070540065497, 0.4929577590714038, 0.5704225377297737, 0.6338028378889594, 0.5375000052154064, 0.7096774251230301, 0.704225352112676, 0.647887325622666, 0.5937500186264515, 0.7887323977242053, 0.8467741897029262, 0.7312500029802322, 0.8098591599665897, 0.7535211519456245, 0.7746478873239436, 0.8169014168457246, 0.8732394315827061, 0.823943663650835, 0.7535211301185716, 0.8500000014901161, 0.8387096716511634, 0.8250000104308128, 0.8661971780615794, 0.8169014168457246, 0.9014084372721928, 0.8661971763825752, 0.8802816817458247, 0.8999999836087227, 0.9366197048778265, 0.9154929459934503, 0.8732394349407142, 0.8873239285509351, 0.8802816716718002, 0.9154929560674748, 0.9507042152780882, 0.9062500074505806, 0.8661971847775957, 0.9225352095886016, 0.9295774664677364, 0.9225352028725853, 0.9274193548387096, 0.9187499955296516, 0.9154929493514585, 0.8943661820720619, 0.9014084389511968, 0.8375000059604645, 0.9014084439882091, 0.9193548425551383, 0.9124999940395355, 0.9647887256783498, 0.9436619583989533, 0.9507042135990841, 0.9225352045515893, 0.9507042236731086, 0.9562499895691872, 0.9838709638964745, 0.9249999970197678, 0.9435483832513133], 'val_acc': [0.14285714382475073, 0.15584415681176372, 0.19480519528899873, 0.24675325217185082, 0.2207792234885228, 0.2337662364755358, 0.4415584442677436, 0.40259740375853204, 0.32467532661054044, 0.3896103942549074, 0.49350649969918386, 0.4805194859380846, 0.4935064981510113, 0.32467532564293256, 0.5194805334140729, 0.5714285745249166, 0.5844155906082747, 0.5844155848026276, 0.5324675344027482, 0.5714285752990029, 0.5194805241250372, 0.5714285760730892, 0.5064935119121106, 0.5064935119121106, 0.506493510363938, 0.5584415596026879, 0.5194805256732098, 0.5194805241250372, 0.5324675371120502, 0.5454545562917535, 0.4675324737251579, 0.5844155890601022, 0.5844155890601022, 0.5454545508731495, 0.5974026097879781, 0.5584415603767742, 0.5844155890601022, 0.4675324729510716, 0.5324675371120502, 0.5194805241250372, 0.519480523350951, 0.5714285776212618, 0.5324675378861365, 0.5454545508731495, 0.5844155863508002, 0.6363636402340679, 0.5194805310918139, 0.5064935111380243, 0.46753247991784824, 0.5714285745249166, 0.5974026004989426, 0.42857143399003267, 0.5974025985637268, 0.467532471402899, 0.5584415615379036, 0.6233766287952275, 0.6233766373101767, 0.5844155960268789, 0.5324675378861365, 0.5194805334140729, 0.5454545508731495, 0.5064935095898517, 0.5584415630860762, 0.5714285776212618]}}}
exception: None

DEBUG:hpbandster:job_callback for (5, 0, 4)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (5, 0, 3)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (5, 0, 3) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 5
DEBUG:hpbandster:HBMASTER: submitting job (5, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (5, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (5, 0, 3) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (5, 0, 3)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 64.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 714, 'zoom_range': 0.0, 'cnn_learning_rate': 3.103991913207938e-05, 'unfreeze_percentage': 0.048290585195785975, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 258, 'batch_size': 29, 'learning_rate': 0.00039780199789041145, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
2018-02-08 16:49:52.035399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/17
 - 7s - loss: 2.3609 - acc: 0.1540 - val_loss: 2.1828 - val_acc: 0.1719
Epoch 2/17
 - 5s - loss: 2.0670 - acc: 0.2483 - val_loss: 2.2546 - val_acc: 0.1094
Epoch 3/17
 - 5s - loss: 1.8215 - acc: 0.5534 - val_loss: 2.1370 - val_acc: 0.1562
Epoch 4/17
 - 6s - loss: 1.5600 - acc: 0.6621 - val_loss: 2.0348 - val_acc: 0.2969
Epoch 5/17
 - 5s - loss: 1.3703 - acc: 0.7498 - val_loss: 2.0714 - val_acc: 0.2500
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 6/17
 - 5s - loss: 1.0938 - acc: 0.7627 - val_loss: 1.8178 - val_acc: 0.2969
Epoch 7/17
 - 5s - loss: 0.9655 - acc: 0.7609 - val_loss: 2.2889 - val_acc: 0.2031
Epoch 8/17
 - 5s - loss: 0.7957 - acc: 0.8169 - val_loss: 2.0083 - val_acc: 0.3438
Epoch 9/17
 - 5s - loss: 0.6560 - acc: 0.8659 - val_loss: 1.8080 - val_acc: 0.4375
Epoch 10/17
 - 6s - loss: 0.5032 - acc: 0.9103 - val_loss: 1.5454 - val_acc: 0.4844
Epoch 11/17
 - 5s - loss: 0.4593 - acc: 0.9149 - val_loss: 2.2100 - val_acc: 0.4062
Epoch 12/17
 - 5s - loss: 0.6643 - acc: 0.7925 - val_loss: 1.3923 - val_acc: 0.5156
Epoch 13/17
 - 5s - loss: 0.4925 - acc: 0.8880 - val_loss: 1.8240 - val_acc: 0.4219
Epoch 14/17
 - 6s - loss: 0.4460 - acc: 0.8897 - val_loss: 2.0715 - val_acc: 0.3750
Epoch 15/17
 - 5s - loss: 0.3609 - acc: 0.9237 - val_loss: 1.4291 - val_acc: 0.5312
Epoch 16/17
 - 5s - loss: 0.2977 - acc: 0.9539 - val_loss: 1.5585 - val_acc: 0.5156
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 17/17
 - 5s - loss: 0.2472 - acc: 0.9860 - val_loss: 1.4431 - val_acc: 0.5625
{'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 714, 'zoom_range': 0.0, 'cnn_learning_rate': 3.103991913207938e-05, 'unfreeze_percentage': 0.048290585195785975, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 258, 'batch_size': 29, 'learning_rate': 0.00039780199789041145, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}

 ****** InceptionResNetV2 unfrozen 2 top blocks, cut_off after layer 744 ******
Epoch 1/47
 - 7s - loss: 0.1903 - acc: 0.9889 - val_loss: 1.1724 - val_acc: 0.6094
Epoch 2/47
 - 6s - loss: 0.1876 - acc: 0.9749 - val_loss: 1.2677 - val_acc: 0.6250
Epoch 3/47
 - 6s - loss: 0.2003 - acc: 0.9749 - val_loss: 1.2554 - val_acc: 0.6094
Epoch 4/47
 - 5s - loss: 0.2102 - acc: 0.9790 - val_loss: 1.1355 - val_acc: 0.6562
Epoch 5/47
 - 6s - loss: 0.2167 - acc: 0.9720 - val_loss: 1.1961 - val_acc: 0.6562
Epoch 6/47
 - 6s - loss: 0.2053 - acc: 0.9862 - val_loss: 1.2791 - val_acc: 0.5938
Epoch 7/47
 - 6s - loss: 0.2031 - acc: 0.9819 - val_loss: 1.2458 - val_acc: 0.5781
Epoch 8/47
 - 5s - loss: 0.2144 - acc: 0.9819 - val_loss: 1.2207 - val_acc: 0.5938
Epoch 9/47
 - 5s - loss: 0.1892 - acc: 0.9819 - val_loss: 1.2223 - val_acc: 0.6094
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 10/47
 - 6s - loss: 0.1969 - acc: 0.9793 - val_loss: 1.0588 - val_acc: 0.6406
Epoch 11/47
 - 6s - loss: 0.1913 - acc: 0.9930 - val_loss: 0.9934 - val_acc: 0.6875
Epoch 12/47
 - 6s - loss: 0.1807 - acc: 0.9930 - val_loss: 1.1390 - val_acc: 0.6250
Epoch 13/47
 - 6s - loss: 0.1630 - acc: 1.0000 - val_loss: 1.1334 - val_acc: 0.6094
Epoch 14/47
 - 5s - loss: 0.1735 - acc: 0.9929 - val_loss: 1.1412 - val_acc: 0.6250
Epoch 15/47
 - 6s - loss: 0.1502 - acc: 0.9860 - val_loss: 1.1102 - val_acc: 0.6250
Epoch 16/47
 - 6s - loss: 0.1481 - acc: 0.9931 - val_loss: 1.1037 - val_acc: 0.6406
Epoch 17/47
 - 6s - loss: 0.1373 - acc: 1.0000 - val_loss: 1.1625 - val_acc: 0.5938
Epoch 18/47
 - 6s - loss: 0.1528 - acc: 0.9860 - val_loss: 1.0150 - val_acc: 0.6875
Epoch 19/47
 - 6s - loss: 0.1505 - acc: 0.9931 - val_loss: 1.1170 - val_acc: 0.6250
Epoch 20/47
 - 6s - loss: 0.1994 - acc: 0.9930 - val_loss: 0.9421 - val_acc: 0.6719
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 21/47
 - 6s - loss: 0.2096 - acc: 0.9749 - val_loss: 1.0639 - val_acc: 0.6250
Epoch 22/47
 - 6s - loss: 0.1836 - acc: 0.9930 - val_loss: 1.0901 - val_acc: 0.5781
Epoch 23/47
 - 6s - loss: 0.1675 - acc: 0.9790 - val_loss: 1.0449 - val_acc: 0.5938
Epoch 24/47
 - 6s - loss: 0.1858 - acc: 0.9790 - val_loss: 1.1324 - val_acc: 0.5781
Epoch 25/47
 - 6s - loss: 0.1609 - acc: 0.9930 - val_loss: 1.0905 - val_acc: 0.6094
Epoch 26/47
 - 6s - loss: 0.1460 - acc: 0.9930 - val_loss: 0.9992 - val_acc: 0.6562
Epoch 27/47
 - 6s - loss: 0.1653 - acc: 0.9930 - val_loss: 1.0194 - val_acc: 0.6094
Epoch 28/47
 - 6s - loss: 0.1558 - acc: 1.0000 - val_loss: 1.1173 - val_acc: 0.5625
Epoch 29/47
 - 5s - loss: 0.1999 - acc: 1.0000 - val_loss: 0.9973 - val_acc: 0.6250
Epoch 30/47
 - 6s - loss: 0.1795 - acc: 0.9889 - val_loss: 1.0517 - val_acc: 0.5938
Epoch 31/47
 - 6s - loss: 0.1343 - acc: 1.0000 - val_loss: 1.0685 - val_acc: 0.6094
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 32/47
 - 6s - loss: 0.1755 - acc: 0.9930 - val_loss: 1.1367 - val_acc: 0.6094
Epoch 33/47
 - 6s - loss: 0.1449 - acc: 0.9819 - val_loss: 1.0267 - val_acc: 0.5938
Epoch 34/47
 - 6s - loss: 0.1914 - acc: 0.9931 - val_loss: 1.1140 - val_acc: 0.5938
Epoch 35/47
 - 6s - loss: 0.1730 - acc: 0.9790 - val_loss: 1.1375 - val_acc: 0.6094
Epoch 36/47
 - 6s - loss: 0.1467 - acc: 1.0000 - val_loss: 1.1660 - val_acc: 0.5781
Epoch 37/47
 - 6s - loss: 0.1653 - acc: 0.9930 - val_loss: 1.1567 - val_acc: 0.5781
Epoch 38/47
 - 6s - loss: 0.1583 - acc: 0.9860 - val_loss: 1.0550 - val_acc: 0.6250
Epoch 39/47
 - 6s - loss: 0.1484 - acc: 0.9931 - val_loss: 1.0747 - val_acc: 0.6250
Epoch 40/47
 - 6s - loss: 0.1547 - acc: 0.9930 - val_loss: 1.0861 - val_acc: 0.6094
Epoch 41/47
 - 6s - loss: 0.1552 - acc: 0.9930 - val_loss: 1.0895 - val_acc: 0.6250
Epoch 42/47
 - 6s - loss: 0.1961 - acc: 0.9749 - val_loss: 1.1961 - val_acc: 0.5938
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 43/47
 - 6s - loss: 0.1668 - acc: 0.9819 - val_loss: 1.1531 - val_acc: 0.5938
Epoch 44/47
 - 6s - loss: 0.1721 - acc: 0.9889 - val_loss: 1.1699 - val_acc: 0.6094
Epoch 45/47
 - 6s - loss: 0.1615 - acc: 1.0000 - val_loss: 1.1707 - val_acc: 0.6094
Epoch 46/47
 - 5s - loss: 0.1458 - acc: 1.0000 - val_loss: 1.1162 - val_acc: 0.6406
Epoch 47/47
 - 6s - loss: 0.1426 - acc: 0.9931 - val_loss: 1.1545 - val_acc: 0.6094
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (5, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (5, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (5, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (5, 0, 3) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (5, 0, 3)
args: ()
kwargs: {'budget': 64.0, 'config': {'num_dense_layers': 2, 'optimizer': 'Adam', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 714, 'zoom_range': 0.0, 'cnn_learning_rate': 3.103991913207938e-05, 'unfreeze_percentage': 0.048290585195785975, 'rotation_range': 0, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 258, 'batch_size': 29, 'learning_rate': 0.00039780199789041145, 'base_model': 'InceptionResNetV2', 'activation': 'relu'}, 'working_directory': '.'}
result: {'loss': 0.390625, 'info': {'runtime': 370.8292019367218, 'histories': {'loss': [2.3564261440047645, 2.066958284378052, 1.8130618432336603, 1.55996413230896, 1.3692433950596286, 1.0932880917886145, 0.9779852552521497, 0.807425234102665, 0.6614450969194111, 0.5032317519187928, 0.4541520400154859, 0.6193773293853703, 0.49296691543177557, 0.44603174924850464, 0.3353952507775529, 0.2924952625780177, 0.2464537440161956, 0.18194657833056344, 0.17607532553654864, 0.1899342412563195, 0.21230406308532657, 0.21465870850068286, 0.20528688728809358, 0.19279410359554722, 0.20630120289953133, 0.18441963610344364, 0.19689722061157228, 0.1812726177443239, 0.17993796756841185, 0.16304650902748108, 0.17983485462744375, 0.1504892261516779, 0.14808115363121033, 0.13472299933209456, 0.14950009261755118, 0.15046046376228334, 0.19241036329054295, 0.2018908475126539, 0.18471782542485043, 0.16237790596888477, 0.1890310729132559, 0.16156495726646336, 0.14740834827709914, 0.16524551808834076, 0.1558021515607834, 0.18898025866513862, 0.1772865766757413, 0.1334824528461112, 0.17739677933373846, 0.14093426071611562, 0.19135242700576782, 0.1734882250316161, 0.1446376748775181, 0.16558060005195158, 0.16028231600845666, 0.14843925833702087, 0.15126826967063703, 0.15458002563257864, 0.19100203729213627, 0.1582776434663543, 0.16089789827067152, 0.15437424132474384, 0.14348229872328894, 0.14259980320930482], 'val_loss': [2.18279767036438, 2.2545769214630127, 2.1370232105255127, 2.0347596406936646, 2.0714099407196045, 1.8178409934043884, 2.288938879966736, 2.00833261013031, 1.8080272674560547, 1.5453655123710632, 2.2100348472595215, 1.392311453819275, 1.824018120765686, 2.0715455412864685, 1.4291064143180847, 1.5585230588912964, 1.4430734515190125, 1.1723715662956238, 1.2677024006843567, 1.2553882598876953, 1.1355242431163788, 1.1960988640785217, 1.279096245765686, 1.2457663416862488, 1.220687747001648, 1.2223235368728638, 1.058847188949585, 0.993378609418869, 1.138954520225525, 1.1334459781646729, 1.141153872013092, 1.1102383136749268, 1.1037193536758423, 1.1624831557273865, 1.0149703919887543, 1.117017686367035, 0.9420832991600037, 1.0638997554779053, 1.090146243572235, 1.0448881387710571, 1.1324261128902435, 1.0904938578605652, 0.9991928339004517, 1.0194140672683716, 1.1172590553760529, 0.9972513616085052, 1.051708459854126, 1.0685373544692993, 1.1366930603981018, 1.0266977846622467, 1.1140039563179016, 1.1374894082546234, 1.1659982204437256, 1.1566500067710876, 1.0550166964530945, 1.074682354927063, 1.0861106514930725, 1.0894564986228943, 1.196087896823883, 1.1531001329421997, 1.1699497699737549, 1.1706925630569458, 1.1162071824073792, 1.1545413732528687], 'acc': [0.16541352834468498, 0.24827586859464645, 0.5619834727984815, 0.6620689749717712, 0.7443608825368092, 0.7669172815810469, 0.7518796920776367, 0.812030061295158, 0.8646616424833026, 0.9103448033332825, 0.9172932106749456, 0.8120300621914684, 0.8796992485684559, 0.8896551609039307, 0.939849627197237, 0.9548871983262829, 0.9849623979482436, 0.992481203455674, 0.9774436090225563, 0.9774436090225563, 0.9774436099188668, 0.9699248088929886, 0.9862068891525269, 0.9849624024297958, 0.9849624024297958, 0.9849624024297958, 0.9793103337287903, 0.9924811989741218, 0.9924811989741218, 1.0, 0.9917355327566794, 0.9849623979482436, 0.9931034445762634, 1.0, 0.9849623979482436, 0.9931034445762634, 0.9924811989741218, 0.9774436090225563, 0.9924811989741218, 0.9774435969223654, 0.9774435969223654, 0.9924811989741218, 0.9924811989741218, 0.9924811989741218, 1.0, 1.0, 0.9924812110743129, 1.0, 0.9924811989741218, 0.9849624100484347, 0.9931034445762634, 0.9774435969223654, 1.0, 0.9924811989741218, 0.9849623979482436, 0.9931034445762634, 0.9924811989741218, 0.9924811989741218, 0.9774436014039176, 0.9849624100484347, 0.9924812110743129, 1.0, 1.0, 0.9931034445762634], 'val_acc': [0.171875, 0.109375, 0.15625, 0.296875, 0.25, 0.296875, 0.203125, 0.34375, 0.4375, 0.484375, 0.40625, 0.515625, 0.421875, 0.375, 0.53125, 0.515625, 0.5625, 0.609375, 0.625, 0.609375, 0.65625, 0.65625, 0.59375, 0.578125, 0.59375, 0.609375, 0.640625, 0.6875, 0.625, 0.609375, 0.625, 0.625, 0.640625, 0.59375, 0.6875, 0.625, 0.671875, 0.625, 0.578125, 0.59375, 0.578125, 0.609375, 0.65625, 0.609375, 0.5625, 0.625, 0.59375, 0.609375, 0.609375, 0.59375, 0.59375, 0.609375, 0.578125, 0.578125, 0.625, 0.625, 0.609375, 0.625, 0.59375, 0.59375, 0.609375, 0.609375, 0.640625, 0.609375]}}}
exception: None

DEBUG:hpbandster:job_callback for (5, 0, 3)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (5, 0, 2)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (5, 0, 2) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (5, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: job (5, 0, 2) dispatched on hpbandster.run_0.worker.tfpool20.27905140655330039552
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: start processing job (5, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: kwargs: {'budget': 64.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 163, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002430120578229517, 'unfreeze_percentage': 0.2954511240277776, 'rotation_range': 0, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 68, 'batch_size': 33, 'num_dense_units_2': 166, 'learning_rate': 0.0003748303920848836, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
2018-02-08 16:55:58.006807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/20
 - 35s - loss: 2.3445 - acc: 0.1515 - val_loss: 2.0907 - val_acc: 0.1562
Epoch 2/20
 - 21s - loss: 1.7532 - acc: 0.5229 - val_loss: 1.7887 - val_acc: 0.3281
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/20
 - 21s - loss: 1.5259 - acc: 0.6364 - val_loss: 1.8062 - val_acc: 0.3750
Epoch 4/20
 - 21s - loss: 1.3366 - acc: 0.7193 - val_loss: 1.5157 - val_acc: 0.6875
Epoch 5/20
 - 21s - loss: 1.1127 - acc: 0.7973 - val_loss: 1.4109 - val_acc: 0.5781
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 6/20
 - 21s - loss: 0.9436 - acc: 0.8618 - val_loss: 1.4125 - val_acc: 0.6406
Epoch 7/20
 - 21s - loss: 0.8308 - acc: 0.8998 - val_loss: 1.2262 - val_acc: 0.7500
Epoch 8/20
 - 21s - loss: 0.7303 - acc: 0.9075 - val_loss: 1.2912 - val_acc: 0.7344
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 9/20
 - 21s - loss: 0.6007 - acc: 0.9318 - val_loss: 1.2820 - val_acc: 0.5938
Epoch 10/20
 - 20s - loss: 0.5382 - acc: 0.9537 - val_loss: 1.0662 - val_acc: 0.7812
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 11/20
 - 21s - loss: 0.4673 - acc: 0.9842 - val_loss: 1.1446 - val_acc: 0.7031
Epoch 12/20
 - 21s - loss: 0.3912 - acc: 0.9848 - val_loss: 1.1273 - val_acc: 0.7188
Epoch 13/20
 - 21s - loss: 0.2706 - acc: 1.0000 - val_loss: 0.9601 - val_acc: 0.7500
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 14/20
 - 21s - loss: 0.2766 - acc: 0.9924 - val_loss: 0.8497 - val_acc: 0.7969
Epoch 15/20
 - 21s - loss: 0.2282 - acc: 1.0000 - val_loss: 0.8497 - val_acc: 0.7812
Epoch 16/20
 - 21s - loss: 0.2172 - acc: 0.9924 - val_loss: 1.0606 - val_acc: 0.6875
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 17/20
 - 21s - loss: 0.2694 - acc: 0.9841 - val_loss: 0.9062 - val_acc: 0.7656
Epoch 18/20
 - 21s - loss: 0.2074 - acc: 1.0000 - val_loss: 0.8563 - val_acc: 0.7656
Epoch 19/20
 - 21s - loss: 0.1537 - acc: 1.0000 - val_loss: 0.8345 - val_acc: 0.7656
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 20/20
 - 21s - loss: 0.0977 - acc: 1.0000 - val_loss: 0.8779 - val_acc: 0.7188
{'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 163, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002430120578229517, 'unfreeze_percentage': 0.2954511240277776, 'rotation_range': 0, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 68, 'batch_size': 33, 'num_dense_units_2': 166, 'learning_rate': 0.0003748303920848836, 'base_model': 'MobileNet', 'activation': 'tanh'}

 ****** MobileNet unfrozen 7 top blocks, cut_off after layer 60 ******
Epoch 1/44
 - 33s - loss: 0.0848 - acc: 1.0000 - val_loss: 0.8968 - val_acc: 0.7188
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/44
 - 21s - loss: 0.0920 - acc: 1.0000 - val_loss: 0.8048 - val_acc: 0.7344
Epoch 3/44
 - 21s - loss: 0.0865 - acc: 1.0000 - val_loss: 0.9192 - val_acc: 0.7031
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/44
 - 21s - loss: 0.0785 - acc: 1.0000 - val_loss: 0.9194 - val_acc: 0.7031
Epoch 5/44
 - 21s - loss: 0.0861 - acc: 1.0000 - val_loss: 0.9040 - val_acc: 0.7188
Epoch 6/44
 - 21s - loss: 0.0808 - acc: 1.0000 - val_loss: 0.9526 - val_acc: 0.7344
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 7/44
 - 21s - loss: 0.0955 - acc: 1.0000 - val_loss: 0.9640 - val_acc: 0.7031
Epoch 8/44
 - 21s - loss: 0.0809 - acc: 1.0000 - val_loss: 0.8944 - val_acc: 0.7031
Epoch 9/44
 - 21s - loss: 0.0726 - acc: 1.0000 - val_loss: 0.9162 - val_acc: 0.7344
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 10/44
 - 21s - loss: 0.0705 - acc: 1.0000 - val_loss: 0.9513 - val_acc: 0.7500
Epoch 11/44
 - 21s - loss: 0.0664 - acc: 1.0000 - val_loss: 0.8017 - val_acc: 0.7812
Epoch 12/44
 - 21s - loss: 0.0753 - acc: 1.0000 - val_loss: 0.9109 - val_acc: 0.7812
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 13/44
 - 21s - loss: 0.0783 - acc: 1.0000 - val_loss: 0.8781 - val_acc: 0.7656
Epoch 14/44
 - 21s - loss: 0.0690 - acc: 1.0000 - val_loss: 0.9616 - val_acc: 0.7188
Epoch 15/44
 - 21s - loss: 0.0714 - acc: 1.0000 - val_loss: 0.9456 - val_acc: 0.7031
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 16/44
 - 21s - loss: 0.0718 - acc: 1.0000 - val_loss: 0.9979 - val_acc: 0.7031
Epoch 17/44
 - 21s - loss: 0.0668 - acc: 1.0000 - val_loss: 0.8246 - val_acc: 0.7656
Epoch 18/44
 - 21s - loss: 0.0667 - acc: 1.0000 - val_loss: 0.8426 - val_acc: 0.7656
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 19/44
 - 21s - loss: 0.0746 - acc: 1.0000 - val_loss: 1.0078 - val_acc: 0.7031
Epoch 20/44
 - 21s - loss: 0.0681 - acc: 1.0000 - val_loss: 0.8366 - val_acc: 0.7656
Epoch 21/44
 - 21s - loss: 0.0645 - acc: 1.0000 - val_loss: 1.0311 - val_acc: 0.7031
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 22/44
 - 21s - loss: 0.0639 - acc: 1.0000 - val_loss: 0.8813 - val_acc: 0.7344
Epoch 23/44
 - 21s - loss: 0.0623 - acc: 1.0000 - val_loss: 0.8991 - val_acc: 0.7500
Epoch 24/44
 - 21s - loss: 0.0637 - acc: 1.0000 - val_loss: 0.9770 - val_acc: 0.7188
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 25/44
 - 21s - loss: 0.0645 - acc: 1.0000 - val_loss: 1.0044 - val_acc: 0.7031
Epoch 26/44
 - 21s - loss: 0.0650 - acc: 1.0000 - val_loss: 0.9217 - val_acc: 0.7500
Epoch 27/44
 - 20s - loss: 0.0702 - acc: 1.0000 - val_loss: 0.8012 - val_acc: 0.7812
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 28/44
 - 21s - loss: 0.0658 - acc: 1.0000 - val_loss: 1.0331 - val_acc: 0.6875
Epoch 29/44
 - 21s - loss: 0.0604 - acc: 1.0000 - val_loss: 1.0005 - val_acc: 0.7031
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 30/44
 - 21s - loss: 0.0555 - acc: 1.0000 - val_loss: 1.0029 - val_acc: 0.7188
Epoch 31/44
 - 21s - loss: 0.0594 - acc: 1.0000 - val_loss: 1.0762 - val_acc: 0.6562
Epoch 32/44
 - 21s - loss: 0.0598 - acc: 1.0000 - val_loss: 0.9202 - val_acc: 0.7188
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 33/44
 - 21s - loss: 0.0565 - acc: 1.0000 - val_loss: 0.8993 - val_acc: 0.7344
Epoch 34/44
 - 20s - loss: 0.0664 - acc: 1.0000 - val_loss: 1.0414 - val_acc: 0.6875
Epoch 35/44
 - 21s - loss: 0.0553 - acc: 1.0000 - val_loss: 0.8551 - val_acc: 0.7656
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 36/44
 - 21s - loss: 0.0594 - acc: 1.0000 - val_loss: 0.9155 - val_acc: 0.7344
Epoch 37/44
 - 21s - loss: 0.0589 - acc: 1.0000 - val_loss: 0.9540 - val_acc: 0.7188
Epoch 38/44
 - 21s - loss: 0.0591 - acc: 1.0000 - val_loss: 0.8226 - val_acc: 0.7344
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 39/44
 - 21s - loss: 0.0585 - acc: 1.0000 - val_loss: 1.0657 - val_acc: 0.6562
Epoch 40/44
 - 21s - loss: 0.0534 - acc: 1.0000 - val_loss: 1.0025 - val_acc: 0.7188
Epoch 41/44
 - 21s - loss: 0.0572 - acc: 1.0000 - val_loss: 0.9804 - val_acc: 0.7031
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 42/44
 - 21s - loss: 0.0558 - acc: 1.0000 - val_loss: 0.9510 - val_acc: 0.7031
Epoch 43/44
 - 21s - loss: 0.0575 - acc: 1.0000 - val_loss: 0.9686 - val_acc: 0.6875
Epoch 44/44
 - 21s - loss: 0.0543 - acc: 1.0000 - val_loss: 0.9297 - val_acc: 0.7344
DEBUG:hpbandster.run_0.worker.tfpool20.27905:WORKER: done with job (5, 0, 2), trying to register it.
DEBUG:hpbandster:DISPATCHER: job (5, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (5, 0, 2) on hpbandster.run_0.worker.tfpool20.27905140655330039552 finished
DEBUG:hpbandster:job_id: (5, 0, 2)
args: ()
kwargs: {'budget': 64.0, 'config': {'num_dense_layers': 3, 'optimizer': 'RMSProp', 'width_shift_range': 0.0, 'height_shift_range': 0.0, 'num_dense_units_0': 163, 'zoom_range': 0.0, 'cnn_learning_rate': 0.0002430120578229517, 'unfreeze_percentage': 0.2954511240277776, 'rotation_range': 0, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 68, 'batch_size': 33, 'num_dense_units_2': 166, 'learning_rate': 0.0003748303920848836, 'base_model': 'MobileNet', 'activation': 'tanh'}, 'working_directory': '.'}
result: {'loss': 0.265625, 'info': {'runtime': 1407.7800443172455, 'histories': {'loss': [2.3444953560829163, 1.7500094828151522, 1.5258718729019165, 1.3335763021957043, 1.1118035288744195, 0.9461661840594092, 0.8327519588692244, 0.7319724324137665, 0.600655809044838, 0.5384099968644076, 0.4673819022123204, 0.39106767330058784, 0.27045314810996834, 0.276580136269331, 0.22757551489874375, 0.21716266870498657, 0.26979237723918187, 0.2065541255612706, 0.1548865583053855, 0.09766113199293613, 0.08471051846132722, 0.09210132998089458, 0.08628075847098994, 0.0785281341522932, 0.08654030169858488, 0.08112906378715537, 0.09515002785727035, 0.08050428192282832, 0.07258611358702183, 0.07059104186157848, 0.06637508794665337, 0.07492379312004362, 0.07828990928828716, 0.06920032272505205, 0.07154604532690935, 0.07159660080837649, 0.06680742885137714, 0.06659481111307476, 0.07455962710082531, 0.06791123721835225, 0.06454113032668829, 0.06388056850017504, 0.0623080726003363, 0.06372390780597925, 0.06437760678141616, 0.06522093540014223, 0.07019037458785744, 0.06575182639062405, 0.060561696954426314, 0.055473821237683296, 0.05936408441427142, 0.059769924730062485, 0.05655686747889186, 0.06653389742686636, 0.05534475203603506, 0.05937146170194759, 0.058975093759769615, 0.05905925668776035, 0.05850242667419966, 0.05335733606371769, 0.0569946538916854, 0.05577046889811754, 0.05762860534149547, 0.05436315222881561], 'val_loss': [2.0907440185546875, 1.7886573672294617, 1.8062222599983215, 1.5157034993171692, 1.4109159708023071, 1.4124680757522583, 1.2262269854545593, 1.2911978363990784, 1.2820228934288025, 1.0662113428115845, 1.1445897817611694, 1.1273032426834106, 0.9600805938243866, 0.8497498333454132, 0.8497048020362854, 1.0605754852294922, 0.9062245190143585, 0.8562650978565216, 0.834454357624054, 0.8778525590896606, 0.8967652022838593, 0.8047571182250977, 0.9192003011703491, 0.9194478392601013, 0.9039509296417236, 0.9526388049125671, 0.9639661908149719, 0.8943561911582947, 0.9162054061889648, 0.9512743949890137, 0.8017407655715942, 0.9109083116054535, 0.8781166672706604, 0.9616196751594543, 0.9456247985363007, 0.9979454576969147, 0.8246009051799774, 0.842606246471405, 1.0078302025794983, 0.8366138339042664, 1.0311079025268555, 0.8812663555145264, 0.8991070985794067, 0.9770035147666931, 1.0044321119785309, 0.9216727018356323, 0.8011557161808014, 1.0331297516822815, 1.0004893243312836, 1.002872794866562, 1.0762174129486084, 0.920168399810791, 0.8993325233459473, 1.041428804397583, 0.8550704121589661, 0.9154989421367645, 0.9540325403213501, 0.8225583136081696, 1.065650463104248, 1.0024968087673187, 0.9804128110408783, 0.950973242521286, 0.9685828983783722, 0.9297231733798981], 'acc': [0.1515151560306549, 0.5238095607076373, 0.6363636702299118, 0.7209302616673846, 0.7984496271887491, 0.860465127368306, 0.8992248413174652, 0.9069767414137374, 0.9318182021379471, 0.9534884164499682, 0.9844961388166561, 0.9844961388166561, 1.0, 0.9924242496490479, 1.0, 0.9924242496490479, 0.9841269992646717, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], 'val_acc': [0.15625, 0.328125, 0.375, 0.6875, 0.578125, 0.640625, 0.75, 0.734375, 0.59375, 0.78125, 0.703125, 0.71875, 0.75, 0.796875, 0.78125, 0.6875, 0.765625, 0.765625, 0.765625, 0.71875, 0.71875, 0.734375, 0.703125, 0.703125, 0.71875, 0.734375, 0.703125, 0.703125, 0.734375, 0.75, 0.78125, 0.78125, 0.765625, 0.71875, 0.703125, 0.703125, 0.765625, 0.765625, 0.703125, 0.765625, 0.703125, 0.734375, 0.75, 0.71875, 0.703125, 0.75, 0.78125, 0.6875, 0.703125, 0.71875, 0.65625, 0.71875, 0.734375, 0.6875, 0.765625, 0.734375, 0.71875, 0.734375, 0.65625, 0.71875, 0.703125, 0.703125, 0.6875, 0.734375]}}}
exception: None

INFO:hpbandster.run_0.worker.tfpool20.27905:WORKER: registered result for job (5, 0, 2) with dispatcher
DEBUG:hpbandster:job_callback for (5, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:HBMASTER: shutdown initiated, shutdown_workers = True
INFO:hpbandster:DISPATCHER: Dispatcher shutting down
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: job_runner shutting down
DEBUG:hpbandster:DISPATCHER: discover_workers shutting down
DEBUG:hpbandster:DISPATCHER: 'discover_worker' thread exited
DEBUG:hpbandster:DISPATCHER: 'job_runner' thread exited
INFO:hpbandster:DISPATCHER: shut down complete

2018-02-08 13:14:03.149020: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2018-02-08 13:14:03.149040: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2018-02-08 13:14:03.149045: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2018-02-08 13:14:03.149047: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2018-02-08 13:14:03.149050: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2018-02-08 13:14:03.312464: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:893] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-02-08 13:14:03.312660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties: 
name: GeForce GTX 1060 3GB
major: 6 minor: 1 memoryClockRate (GHz) 1.7085
pciBusID 0000:01:00.0
Total memory: 2.95GiB
Free memory: 2.84GiB
2018-02-08 13:14:03.312670: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0 
2018-02-08 13:14:03.312674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y 
2018-02-08 13:14:03.312681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
/home/wilhelmb/.local/lib/python3.5/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
INFO:hpbandster:DISPATCHER: started the 'discover_worker' thread
INFO:hpbandster:DISPATCHER: started the 'job_runner' thread
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: Connected to nameserver <Pyro4.core.Proxy at 0x7f7e6966ea90; connected IPv4; for PYRO:Pyro.NameServer@localhost:42891>
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: No dispatcher found. Waiting for one to initiate contact.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start listening for jobs
INFO:hpbandster:DISPATCHER: Pyro daemon running on localhost:45557
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 0 currently in the pool.
INFO:hpbandster:DISPATCHER: discovered new worker, hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
INFO:hpbandster:HBMASTER: starting run at 1518092045.1484878
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 0) to dispatcher
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 0) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (0, 0, 0) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 1) to dispatcher
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 0)
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007110001516669885, 'height_shift_range': 0.267, 'batch_size': 24, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.1671917050562959, 'num_dense_units_0': 120, 'cnn_learning_rate': 0.0008407644218534716, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 197}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:14:06.125960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
optimizing with fixed augmentation including all models.
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.9248 - acc: 0.1208 - val_loss: 3.0668 - val_acc: 0.1169
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 0)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007110001516669885, 'height_shift_range': 0.267, 'batch_size': 24, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.1671917050562959, 'num_dense_units_0': 120, 'cnn_learning_rate': 0.0008407644218534716, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 197}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8831168826330792, 'info': {'histories': {'val_loss': [3.06683281489781], 'acc': [0.12318840930643289], 'loss': [2.918961203616598], 'val_acc': [0.11688311736692082]}, 'runtime': 11.954630136489868}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 0)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 1)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 1) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 1) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00935400780029806, 'height_shift_range': 0.267, 'batch_size': 43, 'num_dense_units_2': 73, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1936363862374609, 'num_dense_units_0': 557, 'cnn_learning_rate': 1.6804311197793663e-05, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 179}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:14:19.474861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
2018-02-08 13:14:23.572936: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.69GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 4.5624 - acc: 0.0783 - val_loss: 3.5026 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 1)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00935400780029806, 'height_shift_range': 0.267, 'batch_size': 43, 'num_dense_units_2': 73, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1936363862374609, 'num_dense_units_0': 557, 'cnn_learning_rate': 1.6804311197793663e-05, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 179}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.875, 'info': {'histories': {'val_loss': [3.5025506019592285], 'acc': [0.07563025429218757], 'loss': [4.702498610280141], 'val_acc': [0.125]}, 'runtime': 14.606556415557861}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 1)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 2)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 2) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 3) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0006914040966394852, 'height_shift_range': 0.267, 'batch_size': 53, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.21844821962337427, 'num_dense_units_0': 598, 'cnn_learning_rate': 0.0009179015212240629, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 252}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:14:33.153628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
2018-02-08 13:14:36.560148: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.84GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.3565 - acc: 0.0421 - val_loss: 2.3550 - val_acc: 0.0312
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 2)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0006914040966394852, 'height_shift_range': 0.267, 'batch_size': 53, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.21844821962337427, 'num_dense_units_0': 598, 'cnn_learning_rate': 0.0009179015212240629, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 252}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.96875, 'info': {'histories': {'val_loss': [2.3550310134887695], 'acc': [0.055045872379880435], 'loss': [2.387563834496594], 'val_acc': [0.03125]}, 'runtime': 13.834847211837769}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 3)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 3) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 3) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 4) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 3) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 3)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0009003462156437976, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.2394753595999796, 'num_dense_units_0': 818, 'cnn_learning_rate': 1.4698529876430302e-05, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 65}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:14:47.062585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.4108 - acc: 0.0893 - val_loss: 2.4344 - val_acc: 0.0642
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 3) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 3)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0009003462156437976, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.2394753595999796, 'num_dense_units_0': 818, 'cnn_learning_rate': 1.4698529876430302e-05, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 65}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.935779815830222, 'info': {'histories': {'val_loss': [2.434401306537313], 'acc': [0.08275862148609654], 'loss': [2.4207446788919382], 'val_acc': [0.06422018416977804]}, 'runtime': 10.261619806289673}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 3)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 4)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 4) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 5) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 4) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 4)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00019706339231567252, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 75, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.16313183588884675, 'num_dense_units_0': 382, 'cnn_learning_rate': 3.425787400401275e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 335}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:14:57.365584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3049 - acc: 0.1282 - val_loss: 2.2811 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 4)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00019706339231567252, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 75, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.16313183588884675, 'num_dense_units_0': 382, 'cnn_learning_rate': 3.425787400401275e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 335}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.84375, 'info': {'histories': {'val_loss': [2.281113624572754], 'acc': [0.12820512987673283], 'loss': [2.3048585653305054], 'val_acc': [0.15625]}, 'runtime': 12.4792001247406}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 4)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 5)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 5) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 6) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 5) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 5)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004295792573900491, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 71, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.023699736236639235, 'num_dense_units_0': 167, 'cnn_learning_rate': 0.00015143532599576204, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 111}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:15:15.892107: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
2018-02-08 13:15:21.421525: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.11GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
2018-02-08 13:15:21.650564: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.23GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
2018-02-08 13:15:25.448109: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.22GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
2018-02-08 13:15:25.786450: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.32GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 8s - loss: 2.3520 - acc: 0.1121 - val_loss: 2.4256 - val_acc: 0.1039
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 5), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 5) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 5) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 5)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004295792573900491, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 71, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.023699736236639235, 'num_dense_units_0': 167, 'cnn_learning_rate': 0.00015143532599576204, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 111}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8961038961038961, 'info': {'histories': {'val_loss': [2.4256276248337385], 'acc': [0.10638298276574054], 'loss': [2.3507221658179103], 'val_acc': [0.1038961038961039]}, 'runtime': 19.448935508728027}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 5)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 6)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 6) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 6) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 7) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 6) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 6)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0009283181352520636, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.08708627437070077, 'num_dense_units_0': 233, 'cnn_learning_rate': 1.6915398032855986e-05, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 451}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:15:28.850779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.3728 - acc: 0.1052 - val_loss: 2.4014 - val_acc: 0.1193
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 6), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 6) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 6) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 6) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 6)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0009283181352520636, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.08708627437070077, 'num_dense_units_0': 233, 'cnn_learning_rate': 1.6915398032855986e-05, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 451}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8807339449541285, 'info': {'histories': {'val_loss': [2.4014067168629496], 'acc': [0.11034482887078975], 'loss': [2.3768679997016644], 'val_acc': [0.11926605504587157]}, 'runtime': 8.414286613464355}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 6)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 7)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 7) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 7) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 8) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 7) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 7)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00045501478271130826, 'height_shift_range': 0.267, 'batch_size': 35, 'num_dense_units_2': 121, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.0058493838712906365, 'num_dense_units_0': 502, 'cnn_learning_rate': 0.00012099864328030101, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 97}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:15:37.988057: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.8507 - acc: 0.1020 - val_loss: 2.6367 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 7), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 7) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 7) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 7) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 7)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00045501478271130826, 'height_shift_range': 0.267, 'batch_size': 35, 'num_dense_units_2': 121, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.0058493838712906365, 'num_dense_units_0': 502, 'cnn_learning_rate': 0.00012099864328030101, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 97}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.84375, 'info': {'histories': {'val_loss': [2.636702537536621], 'acc': [0.11023622416839825], 'loss': [2.8827009351234736], 'val_acc': [0.15625]}, 'runtime': 12.33987045288086}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 7)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 8)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 8) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 8) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 9) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 8) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 8)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0011252188834962845, 'height_shift_range': 0.267, 'batch_size': 34, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1513372263504593, 'num_dense_units_0': 731, 'cnn_learning_rate': 1.4293240239556127e-05, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 420}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:15:50.389807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.2985 - acc: 0.1803 - val_loss: 2.2161 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 8), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 8) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 8) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 8) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 8)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0011252188834962845, 'height_shift_range': 0.267, 'batch_size': 34, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1513372263504593, 'num_dense_units_0': 731, 'cnn_learning_rate': 1.4293240239556127e-05, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 420}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.875, 'info': {'histories': {'val_loss': [2.2160804271698], 'acc': [0.17968750523868948], 'loss': [2.299676224589348], 'val_acc': [0.125]}, 'runtime': 12.577093601226807}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 8)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 9)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 9) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 9) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 10) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 9) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 9)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004268604075274736, 'height_shift_range': 0.267, 'batch_size': 25, 'num_dense_units_2': 121, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.2935389143040096, 'num_dense_units_0': 337, 'cnn_learning_rate': 0.00021382427113501095, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 96}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:16:02.420450: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.3554 - acc: 0.1200 - val_loss: 2.3346 - val_acc: 0.1039
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 9), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 9) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 9) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 9) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 9)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004268604075274736, 'height_shift_range': 0.267, 'batch_size': 25, 'num_dense_units_2': 121, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.2935389143040096, 'num_dense_units_0': 337, 'cnn_learning_rate': 0.00021382427113501095, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 96}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8961038956200922, 'info': {'histories': {'val_loss': [2.3346409921522264], 'acc': [0.11999999607602756], 'loss': [2.355431000391642], 'val_acc': [0.10389610437990783]}, 'runtime': 9.081120014190674}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 9)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 10)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 10) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 11) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 10) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 10) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 10)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00010298931767531302, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 42, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.17634795343568943, 'num_dense_units_0': 185, 'cnn_learning_rate': 0.00018069154183323057, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 135}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:16:16.408424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
2018-02-08 13:16:21.885762: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.12GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
2018-02-08 13:16:22.122414: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.24GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 8s - loss: 2.3138 - acc: 0.1054 - val_loss: 2.3022 - val_acc: 0.1299
/home/wilhelmb/.local/lib/python3.5/site-packages/matplotlib/pyplot.py:528: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  max_open_warning, RuntimeWarning)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 10), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 10) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 10) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 10) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 10)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00010298931767531302, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 42, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.17634795343568943, 'num_dense_units_0': 185, 'cnn_learning_rate': 0.00018069154183323057, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 135}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8701298681946543, 'info': {'histories': {'val_loss': [2.3021621208686334], 'acc': [0.0928571451987539], 'loss': [2.316356679371425], 'val_acc': [0.12987013180534562]}, 'runtime': 17.515519618988037}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 10)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 11)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 11) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 11) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 12) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 11) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 11)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00039864630593258076, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 53, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.18672912496037622, 'num_dense_units_0': 408, 'cnn_learning_rate': 2.1890693747098467e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 59}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:16:32.101736: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.4331 - acc: 0.0913 - val_loss: 2.3628 - val_acc: 0.0779
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 11), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 11) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 11) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 11) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 11)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00039864630593258076, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 53, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.18672912496037622, 'num_dense_units_0': 408, 'cnn_learning_rate': 2.1890693747098467e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 59}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.9220779215941182, 'info': {'histories': {'val_loss': [2.362807410103934], 'acc': [0.09219858351540058], 'loss': [2.430822489109445], 'val_acc': [0.07792207840588186]}, 'runtime': 13.34222960472107}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 11)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 12)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 12) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 12) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 13) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 12) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 12)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00037933185280457767, 'height_shift_range': 0.267, 'batch_size': 26, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.15823558879965471, 'num_dense_units_0': 362, 'cnn_learning_rate': 0.00013884115825566067, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 108}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:16:44.499295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.3432 - acc: 0.1819 - val_loss: 2.3416 - val_acc: 0.1406
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 12), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 12) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 12) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 12) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 12)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00037933185280457767, 'height_shift_range': 0.267, 'batch_size': 26, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.15823558879965471, 'num_dense_units_0': 362, 'cnn_learning_rate': 0.00013884115825566067, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 108}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.859375, 'info': {'histories': {'val_loss': [2.3415627479553223], 'acc': [0.18382353905369253], 'loss': [2.352568384479074], 'val_acc': [0.140625]}, 'runtime': 11.440581560134888}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 12)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 13)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 13) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 13) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 14) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 13) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 13)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009478180873167607, 'height_shift_range': 0.267, 'batch_size': 29, 'num_dense_units_2': 34, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.04431887435227988, 'num_dense_units_0': 150, 'cnn_learning_rate': 0.00021535938243043173, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 116}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:16:59.106916: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
2018-02-08 13:17:04.900732: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.19GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 13:17:05.199784: W tensorflow/core/common_runtime/bfc_allocator.cc:217] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.30GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory is available.
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 8s - loss: 2.3421 - acc: 0.1301 - val_loss: 2.3660 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 13), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 13) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 13) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 13) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 13)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009478180873167607, 'height_shift_range': 0.267, 'batch_size': 29, 'num_dense_units_2': 34, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.04431887435227988, 'num_dense_units_0': 150, 'cnn_learning_rate': 0.00021535938243043173, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 116}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.36597216129303], 'acc': [0.13533834460422509], 'loss': [2.3523376256899726], 'val_acc': [0.09375]}, 'runtime': 17.768134593963623}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 13)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 14)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 14) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 14) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 15) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 14) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 14)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009402838023977329, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.03190583340697125, 'num_dense_units_0': 472, 'cnn_learning_rate': 0.00030303689794181505, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 268}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:17:17.326831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 8s - loss: 9.1741 - acc: 0.0980 - val_loss: 10.6538 - val_acc: 0.0917
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 14), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 14) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 14) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 14) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 14)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009402838023977329, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.03190583340697125, 'num_dense_units_0': 472, 'cnn_learning_rate': 0.00030303689794181505, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 268}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.908256880733945, 'info': {'histories': {'val_loss': [10.653836014073923], 'acc': [0.09790209571381549], 'loss': [9.21015152731142], 'val_acc': [0.09174311926605505]}, 'runtime': 18.0845308303833}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 14)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 15)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 15) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 15) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 16) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 15) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 15)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0005399281817072507, 'height_shift_range': 0.267, 'batch_size': 44, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.089783713142222, 'num_dense_units_0': 207, 'cnn_learning_rate': 0.0009701707441320407, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 98}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:17:31.187417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 4s - loss: 2.5354 - acc: 0.0758 - val_loss: 2.3089 - val_acc: 0.0625
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 15), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 15) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 15) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 15) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 15)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0005399281817072507, 'height_shift_range': 0.267, 'batch_size': 44, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.089783713142222, 'num_dense_units_0': 207, 'cnn_learning_rate': 0.0009701707441320407, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 98}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.9375, 'info': {'histories': {'val_loss': [2.3089146614074707], 'acc': [0.07575757801532745], 'loss': [2.5354323387145996], 'val_acc': [0.0625]}, 'runtime': 11.91954231262207}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 15)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 16)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 16) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 16) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 17) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 16) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 16)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00015912694961424368, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_units_2': 108, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.1648444328252132, 'num_dense_units_0': 860, 'cnn_learning_rate': 0.0002672843142389019, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 203}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:17:43.393860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.2303 - acc: 0.2336 - val_loss: 2.4805 - val_acc: 0.1039
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 16), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 16) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 16) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 16) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 16)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00015912694961424368, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_units_2': 108, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.1648444328252132, 'num_dense_units_0': 860, 'cnn_learning_rate': 0.0002672843142389019, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 203}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8961038933945941, 'info': {'histories': {'val_loss': [2.4805129162676924], 'acc': [0.12949640330650825], 'loss': [2.328948672726858], 'val_acc': [0.10389610660540594]}, 'runtime': 10.35346269607544}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 16)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 17)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 17) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 17) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 18) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 17) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 17)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00027233924361869696, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_units_2': 235, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.2617011372200081, 'num_dense_units_0': 183, 'cnn_learning_rate': 0.00017379987110576712, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 80}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:17:52.870890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.3330 - acc: 0.1104 - val_loss: 2.3110 - val_acc: 0.1651
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 17), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 17) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 17) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 17) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 17)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00027233924361869696, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_units_2': 235, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.2617011372200081, 'num_dense_units_0': 183, 'cnn_learning_rate': 0.00017379987110576712, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 80}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8348623809464482, 'info': {'histories': {'val_loss': [2.310961771448818], 'acc': [0.11034482802296507], 'loss': [2.3381764592795538], 'val_acc': [0.1651376190535519]}, 'runtime': 8.209907054901123}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 17)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 18)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 18) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 18) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 19) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 18) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 18)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0003578958860716047, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 10, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.08092682512038031, 'num_dense_units_0': 160, 'cnn_learning_rate': 1.3283647444427225e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 364}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:18:02.728711: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3027 - acc: 0.1644 - val_loss: 2.2899 - val_acc: 0.1688
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 18), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 18) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 18) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 18) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 18)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0003578958860716047, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 10, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.08092682512038031, 'num_dense_units_0': 160, 'cnn_learning_rate': 1.3283647444427225e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 364}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8311688306850272, 'info': {'histories': {'val_loss': [2.2898653451498454], 'acc': [0.17857143389327185], 'loss': [2.2644887890134537], 'val_acc': [0.16883116931497277]}, 'runtime': 11.934046983718872}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 18)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 19)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 19) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 19) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 20) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 19) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 19)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007871953646858892, 'height_shift_range': 0.267, 'batch_size': 28, 'num_dense_units_2': 53, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.012384013109226332, 'num_dense_units_0': 621, 'cnn_learning_rate': 2.6364306863722265e-05, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 359}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:18:14.817381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.4059 - acc: 0.1024 - val_loss: 2.4030 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 19), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 19) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 19) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 19) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 19)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007871953646858892, 'height_shift_range': 0.267, 'batch_size': 28, 'num_dense_units_2': 53, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.012384013109226332, 'num_dense_units_0': 621, 'cnn_learning_rate': 2.6364306863722265e-05, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 359}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.4029732942581177], 'acc': [0.10447761883486563], 'loss': [2.405064440485257], 'val_acc': [0.09375]}, 'runtime': 13.819567203521729}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 19)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 20)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 20) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 20) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 21) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 20) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 20)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008498560064325884, 'height_shift_range': 0.267, 'batch_size': 52, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.23736502775800886, 'num_dense_units_0': 201, 'cnn_learning_rate': 0.00013664718147462967, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 69}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:18:32.060815: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 7s - loss: 2.9646 - acc: 0.1955 - val_loss: 2.2881 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 20), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 20) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 20) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 20) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 20)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008498560064325884, 'height_shift_range': 0.267, 'batch_size': 52, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.23736502775800886, 'num_dense_units_0': 201, 'cnn_learning_rate': 0.00013664718147462967, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 69}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.84375, 'info': {'histories': {'val_loss': [2.2881081104278564], 'acc': [0.10909091478044336], 'loss': [3.1994968847794967], 'val_acc': [0.15625]}, 'runtime': 21.079818725585938}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 20)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 21)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 21) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 21) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 22) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 21) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 21)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.003048358501380096, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.17301131393546076, 'num_dense_units_0': 176, 'cnn_learning_rate': 0.00010638595155329936, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 402}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:18:50.106656: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3360 - acc: 0.0861 - val_loss: 2.3452 - val_acc: 0.1101
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 21), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 21) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 21) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 21) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 21)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.003048358501380096, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.17301131393546076, 'num_dense_units_0': 176, 'cnn_learning_rate': 0.00010638595155329936, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 402}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8899082561971945, 'info': {'histories': {'val_loss': [2.3452244176777133], 'acc': [0.09090909059647914], 'loss': [2.3319742029363457], 'val_acc': [0.11009174380280556]}, 'runtime': 12.743152141571045}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 21)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 22)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 22) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 22) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 23) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 22) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 22)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00015802127566026057, 'height_shift_range': 0.267, 'batch_size': 45, 'num_dense_units_2': 41, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.18511350304018717, 'num_dense_units_0': 1000, 'cnn_learning_rate': 0.0002758911648648801, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 296}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:19:01.719912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.9499 - acc: 0.0769 - val_loss: 2.5544 - val_acc: 0.0625
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 22), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 22) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 22) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 22) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 22)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00015802127566026057, 'height_shift_range': 0.267, 'batch_size': 45, 'num_dense_units_2': 41, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.18511350304018717, 'num_dense_units_0': 1000, 'cnn_learning_rate': 0.0002758911648648801, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 296}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.9375, 'info': {'histories': {'val_loss': [2.554370641708374], 'acc': [0.08547008897249515], 'loss': [2.876516819000244], 'val_acc': [0.0625]}, 'runtime': 14.183958053588867}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 22)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 23)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 23) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 23) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 24) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 23) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 23)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.002803783588843689, 'height_shift_range': 0.267, 'batch_size': 27, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.07847566466327777, 'num_dense_units_0': 138, 'cnn_learning_rate': 0.00010856353132507019, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 71}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:19:17.025504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 3.1690 - acc: 0.1543 - val_loss: 2.3676 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 23), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 23) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 23) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 23) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 23)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.002803783588843689, 'height_shift_range': 0.267, 'batch_size': 27, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.07847566466327777, 'num_dense_units_0': 138, 'cnn_learning_rate': 0.00010856353132507019, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 71}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.3676445484161377], 'acc': [0.15432099004586539], 'loss': [3.16904083887736], 'val_acc': [0.09375]}, 'runtime': 14.200431108474731}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 23)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 24)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 24) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 24) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 25) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 24)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0006245707686486292, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_units_2': 57, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.19131425130324722, 'num_dense_units_0': 275, 'cnn_learning_rate': 4.56119804456153e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 162}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:19:31.265957: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.5929 - acc: 0.0887 - val_loss: 2.4276 - val_acc: 0.1558
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 24), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 24) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 24)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0006245707686486292, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_units_2': 57, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.19131425130324722, 'num_dense_units_0': 275, 'cnn_learning_rate': 4.56119804456153e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 162}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8441558436720402, 'info': {'histories': {'val_loss': [2.4276246591047808], 'acc': [0.10071942572006219], 'loss': [2.6309861793792506], 'val_acc': [0.15584415632795978]}, 'runtime': 12.75094199180603}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 24)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 25)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 25) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 25) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 26) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 25) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 25)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00024242811760568562, 'height_shift_range': 0.267, 'batch_size': 25, 'num_dense_units_2': 22, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.1066477912553486, 'num_dense_units_0': 128, 'cnn_learning_rate': 0.00019096358806546188, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 223}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:19:42.524187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.3630 - acc: 0.0867 - val_loss: 2.2667 - val_acc: 0.1299
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 25), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 25) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 25) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 25) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 25)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00024242811760568562, 'height_shift_range': 0.267, 'batch_size': 25, 'num_dense_units_2': 22, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.1066477912553486, 'num_dense_units_0': 128, 'cnn_learning_rate': 0.00019096358806546188, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 223}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8701298674205681, 'info': {'histories': {'val_loss': [2.2667291071507836], 'acc': [0.0802919697696275], 'loss': [2.3711262445380217], 'val_acc': [0.12987013257943192]}, 'runtime': 8.713881969451904}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 25)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 26)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 26) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 26) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 27) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 26) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 26)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.001610620067654615, 'height_shift_range': 0.267, 'batch_size': 52, 'num_dense_units_2': 31, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.2614660309066346, 'num_dense_units_0': 991, 'cnn_learning_rate': 5.197330375717934e-05, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 328}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:19:56.235422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.8416 - acc: 0.1204 - val_loss: 2.6156 - val_acc: 0.1875
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 26), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 26) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 26) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 26) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 26)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.001610620067654615, 'height_shift_range': 0.267, 'batch_size': 52, 'num_dense_units_2': 31, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.2614660309066346, 'num_dense_units_0': 991, 'cnn_learning_rate': 5.197330375717934e-05, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 328}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8125, 'info': {'histories': {'val_loss': [2.6156327724456787], 'acc': [0.1545454664663835], 'loss': [2.993832167712125], 'val_acc': [0.1875]}, 'runtime': 27.822141885757446}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 26)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 27)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 27) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 27) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 28) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 27) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 27)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.001360628444718282, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_units_2': 77, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.009807064250404096, 'num_dense_units_0': 138, 'cnn_learning_rate': 0.0004588728185861899, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 390}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:20:20.360259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.4410 - acc: 0.1853 - val_loss: 2.6950 - val_acc: 0.0826
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 27), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 27) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 27) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 27) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 27)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.001360628444718282, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_units_2': 77, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.009807064250404096, 'num_dense_units_0': 138, 'cnn_learning_rate': 0.0004588728185861899, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 390}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.9174311923187807, 'info': {'histories': {'val_loss': [2.6949532185125786], 'acc': [0.1678321688221051], 'loss': [2.470934979565494], 'val_acc': [0.0825688076812193]}, 'runtime': 11.481072664260864}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 27)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 28)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 28) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 28) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 29) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 28) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 28)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0001347751751817989, 'height_shift_range': 0.267, 'batch_size': 29, 'num_dense_units_2': 63, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.000335988339817983, 'num_dense_units_0': 415, 'cnn_learning_rate': 0.000293589887804566, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 247}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:20:31.849513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.4843 - acc: 0.1312 - val_loss: 2.5067 - val_acc: 0.0781
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 28), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 28) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 28) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 28) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 28)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0001347751751817989, 'height_shift_range': 0.267, 'batch_size': 29, 'num_dense_units_2': 63, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.000335988339817983, 'num_dense_units_0': 415, 'cnn_learning_rate': 0.000293589887804566, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 247}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.921875, 'info': {'histories': {'val_loss': [2.5066851377487183], 'acc': [0.12781954741567597], 'loss': [2.4757434389644994], 'val_acc': [0.078125]}, 'runtime': 12.038777589797974}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 28)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 29)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 29) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 29) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 30) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 29) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 29)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00030912433098717856, 'height_shift_range': 0.267, 'batch_size': 41, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10463537736613007, 'num_dense_units_0': 296, 'cnn_learning_rate': 0.00029688826057106037, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 162}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:20:43.449852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3258 - acc: 0.1545 - val_loss: 2.2224 - val_acc: 0.2188
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 29), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 29) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 29) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 29) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 29)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00030912433098717856, 'height_shift_range': 0.267, 'batch_size': 41, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10463537736613007, 'num_dense_units_0': 296, 'cnn_learning_rate': 0.00029688826057106037, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 162}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.78125, 'info': {'histories': {'val_loss': [2.222421646118164], 'acc': [0.15447153647740683], 'loss': [2.325789133707682], 'val_acc': [0.21875]}, 'runtime': 14.055538177490234}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 29)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 30)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 30) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 30) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 31) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 30) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 30)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009762454574108563, 'height_shift_range': 0.267, 'batch_size': 51, 'num_dense_units_2': 32, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.24068245638600697, 'num_dense_units_0': 278, 'cnn_learning_rate': 0.0007606639430595606, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 233}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:20:56.943205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 4s - loss: 3.0306 - acc: 0.0715 - val_loss: 2.5436 - val_acc: 0.1250
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 30), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 30) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 30) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 30) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 30)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009762454574108563, 'height_shift_range': 0.267, 'batch_size': 51, 'num_dense_units_2': 32, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.24068245638600697, 'num_dense_units_0': 278, 'cnn_learning_rate': 0.0007606639430595606, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 233}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.875, 'info': {'histories': {'val_loss': [2.543578863143921], 'acc': [0.09009009841326121], 'loss': [2.806454581183356], 'val_acc': [0.125]}, 'runtime': 10.920174598693848}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 30)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 31)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 31) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 31) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 32) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 31) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 31)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0009487352712683983, 'height_shift_range': 0.267, 'batch_size': 57, 'num_dense_units_2': 20, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.1445711830449289, 'num_dense_units_0': 193, 'cnn_learning_rate': 0.0001935000181847217, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 214}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:21:12.960130: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 8s - loss: 2.7176 - acc: 0.1138 - val_loss: 2.2902 - val_acc: 0.2812
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 31), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 31) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 31) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 31) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 31)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0009487352712683983, 'height_shift_range': 0.267, 'batch_size': 57, 'num_dense_units_2': 20, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.1445711830449289, 'num_dense_units_0': 193, 'cnn_learning_rate': 0.0001935000181847217, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 214}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.71875, 'info': {'histories': {'val_loss': [2.290173053741455], 'acc': [0.11428571705307279], 'loss': [2.734044211251395], 'val_acc': [0.28125]}, 'runtime': 22.962270259857178}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 31)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 32)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 32) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 32) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 33) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 32) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 32)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00015696215844388002, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_units_2': 26, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.023079139071074204, 'num_dense_units_0': 340, 'cnn_learning_rate': 3.608531416092223e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 117}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:21:31.334608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3022 - acc: 0.1827 - val_loss: 2.2174 - val_acc: 0.1743
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 32), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 32) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 32) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 32) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 32)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00015696215844388002, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_units_2': 26, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.023079139071074204, 'num_dense_units_0': 340, 'cnn_learning_rate': 3.608531416092223e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 117}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8256880714805848, 'info': {'histories': {'val_loss': [2.217380467904817], 'acc': [0.18620689901812323], 'loss': [2.2966551813586005], 'val_acc': [0.1743119285194152]}, 'runtime': 10.065471649169922}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 32)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 33)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 33) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 33) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 34) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 33)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018883732300841306, 'height_shift_range': 0.267, 'batch_size': 31, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.03631828087169122, 'num_dense_units_0': 238, 'cnn_learning_rate': 0.0002448877074276911, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 61}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:21:41.741612: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 3.0886 - acc: 0.0532 - val_loss: 2.5699 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 33), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 33) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 33)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018883732300841306, 'height_shift_range': 0.267, 'batch_size': 31, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.03631828087169122, 'num_dense_units_0': 238, 'cnn_learning_rate': 0.0002448877074276911, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 61}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.84375, 'info': {'histories': {'val_loss': [2.5699031352996826], 'acc': [0.06106870047008718], 'loss': [3.052778140279173], 'val_acc': [0.15625]}, 'runtime': 12.655484199523926}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 33)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 34)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 34) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 34) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 35) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 34) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 34)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.006530431631179156, 'height_shift_range': 0.267, 'batch_size': 53, 'num_dense_units_2': 37, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.02733642500175958, 'num_dense_units_0': 575, 'cnn_learning_rate': 0.0002150660970160796, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 226}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:21:54.905527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.7889 - acc: 0.1447 - val_loss: 2.8192 - val_acc: 0.0312
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 34), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 34) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 34) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 34) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 34)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.006530431631179156, 'height_shift_range': 0.267, 'batch_size': 53, 'num_dense_units_2': 37, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.02733642500175958, 'num_dense_units_0': 575, 'cnn_learning_rate': 0.0002150660970160796, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 226}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.96875, 'info': {'histories': {'val_loss': [2.8191967010498047], 'acc': [0.14465409020582834], 'loss': [2.788926839828491], 'val_acc': [0.03125]}, 'runtime': 13.994086027145386}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 34)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 35)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 35) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 35) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 36) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 35) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 35)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0025613010311029325, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 103, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.11642033735383384, 'num_dense_units_0': 148, 'cnn_learning_rate': 3.2264818172448785e-05, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 437}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:22:08.974992: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 7.9446 - acc: 0.1013 - val_loss: 2.6515 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 35), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 35) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 35) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 35) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 35)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0025613010311029325, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 103, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.11642033735383384, 'num_dense_units_0': 148, 'cnn_learning_rate': 3.2264818172448785e-05, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 437}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.6514601707458496], 'acc': [0.12195122169285286], 'loss': [9.081810148750863], 'val_acc': [0.09375]}, 'runtime': 11.738228797912598}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 35)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 36)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 36) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 36) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 37) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 36) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 36)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.001167745954695799, 'height_shift_range': 0.267, 'batch_size': 24, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.203775660328654, 'num_dense_units_0': 104, 'cnn_learning_rate': 0.00015916952070955923, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 459}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:22:19.813738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.4484 - acc: 0.1527 - val_loss: 2.4373 - val_acc: 0.1039
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 36), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 36) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 36) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 36) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 36)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.001167745954695799, 'height_shift_range': 0.267, 'batch_size': 24, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.203775660328654, 'num_dense_units_0': 104, 'cnn_learning_rate': 0.00015916952070955923, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 459}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8961038951362882, 'info': {'histories': {'val_loss': [2.4372506234552955], 'acc': [0.15217392017012057], 'loss': [2.4482653244681982], 'val_acc': [0.10389610486371177]}, 'runtime': 9.125743389129639}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 36)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 37)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 37) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 37) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 38) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 37) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 37)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0005731565142495802, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_units_2': 16, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.0333580557354057, 'num_dense_units_0': 682, 'cnn_learning_rate': 1.3026109212597465e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 389}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:22:30.538462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 7s - loss: 2.3983 - acc: 0.0741 - val_loss: 2.3842 - val_acc: 0.1101
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 37), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 37) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 37) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 37) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 37)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0005731565142495802, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_units_2': 16, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.0333580557354057, 'num_dense_units_0': 682, 'cnn_learning_rate': 1.3026109212597465e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 389}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8899082561971945, 'info': {'histories': {'val_loss': [2.384210017842984], 'acc': [0.07407407462596893], 'loss': [2.3983493910895453], 'val_acc': [0.11009174380280556]}, 'runtime': 12.458717823028564}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 37)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 38)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 38) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 38) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 39) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 38) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 38)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004668810647282406, 'height_shift_range': 0.267, 'batch_size': 48, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.10252888059302052, 'num_dense_units_0': 237, 'cnn_learning_rate': 0.000798695089569573, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 51}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:22:41.557747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.5003 - acc: 0.0914 - val_loss: 2.4193 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 38), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 38) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 38) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 38) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 38)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004668810647282406, 'height_shift_range': 0.267, 'batch_size': 48, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.10252888059302052, 'num_dense_units_0': 237, 'cnn_learning_rate': 0.000798695089569573, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 51}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.419271469116211], 'acc': [0.08771929889917374], 'loss': [2.477838817395662], 'val_acc': [0.09375]}, 'runtime': 11.826619863510132}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 38)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 39)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 39) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 39) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 40) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 39) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 39)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00019916987708711864, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_units_2': 16, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.0918489514199288, 'num_dense_units_0': 845, 'cnn_learning_rate': 1.1312274602229464e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 160}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:22:53.327451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.4450 - acc: 0.1643 - val_loss: 2.4857 - val_acc: 0.1193
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 39), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 39) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 39) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 39) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 39)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00019916987708711864, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_units_2': 16, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.0918489514199288, 'num_dense_units_0': 845, 'cnn_learning_rate': 1.1312274602229464e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 160}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8807339449541285, 'info': {'histories': {'val_loss': [2.4856639739570268], 'acc': [0.16783216616490504], 'loss': [2.435265360178647], 'val_acc': [0.11926605504587157]}, 'runtime': 9.52538251876831}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 39)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 40)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 40) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 40) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 41) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 40)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00012882947262845318, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.06508243080896674, 'num_dense_units_0': 978, 'cnn_learning_rate': 0.00020753889586138015, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 286}, 'working_directory': '.', 'budget': 1.0}
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 13:23:07.923343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 9s - loss: 2.8709 - acc: 0.0864 - val_loss: 2.2112 - val_acc: 0.1560
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 40), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 40) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 40)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00012882947262845318, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.06508243080896674, 'num_dense_units_0': 978, 'cnn_learning_rate': 0.00020753889586138015, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 286}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8440366965641669, 'info': {'histories': {'val_loss': [2.2111949067596997], 'acc': [0.08641975538598166], 'loss': [2.8708564970228405], 'val_acc': [0.1559633034358331]}, 'runtime': 20.15339994430542}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 40)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 41)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 41) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 41) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 42) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 41)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025648462216023524, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 96, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.10035949091721118, 'num_dense_units_0': 498, 'cnn_learning_rate': 0.000134233839888681, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 100}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:23:23.502571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.2431 - acc: 0.2465 - val_loss: 2.0256 - val_acc: 0.3117
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 41), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 41) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 41)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025648462216023524, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 96, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.10035949091721118, 'num_dense_units_0': 498, 'cnn_learning_rate': 0.000134233839888681, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 100}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.6883116856023863, 'info': {'histories': {'val_loss': [2.025595795024525], 'acc': [0.2482269620324703], 'loss': [2.2520715099699955], 'val_acc': [0.31168831439761374]}, 'runtime': 9.389096736907959}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 41)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 42)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 42) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 42) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 43) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 42) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 42)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00011866154402909394, 'height_shift_range': 0.267, 'batch_size': 40, 'num_dense_units_2': 11, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.05879310003952833, 'num_dense_units_0': 112, 'cnn_learning_rate': 4.2269499276638755e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 62}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:23:33.329275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3284 - acc: 0.0930 - val_loss: 2.3353 - val_acc: 0.2188
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 42), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 42) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 42) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 42) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 42)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00011866154402909394, 'height_shift_range': 0.267, 'batch_size': 40, 'num_dense_units_2': 11, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.05879310003952833, 'num_dense_units_0': 112, 'cnn_learning_rate': 4.2269499276638755e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 62}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.78125, 'info': {'histories': {'val_loss': [2.3353240489959717], 'acc': [0.11475410007062506], 'loss': [2.3142364142371004], 'val_acc': [0.21875]}, 'runtime': 14.012022733688354}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 42)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 43)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 43) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 43) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 44) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 43) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 43)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0003693203828143039, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10900765194925684, 'num_dense_units_0': 132, 'cnn_learning_rate': 0.00039223277930003076, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 150}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:23:47.461113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3265 - acc: 0.1546 - val_loss: 2.2246 - val_acc: 0.2208
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 43), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 43) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 43) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 43) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 43)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0003693203828143039, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10900765194925684, 'num_dense_units_0': 132, 'cnn_learning_rate': 0.00039223277930003076, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 150}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.7792207782531714, 'info': {'histories': {'val_loss': [2.2245988474263774], 'acc': [0.1571428616132055], 'loss': [2.323021766117641], 'val_acc': [0.22077922174682865]}, 'runtime': 11.266116380691528}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 43)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 44)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 44) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 44) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 45) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 44) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 44)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0014990589600709881, 'height_shift_range': 0.267, 'batch_size': 48, 'num_dense_units_2': 47, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.05636697845241148, 'num_dense_units_0': 296, 'cnn_learning_rate': 0.00021784719879380733, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 126}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:23:59.718181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.9195 - acc: 0.0605 - val_loss: 2.6174 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 44), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 44) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 44) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 44) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 44)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0014990589600709881, 'height_shift_range': 0.267, 'batch_size': 48, 'num_dense_units_2': 47, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.05636697845241148, 'num_dense_units_0': 296, 'cnn_learning_rate': 0.00021784719879380733, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 126}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.617356777191162], 'acc': [0.06140350883728579], 'loss': [2.9564121773368432], 'val_acc': [0.09375]}, 'runtime': 16.219141483306885}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 44)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 45)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 45) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 45) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 46) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 45) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 45)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0017453515006018141, 'height_shift_range': 0.267, 'batch_size': 42, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.16597100101240886, 'num_dense_units_0': 863, 'cnn_learning_rate': 0.0009828862833248081, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 167}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:24:15.323014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.4823 - acc: 0.1064 - val_loss: 2.3858 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 45), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 45) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 45) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 45) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 45)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0017453515006018141, 'height_shift_range': 0.267, 'batch_size': 42, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.16597100101240886, 'num_dense_units_0': 863, 'cnn_learning_rate': 0.0009828862833248081, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 167}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.385817527770996], 'acc': [0.10833333842456341], 'loss': [2.48216427564621], 'val_acc': [0.09375]}, 'runtime': 12.77537727355957}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 45)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 46)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 46) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 47) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 46) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 46)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00034250364632725075, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10187798747318884, 'num_dense_units_0': 102, 'cnn_learning_rate': 0.0006568568909618812, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 72}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:24:27.796530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 7s - loss: 2.2817 - acc: 0.1870 - val_loss: 2.2342 - val_acc: 0.2208
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 46), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 46) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 46)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00034250364632725075, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10187798747318884, 'num_dense_units_0': 102, 'cnn_learning_rate': 0.0006568568909618812, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 72}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.7792207782531714, 'info': {'histories': {'val_loss': [2.2341671516368917], 'acc': [0.1914893682808318], 'loss': [2.2843139831055987], 'val_acc': [0.22077922174682865]}, 'runtime': 12.536661148071289}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 46)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 47)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 47) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 47) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 48) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 47)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0005618056923890776, 'height_shift_range': 0.267, 'batch_size': 48, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.12378679667693099, 'num_dense_units_0': 159, 'cnn_learning_rate': 0.00010299135666647601, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 53}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:24:40.471015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.3544 - acc: 0.1110 - val_loss: 2.2701 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 47), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 47) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 47)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0005618056923890776, 'height_shift_range': 0.267, 'batch_size': 48, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.12378679667693099, 'num_dense_units_0': 159, 'cnn_learning_rate': 0.00010299135666647601, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 53}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.84375, 'info': {'histories': {'val_loss': [2.270132064819336], 'acc': [0.1315789505055076], 'loss': [2.3487253314570378], 'val_acc': [0.15625]}, 'runtime': 13.804059267044067}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 47)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 48)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 48) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 48) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 49) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 48) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 48)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0023286056007376416, 'height_shift_range': 0.267, 'batch_size': 57, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.22815703149877098, 'num_dense_units_0': 684, 'cnn_learning_rate': 0.000256128531785433, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 203}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:24:54.717683: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 3.8989 - acc: 0.1643 - val_loss: 4.2051 - val_acc: 0.1250
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 48), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 48) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 48) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 48) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 48)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0023286056007376416, 'height_shift_range': 0.267, 'batch_size': 57, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.22815703149877098, 'num_dense_units_0': 684, 'cnn_learning_rate': 0.000256128531785433, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 203}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.875, 'info': {'histories': {'val_loss': [4.2050557136535645], 'acc': [0.16190476694277356], 'loss': [3.825325652531215], 'val_acc': [0.125]}, 'runtime': 13.655044078826904}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 48)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 49)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 49) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 49) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 50) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 49)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0002603793701118468, 'height_shift_range': 0.267, 'batch_size': 28, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.027779328620668873, 'num_dense_units_0': 111, 'cnn_learning_rate': 3.69461656985025e-05, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 151}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:25:08.282501: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.4435 - acc: 0.1024 - val_loss: 2.5078 - val_acc: 0.1406
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 49), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 49) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 49)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0002603793701118468, 'height_shift_range': 0.267, 'batch_size': 28, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.027779328620668873, 'num_dense_units_0': 111, 'cnn_learning_rate': 3.69461656985025e-05, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 151}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.859375, 'info': {'histories': {'val_loss': [2.5078266859054565], 'acc': [0.10447761727802789], 'loss': [2.4447717275192486], 'val_acc': [0.140625]}, 'runtime': 11.178305625915527}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 49)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 50)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 50) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 50) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 51) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 50) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 50)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00010311005645283783, 'height_shift_range': 0.267, 'batch_size': 50, 'num_dense_units_2': 135, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.04640805359218429, 'num_dense_units_0': 218, 'cnn_learning_rate': 0.0007490358151603908, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 85}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:25:19.538766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.3697 - acc: 0.0800 - val_loss: 2.4183 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 50), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 50) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 50) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 50) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 50)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00010311005645283783, 'height_shift_range': 0.267, 'batch_size': 50, 'num_dense_units_2': 135, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.04640805359218429, 'num_dense_units_0': 218, 'cnn_learning_rate': 0.0007490358151603908, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 85}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.875, 'info': {'histories': {'val_loss': [2.4183340072631836], 'acc': [0.07999999572833379], 'loss': [2.3697498639424643], 'val_acc': [0.125]}, 'runtime': 13.527239084243774}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 50)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 51)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 51) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 51) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 52) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 51) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 51)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009572733114123077, 'height_shift_range': 0.267, 'batch_size': 49, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.26618976141046374, 'num_dense_units_0': 689, 'cnn_learning_rate': 1.6463113350334674e-05, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 145}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:25:32.804424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3626 - acc: 0.0993 - val_loss: 2.3723 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 51), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 51) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 51) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 51) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 51)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009572733114123077, 'height_shift_range': 0.267, 'batch_size': 49, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.26618976141046374, 'num_dense_units_0': 689, 'cnn_learning_rate': 1.6463113350334674e-05, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 145}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.875, 'info': {'histories': {'val_loss': [2.372342824935913], 'acc': [0.10619468954020897], 'loss': [2.3552112326157832], 'val_acc': [0.125]}, 'runtime': 21.218830108642578}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 51)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 52)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 52) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 53) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 52) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 52) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 52)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.005154958802759252, 'height_shift_range': 0.267, 'batch_size': 46, 'num_dense_units_2': 131, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.26518185033822805, 'num_dense_units_0': 516, 'cnn_learning_rate': 1.946527864526595e-05, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 52}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:25:58.591787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 7s - loss: 2.7678 - acc: 0.1087 - val_loss: 2.3875 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 52), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 52) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 52) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 52) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 52)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.005154958802759252, 'height_shift_range': 0.267, 'batch_size': 46, 'num_dense_units_2': 131, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.26518185033822805, 'num_dense_units_0': 516, 'cnn_learning_rate': 1.946527864526595e-05, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 52}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.875, 'info': {'histories': {'val_loss': [2.3875222206115723], 'acc': [0.10869565606117249], 'loss': [2.7677976290384927], 'val_acc': [0.125]}, 'runtime': 20.333616733551025}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 52)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 53)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 53) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 53) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 54) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 53) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 53)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00011201029653871758, 'height_shift_range': 0.267, 'batch_size': 28, 'num_dense_units_2': 42, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.1466528370010289, 'num_dense_units_0': 556, 'cnn_learning_rate': 0.0006807788800877052, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 365}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:26:14.237703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.4151 - acc: 0.0968 - val_loss: 2.4600 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 53), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 53) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 53) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 53) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 53)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00011201029653871758, 'height_shift_range': 0.267, 'batch_size': 28, 'num_dense_units_2': 42, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.1466528370010289, 'num_dense_units_0': 556, 'cnn_learning_rate': 0.0006807788800877052, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 365}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.4599592685699463], 'acc': [0.09701493026605293], 'loss': [2.412522707412492], 'val_acc': [0.09375]}, 'runtime': 11.000588417053223}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 53)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 54)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 54) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 54) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 55) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 54) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 54)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007375952696489826, 'height_shift_range': 0.267, 'batch_size': 20, 'num_dense_units_2': 46, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.1948326290223274, 'num_dense_units_0': 559, 'cnn_learning_rate': 4.376305234907981e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 430}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:26:25.920187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 2.9745 - acc: 0.1268 - val_loss: 2.5074 - val_acc: 0.0909
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 54), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 54) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 54) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 54) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 54)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007375952696489826, 'height_shift_range': 0.267, 'batch_size': 20, 'num_dense_units_2': 46, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.1948326290223274, 'num_dense_units_0': 559, 'cnn_learning_rate': 4.376305234907981e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 430}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.9090909081233012, 'info': {'histories': {'val_loss': [2.507389833400776], 'acc': [0.14084507199660154], 'loss': [2.9403328559768034], 'val_acc': [0.09090909187669878]}, 'runtime': 10.789109230041504}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 54)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 55)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 55) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 56) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 55) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 55) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 55)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007935858280641571, 'height_shift_range': 0.267, 'batch_size': 48, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.2152674468397088, 'num_dense_units_0': 262, 'cnn_learning_rate': 0.00012532765046194264, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 60}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:26:36.491739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3869 - acc: 0.0753 - val_loss: 2.3241 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 55), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 55) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 55) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 55) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 55)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007935858280641571, 'height_shift_range': 0.267, 'batch_size': 48, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.2152674468397088, 'num_dense_units_0': 262, 'cnn_learning_rate': 0.00012532765046194264, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 60}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.324122667312622], 'acc': [0.07894736900925636], 'loss': [2.4022975971824243], 'val_acc': [0.09375]}, 'runtime': 14.946029424667358}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 55)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 56)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 56) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 56) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 57) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 56)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00027930706769058807, 'height_shift_range': 0.267, 'batch_size': 34, 'num_dense_units_2': 53, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.13434691564631, 'num_dense_units_0': 289, 'cnn_learning_rate': 3.8146762325181635e-05, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 335}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:26:55.653969: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 8s - loss: 2.2949 - acc: 0.1245 - val_loss: 2.2684 - val_acc: 0.1875
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 56), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 56) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 56)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00027930706769058807, 'height_shift_range': 0.267, 'batch_size': 34, 'num_dense_units_2': 53, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.13434691564631, 'num_dense_units_0': 289, 'cnn_learning_rate': 3.8146762325181635e-05, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 335}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8125, 'info': {'histories': {'val_loss': [2.268420457839966], 'acc': [0.1250000044819899], 'loss': [2.2950843907892704], 'val_acc': [0.1875]}, 'runtime': 19.635308980941772}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 56)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 57)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 57) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 57) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 58) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 57) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 57)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0023993643677003114, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_units_2': 10, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.1476684015954915, 'num_dense_units_0': 159, 'cnn_learning_rate': 0.0004248216625795517, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 75}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:27:11.935337: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.4093 - acc: 0.0864 - val_loss: 2.3840 - val_acc: 0.1101
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 57), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 57) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 57) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 57) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 57)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0023993643677003114, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_units_2': 10, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.1476684015954915, 'num_dense_units_0': 159, 'cnn_learning_rate': 0.0004248216625795517, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 75}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8899082565389642, 'info': {'histories': {'val_loss': [2.3839720236052067], 'acc': [0.08641975373029709], 'loss': [2.4092522727118597], 'val_acc': [0.11009174346103581]}, 'runtime': 11.195478677749634}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 57)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 58)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 58) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 58) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 59) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 58) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 58)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.008818134863514567, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.18385650793826339, 'num_dense_units_0': 298, 'cnn_learning_rate': 0.000380281961577311, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 346}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:27:23.796489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3423 - acc: 0.1915 - val_loss: 2.2264 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 58), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 58) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 58) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 58) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 58)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.008818134863514567, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.18385650793826339, 'num_dense_units_0': 298, 'cnn_learning_rate': 0.000380281961577311, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 346}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.84375, 'info': {'histories': {'val_loss': [2.2264175415039062], 'acc': [0.1626016319524951], 'loss': [2.3428143117485978], 'val_acc': [0.15625]}, 'runtime': 15.068472385406494}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 58)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 59)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 59) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 59) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 60) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 59) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 59)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00043149485748414596, 'height_shift_range': 0.267, 'batch_size': 45, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.0434977135368298, 'num_dense_units_0': 677, 'cnn_learning_rate': 0.00025402590935836607, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 252}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:27:37.767831: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 6s - loss: 2.3540 - acc: 0.0883 - val_loss: 2.2857 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 59), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 59) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 59) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 59) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 59)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00043149485748414596, 'height_shift_range': 0.267, 'batch_size': 45, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.0434977135368298, 'num_dense_units_0': 677, 'cnn_learning_rate': 0.00025402590935836607, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 252}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.2857067584991455], 'acc': [0.0940171004487918], 'loss': [2.3524482250213623], 'val_acc': [0.09375]}, 'runtime': 14.046175956726074}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 59)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 60)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 60) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 60) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 61) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 60) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 60)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004261161187545934, 'height_shift_range': 0.267, 'batch_size': 45, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.2083205686352454, 'num_dense_units_0': 713, 'cnn_learning_rate': 3.476681942645092e-05, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 62}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:27:51.040137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 5s - loss: 9.7880 - acc: 0.1111 - val_loss: 14.6070 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 60), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 60) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 60) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 60) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 60)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004261161187545934, 'height_shift_range': 0.267, 'batch_size': 45, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.2083205686352454, 'num_dense_units_0': 713, 'cnn_learning_rate': 3.476681942645092e-05, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 62}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [14.607023239135742], 'acc': [0.11111111480456132], 'loss': [9.283675652283888], 'val_acc': [0.09375]}, 'runtime': 12.579349517822266}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 60)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 61)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 61) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 61) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 62) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 61) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 61)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009687922303122322, 'height_shift_range': 0.267, 'batch_size': 47, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.15514314407219834, 'num_dense_units_0': 217, 'cnn_learning_rate': 1.3453701264303557e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 403}, 'working_directory': '.', 'budget': 1.0}
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 13:28:08.801748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 7s - loss: 2.3031 - acc: 0.1612 - val_loss: 2.2954 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 61), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 61) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 61) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 61) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 61)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009687922303122322, 'height_shift_range': 0.267, 'batch_size': 47, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.15514314407219834, 'num_dense_units_0': 217, 'cnn_learning_rate': 1.3453701264303557e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 403}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.875, 'info': {'histories': {'val_loss': [2.29541015625], 'acc': [0.1565217344009358], 'loss': [2.296843041544375], 'val_acc': [0.125]}, 'runtime': 21.702912092208862}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 61)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 62)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 62) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 62) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 63) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 62) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 62)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00026835738398635247, 'height_shift_range': 0.267, 'batch_size': 16, 'num_dense_units_2': 108, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.2020157313067293, 'num_dense_units_0': 372, 'cnn_learning_rate': 8.451343082591651e-05, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 149}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:28:30.613767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 7s - loss: 2.4424 - acc: 0.1387 - val_loss: 2.3063 - val_acc: 0.1193
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 62), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 62) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 62) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 62) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 62)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00026835738398635247, 'height_shift_range': 0.267, 'batch_size': 16, 'num_dense_units_2': 108, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.2020157313067293, 'num_dense_units_0': 372, 'cnn_learning_rate': 8.451343082591651e-05, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 149}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 0.8807339442705889, 'info': {'histories': {'val_loss': [2.3062964185662227], 'acc': [0.1506849315068493], 'loss': [2.42031613114762], 'val_acc': [0.11926605572941107]}, 'runtime': 18.26380729675293}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 62)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 63)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 63) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 63) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 0) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 63) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 63)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0001836090290558961, 'height_shift_range': 0.267, 'batch_size': 41, 'num_dense_units_2': 12, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.090601214632202, 'num_dense_units_0': 250, 'cnn_learning_rate': 1.0588158240475469e-05, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 50}, 'working_directory': '.', 'budget': 1.0}
2018-02-08 13:28:49.407818: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/1
 - 9s - loss: 2.3766 - acc: 0.0976 - val_loss: 2.4004 - val_acc: 0.0000e+00
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 63), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 63) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 63) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 63) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 63)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0001836090290558961, 'height_shift_range': 0.267, 'batch_size': 41, 'num_dense_units_2': 12, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.090601214632202, 'num_dense_units_0': 250, 'cnn_learning_rate': 1.0588158240475469e-05, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 50}, 'working_directory': '.', 'budget': 1.0}
result: {'loss': 1.0, 'info': {'histories': {'val_loss': [2.400435209274292], 'acc': [0.09756096949179967], 'loss': [2.376575152079264], 'val_acc': [0.0]}, 'runtime': 48.12274098396301}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 63)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 0) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 46) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004440858756346598, 'height_shift_range': 0.267, 'batch_size': 24, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.0038465833794067983, 'num_dense_units_0': 152, 'cnn_learning_rate': 1.3197144852527731e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 78}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:29:32.330235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.6944 - acc: 0.1697 - val_loss: 2.1184 - val_acc: 0.1688
Epoch 2/2
 - 3s - loss: 1.7530 - acc: 0.4482 - val_loss: 1.6731 - val_acc: 0.4675
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 0)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004440858756346598, 'height_shift_range': 0.267, 'batch_size': 24, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.0038465833794067983, 'num_dense_units_0': 152, 'cnn_learning_rate': 1.3197144852527731e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 78}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.5324675262748422, 'info': {'histories': {'val_loss': [2.1183833580512506, 1.6730975191314499], 'acc': [0.17391304720355116, 0.4565217410740645], 'loss': [2.6689296494359556, 1.744525899057803], 'val_acc': [0.16883117154047086, 0.4675324737251579]}, 'runtime': 11.042502880096436}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 0)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 46)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 46) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 46) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 8) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 46)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00034250364632725075, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10187798747318884, 'num_dense_units_0': 102, 'cnn_learning_rate': 0.0006568568909618812, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 72}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:29:44.417142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.3451 - acc: 0.1701 - val_loss: 2.2598 - val_acc: 0.1818
Epoch 2/2
 - 5s - loss: 2.0738 - acc: 0.3056 - val_loss: 2.0633 - val_acc: 0.4026
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 46), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 46) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 46)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00034250364632725075, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10187798747318884, 'num_dense_units_0': 102, 'cnn_learning_rate': 0.0006568568909618812, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 72}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.5974025919839934, 'info': {'histories': {'val_loss': [2.2598339365674303, 2.0633008727779636], 'acc': [0.1700680357004915, 0.31111113015148373], 'loss': [2.3451370852334157, 2.0638517088360255], 'val_acc': [0.18181818181818182, 0.4025974080160067]}, 'runtime': 16.62668013572693}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 46)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 8)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 8) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 8) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 58) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 8) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 8)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0011252188834962845, 'height_shift_range': 0.267, 'batch_size': 34, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1513372263504593, 'num_dense_units_0': 731, 'cnn_learning_rate': 1.4293240239556127e-05, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 420}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:30:00.882223: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.3100 - acc: 0.1710 - val_loss: 2.2099 - val_acc: 0.2656
Epoch 2/2
 - 5s - loss: 1.9829 - acc: 0.3456 - val_loss: 2.0384 - val_acc: 0.3281
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 8), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 8) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 8) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 8) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 8)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0011252188834962845, 'height_shift_range': 0.267, 'batch_size': 34, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1513372263504593, 'num_dense_units_0': 731, 'cnn_learning_rate': 1.4293240239556127e-05, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 420}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.671875, 'info': {'histories': {'val_loss': [2.2099450826644897, 2.03842031955719], 'acc': [0.17187500663567334, 0.34558824449777603], 'loss': [2.316804576665163, 1.9829169809818268], 'val_acc': [0.265625, 0.328125]}, 'runtime': 18.024654626846313}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 8)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 58)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 58) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 58) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 43) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 58) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 58)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.008818134863514567, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.18385650793826339, 'num_dense_units_0': 298, 'cnn_learning_rate': 0.000380281961577311, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 346}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:30:20.002727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.3304 - acc: 0.1295 - val_loss: 2.2907 - val_acc: 0.0625
Epoch 2/2
 - 4s - loss: 2.3207 - acc: 0.1410 - val_loss: 2.2704 - val_acc: 0.2188
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 58), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 58) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 58) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 58) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 58)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.008818134863514567, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.18385650793826339, 'num_dense_units_0': 298, 'cnn_learning_rate': 0.000380281961577311, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 346}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.78125, 'info': {'histories': {'val_loss': [2.290656089782715, 2.2704195976257324], 'acc': [0.12195122478211798, 0.14102564845234156], 'loss': [2.289971607487376, 2.3206679224967957], 'val_acc': [0.0625, 0.21875]}, 'runtime': 16.359326601028442}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 58)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 43)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 43) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 56) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 43) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (0, 0, 43) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 43)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0003693203828143039, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10900765194925684, 'num_dense_units_0': 132, 'cnn_learning_rate': 0.00039223277930003076, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 150}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:30:35.128677: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.3002 - acc: 0.1809 - val_loss: 2.2827 - val_acc: 0.0909
Epoch 2/2
 - 5s - loss: 2.1774 - acc: 0.3191 - val_loss: 2.2241 - val_acc: 0.1429
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 43), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 43) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 43) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 43) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 43)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0003693203828143039, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10900765194925684, 'num_dense_units_0': 132, 'cnn_learning_rate': 0.00039223277930003076, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 150}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.8571428544335551, 'info': {'histories': {'val_loss': [2.2827458722250804, 2.224050775750891], 'acc': [0.185714291036129, 0.3142857276967594], 'loss': [2.2930942739759175, 2.191260549000331], 'val_acc': [0.09090909187669878, 0.14285714556644488]}, 'runtime': 15.308913230895996}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 43)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 56)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 56) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 42) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 56) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 56)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00027930706769058807, 'height_shift_range': 0.267, 'batch_size': 34, 'num_dense_units_2': 53, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.13434691564631, 'num_dense_units_0': 289, 'cnn_learning_rate': 3.8146762325181635e-05, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 335}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:30:55.187623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.3031 - acc: 0.1728 - val_loss: 2.2585 - val_acc: 0.2344
Epoch 2/2
 - 5s - loss: 2.2417 - acc: 0.1985 - val_loss: 2.2257 - val_acc: 0.2969
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 56), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 56) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 56)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00027930706769058807, 'height_shift_range': 0.267, 'batch_size': 34, 'num_dense_units_2': 53, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.13434691564631, 'num_dense_units_0': 289, 'cnn_learning_rate': 3.8146762325181635e-05, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 335}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.703125, 'info': {'histories': {'val_loss': [2.258502721786499, 2.225690007209778], 'acc': [0.17187500465661287, 0.1985294185578823], 'loss': [2.3040684163570404, 2.241684913635254], 'val_acc': [0.234375, 0.296875]}, 'runtime': 21.58002495765686}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 56)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 42)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 42) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 42) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 7) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 42) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 42)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00011866154402909394, 'height_shift_range': 0.267, 'batch_size': 40, 'num_dense_units_2': 11, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.05879310003952833, 'num_dense_units_0': 112, 'cnn_learning_rate': 4.2269499276638755e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 62}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:31:12.710781: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.3152 - acc: 0.1062 - val_loss: 2.3387 - val_acc: 0.0000e+00
Epoch 2/2
 - 4s - loss: 2.2593 - acc: 0.1880 - val_loss: 2.3363 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 42), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 42) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 42) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 42) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 42)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00011866154402909394, 'height_shift_range': 0.267, 'batch_size': 40, 'num_dense_units_2': 11, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.05879310003952833, 'num_dense_units_0': 112, 'cnn_learning_rate': 4.2269499276638755e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 62}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.3386600017547607, 2.3362672328948975], 'acc': [0.13114754293785721, 0.11475409933778107], 'loss': [2.314301338352141, 2.291630182109895], 'val_acc': [0.0, 0.09375]}, 'runtime': 15.188456773757935}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 42)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 7)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 7) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 7) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 41) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 7) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 7)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00045501478271130826, 'height_shift_range': 0.267, 'batch_size': 35, 'num_dense_units_2': 121, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.0058493838712906365, 'num_dense_units_0': 502, 'cnn_learning_rate': 0.00012099864328030101, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 97}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:31:27.744426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.9543 - acc: 0.1239 - val_loss: 2.3709 - val_acc: 0.1250
Epoch 2/2
 - 4s - loss: 2.2502 - acc: 0.2569 - val_loss: 1.9433 - val_acc: 0.4375
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 7), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 7) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 7) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 7) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 7)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00045501478271130826, 'height_shift_range': 0.267, 'batch_size': 35, 'num_dense_units_2': 121, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.0058493838712906365, 'num_dense_units_0': 502, 'cnn_learning_rate': 0.00012099864328030101, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 97}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.5625, 'info': {'histories': {'val_loss': [2.370911121368408, 1.9433097839355469], 'acc': [0.133858270004509, 0.25196850769163115], 'loss': [2.909149434622817, 2.2562709361549436], 'val_acc': [0.125, 0.4375]}, 'runtime': 15.42851448059082}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 7)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 41)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 41) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 41) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 20) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 41)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025648462216023524, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 96, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.10035949091721118, 'num_dense_units_0': 498, 'cnn_learning_rate': 0.000134233839888681, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 100}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:31:42.643818: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.3649 - acc: 0.1873 - val_loss: 1.9382 - val_acc: 0.3377
Epoch 2/2
 - 3s - loss: 1.8426 - acc: 0.3467 - val_loss: 1.7686 - val_acc: 0.3247
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 41), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 41) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 41)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025648462216023524, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 96, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.10035949091721118, 'num_dense_units_0': 498, 'cnn_learning_rate': 0.000134233839888681, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 100}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.6753246726153732, 'info': {'histories': {'val_loss': [1.938209242634959, 1.7685918436421977], 'acc': [0.1843971680612006, 0.3546099472553172], 'loss': [2.3786715269088745, 1.831281971424184], 'val_acc': [0.337662343855028, 0.32467532738462673]}, 'runtime': 11.35372281074524}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 41)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 20)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 20) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 20) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 40) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 20) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 20)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008498560064325884, 'height_shift_range': 0.267, 'batch_size': 52, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.23736502775800886, 'num_dense_units_0': 201, 'cnn_learning_rate': 0.00013664718147462967, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 69}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:31:59.022882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.4181 - acc: 0.0833 - val_loss: 2.3580 - val_acc: 0.2188
Epoch 2/2
 - 4s - loss: 2.4897 - acc: 0.1077 - val_loss: 2.3600 - val_acc: 0.0312
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 20), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 20) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 20) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 20) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 20)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008498560064325884, 'height_shift_range': 0.267, 'batch_size': 52, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.23736502775800886, 'num_dense_units_0': 201, 'cnn_learning_rate': 0.00013664718147462967, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 69}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.96875, 'info': {'histories': {'val_loss': [2.3579704761505127, 2.35996675491333], 'acc': [0.0833333358168602, 0.09090909686955538], 'loss': [2.4180715084075928, 2.5172199509360573], 'val_acc': [0.21875, 0.03125]}, 'runtime': 22.423917531967163}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 20)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 40)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 40) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 40) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 18) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 40)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00012882947262845318, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.06508243080896674, 'num_dense_units_0': 978, 'cnn_learning_rate': 0.00020753889586138015, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 286}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:32:21.964284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.6793 - acc: 0.1543 - val_loss: 2.1699 - val_acc: 0.1101
Epoch 2/2
 - 6s - loss: 1.9070 - acc: 0.3395 - val_loss: 2.0813 - val_acc: 0.2661
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 40), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 40) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 40)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00012882947262845318, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.06508243080896674, 'num_dense_units_0': 978, 'cnn_learning_rate': 0.00020753889586138015, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 286}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.7339449534449008, 'info': {'histories': {'val_loss': [2.169914416216929, 2.081283455594964], 'acc': [0.15432099252939224, 0.3395061906841066], 'loss': [2.6793460845947266, 1.9069947136773004], 'val_acc': [0.11009174380280556, 0.26605504655509915]}, 'runtime': 24.092422246932983}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 40)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 18)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 18) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 4) to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 18) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (0, 0, 18) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 18)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0003578958860716047, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 10, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.08092682512038031, 'num_dense_units_0': 160, 'cnn_learning_rate': 1.3283647444427225e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 364}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:32:42.706542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.3133 - acc: 0.0723 - val_loss: 2.3006 - val_acc: 0.0649
Epoch 2/2
 - 4s - loss: 2.3046 - acc: 0.1414 - val_loss: 2.2796 - val_acc: 0.1299
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 18), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 18) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 18) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 18) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 18)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0003578958860716047, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 10, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.08092682512038031, 'num_dense_units_0': 160, 'cnn_learning_rate': 1.3283647444427225e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 364}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.8701298691622623, 'info': {'histories': {'val_loss': [2.3006067090220266, 2.2796216196828074], 'acc': [0.07857143091303961, 0.14285714690174375], 'loss': [2.31135322366442, 2.3011724097388133], 'val_acc': [0.06493506590267281, 0.12987013083773774]}, 'runtime': 16.0996732711792}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 18)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 4)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 4) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 17) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 4) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 4)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00019706339231567252, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 75, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.16313183588884675, 'num_dense_units_0': 382, 'cnn_learning_rate': 3.425787400401275e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 335}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:32:57.467739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.3346 - acc: 0.0811 - val_loss: 2.2716 - val_acc: 0.0938
Epoch 2/2
 - 5s - loss: 2.1855 - acc: 0.2885 - val_loss: 2.2281 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 4)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00019706339231567252, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 75, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.16313183588884675, 'num_dense_units_0': 382, 'cnn_learning_rate': 3.425787400401275e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 335}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.2716164588928223, 2.2281248569488525], 'acc': [0.09756097924418566, 0.28846154920756817], 'loss': [2.3160573215019413, 2.185518443584442], 'val_acc': [0.09375, 0.09375]}, 'runtime': 15.120686531066895}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 4)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 17)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 17) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 52) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 17) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 17) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 17)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00027233924361869696, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_units_2': 235, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.2617011372200081, 'num_dense_units_0': 183, 'cnn_learning_rate': 0.00017379987110576712, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 80}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:33:12.083547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.3410 - acc: 0.0850 - val_loss: 2.3308 - val_acc: 0.0642
Epoch 2/2
 - 3s - loss: 2.3541 - acc: 0.0595 - val_loss: 2.3137 - val_acc: 0.0734
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 17), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 17) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 17) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 17) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 17)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00027233924361869696, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_units_2': 235, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.2617011372200081, 'num_dense_units_0': 183, 'cnn_learning_rate': 0.00017379987110576712, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 80}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.9266055039036165, 'info': {'histories': {'val_loss': [2.330764492717358, 2.3136575703227193], 'acc': [0.08496732140580814, 0.06569343136392371], 'loss': [2.3409646881951227, 2.341247614282761], 'val_acc': [0.06422018382800829, 0.07339449609638354]}, 'runtime': 11.618126630783081}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 17)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 52)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 52) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 52) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 31) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 52) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 52)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.005154958802759252, 'height_shift_range': 0.267, 'batch_size': 46, 'num_dense_units_2': 131, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.26518185033822805, 'num_dense_units_0': 516, 'cnn_learning_rate': 1.946527864526595e-05, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 52}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:33:28.805537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.6602 - acc: 0.1159 - val_loss: 2.4325 - val_acc: 0.1875
Epoch 2/2
 - 5s - loss: 2.3666 - acc: 0.1239 - val_loss: 2.2977 - val_acc: 0.2500
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 52), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 52) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 52) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 52) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 52)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.005154958802759252, 'height_shift_range': 0.267, 'batch_size': 46, 'num_dense_units_2': 131, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.26518185033822805, 'num_dense_units_0': 516, 'cnn_learning_rate': 1.946527864526595e-05, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 52}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.75, 'info': {'histories': {'val_loss': [2.432464122772217, 2.2977161407470703], 'acc': [0.1159420299033324, 0.11702127865654358], 'loss': [2.6601718266805015, 2.365723041777915], 'val_acc': [0.1875, 0.25]}, 'runtime': 22.6121027469635}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 52)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 31)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 31) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 31) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 1) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 31) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 31)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0009487352712683983, 'height_shift_range': 0.267, 'batch_size': 57, 'num_dense_units_2': 20, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.1445711830449289, 'num_dense_units_0': 193, 'cnn_learning_rate': 0.0001935000181847217, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 214}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:33:51.857518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.8611 - acc: 0.1579 - val_loss: 2.8441 - val_acc: 0.0625
Epoch 2/2
 - 4s - loss: 2.6875 - acc: 0.1567 - val_loss: 2.3345 - val_acc: 0.2500
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 31), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 31) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 31) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 31) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 31)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0009487352712683983, 'height_shift_range': 0.267, 'batch_size': 57, 'num_dense_units_2': 20, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.1445711830449289, 'num_dense_units_0': 193, 'cnn_learning_rate': 0.0001935000181847217, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 214}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.75, 'info': {'histories': {'val_loss': [2.8441004753112793, 2.3344926834106445], 'acc': [0.15789473056793213, 0.16190476289817265], 'loss': [2.8611422777175903, 2.6826981612614222], 'val_acc': [0.0625, 0.25]}, 'runtime': 28.817558526992798}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 31)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 1)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 1) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 51) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 1) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00935400780029806, 'height_shift_range': 0.267, 'batch_size': 43, 'num_dense_units_2': 73, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1936363862374609, 'num_dense_units_0': 557, 'cnn_learning_rate': 1.6804311197793663e-05, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 179}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:34:16.114074: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 3.7825 - acc: 0.0748 - val_loss: 3.7613 - val_acc: 0.1250
Epoch 2/2
 - 4s - loss: 4.7120 - acc: 0.0704 - val_loss: 2.5085 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 1)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00935400780029806, 'height_shift_range': 0.267, 'batch_size': 43, 'num_dense_units_2': 73, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1936363862374609, 'num_dense_units_0': 557, 'cnn_learning_rate': 1.6804311197793663e-05, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 179}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [3.761263132095337, 2.5085458755493164], 'acc': [0.07563025372869828, 0.06722689297895472], 'loss': [3.723917993176885, 4.724899532414284], 'val_acc': [0.125, 0.09375]}, 'runtime': 15.90941572189331}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 1)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 51)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 51) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 51) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 30) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 51) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 51)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009572733114123077, 'height_shift_range': 0.267, 'batch_size': 49, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.26618976141046374, 'num_dense_units_0': 689, 'cnn_learning_rate': 1.6463113350334674e-05, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 145}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:34:32.570713: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.3310 - acc: 0.0701 - val_loss: 2.3087 - val_acc: 0.0938
Epoch 2/2
 - 4s - loss: 2.3318 - acc: 0.0952 - val_loss: 2.2751 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 51), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 51) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 51) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 51) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 51)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009572733114123077, 'height_shift_range': 0.267, 'batch_size': 49, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.26618976141046374, 'num_dense_units_0': 689, 'cnn_learning_rate': 1.6463113350334674e-05, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 145}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.875, 'info': {'histories': {'val_loss': [2.3086507320404053, 2.2750918865203857], 'acc': [0.07079646017699115, 0.09523809204498927], 'loss': [2.3385629590633696, 2.3318256537119546], 'val_acc': [0.09375, 0.125]}, 'runtime': 17.130563259124756}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 51)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 30)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 30) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 30) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 50) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 30) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 30)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009762454574108563, 'height_shift_range': 0.267, 'batch_size': 51, 'num_dense_units_2': 32, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.24068245638600697, 'num_dense_units_0': 278, 'cnn_learning_rate': 0.0007606639430595606, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 233}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:34:48.697981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 4s - loss: 2.6472 - acc: 0.0715 - val_loss: 3.0750 - val_acc: 0.1562
Epoch 2/2
 - 3s - loss: 2.8444 - acc: 0.1016 - val_loss: 2.4430 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 30), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 30) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 30) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 30) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 30)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009762454574108563, 'height_shift_range': 0.267, 'batch_size': 51, 'num_dense_units_2': 32, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.24068245638600697, 'num_dense_units_0': 278, 'cnn_learning_rate': 0.0007606639430595606, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 233}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.84375, 'info': {'histories': {'val_loss': [3.074981927871704, 2.443047523498535], 'acc': [0.09009010012488107, 0.09909910235453297], 'loss': [2.5987893310753076, 2.9140561851295264], 'val_acc': [0.15625, 0.15625]}, 'runtime': 11.370277404785156}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 30)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 50)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 50) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 50) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 29) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 50) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 50)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00010311005645283783, 'height_shift_range': 0.267, 'batch_size': 50, 'num_dense_units_2': 135, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.04640805359218429, 'num_dense_units_0': 218, 'cnn_learning_rate': 0.0007490358151603908, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 85}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:35:01.445856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 4s - loss: 2.4239 - acc: 0.0882 - val_loss: 2.3226 - val_acc: 0.1562
Epoch 2/2
 - 3s - loss: 2.3939 - acc: 0.0933 - val_loss: 2.3591 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 50), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 50) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 50) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 50) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 50)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00010311005645283783, 'height_shift_range': 0.267, 'batch_size': 50, 'num_dense_units_2': 135, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.04640805359218429, 'num_dense_units_0': 218, 'cnn_learning_rate': 0.0007490358151603908, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 85}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.322558879852295, 2.359067440032959], 'acc': [0.08928571109260831, 0.0933333324889342], 'loss': [2.435603908130101, 2.3938896656036377], 'val_acc': [0.15625, 0.09375]}, 'runtime': 14.016577005386353}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 50)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 29)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 29) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 49) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 29) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (0, 0, 29) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 29)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00030912433098717856, 'height_shift_range': 0.267, 'batch_size': 41, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10463537736613007, 'num_dense_units_0': 296, 'cnn_learning_rate': 0.00029688826057106037, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 162}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:35:14.979584: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.3917 - acc: 0.1074 - val_loss: 2.2604 - val_acc: 0.1250
Epoch 2/2
 - 4s - loss: 2.0404 - acc: 0.3659 - val_loss: 2.1873 - val_acc: 0.2188
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 29), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 29) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 29) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 29) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 29)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00030912433098717856, 'height_shift_range': 0.267, 'batch_size': 41, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10463537736613007, 'num_dense_units_0': 296, 'cnn_learning_rate': 0.00029688826057106037, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 162}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.78125, 'info': {'histories': {'val_loss': [2.2604246139526367, 2.1873092651367188], 'acc': [0.10743801418907387, 0.3658536374568939], 'loss': [2.3921085684752663, 2.0403550465901694], 'val_acc': [0.125, 0.21875]}, 'runtime': 16.228638172149658}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 29)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 49)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 49) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 49) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 48) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 49)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0002603793701118468, 'height_shift_range': 0.267, 'batch_size': 28, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.027779328620668873, 'num_dense_units_0': 111, 'cnn_learning_rate': 3.69461656985025e-05, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 151}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:35:31.569270: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.3779 - acc: 0.1007 - val_loss: 2.4710 - val_acc: 0.1094
Epoch 2/2
 - 3s - loss: 2.1691 - acc: 0.2571 - val_loss: 2.5464 - val_acc: 0.0781
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 49), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 49) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 49) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 49)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0002603793701118468, 'height_shift_range': 0.267, 'batch_size': 28, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.027779328620668873, 'num_dense_units_0': 111, 'cnn_learning_rate': 3.69461656985025e-05, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 151}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.921875, 'info': {'histories': {'val_loss': [2.470986843109131, 2.5464255809783936], 'acc': [0.10447761505397397, 0.2571428716182709], 'loss': [2.3686166094310246, 2.169142484664917], 'val_acc': [0.109375, 0.078125]}, 'runtime': 12.77586841583252}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 49)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 48)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 48) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 33) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 48) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (0, 0, 48) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 48)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0023286056007376416, 'height_shift_range': 0.267, 'batch_size': 57, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.22815703149877098, 'num_dense_units_0': 684, 'cnn_learning_rate': 0.000256128531785433, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 203}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:35:44.403429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 4s - loss: 3.2361 - acc: 0.2040 - val_loss: 3.3386 - val_acc: 0.0938
Epoch 2/2
 - 3s - loss: 3.0147 - acc: 0.2680 - val_loss: 3.7990 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 48), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 48) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 48) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 48) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 48)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0023286056007376416, 'height_shift_range': 0.267, 'batch_size': 57, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.22815703149877098, 'num_dense_units_0': 684, 'cnn_learning_rate': 0.000256128531785433, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 203}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [3.338615655899048, 3.7990262508392334], 'acc': [0.20952380895614625, 0.26666667674268996], 'loss': [3.281842408861433, 3.045109578541347], 'val_acc': [0.09375, 0.09375]}, 'runtime': 14.984418869018555}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 48)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 33)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 33) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 33) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 26) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 33)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018883732300841306, 'height_shift_range': 0.267, 'batch_size': 31, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.03631828087169122, 'num_dense_units_0': 238, 'cnn_learning_rate': 0.0002448877074276911, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 61}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:35:59.178260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 3.2618 - acc: 0.1182 - val_loss: 2.2435 - val_acc: 0.2344
Epoch 2/2
 - 5s - loss: 2.2850 - acc: 0.2046 - val_loss: 2.4531 - val_acc: 0.1719
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 33), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 33) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 33)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018883732300841306, 'height_shift_range': 0.267, 'batch_size': 31, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.03631828087169122, 'num_dense_units_0': 238, 'cnn_learning_rate': 0.0002448877074276911, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 61}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.828125, 'info': {'histories': {'val_loss': [2.243457794189453, 2.4531495571136475], 'acc': [0.11450381395016007, 0.21374045221405175], 'loss': [3.0682509855459665, 2.25505959714642], 'val_acc': [0.234375, 0.171875]}, 'runtime': 15.098820209503174}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 33)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 26)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 26) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 26) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 12) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 26) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 26)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.001610620067654615, 'height_shift_range': 0.267, 'batch_size': 52, 'num_dense_units_2': 31, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.2614660309066346, 'num_dense_units_0': 991, 'cnn_learning_rate': 5.197330375717934e-05, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 328}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:36:18.760020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.7710 - acc: 0.1360 - val_loss: 2.3502 - val_acc: 0.1875
Epoch 2/2
 - 4s - loss: 2.5312 - acc: 0.1218 - val_loss: 2.4083 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 26), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 26) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 26) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 26) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 26)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.001610620067654615, 'height_shift_range': 0.267, 'batch_size': 52, 'num_dense_units_2': 31, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.2614660309066346, 'num_dense_units_0': 991, 'cnn_learning_rate': 5.197330375717934e-05, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 328}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.84375, 'info': {'histories': {'val_loss': [2.3501956462860107, 2.4082512855529785], 'acc': [0.12727273458784277, 0.10909091396765276], 'loss': [2.875158925489946, 2.5971732789819892], 'val_acc': [0.1875, 0.15625]}, 'runtime': 23.406609535217285}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 26)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 12)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 12) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 62) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 12) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (0, 0, 12) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 12)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00037933185280457767, 'height_shift_range': 0.267, 'batch_size': 26, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.15823558879965471, 'num_dense_units_0': 362, 'cnn_learning_rate': 0.00013884115825566067, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 108}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:36:38.560007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.2442 - acc: 0.2115 - val_loss: 2.7900 - val_acc: 0.0625
Epoch 2/2
 - 3s - loss: 1.8018 - acc: 0.4242 - val_loss: 2.7929 - val_acc: 0.0781
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 12), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 12) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 12) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 12) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 12)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00037933185280457767, 'height_shift_range': 0.267, 'batch_size': 26, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.15823558879965471, 'num_dense_units_0': 362, 'cnn_learning_rate': 0.00013884115825566067, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 108}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.921875, 'info': {'histories': {'val_loss': [2.7899703979492188, 2.792886972427368], 'acc': [0.21153847749034563, 0.3793103651239954], 'loss': [2.2442236145337424, 1.826627406580695], 'val_acc': [0.0625, 0.078125]}, 'runtime': 13.346579790115356}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 12)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 62)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 62) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 32) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 62) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 62) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 62)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00026835738398635247, 'height_shift_range': 0.267, 'batch_size': 16, 'num_dense_units_2': 108, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.2020157313067293, 'num_dense_units_0': 372, 'cnn_learning_rate': 8.451343082591651e-05, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 149}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:36:56.372395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.6326 - acc: 0.0946 - val_loss: 2.2870 - val_acc: 0.2294
Epoch 2/2
 - 6s - loss: 2.1988 - acc: 0.1891 - val_loss: 2.1919 - val_acc: 0.2202
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 62), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 62) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 62) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 62) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 62)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00026835738398635247, 'height_shift_range': 0.267, 'batch_size': 16, 'num_dense_units_2': 108, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.2020157313067293, 'num_dense_units_0': 372, 'cnn_learning_rate': 8.451343082591651e-05, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 149}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.7798165118475573, 'info': {'histories': {'val_loss': [2.2870368498180986, 2.1918958764557446], 'acc': [0.10273972602739725, 0.2054794520547945], 'loss': [2.6713691247652656, 2.207524351877709], 'val_acc': [0.22935779884867713, 0.22018348815244274]}, 'runtime': 23.93929100036621}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 62)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 32)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 32) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 25) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 32) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 32) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 32)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00015696215844388002, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_units_2': 26, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.023079139071074204, 'num_dense_units_0': 340, 'cnn_learning_rate': 3.608531416092223e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 117}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:37:15.096155: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.3694 - acc: 0.1721 - val_loss: 2.2743 - val_acc: 0.2569
Epoch 2/2
 - 3s - loss: 2.0330 - acc: 0.2747 - val_loss: 2.1896 - val_acc: 0.2477
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 32), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 32) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 32) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 32) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 32)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00015696215844388002, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_units_2': 26, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.023079139071074204, 'num_dense_units_0': 340, 'cnn_learning_rate': 3.608531416092223e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 117}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.7522935760677407, 'info': {'histories': {'val_loss': [2.274306686646348, 2.1896067464023554], 'acc': [0.15862069165912168, 0.2827586235157375], 'loss': [2.391772215119724, 2.0322759217229383], 'val_acc': [0.25688073531203315, 0.24770642393225922]}, 'runtime': 11.814488649368286}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 32)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 25)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 25) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 61) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 25) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 25) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 25)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00024242811760568562, 'height_shift_range': 0.267, 'batch_size': 25, 'num_dense_units_2': 22, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.1066477912553486, 'num_dense_units_0': 128, 'cnn_learning_rate': 0.00019096358806546188, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 223}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:37:26.719038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.3321 - acc: 0.1008 - val_loss: 2.4027 - val_acc: 0.0779
Epoch 2/2
 - 3s - loss: 2.1733 - acc: 0.1684 - val_loss: 2.1861 - val_acc: 0.1429
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 25), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 25) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 25) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 25) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 25)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00024242811760568562, 'height_shift_range': 0.267, 'batch_size': 25, 'num_dense_units_2': 22, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.1066477912553486, 'num_dense_units_0': 128, 'cnn_learning_rate': 0.00019096358806546188, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 223}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.8571428561752492, 'info': {'histories': {'val_loss': [2.4026885528069037, 2.186050390268301], 'acc': [0.10218977911846482, 0.17518247821687782], 'loss': [2.330597644304707, 2.174445082671451], 'val_acc': [0.07792207840588186, 0.14285714382475073]}, 'runtime': 11.907703876495361}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 25)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 61)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 61) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 61) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 47) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 61) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 61)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009687922303122322, 'height_shift_range': 0.267, 'batch_size': 47, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.15514314407219834, 'num_dense_units_0': 217, 'cnn_learning_rate': 1.3453701264303557e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 403}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:37:43.722524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.3649 - acc: 0.0922 - val_loss: 2.2923 - val_acc: 0.2188
Epoch 2/2
 - 4s - loss: 2.3469 - acc: 0.1312 - val_loss: 2.3045 - val_acc: 0.1875
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 61), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 61) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 61) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 61) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 61)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009687922303122322, 'height_shift_range': 0.267, 'batch_size': 47, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.15514314407219834, 'num_dense_units_0': 217, 'cnn_learning_rate': 1.3453701264303557e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 403}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.8125, 'info': {'histories': {'val_loss': [2.2922520637512207, 2.3044755458831787], 'acc': [0.09219858050346375, 0.1217391268066738], 'loss': [2.3649098873138428, 2.3497664679651673], 'val_acc': [0.21875, 0.1875]}, 'runtime': 21.998796701431274}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 61)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 47)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 47) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 24) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 47) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 47)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0005618056923890776, 'height_shift_range': 0.267, 'batch_size': 48, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.12378679667693099, 'num_dense_units_0': 159, 'cnn_learning_rate': 0.00010299135666647601, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 53}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:38:01.228398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.2356 - acc: 0.1927 - val_loss: 2.2990 - val_acc: 0.1562
Epoch 2/2
 - 5s - loss: 2.0927 - acc: 0.2778 - val_loss: 2.2209 - val_acc: 0.2500
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 47), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 47) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 47)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0005618056923890776, 'height_shift_range': 0.267, 'batch_size': 48, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.12378679667693099, 'num_dense_units_0': 159, 'cnn_learning_rate': 0.00010299135666647601, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 53}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.75, 'info': {'histories': {'val_loss': [2.2989656925201416, 2.2208971977233887], 'acc': [0.16666667241799205, 0.2777777860562007], 'loss': [2.268816295423006, 2.0926557381947837], 'val_acc': [0.15625, 0.25]}, 'runtime': 17.72249937057495}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 47)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 24)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 24) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 24) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 10) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 24)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0006245707686486292, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_units_2': 57, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.19131425130324722, 'num_dense_units_0': 275, 'cnn_learning_rate': 4.56119804456153e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 162}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:38:20.137419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.6936 - acc: 0.1013 - val_loss: 2.3468 - val_acc: 0.1169
Epoch 2/2
 - 4s - loss: 2.4166 - acc: 0.1140 - val_loss: 2.2609 - val_acc: 0.2338
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 24), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 24) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 24)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0006245707686486292, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_units_2': 57, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.19131425130324722, 'num_dense_units_0': 275, 'cnn_learning_rate': 4.56119804456153e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 162}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.7662337652661584, 'info': {'histories': {'val_loss': [2.346778237974489, 2.260913728119491], 'acc': [0.11510791642953166, 0.1294964052897563], 'loss': [2.858165358467925, 2.518481071904409], 'val_acc': [0.11688311688311688, 0.23376623473384164]}, 'runtime': 16.538629293441772}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 24)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 10)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 10) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 10) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 1) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 10) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 10)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00010298931767531302, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 42, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.17634795343568943, 'num_dense_units_0': 185, 'cnn_learning_rate': 0.00018069154183323057, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 135}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:38:40.206456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.3243 - acc: 0.1679 - val_loss: 2.2983 - val_acc: 0.1169
Epoch 2/2
 - 5s - loss: 2.3336 - acc: 0.1283 - val_loss: 2.3010 - val_acc: 0.1299
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 10), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 10) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 10) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 10) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 10)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00010298931767531302, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 42, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.17634795343568943, 'num_dense_units_0': 185, 'cnn_learning_rate': 0.00018069154183323057, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 135}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.8701298696460662, 'info': {'histories': {'val_loss': [2.2982900235560035, 2.300997306774189], 'acc': [0.15000000383172715, 0.128571432190282], 'loss': [2.323487251145499, 2.335417056083679], 'val_acc': [0.11688311736692082, 0.1298701303539338]}, 'runtime': 22.83069920539856}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 10)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 1)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 1) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 46) to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (1, 0, 1) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00022663911379993868, 'height_shift_range': 0.267, 'batch_size': 33, 'num_dense_units_2': 20, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.12954286764724737, 'num_dense_units_0': 100, 'cnn_learning_rate': 5.603198636079612e-05, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 166}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:38:58.045025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.4275 - acc: 0.0758 - val_loss: 2.3649 - val_acc: 0.1094
Epoch 2/2
 - 3s - loss: 2.4203 - acc: 0.1160 - val_loss: 2.3592 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 1)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00022663911379993868, 'height_shift_range': 0.267, 'batch_size': 33, 'num_dense_units_2': 20, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.12954286764724737, 'num_dense_units_0': 100, 'cnn_learning_rate': 5.603198636079612e-05, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 166}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.890625, 'info': {'histories': {'val_loss': [2.364923357963562, 2.359212875366211], 'acc': [0.07575757801532745, 0.11627907461898271], 'loss': [2.4275121688842773, 2.418009031650632], 'val_acc': [0.109375, 0.109375]}, 'runtime': 11.491313457489014}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 1)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 46)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 46) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 8) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 46) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 46)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00034250364632725075, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10187798747318884, 'num_dense_units_0': 102, 'cnn_learning_rate': 0.0006568568909618812, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 72}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 13:39:10.107263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 7s - loss: 2.2516 - acc: 0.1973 - val_loss: 2.2920 - val_acc: 0.1169
Epoch 2/4
 - 5s - loss: 2.0914 - acc: 0.2989 - val_loss: 2.0047 - val_acc: 0.3117
Epoch 3/4
 - 5s - loss: 1.8432 - acc: 0.3925 - val_loss: 1.9556 - val_acc: 0.2987
Epoch 4/4
 - 5s - loss: 1.6475 - acc: 0.5097 - val_loss: 1.8275 - val_acc: 0.3377
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 46), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 46) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 46)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00034250364632725075, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10187798747318884, 'num_dense_units_0': 102, 'cnn_learning_rate': 0.0006568568909618812, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 72}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.6623376604024466, 'info': {'histories': {'val_loss': [2.292031179774891, 2.004718780517578, 1.9555769616907293, 1.8275007303659019], 'acc': [0.19727891949670656, 0.2962963144812319, 0.39716314223218474, 0.4964539237478946], 'loss': [2.251645633152553, 2.0916860077116226, 1.8438804301809757, 1.6602610907656081], 'val_acc': [0.11688311736692082, 0.31168831788100204, 0.29870130141060075, 0.33766233959755343]}, 'runtime': 26.145548820495605}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 46)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 8)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 8) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 8) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 58) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 8) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 8)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0011252188834962845, 'height_shift_range': 0.267, 'batch_size': 34, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1513372263504593, 'num_dense_units_0': 731, 'cnn_learning_rate': 1.4293240239556127e-05, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 420}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 13:39:36.577420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.2975 - acc: 0.1986 - val_loss: 2.2431 - val_acc: 0.2500
Epoch 2/4
 - 5s - loss: 1.7854 - acc: 0.4779 - val_loss: 2.0344 - val_acc: 0.2500
Epoch 3/4
 - 5s - loss: 1.4435 - acc: 0.4980 - val_loss: 1.9916 - val_acc: 0.2031
Epoch 4/4
 - 4s - loss: 1.1810 - acc: 0.6304 - val_loss: 1.7171 - val_acc: 0.4375
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 8), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 8) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 8) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 8) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 8)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0011252188834962845, 'height_shift_range': 0.267, 'batch_size': 34, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1513372263504593, 'num_dense_units_0': 731, 'cnn_learning_rate': 1.4293240239556127e-05, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 420}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.5625, 'info': {'histories': {'val_loss': [2.243092894554138, 2.034407615661621, 1.9915847778320312, 1.7171049118041992], 'acc': [0.1875000018044375, 0.47794120013713837, 0.4921875302679837, 0.6406250232830644], 'loss': [2.3010592311620712, 1.7853838801383972, 1.4401903245598078, 1.162484634667635], 'val_acc': [0.25, 0.25, 0.203125, 0.4375]}, 'runtime': 24.49485421180725}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 8)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 58)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 58) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 58) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 56) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 58) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 58)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.008818134863514567, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.18385650793826339, 'num_dense_units_0': 298, 'cnn_learning_rate': 0.000380281961577311, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 346}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 13:40:02.390788: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.4169 - acc: 0.1228 - val_loss: 2.3602 - val_acc: 0.1562
Epoch 2/4
 - 4s - loss: 2.2978 - acc: 0.1081 - val_loss: 2.4048 - val_acc: 0.0938
Epoch 3/4
 - 4s - loss: 2.3403 - acc: 0.0878 - val_loss: 2.3471 - val_acc: 0.1562
Epoch 4/4
 - 4s - loss: 2.2969 - acc: 0.1154 - val_loss: 2.4193 - val_acc: 0.0625
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 58), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 58) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 58) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 58) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 58)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.008818134863514567, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.18385650793826339, 'num_dense_units_0': 298, 'cnn_learning_rate': 0.000380281961577311, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 346}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.9375, 'info': {'histories': {'val_loss': [2.360215902328491, 2.4048073291778564, 2.3470728397369385, 2.419311761856079], 'acc': [0.11382114278470598, 0.13008130723383368, 0.10569106065100287, 0.11538461968302727], 'loss': [2.4432262734669012, 2.31952074097424, 2.340858104752331, 2.2968620657920837], 'val_acc': [0.15625, 0.09375, 0.15625, 0.0625]}, 'runtime': 23.111138582229614}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 58)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 56)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 56) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 7) to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 56) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 56)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00027930706769058807, 'height_shift_range': 0.267, 'batch_size': 34, 'num_dense_units_2': 53, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.13434691564631, 'num_dense_units_0': 289, 'cnn_learning_rate': 3.8146762325181635e-05, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 335}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 13:40:28.713384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 7s - loss: 2.3259 - acc: 0.0855 - val_loss: 2.2760 - val_acc: 0.1250
Epoch 2/4
 - 5s - loss: 2.2863 - acc: 0.1449 - val_loss: 2.2656 - val_acc: 0.2188
Epoch 3/4
 - 5s - loss: 2.2584 - acc: 0.2132 - val_loss: 2.2258 - val_acc: 0.2500
Epoch 4/4
 - 5s - loss: 2.1882 - acc: 0.2471 - val_loss: 2.2089 - val_acc: 0.2656
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 56), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 56) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 56)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00027930706769058807, 'height_shift_range': 0.267, 'batch_size': 34, 'num_dense_units_2': 53, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.13434691564631, 'num_dense_units_0': 289, 'cnn_learning_rate': 3.8146762325181635e-05, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 335}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.734375, 'info': {'histories': {'val_loss': [2.275960087776184, 2.2656283378601074, 2.2258437871932983, 2.208927273750305], 'acc': [0.08593750232830644, 0.1406250045984052, 0.2132353000342846, 0.2421875074505806], 'loss': [2.3253341913223267, 2.2872246727347374, 2.25841224193573, 2.1910088770091534], 'val_acc': [0.125, 0.21875, 0.25, 0.265625]}, 'runtime': 32.752734422683716}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 56)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 7)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 7) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 41) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 7) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (0, 0, 7) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 7)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00045501478271130826, 'height_shift_range': 0.267, 'batch_size': 35, 'num_dense_units_2': 121, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.0058493838712906365, 'num_dense_units_0': 502, 'cnn_learning_rate': 0.00012099864328030101, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 97}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 13:40:56.985197: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.7245 - acc: 0.1554 - val_loss: 2.3586 - val_acc: 0.1250
Epoch 2/4
 - 5s - loss: 2.1214 - acc: 0.2715 - val_loss: 2.1131 - val_acc: 0.1875
Epoch 3/4
 - 5s - loss: 1.8408 - acc: 0.3429 - val_loss: 1.9867 - val_acc: 0.2812
Epoch 4/4
 - 5s - loss: 1.6035 - acc: 0.5172 - val_loss: 2.0607 - val_acc: 0.2188
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 7), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 7) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 7) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 7) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 7)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00045501478271130826, 'height_shift_range': 0.267, 'batch_size': 35, 'num_dense_units_2': 121, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.0058493838712906365, 'num_dense_units_0': 502, 'cnn_learning_rate': 0.00012099864328030101, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 97}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.78125, 'info': {'histories': {'val_loss': [2.3585782051086426, 2.1130926609039307, 1.9866695404052734, 2.0607309341430664], 'acc': [0.1496063020285659, 0.26771654235565756, 0.34285715222358704, 0.5039370268817962], 'loss': [2.7137796935134046, 2.13208225580651, 1.8407500982284546, 1.6165115298248651], 'val_acc': [0.125, 0.1875, 0.28125, 0.21875]}, 'runtime': 24.021619081497192}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 7)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 41)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 41) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 41) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 40) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 41)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025648462216023524, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 96, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.10035949091721118, 'num_dense_units_0': 498, 'cnn_learning_rate': 0.000134233839888681, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 100}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 13:41:21.109985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.4241 - acc: 0.1395 - val_loss: 1.9830 - val_acc: 0.3896
Epoch 2/4
 - 3s - loss: 1.8716 - acc: 0.3399 - val_loss: 1.8440 - val_acc: 0.3636
Epoch 3/4
 - 3s - loss: 1.4907 - acc: 0.5754 - val_loss: 1.6242 - val_acc: 0.5195
Epoch 4/4
 - 3s - loss: 1.3668 - acc: 0.5638 - val_loss: 1.5224 - val_acc: 0.5325
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 41), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 41) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 41)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025648462216023524, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 96, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.10035949091721118, 'num_dense_units_0': 498, 'cnn_learning_rate': 0.000134233839888681, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 100}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.4675324628879498, 'info': {'histories': {'val_loss': [1.983042525006579, 1.8440314732588732, 1.624155920821351, 1.5223855322057551], 'acc': [0.1347517798397135, 0.3475177490964849, 0.5744681104700616, 0.5673759123112293], 'loss': [2.4257217569554106, 1.867312213207813, 1.494157905274249, 1.3632498649840659], 'val_acc': [0.3896103934808211, 0.36363636460397153, 0.5194805241250372, 0.5324675371120502]}, 'runtime': 17.814372062683105}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 41)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 40)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 40) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 52) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 40) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 40)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00012882947262845318, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.06508243080896674, 'num_dense_units_0': 978, 'cnn_learning_rate': 0.00020753889586138015, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 286}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 13:41:43.512668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 8s - loss: 2.5727 - acc: 0.1728 - val_loss: 2.1574 - val_acc: 0.1651
Epoch 2/4
 - 6s - loss: 1.9509 - acc: 0.3272 - val_loss: 2.0523 - val_acc: 0.3486
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/4
 - 6s - loss: 1.9139 - acc: 0.3519 - val_loss: 1.9199 - val_acc: 0.3394
Epoch 4/4
 - 6s - loss: 1.6998 - acc: 0.4012 - val_loss: 1.9389 - val_acc: 0.3303
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 40), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 40) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 40)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00012882947262845318, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.06508243080896674, 'num_dense_units_0': 978, 'cnn_learning_rate': 0.00020753889586138015, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 286}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.669724766267549, 'info': {'histories': {'val_loss': [2.157370142980453, 2.052326429874525, 1.9199042014025767, 1.9389411517239492], 'acc': [0.17283951077196333, 0.32716050495704013, 0.3518518627517753, 0.40123457875516677], 'loss': [2.57269016901652, 1.9508568710751004, 1.91393154197269, 1.6998246908187866], 'val_acc': [0.16513761850672032, 0.3486238559451672, 0.3394495451122249, 0.330275233732451]}, 'runtime': 36.718510389328}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 40)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 52)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 52) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 52) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 31) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 52) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 52)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.005154958802759252, 'height_shift_range': 0.267, 'batch_size': 46, 'num_dense_units_2': 131, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.26518185033822805, 'num_dense_units_0': 516, 'cnn_learning_rate': 1.946527864526595e-05, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 52}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 13:42:20.547688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.6485 - acc: 0.1008 - val_loss: 2.8788 - val_acc: 0.1250
Epoch 2/4
 - 5s - loss: 2.7728 - acc: 0.1159 - val_loss: 2.2288 - val_acc: 0.0938
Epoch 3/4
 - 4s - loss: 2.3448 - acc: 0.0835 - val_loss: 2.1779 - val_acc: 0.0000e+00
Epoch 4/4
 - 4s - loss: 2.2698 - acc: 0.1366 - val_loss: 2.3350 - val_acc: 0.0625
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 52), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 52) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 52) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 52) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 52)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.005154958802759252, 'height_shift_range': 0.267, 'batch_size': 46, 'num_dense_units_2': 131, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.26518185033822805, 'num_dense_units_0': 516, 'cnn_learning_rate': 1.946527864526595e-05, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 52}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.9375, 'info': {'histories': {'val_loss': [2.8787803649902344, 2.228788137435913, 2.177931070327759, 2.3350467681884766], 'acc': [0.086206899409921, 0.1159420336286227, 0.09482758723456285, 0.15517241225160402], 'loss': [2.6950173419097374, 2.7728426456451416, 2.338225508558339, 2.2638236736429147], 'val_acc': [0.125, 0.09375, 0.0, 0.0625]}, 'runtime': 29.613184213638306}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 52)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 31)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 31) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 31) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 29) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 31) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 31)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0009487352712683983, 'height_shift_range': 0.267, 'batch_size': 57, 'num_dense_units_2': 20, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.1445711830449289, 'num_dense_units_0': 193, 'cnn_learning_rate': 0.0001935000181847217, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 214}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 13:42:50.500180: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.6084 - acc: 0.1140 - val_loss: 2.8813 - val_acc: 0.0938
Epoch 2/4
 - 4s - loss: 2.8323 - acc: 0.1239 - val_loss: 2.4337 - val_acc: 0.1250
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/4
 - 4s - loss: 2.5615 - acc: 0.1665 - val_loss: 2.4059 - val_acc: 0.0625
Epoch 4/4
 - 4s - loss: 2.3582 - acc: 0.0856 - val_loss: 2.3903 - val_acc: 0.0625
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 31), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 31) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 31) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 31) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 31)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0009487352712683983, 'height_shift_range': 0.267, 'batch_size': 57, 'num_dense_units_2': 20, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.1445711830449289, 'num_dense_units_0': 193, 'cnn_learning_rate': 0.0001935000181847217, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 214}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.9375, 'info': {'histories': {'val_loss': [2.881333351135254, 2.4337046146392822, 2.4059088230133057, 2.3902747631073], 'acc': [0.11403508856892586, 0.12380952430622919, 0.16190476225955144, 0.08571428720440183], 'loss': [2.608384370803833, 2.825815561839512, 2.573233699798584, 2.3583250658852712], 'val_acc': [0.09375, 0.125, 0.0625, 0.0625]}, 'runtime': 29.274505615234375}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 31)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 29)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 29) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 29) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 33) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 29) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 29)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00030912433098717856, 'height_shift_range': 0.267, 'batch_size': 41, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10463537736613007, 'num_dense_units_0': 296, 'cnn_learning_rate': 0.00029688826057106037, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 162}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 13:43:15.607468: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.3104 - acc: 0.1827 - val_loss: 2.2719 - val_acc: 0.0938
Epoch 2/4
 - 4s - loss: 2.1119 - acc: 0.2520 - val_loss: 2.2352 - val_acc: 0.1875
Epoch 3/4
 - 4s - loss: 1.8652 - acc: 0.4788 - val_loss: 2.1310 - val_acc: 0.1562
Epoch 4/4
 - 4s - loss: 1.6913 - acc: 0.5457 - val_loss: 2.1157 - val_acc: 0.0625
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 29), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 29) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 29) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 29) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 29)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00030912433098717856, 'height_shift_range': 0.267, 'batch_size': 41, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10463537736613007, 'num_dense_units_0': 296, 'cnn_learning_rate': 0.00029688826057106037, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 162}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.9375, 'info': {'histories': {'val_loss': [2.2719221115112305, 2.235231637954712, 2.1309876441955566, 2.115715503692627], 'acc': [0.18181818785253634, 0.2520325034856796, 0.47933885381241476, 0.545454530183934], 'loss': [2.311379208052454, 2.111873189608256, 1.8639121331459234, 1.6906224843884303], 'val_acc': [0.09375, 0.1875, 0.15625, 0.0625]}, 'runtime': 23.65092396736145}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 29)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 33)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 33) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 62) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 33) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 33)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018883732300841306, 'height_shift_range': 0.267, 'batch_size': 31, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.03631828087169122, 'num_dense_units_0': 238, 'cnn_learning_rate': 0.0002448877074276911, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 61}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 13:43:39.073193: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.9419 - acc: 0.1432 - val_loss: 3.0794 - val_acc: 0.1406
Epoch 2/4
 - 5s - loss: 2.6596 - acc: 0.1226 - val_loss: 2.3524 - val_acc: 0.0938
Epoch 3/4
 - 5s - loss: 2.3289 - acc: 0.1632 - val_loss: 2.1356 - val_acc: 0.2656
Epoch 4/4
 - 5s - loss: 1.9479 - acc: 0.3161 - val_loss: 2.0606 - val_acc: 0.2812
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 33), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 33) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 33)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018883732300841306, 'height_shift_range': 0.267, 'batch_size': 31, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.03631828087169122, 'num_dense_units_0': 238, 'cnn_learning_rate': 0.0002448877074276911, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 61}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.71875, 'info': {'histories': {'val_loss': [3.079354763031006, 2.3523783683776855, 2.135620951652527, 2.060644567012787], 'acc': [0.12213740207766759, 0.12258064150810241, 0.1450381647539503, 0.32061067860545095], 'loss': [3.109300928261444, 2.659626293182373, 2.352503157753981, 1.9658865382653157], 'val_acc': [0.140625, 0.09375, 0.265625, 0.28125]}, 'runtime': 24.631778478622437}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 33)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 62)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 62) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 32) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 62) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 62) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 62)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00026835738398635247, 'height_shift_range': 0.267, 'batch_size': 16, 'num_dense_units_2': 108, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.2020157313067293, 'num_dense_units_0': 372, 'cnn_learning_rate': 8.451343082591651e-05, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 149}, 'working_directory': '.', 'budget': 4.0}
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 13:44:08.250017: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 7s - loss: 2.4381 - acc: 0.1135 - val_loss: 2.3662 - val_acc: 0.1468
Epoch 2/4
 - 6s - loss: 2.1963 - acc: 0.2037 - val_loss: 2.1877 - val_acc: 0.2477
Epoch 3/4
 - 6s - loss: 2.0128 - acc: 0.3676 - val_loss: 2.0698 - val_acc: 0.3486
Epoch 4/4
 - 6s - loss: 1.7585 - acc: 0.4375 - val_loss: 1.9175 - val_acc: 0.3853
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 62), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 62) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 62) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 62) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 62)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00026835738398635247, 'height_shift_range': 0.267, 'batch_size': 16, 'num_dense_units_2': 108, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.2020157313067293, 'num_dense_units_0': 372, 'cnn_learning_rate': 8.451343082591651e-05, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 149}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.6146788958015792, 'info': {'histories': {'val_loss': [2.366221134815741, 2.187653443135253, 2.0698040701927396, 1.9175393504833957], 'acc': [0.1232876712328767, 0.1780821917808219, 0.3561643835616438, 0.4375], 'loss': [2.4238463885163606, 2.1893257768186802, 2.013501921745196, 1.758544421195984], 'val_acc': [0.14678899150922758, 0.2477064223601184, 0.348623857585662, 0.3853211041984208]}, 'runtime': 35.56738090515137}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 62)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 32)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 32) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 32) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 61) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 32) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 32)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00015696215844388002, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_units_2': 26, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.023079139071074204, 'num_dense_units_0': 340, 'cnn_learning_rate': 3.608531416092223e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 117}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 13:44:38.693859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.2495 - acc: 0.1577 - val_loss: 2.0188 - val_acc: 0.3670
Epoch 2/4
 - 3s - loss: 1.8913 - acc: 0.3969 - val_loss: 1.9149 - val_acc: 0.3394
Epoch 3/4
 - 3s - loss: 1.7267 - acc: 0.4902 - val_loss: 1.7035 - val_acc: 0.4771
Epoch 4/4
 - 3s - loss: 1.6491 - acc: 0.5075 - val_loss: 1.6148 - val_acc: 0.5413
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 32), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 32) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 32) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 32) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 32)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00015696215844388002, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_units_2': 26, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.023079139071074204, 'num_dense_units_0': 340, 'cnn_learning_rate': 3.608531416092223e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 117}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.4587155886746328, 'info': {'histories': {'val_loss': [2.018761676385862, 1.9149065542658534, 1.7034700048079185, 1.614818166155334], 'acc': [0.16551724286942646, 0.40000001644266064, 0.4901960955725776, 0.52554746222322], 'loss': [2.247866084657866, 1.8920558436163541, 1.7266542779074774, 1.6250767107427555], 'val_acc': [0.3669724784312992, 0.3394495431983143, 0.47706422209739685, 0.5412844113253672]}, 'runtime': 18.004282474517822}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 32)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 61)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 61) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 61) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 47) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 61) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 61)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009687922303122322, 'height_shift_range': 0.267, 'batch_size': 47, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.15514314407219834, 'num_dense_units_0': 217, 'cnn_learning_rate': 1.3453701264303557e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 403}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 13:45:02.764832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 7s - loss: 2.4146 - acc: 0.0515 - val_loss: 2.3119 - val_acc: 0.1250
Epoch 2/4
 - 5s - loss: 2.3061 - acc: 0.1277 - val_loss: 2.2228 - val_acc: 0.1250
Epoch 3/4
 - 5s - loss: 2.3013 - acc: 0.1903 - val_loss: 2.2345 - val_acc: 0.1562
Epoch 4/4
 - 4s - loss: 2.3159 - acc: 0.1106 - val_loss: 2.2475 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 61), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 61) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 61) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 61) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 61)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009687922303122322, 'height_shift_range': 0.267, 'batch_size': 47, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.15514314407219834, 'num_dense_units_0': 217, 'cnn_learning_rate': 1.3453701264303557e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 403}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.875, 'info': {'histories': {'val_loss': [2.3119454383850098, 2.222769021987915, 2.23447847366333, 2.2475433349609375], 'acc': [0.05217391182870969, 0.12765957166751227, 0.18260870018730993, 0.11304347631723985], 'loss': [2.4230653306712275, 2.306124687194824, 2.304334715138311, 2.3283210920250936], 'val_acc': [0.125, 0.125, 0.15625, 0.125]}, 'runtime': 32.16355609893799}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 61)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 47)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 47) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 24) to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 47) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 47)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0005618056923890776, 'height_shift_range': 0.267, 'batch_size': 48, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.12378679667693099, 'num_dense_units_0': 159, 'cnn_learning_rate': 0.00010299135666647601, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 53}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 13:45:29.642101: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.4322 - acc: 0.0888 - val_loss: 2.2197 - val_acc: 0.2188
Epoch 2/4
 - 4s - loss: 2.1619 - acc: 0.1853 - val_loss: 2.1840 - val_acc: 0.1250
Epoch 3/4
 - 4s - loss: 1.9559 - acc: 0.3611 - val_loss: 2.2867 - val_acc: 0.0938
Epoch 4/4
 - 4s - loss: 1.7588 - acc: 0.5061 - val_loss: 2.0719 - val_acc: 0.2188
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 47), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 47) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 47) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 47)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0005618056923890776, 'height_shift_range': 0.267, 'batch_size': 48, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.12378679667693099, 'num_dense_units_0': 159, 'cnn_learning_rate': 0.00010299135666647601, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 53}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.78125, 'info': {'histories': {'val_loss': [2.2197489738464355, 2.1839866638183594, 2.2866525650024414, 2.0718846321105957], 'acc': [0.10526316103182341, 0.15789473841064855, 0.3611111243565877, 0.5175438727203169], 'loss': [2.4440305609452095, 2.2029734285254228, 1.9558573563893635, 1.7370480800929822], 'val_acc': [0.21875, 0.125, 0.09375, 0.21875]}, 'runtime': 22.971367597579956}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 47)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 24)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 24) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 24) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 24)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0006245707686486292, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_units_2': 57, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.19131425130324722, 'num_dense_units_0': 275, 'cnn_learning_rate': 4.56119804456153e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 162}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 13:45:53.918008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 7s - loss: 2.5765 - acc: 0.0887 - val_loss: 2.3187 - val_acc: 0.0649
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/4
 - 4s - loss: 2.2929 - acc: 0.2146 - val_loss: 2.4456 - val_acc: 0.1429
Epoch 3/4
 - 4s - loss: 2.2736 - acc: 0.1429 - val_loss: 2.2434 - val_acc: 0.2338
Epoch 4/4
 - 4s - loss: 2.2244 - acc: 0.1267 - val_loss: 2.2844 - val_acc: 0.1429
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 24), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 24) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 24) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 24)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0006245707686486292, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_units_2': 57, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.19131425130324722, 'num_dense_units_0': 275, 'cnn_learning_rate': 4.56119804456153e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 162}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.8571428566590532, 'info': {'histories': {'val_loss': [2.318665362023688, 2.4455859010869805, 2.243371616710316, 2.284397081895308], 'acc': [0.10071942572006219, 0.10791367094079368, 0.14285714232495852, 0.143884893533566], 'loss': [2.525985091710262, 2.349847687234124, 2.2736284732818604, 2.2368434075828936], 'val_acc': [0.06493506590267281, 0.1428571433409468, 0.23376623473384164, 0.1428571433409468]}, 'runtime': 25.439762115478516}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 24)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 2)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 2) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 46) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (1, 0, 2) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004330265205617455, 'height_shift_range': 0.267, 'batch_size': 20, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.15941133930304655, 'num_dense_units_0': 129, 'cnn_learning_rate': 8.815248874546198e-05, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 60}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:46:18.830228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 11.9505 - acc: 0.0875 - val_loss: 11.4118 - val_acc: 0.1429
Epoch 2/2
 - 3s - loss: 13.4028 - acc: 0.1419 - val_loss: 9.2568 - val_acc: 0.1429
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 2)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004330265205617455, 'height_shift_range': 0.267, 'batch_size': 20, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.15941133930304655, 'num_dense_units_0': 129, 'cnn_learning_rate': 8.815248874546198e-05, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 60}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.8571428566590532, 'info': {'histories': {'val_loss': [11.411816658911768, 9.256759049056413], 'acc': [0.0875000013038516, 0.1774193574824641], 'loss': [11.950543403625488, 12.723974504778463], 'val_acc': [0.14285714556644488, 0.1428571433409468]}, 'runtime': 14.001439094543457}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 46)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 46) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 46) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 8) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 46)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00034250364632725075, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10187798747318884, 'num_dense_units_0': 102, 'cnn_learning_rate': 0.0006568568909618812, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 72}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 13:46:32.241548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 6s - loss: 2.3431 - acc: 0.1210 - val_loss: 2.2208 - val_acc: 0.1299
Epoch 2/8
 - 5s - loss: 2.0141 - acc: 0.3129 - val_loss: 2.0827 - val_acc: 0.3247
Epoch 3/8
 - 5s - loss: 1.8384 - acc: 0.4206 - val_loss: 1.9906 - val_acc: 0.3766
Epoch 4/8
 - 5s - loss: 1.5971 - acc: 0.5891 - val_loss: 1.9409 - val_acc: 0.3117
Epoch 5/8
 - 5s - loss: 1.5537 - acc: 0.5986 - val_loss: 1.8017 - val_acc: 0.3766
Epoch 6/8
 - 5s - loss: 1.3523 - acc: 0.6783 - val_loss: 1.7136 - val_acc: 0.4675
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 7/8
 - 5s - loss: 1.4001 - acc: 0.6054 - val_loss: 1.5853 - val_acc: 0.4675
Epoch 8/8
 - 5s - loss: 1.3480 - acc: 0.6735 - val_loss: 1.4947 - val_acc: 0.6104
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 46), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 46) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 46)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00034250364632725075, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10187798747318884, 'num_dense_units_0': 102, 'cnn_learning_rate': 0.0006568568909618812, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 72}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.3896103841917855, 'info': {'histories': {'val_loss': [2.2207907453759925, 2.082686052693949, 1.9906077756510152, 1.9409181762051273, 1.801653587972963, 1.7135742670529848, 1.585257835202403, 1.4946655932959023], 'acc': [0.12056737971749712, 0.3129251907978739, 0.4222222473886278, 0.5886525156650138, 0.5986394797052655, 0.6740741027726067, 0.6054422089031765, 0.6737589176664961], 'loss': [2.341391223542234, 2.014139345714024, 1.840109650293986, 1.597457398759558, 1.5536998340061732, 1.360417456097073, 1.4001231363841466, 1.3419867601800473], 'val_acc': [0.12987013083773774, 0.32467533086801503, 0.3766233812678944, 0.31168831439761374, 0.37662337933267864, 0.4675324737251579, 0.467532471402899, 0.6103896158082145]}, 'runtime': 44.315529108047485}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 46)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 8)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 8) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 56) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 8) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (0, 0, 8) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 8)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0011252188834962845, 'height_shift_range': 0.267, 'batch_size': 34, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1513372263504593, 'num_dense_units_0': 731, 'cnn_learning_rate': 1.4293240239556127e-05, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 420}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 13:47:16.623295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 6s - loss: 2.3191 - acc: 0.1487 - val_loss: 2.1299 - val_acc: 0.3750
Epoch 2/8
 - 4s - loss: 2.0009 - acc: 0.3714 - val_loss: 1.9625 - val_acc: 0.2969
Epoch 3/8
 - 4s - loss: 1.4924 - acc: 0.5662 - val_loss: 1.9354 - val_acc: 0.1719
Epoch 4/8
 - 4s - loss: 1.1581 - acc: 0.6264 - val_loss: 1.5765 - val_acc: 0.5156
Epoch 5/8
 - 4s - loss: 1.1733 - acc: 0.6563 - val_loss: 2.0793 - val_acc: 0.3438
Epoch 6/8
 - 4s - loss: 0.8910 - acc: 0.6934 - val_loss: 1.5177 - val_acc: 0.3750
Epoch 7/8
 - 4s - loss: 0.7414 - acc: 0.7177 - val_loss: 1.6776 - val_acc: 0.4375
Epoch 8/8
 - 4s - loss: 0.7336 - acc: 0.7574 - val_loss: 1.7245 - val_acc: 0.5312
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 8), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 8) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 8) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 8) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 8)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0011252188834962845, 'height_shift_range': 0.267, 'batch_size': 34, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1513372263504593, 'num_dense_units_0': 731, 'cnn_learning_rate': 1.4293240239556127e-05, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 420}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.46875, 'info': {'histories': {'val_loss': [2.1298635005950928, 1.962524175643921, 1.9354190826416016, 1.5765035152435303, 2.0792888402938843, 1.5177263021469116, 1.6776357293128967, 1.724535584449768], 'acc': [0.14843750308500603, 0.359375006519258, 0.5661764889955521, 0.6250000162981451, 0.6640625139698386, 0.6953125558793545, 0.7265625400468707, 0.7573529630899429], 'loss': [2.3162104412913322, 2.015974845737219, 1.4924469292163849, 1.158279787749052, 1.1373841585591435, 0.881286758929491, 0.7227471298538148, 0.7336452156305313], 'val_acc': [0.375, 0.296875, 0.171875, 0.515625, 0.34375, 0.375, 0.4375, 0.53125]}, 'runtime': 40.99303102493286}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 8)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 56)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 56) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 56) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 41) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 56)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00027930706769058807, 'height_shift_range': 0.267, 'batch_size': 34, 'num_dense_units_2': 53, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.13434691564631, 'num_dense_units_0': 289, 'cnn_learning_rate': 3.8146762325181635e-05, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 335}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 13:48:02.181413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 7s - loss: 2.3281 - acc: 0.0966 - val_loss: 2.3278 - val_acc: 0.0781
Epoch 2/8
 - 5s - loss: 2.2649 - acc: 0.1691 - val_loss: 2.2825 - val_acc: 0.1406
Epoch 3/8
 - 5s - loss: 2.2378 - acc: 0.1579 - val_loss: 2.2517 - val_acc: 0.2031
Epoch 4/8
 - 5s - loss: 2.1795 - acc: 0.2714 - val_loss: 2.2244 - val_acc: 0.1875
Epoch 5/8
 - 5s - loss: 2.1204 - acc: 0.3457 - val_loss: 2.1876 - val_acc: 0.1875
Epoch 6/8
 - 5s - loss: 2.0759 - acc: 0.3199 - val_loss: 2.1362 - val_acc: 0.2656
Epoch 7/8
 - 5s - loss: 2.0203 - acc: 0.3682 - val_loss: 2.0751 - val_acc: 0.3125
Epoch 8/8
 - 5s - loss: 1.9351 - acc: 0.4052 - val_loss: 1.9938 - val_acc: 0.2969
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 56), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 56) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 56) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 56)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00027930706769058807, 'height_shift_range': 0.267, 'batch_size': 34, 'num_dense_units_2': 53, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.13434691564631, 'num_dense_units_0': 289, 'cnn_learning_rate': 3.8146762325181635e-05, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 335}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.703125, 'info': {'histories': {'val_loss': [2.3278168439865112, 2.282459259033203, 2.251681685447693, 2.2244075536727905, 2.1876251697540283, 2.1361773014068604, 2.0750908851623535, 1.9937617182731628], 'acc': [0.09375000288127922, 0.16911765187978745, 0.15625000558793545, 0.27343751350417733, 0.34375000931322575, 0.32812500721774995, 0.37500002328306437, 0.4062500116415322], 'loss': [2.3324178643524647, 2.264869213104248, 2.2384387217462063, 2.1797143295407295, 2.1201804280281067, 2.070314910262823, 2.0156800262629986, 1.9330009762197733], 'val_acc': [0.078125, 0.140625, 0.203125, 0.1875, 0.1875, 0.265625, 0.3125, 0.296875]}, 'runtime': 51.092751264572144}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 56)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 41)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 41) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 41) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 40) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 41)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025648462216023524, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 96, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.10035949091721118, 'num_dense_units_0': 498, 'cnn_learning_rate': 0.000134233839888681, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 100}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 13:48:48.424597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 6s - loss: 2.4440 - acc: 0.1439 - val_loss: 2.0091 - val_acc: 0.3247
Epoch 2/8
 - 4s - loss: 1.9219 - acc: 0.3194 - val_loss: 1.8249 - val_acc: 0.4156
Epoch 3/8
 - 3s - loss: 1.5858 - acc: 0.5064 - val_loss: 1.8433 - val_acc: 0.3506
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/8
 - 3s - loss: 1.2772 - acc: 0.6871 - val_loss: 1.7905 - val_acc: 0.3636
Epoch 5/8
 - 3s - loss: 1.2824 - acc: 0.6577 - val_loss: 1.5064 - val_acc: 0.5584
Epoch 6/8
 - 3s - loss: 1.0637 - acc: 0.7211 - val_loss: 1.2969 - val_acc: 0.6364
Epoch 7/8
 - 3s - loss: 0.9870 - acc: 0.7829 - val_loss: 1.3589 - val_acc: 0.5844
Epoch 8/8
 - 3s - loss: 0.8198 - acc: 0.8219 - val_loss: 1.1506 - val_acc: 0.7013
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 41), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 41) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 41)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025648462216023524, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 96, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.10035949091721118, 'num_dense_units_0': 498, 'cnn_learning_rate': 0.000134233839888681, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 100}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.29870128631591797, 'info': {'histories': {'val_loss': [2.0090827879967628, 1.82490725795944, 1.843250180219675, 1.7904988511816247, 1.506398139061866, 1.2968592070913934, 1.3589322938547506, 1.1505566223875268], 'acc': [0.1418439768888849, 0.3262411524006661, 0.5177305220289433, 0.6870748570987156, 0.6518518812126584, 0.7210884690284729, 0.7872340970851005, 0.822695087879262], 'loss': [2.4347698891416507, 1.916568474566683, 1.5767101734242541, 1.2771732125963484, 1.2877089791827732, 1.0636894873210363, 0.9763272049579215, 0.8191501193858207], 'val_acc': [0.32467533009392874, 0.415584421777106, 0.35064935258456637, 0.36363636557157936, 0.5584415615379036, 0.6363636394599815, 0.5844155890601022, 0.701298713684082]}, 'runtime': 31.993879079818726}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 41)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 40)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 40) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 40) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 33) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 40)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00012882947262845318, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.06508243080896674, 'num_dense_units_0': 978, 'cnn_learning_rate': 0.00020753889586138015, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 286}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 13:49:25.953621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 8s - loss: 2.8351 - acc: 0.0926 - val_loss: 2.2528 - val_acc: 0.2110
Epoch 2/8
 - 6s - loss: 2.1297 - acc: 0.2222 - val_loss: 2.2739 - val_acc: 0.1743
Epoch 3/8
 - 6s - loss: 1.9317 - acc: 0.2593 - val_loss: 1.9381 - val_acc: 0.3670
Epoch 4/8
 - 6s - loss: 1.7874 - acc: 0.4012 - val_loss: 1.8852 - val_acc: 0.2661
Epoch 5/8
 - 6s - loss: 1.6403 - acc: 0.4383 - val_loss: 1.6965 - val_acc: 0.4771
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 6/8
 - 6s - loss: 1.6041 - acc: 0.4630 - val_loss: 1.6416 - val_acc: 0.4312
Epoch 7/8
 - 6s - loss: 1.3225 - acc: 0.5926 - val_loss: 1.3747 - val_acc: 0.5780
Epoch 8/8
 - 6s - loss: 1.2606 - acc: 0.6420 - val_loss: 1.2993 - val_acc: 0.5596
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 40), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 40) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 40)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00012882947262845318, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.06508243080896674, 'num_dense_units_0': 978, 'cnn_learning_rate': 0.00020753889586138015, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 286}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.4403669681024114, 'info': {'histories': {'val_loss': [2.2527667601174173, 2.273915360826965, 1.938076699545624, 1.8851662305516934, 1.696548554875435, 1.6415594411552499, 1.3746645188112872, 1.299322775744517], 'acc': [0.0925925945242246, 0.2222222255335914, 0.25925926864147186, 0.40123458041085136, 0.43827161027325523, 0.46296298545267844, 0.5925926036304898, 0.6419753233591715], 'loss': [2.8351289563708835, 2.1297376818127103, 1.9317223230997722, 1.787422736485799, 1.640309042400784, 1.6041049030092027, 1.3224774201711018, 1.2605616980128818], 'val_acc': [0.21100917499546612, 0.17431192694727435, 0.3669724784312992, 0.266055046691807, 0.47706422155056527, 0.43119266492511155, 0.5779816612191156, 0.5596330318975886]}, 'runtime': 59.222572326660156}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 40)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 33)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 33) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 62) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 33) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 33)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018883732300841306, 'height_shift_range': 0.267, 'batch_size': 31, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.03631828087169122, 'num_dense_units_0': 238, 'cnn_learning_rate': 0.0002448877074276911, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 61}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 13:50:20.416323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 6s - loss: 3.4132 - acc: 0.1049 - val_loss: 2.7631 - val_acc: 0.0938
Epoch 2/8
 - 5s - loss: 2.4853 - acc: 0.1806 - val_loss: 2.1339 - val_acc: 0.3281
Epoch 3/8
 - 4s - loss: 2.1996 - acc: 0.2726 - val_loss: 2.0175 - val_acc: 0.2812
Epoch 4/8
 - 4s - loss: 2.2788 - acc: 0.1201 - val_loss: 2.3004 - val_acc: 0.1094
Epoch 5/8
 - 4s - loss: 2.1413 - acc: 0.1913 - val_loss: 2.0782 - val_acc: 0.2188
Epoch 6/8
 - 5s - loss: 1.7387 - acc: 0.4000 - val_loss: 1.7738 - val_acc: 0.3125
Epoch 7/8
 - 5s - loss: 1.6497 - acc: 0.4710 - val_loss: 2.1803 - val_acc: 0.1875
Epoch 8/8
 - 4s - loss: 1.9331 - acc: 0.3809 - val_loss: 1.6562 - val_acc: 0.3750
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 33), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 33) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 33) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 33)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018883732300841306, 'height_shift_range': 0.267, 'batch_size': 31, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.03631828087169122, 'num_dense_units_0': 238, 'cnn_learning_rate': 0.0002448877074276911, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 61}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.625, 'info': {'histories': {'val_loss': [2.7630722522735596, 2.1338906288146973, 2.0175240635871887, 2.300429344177246, 2.0781878232955933, 1.773839294910431, 2.180329918861389, 1.6562069654464722], 'acc': [0.09923663883263828, 0.18064515590667723, 0.3129770899091968, 0.11214953076059574, 0.19847327709652995, 0.39999998807907106, 0.4709677278995514, 0.2897196228259078], 'loss': [3.5159781397753997, 2.4852506637573244, 2.157553026694378, 2.3483629872865768, 2.1516008340675414, 1.7386539936065675, 1.6496671676635741, 2.0197387722051032], 'val_acc': [0.09375, 0.328125, 0.28125, 0.109375, 0.21875, 0.3125, 0.1875, 0.375]}, 'runtime': 41.6979238986969}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 33)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 62)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 62) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 62) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 32) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 62) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 62)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00026835738398635247, 'height_shift_range': 0.267, 'batch_size': 16, 'num_dense_units_2': 108, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.2020157313067293, 'num_dense_units_0': 372, 'cnn_learning_rate': 8.451343082591651e-05, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 149}, 'working_directory': '.', 'budget': 8.0}
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 13:51:06.653551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 8s - loss: 2.4003 - acc: 0.1198 - val_loss: 2.2565 - val_acc: 0.1193
Epoch 2/8
 - 6s - loss: 2.1565 - acc: 0.1974 - val_loss: 2.1560 - val_acc: 0.3028
Epoch 3/8
 - 6s - loss: 1.9803 - acc: 0.3846 - val_loss: 2.0145 - val_acc: 0.2661
Epoch 4/8
 - 6s - loss: 2.0234 - acc: 0.3152 - val_loss: 2.2479 - val_acc: 0.1835
Epoch 5/8
 - 6s - loss: 1.6847 - acc: 0.4375 - val_loss: 1.7437 - val_acc: 0.4037
Epoch 6/8
 - 6s - loss: 1.6867 - acc: 0.4224 - val_loss: 1.9486 - val_acc: 0.2202
Epoch 7/8
 - 6s - loss: 1.5803 - acc: 0.5044 - val_loss: 1.7386 - val_acc: 0.4128
Epoch 8/8
 - 6s - loss: 1.6290 - acc: 0.4205 - val_loss: 1.5817 - val_acc: 0.3853
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 62), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 62) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 62) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 62) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 62)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00026835738398635247, 'height_shift_range': 0.267, 'batch_size': 16, 'num_dense_units_2': 108, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.2020157313067293, 'num_dense_units_0': 372, 'cnn_learning_rate': 8.451343082591651e-05, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 149}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.6146788977154898, 'info': {'histories': {'val_loss': [2.25651862424448, 2.1559875995740976, 2.014461854182252, 2.2479399453609363, 1.743692107156876, 1.9485642778764076, 1.7386311883226446, 1.5816686678370204], 'acc': [0.13013698630136986, 0.17123287671232876, 0.4178082191780822, 0.3424657534246575, 0.4375, 0.4589041095890411, 0.547945205479452, 0.5], 'loss': [2.416778136606086, 2.2012256628846467, 1.975925866871664, 1.8849177066593954, 1.6846629858016968, 1.6412287280984121, 1.5039834649595496, 1.5222276738195708], 'val_acc': [0.11926605572941107, 0.30275229549189225, 0.26605504778547023, 0.18348623887387985, 0.40366972613772123, 0.22018348815244274, 0.41284404107190054, 0.3853211022845102]}, 'runtime': 60.000508546829224}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 62)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 32)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 32) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 32) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 3) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 32) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 32)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00015696215844388002, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_units_2': 26, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.023079139071074204, 'num_dense_units_0': 340, 'cnn_learning_rate': 3.608531416092223e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 117}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 13:52:01.810746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 2.2246 - acc: 0.1550 - val_loss: 1.9884 - val_acc: 0.2385
Epoch 2/8
 - 3s - loss: 1.8950 - acc: 0.3640 - val_loss: 1.9053 - val_acc: 0.4404
Epoch 3/8
 - 3s - loss: 1.6459 - acc: 0.4993 - val_loss: 1.7720 - val_acc: 0.4312
Epoch 4/8
 - 3s - loss: 1.5298 - acc: 0.5295 - val_loss: 1.6506 - val_acc: 0.5046
Epoch 5/8
 - 3s - loss: 1.5023 - acc: 0.5490 - val_loss: 1.6375 - val_acc: 0.4495
Epoch 6/8
 - 3s - loss: 1.3536 - acc: 0.6859 - val_loss: 1.6005 - val_acc: 0.4771
Epoch 7/8
 - 3s - loss: 1.2420 - acc: 0.7083 - val_loss: 1.6058 - val_acc: 0.4679
Epoch 8/8
 - 3s - loss: 1.2458 - acc: 0.6551 - val_loss: 1.4385 - val_acc: 0.5872
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 32), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 32) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 32) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 32) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 32)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00015696215844388002, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_units_2': 26, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.023079139071074204, 'num_dense_units_0': 340, 'cnn_learning_rate': 3.608531416092223e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 117}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.41284403450992124, 'info': {'histories': {'val_loss': [1.9884343475376793, 1.9053462546899778, 1.7719734218142449, 1.6505605058932522, 1.637517751903709, 1.6005310673232471, 1.6057985211731096, 1.4384592060649066], 'acc': [0.15172414073142512, 0.3655172493951074, 0.49655174016952514, 0.5172414010968701, 0.549019628100925, 0.6758620884911767, 0.7103448448510006, 0.6423357877418072], 'loss': [2.2289124735470476, 1.8887441931099727, 1.6419719169879783, 1.5446575057917629, 1.502303229437934, 1.362313669303368, 1.247068294163408, 1.255125472145359], 'val_acc': [0.23853211200565372, 0.44036697630488547, 0.43119266383144833, 0.504587159791124, 0.449541288231491, 0.47706422401130744, 0.46788991208470193, 0.5871559654900788]}, 'runtime': 31.231019735336304}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 32)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 3)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 3) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 3) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 46) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 3) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 3)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00019417179692728372, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 27, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.17700506012298858, 'num_dense_units_0': 160, 'cnn_learning_rate': 0.00013759620360265356, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 66}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:52:34.540070: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.2614 - acc: 0.2237 - val_loss: 2.4653 - val_acc: 0.1429
Epoch 2/2
 - 4s - loss: 2.1844 - acc: 0.2335 - val_loss: 2.5228 - val_acc: 0.1039
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 3) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 3)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00019417179692728372, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 27, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.17700506012298858, 'num_dense_units_0': 160, 'cnn_learning_rate': 0.00013759620360265356, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 66}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.8961038961038961, 'info': {'histories': {'val_loss': [2.465338781282499, 2.5228067961606113], 'acc': [0.2214285752602986, 0.24285714754036494], 'loss': [2.25941664491381, 2.1615440368652346], 'val_acc': [0.1428571433409468, 0.1038961038961039]}, 'runtime': 14.031546831130981}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 3)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 46)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 46) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 46) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 41) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 46)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00034250364632725075, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10187798747318884, 'num_dense_units_0': 102, 'cnn_learning_rate': 0.0006568568909618812, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 72}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 13:52:48.099554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 6s - loss: 2.2481 - acc: 0.1837 - val_loss: 2.2149 - val_acc: 0.1558
Epoch 2/16
 - 5s - loss: 1.8910 - acc: 0.4598 - val_loss: 2.1215 - val_acc: 0.1948
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/16
 - 5s - loss: 1.7905 - acc: 0.4817 - val_loss: 1.9402 - val_acc: 0.3506
Epoch 4/16
 - 5s - loss: 1.4823 - acc: 0.6030 - val_loss: 1.8584 - val_acc: 0.3377
Epoch 5/16
 - 5s - loss: 1.5497 - acc: 0.5646 - val_loss: 1.7327 - val_acc: 0.4675
Epoch 6/16
 - 5s - loss: 1.2449 - acc: 0.7354 - val_loss: 1.6651 - val_acc: 0.3506
Epoch 7/16
 - 5s - loss: 1.2892 - acc: 0.6482 - val_loss: 1.5340 - val_acc: 0.5195
Epoch 8/16
 - 5s - loss: 1.2065 - acc: 0.6482 - val_loss: 1.5057 - val_acc: 0.4935
Epoch 9/16
 - 5s - loss: 1.1068 - acc: 0.7443 - val_loss: 1.3074 - val_acc: 0.6104
Epoch 10/16
 - 5s - loss: 1.0627 - acc: 0.7327 - val_loss: 1.2971 - val_acc: 0.6623
Epoch 11/16
 - 5s - loss: 0.8478 - acc: 0.8311 - val_loss: 1.2314 - val_acc: 0.6494
Epoch 12/16
 - 5s - loss: 0.9233 - acc: 0.7467 - val_loss: 1.2372 - val_acc: 0.6494
Epoch 13/16
 - 5s - loss: 0.8812 - acc: 0.7687 - val_loss: 1.1241 - val_acc: 0.6623
Epoch 14/16
 - 5s - loss: 0.7968 - acc: 0.8011 - val_loss: 1.0731 - val_acc: 0.7013
Epoch 15/16
 - 5s - loss: 0.8037 - acc: 0.8263 - val_loss: 1.0497 - val_acc: 0.7792
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 16/16
 - 5s - loss: 0.7004 - acc: 0.8448 - val_loss: 0.9831 - val_acc: 0.7273
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 46), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 46) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 46)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00034250364632725075, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10187798747318884, 'num_dense_units_0': 102, 'cnn_learning_rate': 0.0006568568909618812, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 72}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.272727260341892, 'info': {'histories': {'val_loss': [2.21489354232689, 2.1215258573556874, 1.9402297007573115, 1.8584496077004966, 1.732703829740549, 1.6651043148783895, 1.5339822862055394, 1.5056642696454927, 1.307448823730667, 1.2971032277330177, 1.231396990937072, 1.2371908441766517, 1.1240878476724996, 1.0730785897799902, 1.0497211542996494, 0.9830808933679159], 'acc': [0.1836734754698617, 0.45925928552945455, 0.4822695321859197, 0.5957447112874782, 0.564625872032983, 0.730496494059867, 0.652482307971792, 0.652482307971792, 0.7446808815002441, 0.7375886858777797, 0.8297872682835193, 0.7446809081321067, 0.7687075393540519, 0.8085106763433902, 0.829787294915382, 0.8439716912330465], 'loss': [2.2481097153254916, 1.8987613519032795, 1.793504775838649, 1.4914865138682913, 1.5497297389166695, 1.2515300055767626, 1.2823684900364978, 1.2057023251310308, 1.099026543028811, 1.0628777387294364, 0.8493137866892713, 0.9322180646531125, 0.8812284980501447, 0.7899202501520197, 0.7994279633177087, 0.7001893989583279], 'val_acc': [0.15584415855345787, 0.19480519751449685, 0.350649356842041, 0.33766234308094173, 0.4675324729510716, 0.3506493560679547, 0.5194805318659003, 0.4935064981510113, 0.6103896134859556, 0.6623376731748705, 0.6493506547692535, 0.6493506617360301, 0.6623376669821801, 0.7012987121359094, 0.7792207908320736, 0.727272739658108]}, 'runtime': 81.63079595565796}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 46)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 41)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 41) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 41) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 40) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 41)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025648462216023524, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 96, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.10035949091721118, 'num_dense_units_0': 498, 'cnn_learning_rate': 0.000134233839888681, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 100}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 13:54:09.180326: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 6s - loss: 2.3764 - acc: 0.1665 - val_loss: 1.8837 - val_acc: 0.3247
Epoch 2/16
 - 3s - loss: 1.7850 - acc: 0.4065 - val_loss: 1.6520 - val_acc: 0.5325
Epoch 3/16
 - 3s - loss: 1.5353 - acc: 0.5374 - val_loss: 1.4458 - val_acc: 0.6364
Epoch 4/16
 - 3s - loss: 1.3917 - acc: 0.6164 - val_loss: 1.3117 - val_acc: 0.7403
Epoch 5/16
 - 3s - loss: 1.1196 - acc: 0.6800 - val_loss: 1.1827 - val_acc: 0.6234
Epoch 6/16
 - 3s - loss: 1.0349 - acc: 0.7347 - val_loss: 1.0587 - val_acc: 0.7792
Epoch 7/16
 - 4s - loss: 1.0908 - acc: 0.6824 - val_loss: 0.9609 - val_acc: 0.7013
Epoch 8/16
 - 3s - loss: 0.8859 - acc: 0.7877 - val_loss: 0.8926 - val_acc: 0.7662
Epoch 9/16
 - 3s - loss: 0.7417 - acc: 0.8424 - val_loss: 0.9680 - val_acc: 0.7403
Epoch 10/16
 - 3s - loss: 0.7863 - acc: 0.8243 - val_loss: 0.8906 - val_acc: 0.7792
Epoch 11/16
 - 3s - loss: 0.7457 - acc: 0.8219 - val_loss: 1.0415 - val_acc: 0.6753
Epoch 12/16
 - 3s - loss: 0.5137 - acc: 0.9116 - val_loss: 0.9117 - val_acc: 0.6883
Epoch 13/16
 - 3s - loss: 0.6633 - acc: 0.8413 - val_loss: 0.7261 - val_acc: 0.7662
Epoch 14/16
 - 3s - loss: 0.6174 - acc: 0.8503 - val_loss: 0.6280 - val_acc: 0.8052
Epoch 15/16
 - 3s - loss: 0.5841 - acc: 0.8721 - val_loss: 0.6876 - val_acc: 0.7662
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 16/16
 - 3s - loss: 0.5050 - acc: 0.8950 - val_loss: 0.6766 - val_acc: 0.7662
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 41), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 41) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 41)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025648462216023524, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 96, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.10035949091721118, 'num_dense_units_0': 498, 'cnn_learning_rate': 0.000134233839888681, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 100}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.233766221380853, 'info': {'histories': {'val_loss': [1.8836557725807288, 1.6520485877990723, 1.4457524209827572, 1.3116971656873628, 1.1826675959995814, 1.0586813099972614, 0.9609169944540247, 0.8926368255119819, 0.9680365788472163, 0.8906103759617, 1.0415345585191405, 0.9117380380630493, 0.7261493399545744, 0.6279541795903986, 0.6875771884020273, 0.6766417212300486], 'acc': [0.17021277269467394, 0.40425533912283307, 0.5374149935586112, 0.6074074394173092, 0.6879432987659535, 0.7346939103943961, 0.6879433051068732, 0.7872340793305255, 0.8439716912330465, 0.822695087879262, 0.8226950967565496, 0.9115646822111947, 0.8444445040490892, 0.8503401960645404, 0.8723404749910882, 0.8936170605902977], 'loss': [2.3762139868228993, 1.7902806667571372, 1.535346371786935, 1.3999094009399413, 1.115711787913708, 1.0348740220069885, 1.082561159387548, 0.8818951781759871, 0.7376222902155937, 0.7891622173025253, 0.7440387822212057, 0.5137473004204887, 0.6601678993966844, 0.6174140061650958, 0.5888917890000851, 0.5081093482514645], 'val_acc': [0.32467533086801503, 0.532467536337964, 0.6363636394599815, 0.740259744904258, 0.6233766264729685, 0.7792207807689518, 0.7012987059432191, 0.7662337778450606, 0.7402597518710347, 0.77922079160616, 0.675324687710056, 0.688311700697069, 0.766233778619147, 0.8051948160320134, 0.7662337778450606, 0.766233778619147]}, 'runtime': 57.98553967475891}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 41)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 40)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 40) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 32) to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 40) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 40)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00012882947262845318, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.06508243080896674, 'num_dense_units_0': 978, 'cnn_learning_rate': 0.00020753889586138015, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 286}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 13:55:12.180890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/13
 - 8s - loss: 2.7071 - acc: 0.0864 - val_loss: 2.1776 - val_acc: 0.3119
Epoch 2/13
 - 6s - loss: 2.0987 - acc: 0.2901 - val_loss: 2.0225 - val_acc: 0.2202
Epoch 3/13
 - 6s - loss: 1.8054 - acc: 0.4753 - val_loss: 2.0485 - val_acc: 0.3486
Epoch 4/13
 - 6s - loss: 1.7690 - acc: 0.3889 - val_loss: 1.9467 - val_acc: 0.2569
Epoch 5/13
 - 6s - loss: 1.6502 - acc: 0.4259 - val_loss: 1.7137 - val_acc: 0.4587
Epoch 6/13
 - 6s - loss: 1.4359 - acc: 0.5988 - val_loss: 1.6711 - val_acc: 0.4220
Epoch 7/13
 - 6s - loss: 1.3146 - acc: 0.5741 - val_loss: 1.6093 - val_acc: 0.4128
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/13
 - 6s - loss: 1.2815 - acc: 0.6173 - val_loss: 1.4255 - val_acc: 0.4679
Epoch 9/13
 - 6s - loss: 1.1461 - acc: 0.6605 - val_loss: 1.2721 - val_acc: 0.5229
Epoch 10/13
 - 6s - loss: 1.2198 - acc: 0.5864 - val_loss: 1.4354 - val_acc: 0.4587
Epoch 11/13
 - 6s - loss: 0.9942 - acc: 0.7222 - val_loss: 1.1366 - val_acc: 0.5596
Epoch 12/13
 - 6s - loss: 1.0109 - acc: 0.6914 - val_loss: 1.3041 - val_acc: 0.5321
Epoch 13/13
 - 6s - loss: 0.8090 - acc: 0.7531 - val_loss: 1.0159 - val_acc: 0.6055
{'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00012882947262845318, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.06508243080896674, 'num_dense_units_0': 978, 'cnn_learning_rate': 0.00020753889586138015, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 286}

 ****** InceptionResNetV2 unfrozen 2 top blocks, cut_off after layer 744 ******
Epoch 1/3
 - 8s - loss: 0.7864 - acc: 0.8025 - val_loss: 0.9784 - val_acc: 0.6606
Epoch 2/3
 - 6s - loss: 0.7529 - acc: 0.8148 - val_loss: 1.0278 - val_acc: 0.6422
Epoch 3/3
 - 6s - loss: 0.6778 - acc: 0.8642 - val_loss: 1.1210 - val_acc: 0.5963
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 40), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 40) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 40) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 40)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00012882947262845318, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.06508243080896674, 'num_dense_units_0': 978, 'cnn_learning_rate': 0.00020753889586138015, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 286}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.4036697220364842, 'info': {'histories': {'val_loss': [2.177593137146136, 2.0224828195134434, 2.0484796839022854, 1.9466688075196852, 1.7136709274501976, 1.671067952016078, 1.6092537083757033, 1.4254520420634418, 1.2721392714649165, 1.4354459692578796, 1.1365942462868648, 1.3041106889007288, 1.0158706105083501, 0.9783551091447883, 1.0278443502723624, 1.1209585141698155], 'acc': [0.08641975373029709, 0.29012346267700195, 0.47530866000387406, 0.3888889021343655, 0.42592594027519226, 0.5987654593255785, 0.5740741027726067, 0.6172839734289381, 0.6604938407739004, 0.5864197744263543, 0.7222222354676988, 0.6913580397764841, 0.7530864278475443, 0.8024691475762261, 0.8148148390981886, 0.8641975455813937], 'loss': [2.7070887088775635, 2.0987210936016507, 1.8053739070892334, 1.7690109014511108, 1.6502232286665175, 1.4359136025110881, 1.3145748376846313, 1.2814525696966383, 1.1461025211546156, 1.2198438843091328, 0.9941860503620572, 1.010946856604682, 0.8089694380760193, 0.7863530913988749, 0.7528976930512322, 0.6777944895956252], 'val_acc': [0.3119266061881267, 0.22018348692207163, 0.3486238545780882, 0.25688073777277537, 0.4587156001580964, 0.4220183505377638, 0.4128440386111583, 0.46788991208470193, 0.522935783644335, 0.45871559824418584, 0.5596330308039253, 0.5321100955709405, 0.6055045893432898, 0.6605504625434175, 0.6422018375965434, 0.5963302779635158]}, 'runtime': 111.10200452804565}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 40)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 32)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 32) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 32) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 4) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 32) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 32)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00015696215844388002, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_units_2': 26, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.023079139071074204, 'num_dense_units_0': 340, 'cnn_learning_rate': 3.608531416092223e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 117}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 13:56:58.243404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 5s - loss: 2.3321 - acc: 0.1564 - val_loss: 2.2102 - val_acc: 0.1927
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/16
 - 3s - loss: 1.8774 - acc: 0.3456 - val_loss: 2.0693 - val_acc: 0.1927
Epoch 3/16
 - 3s - loss: 1.7072 - acc: 0.4454 - val_loss: 1.9951 - val_acc: 0.2844
Epoch 4/16
 - 3s - loss: 1.6830 - acc: 0.4468 - val_loss: 1.8643 - val_acc: 0.3211
Epoch 5/16
 - 3s - loss: 1.4854 - acc: 0.5768 - val_loss: 1.8240 - val_acc: 0.3303
Epoch 6/16
 - 3s - loss: 1.3547 - acc: 0.6229 - val_loss: 1.7765 - val_acc: 0.2936
Epoch 7/16
 - 3s - loss: 1.2415 - acc: 0.6536 - val_loss: 1.4313 - val_acc: 0.6055
Epoch 8/16
 - 3s - loss: 1.1568 - acc: 0.6793 - val_loss: 1.5337 - val_acc: 0.5229
Epoch 9/16
 - 3s - loss: 1.1132 - acc: 0.6899 - val_loss: 1.3887 - val_acc: 0.5321
Epoch 10/16
 - 3s - loss: 1.0453 - acc: 0.7595 - val_loss: 1.4135 - val_acc: 0.4954
Epoch 11/16
 - 3s - loss: 0.9719 - acc: 0.7516 - val_loss: 1.3166 - val_acc: 0.6239
Epoch 12/16
 - 3s - loss: 0.9449 - acc: 0.7974 - val_loss: 1.3200 - val_acc: 0.5963
Epoch 13/16
 - 3s - loss: 0.9554 - acc: 0.7901 - val_loss: 1.2604 - val_acc: 0.6514
Epoch 14/16
 - 3s - loss: 0.9317 - acc: 0.7908 - val_loss: 1.2813 - val_acc: 0.6055
Epoch 15/16
 - 3s - loss: 0.8144 - acc: 0.8305 - val_loss: 1.2206 - val_acc: 0.6422
Epoch 16/16
 - 3s - loss: 0.8179 - acc: 0.8345 - val_loss: 1.2041 - val_acc: 0.6422
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 32), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 32) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 32) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 32) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 32)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00015696215844388002, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_units_2': 26, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.023079139071074204, 'num_dense_units_0': 340, 'cnn_learning_rate': 3.608531416092223e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 117}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.3577981629502882, 'info': {'histories': {'val_loss': [2.2101552245813774, 2.069349030835913, 1.9951426173568865, 1.864257084120304, 1.8240333478385156, 1.776539197755516, 1.4312517927327286, 1.533683757169531, 1.388654076724971, 1.4134747041474789, 1.3166277507029542, 1.3199604651249877, 1.2603808707053508, 1.2813253304280272, 1.220600154421745, 1.2041360938220942], 'acc': [0.15862069201880488, 0.351724151085163, 0.434482774857817, 0.44137932267682306, 0.5724138150955068, 0.6206896777810722, 0.6535947952005599, 0.6689655406721707, 0.6965517422248577, 0.7586207040425005, 0.7448276051159562, 0.7973856329917908, 0.8029197271722947, 0.7908496922916837, 0.827586227860944, 0.8482758850886905], 'loss': [2.3416560929397057, 1.8782859580270175, 1.7309298128917299, 1.678590492544503, 1.4867447737989754, 1.3523563047935223, 1.2415449221928914, 1.163671459822819, 1.1128868982709688, 1.0547369948748884, 0.9858685838765111, 0.9448715978198581, 0.9340434757462384, 0.9316631423102485, 0.821879963628177, 0.7891752699325825], 'val_acc': [0.1926605518257946, 0.1926605511422551, 0.2844036700665404, 0.3211009218058455, 0.3302752326387878, 0.29357798356528675, 0.6055045915306161, 0.522935783644335, 0.5321100944772773, 0.49541284731768687, 0.6238532142901639, 0.5963302765964368, 0.6513761500699804, 0.6055045909837845, 0.6422018370497118, 0.6422018370497118]}, 'runtime': 55.44870448112488}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 32)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 4)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 4) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 46) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 4) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 4)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009393092704395744, 'height_shift_range': 0.267, 'batch_size': 27, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.09675880598775119, 'num_dense_units_0': 228, 'cnn_learning_rate': 0.000696176367713929, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 177}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 13:57:55.855172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 12.6626 - acc: 0.0988 - val_loss: 14.6070 - val_acc: 0.0938
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/2
 - 4s - loss: 14.5262 - acc: 0.0988 - val_loss: 14.3552 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 4)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009393092704395744, 'height_shift_range': 0.267, 'batch_size': 27, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.09675880598775119, 'num_dense_units_0': 228, 'cnn_learning_rate': 0.000696176367713929, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 177}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.890625, 'info': {'histories': {'val_loss': [14.607024192810059, 14.355178833007812], 'acc': [0.09876543407638867, 0.09876543283462524], 'loss': [12.662609100341797, 14.526184558868408], 'val_acc': [0.09375, 0.109375]}, 'runtime': 17.83154320716858}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 4)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 46)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 46) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 46) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 41) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 46)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00034250364632725075, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10187798747318884, 'num_dense_units_0': 102, 'cnn_learning_rate': 0.0006568568909618812, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 72}, 'working_directory': '.', 'budget': 32.0}
2018-02-08 13:58:12.191855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/26
 - 7s - loss: 2.4209 - acc: 0.1142 - val_loss: 2.2900 - val_acc: 0.1948
Epoch 2/26
 - 5s - loss: 2.0868 - acc: 0.2304 - val_loss: 2.1894 - val_acc: 0.2078
Epoch 3/26
 - 5s - loss: 1.9125 - acc: 0.3791 - val_loss: 2.0241 - val_acc: 0.3377
Epoch 4/26
 - 5s - loss: 1.6503 - acc: 0.5170 - val_loss: 1.9347 - val_acc: 0.3636
Epoch 5/26
 - 5s - loss: 1.4861 - acc: 0.6622 - val_loss: 1.8274 - val_acc: 0.3377
Epoch 6/26
 - 5s - loss: 1.4065 - acc: 0.6417 - val_loss: 1.7547 - val_acc: 0.4286
Epoch 7/26
 - 5s - loss: 1.3959 - acc: 0.5822 - val_loss: 1.6280 - val_acc: 0.4156
Epoch 8/26
 - 5s - loss: 1.2902 - acc: 0.6601 - val_loss: 1.5016 - val_acc: 0.6234
Epoch 9/26
 - 5s - loss: 1.1595 - acc: 0.7377 - val_loss: 1.4360 - val_acc: 0.6234
Epoch 10/26
 - 5s - loss: 1.0509 - acc: 0.7755 - val_loss: 1.3937 - val_acc: 0.6104
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 11/26
 - 5s - loss: 1.0185 - acc: 0.8026 - val_loss: 1.2166 - val_acc: 0.7273
Epoch 12/26
 - 5s - loss: 1.0151 - acc: 0.7535 - val_loss: 1.2021 - val_acc: 0.6494
Epoch 13/26
 - 5s - loss: 0.9057 - acc: 0.7755 - val_loss: 1.1937 - val_acc: 0.6494
Epoch 14/26
 - 5s - loss: 0.8870 - acc: 0.7556 - val_loss: 1.1028 - val_acc: 0.6623
Epoch 15/26
 - 5s - loss: 0.8938 - acc: 0.8379 - val_loss: 1.0542 - val_acc: 0.6753
Epoch 16/26
 - 5s - loss: 0.8736 - acc: 0.7853 - val_loss: 1.0273 - val_acc: 0.6883
Epoch 17/26
 - 5s - loss: 0.8889 - acc: 0.7716 - val_loss: 0.9925 - val_acc: 0.7013
Epoch 18/26
 - 5s - loss: 0.8134 - acc: 0.7990 - val_loss: 0.9040 - val_acc: 0.7792
Epoch 19/26
 - 5s - loss: 0.6876 - acc: 0.8472 - val_loss: 0.8965 - val_acc: 0.7662
Epoch 20/26
 - 5s - loss: 0.6252 - acc: 0.8707 - val_loss: 0.9061 - val_acc: 0.7273
Epoch 21/26
 - 5s - loss: 0.6748 - acc: 0.8195 - val_loss: 0.8587 - val_acc: 0.7922
Epoch 22/26
 - 5s - loss: 0.6190 - acc: 0.8437 - val_loss: 0.8396 - val_acc: 0.7532
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 23/26
 - 5s - loss: 0.6038 - acc: 0.8639 - val_loss: 0.8111 - val_acc: 0.8052
Epoch 24/26
 - 5s - loss: 0.5743 - acc: 0.8882 - val_loss: 0.8447 - val_acc: 0.7403
Epoch 25/26
 - 5s - loss: 0.5501 - acc: 0.8912 - val_loss: 0.8141 - val_acc: 0.7403
Epoch 26/26
 - 5s - loss: 0.5444 - acc: 0.9034 - val_loss: 0.8049 - val_acc: 0.7792
{'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00034250364632725075, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10187798747318884, 'num_dense_units_0': 102, 'cnn_learning_rate': 0.0006568568909618812, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 72}

 ****** Xception unfrozen 1 top blocks, cut_off after layer 125 ******
Epoch 1/6
 - 6s - loss: 0.4851 - acc: 0.8858 - val_loss: 0.7993 - val_acc: 0.7792
Epoch 2/6
 - 5s - loss: 0.5629 - acc: 0.8561 - val_loss: 0.7843 - val_acc: 0.8052
Epoch 3/6
 - 5s - loss: 0.4109 - acc: 0.9361 - val_loss: 0.7746 - val_acc: 0.7922
Epoch 4/6
 - 5s - loss: 0.4912 - acc: 0.9116 - val_loss: 0.7655 - val_acc: 0.7922
Epoch 5/6
 - 5s - loss: 0.4025 - acc: 0.9248 - val_loss: 0.7598 - val_acc: 0.7792
Epoch 6/6
 - 5s - loss: 0.4467 - acc: 0.9224 - val_loss: 0.7540 - val_acc: 0.7792
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 46), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 46) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 46)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00034250364632725075, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10187798747318884, 'num_dense_units_0': 102, 'cnn_learning_rate': 0.0006568568909618812, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 72}, 'working_directory': '.', 'budget': 32.0}
result: {'loss': 0.22077920839384002, 'info': {'histories': {'val_loss': [2.289982969110662, 2.1894138943065298, 2.0240529481466716, 1.9347308471605376, 1.8274007927287708, 1.754729345247343, 1.6280074862690714, 1.501603152844813, 1.4360487615907347, 1.3937480697384128, 1.2166457454879562, 1.2021468444304033, 1.1937001726844094, 1.1027650972465417, 1.0542222524618174, 1.027278726751154, 0.9925480198550534, 0.9039838012162741, 0.8964615704177262, 0.9061161527385959, 0.8586906752029022, 0.8395921177678294, 0.8110530190653615, 0.8447445739399303, 0.8140835204681793, 0.8048712820201726, 0.7993360293375982, 0.7842903818402972, 0.7745711904067498, 0.7655433756964547, 0.7598488361804516, 0.753967868817317], 'acc': [0.11347518100383434, 0.23404256080059296, 0.37588654537784294, 0.5170068272522518, 0.6595745150079119, 0.6382979091177595, 0.5815603130675376, 0.6524823054354242, 0.7304964851825795, 0.7755102600370135, 0.792592646016015, 0.751773106290939, 0.7755102515220642, 0.7588652955724838, 0.8368794841969267, 0.7872340793305255, 0.7730496918901484, 0.8014184845254776, 0.843971682355759, 0.8707483410835266, 0.8226950815383424, 0.8444445040490892, 0.8639456289155143, 0.8865248624314653, 0.89115652016231, 0.903703769048055, 0.8865248713087528, 0.8581560786734236, 0.936170258420579, 0.9115646736962455, 0.9219858646392822, 0.9219858798574894], 'loss': [2.4277515208467526, 2.085096653471602, 1.91411902549419, 1.6502882071903773, 1.4869483709335327, 1.4119682920740007, 1.401038555388755, 1.3010653688552531, 1.1667551309504407, 1.0509219765663147, 1.0253373437457614, 1.0184022784233093, 0.9057199614388602, 0.8839058939446794, 0.890341729559797, 0.8691985454965145, 0.8895209951603666, 0.7952322795035991, 0.6981294852622012, 0.6251727598054069, 0.6710685757880516, 0.6147698680559794, 0.6038306100027901, 0.5771255442436706, 0.5500900532518115, 0.544201378027598, 0.4793552940196179, 0.5597395560842879, 0.4110632018840059, 0.491192843232836, 0.40523553782321037, 0.4446253174162926], 'val_acc': [0.19480519674041055, 0.20779220972742354, 0.33766233766233766, 0.3636363690549677, 0.33766233959755343, 0.4285714312807306, 0.415584421777106, 0.6233766280211411, 0.6233766264729685, 0.6103896243231637, 0.7272727303690725, 0.6493506632842027, 0.6493506532210809, 0.6623376677562665, 0.6753246784210205, 0.6883116999229828, 0.701298713684082, 0.7792207792207793, 0.7662337778450606, 0.7272727388840217, 0.792207804593173, 0.753246765632134, 0.805194817580186, 0.740259752645121, 0.7402597433560855, 0.77922079160616, 0.77922079160616, 0.805194817580186, 0.7922078038190866, 0.7922077953041374, 0.7792207823171244, 0.77922079160616]}, 'runtime': 165.47086787223816}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 46)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 41)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 41) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 41) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 5) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 41)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025648462216023524, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 96, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.10035949091721118, 'num_dense_units_0': 498, 'cnn_learning_rate': 0.000134233839888681, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 100}, 'working_directory': '.', 'budget': 32.0}
2018-02-08 14:00:57.631272: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/22
 - 5s - loss: 2.2953 - acc: 0.1983 - val_loss: 2.0698 - val_acc: 0.1948
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/22
 - 3s - loss: 1.7472 - acc: 0.5170 - val_loss: 1.7599 - val_acc: 0.4026
Epoch 3/22
 - 3s - loss: 1.3352 - acc: 0.6322 - val_loss: 1.5862 - val_acc: 0.4805
Epoch 4/22
 - 3s - loss: 1.3466 - acc: 0.5659 - val_loss: 1.4263 - val_acc: 0.6104
Epoch 5/22
 - 3s - loss: 1.0901 - acc: 0.7261 - val_loss: 1.4343 - val_acc: 0.5065
Epoch 6/22
 - 3s - loss: 1.0208 - acc: 0.7632 - val_loss: 1.2229 - val_acc: 0.6753
Epoch 7/22
 - 3s - loss: 0.9694 - acc: 0.7143 - val_loss: 1.2462 - val_acc: 0.5974
Epoch 8/22
 - 3s - loss: 0.8642 - acc: 0.7782 - val_loss: 1.0568 - val_acc: 0.6623
Epoch 9/22
 - 3s - loss: 0.7587 - acc: 0.8130 - val_loss: 1.0688 - val_acc: 0.7403
Epoch 10/22
 - 3s - loss: 0.7027 - acc: 0.8287 - val_loss: 0.9713 - val_acc: 0.7403
Epoch 11/22
 - 3s - loss: 0.7046 - acc: 0.8243 - val_loss: 1.2051 - val_acc: 0.5714
Epoch 12/22
 - 3s - loss: 0.6032 - acc: 0.8707 - val_loss: 1.0317 - val_acc: 0.6753
Epoch 13/22
 - 3s - loss: 0.5609 - acc: 0.8759 - val_loss: 0.8515 - val_acc: 0.7792
Epoch 14/22
 - 3s - loss: 0.5418 - acc: 0.8912 - val_loss: 0.8809 - val_acc: 0.7532
Epoch 15/22
 - 3s - loss: 0.4293 - acc: 0.8897 - val_loss: 0.9653 - val_acc: 0.6883
Epoch 16/22
 - 3s - loss: 0.5876 - acc: 0.8776 - val_loss: 0.8769 - val_acc: 0.7403
Epoch 17/22
 - 3s - loss: 0.3391 - acc: 0.9384 - val_loss: 1.0004 - val_acc: 0.6753
Epoch 18/22
 - 3s - loss: 0.4123 - acc: 0.9156 - val_loss: 0.7202 - val_acc: 0.7922
Epoch 19/22
 - 3s - loss: 0.4275 - acc: 0.9048 - val_loss: 1.0064 - val_acc: 0.7403
Epoch 20/22
 - 3s - loss: 0.4435 - acc: 0.8653 - val_loss: 0.9473 - val_acc: 0.7662
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 21/22
 - 3s - loss: 0.2949 - acc: 0.9426 - val_loss: 0.7863 - val_acc: 0.8052
Epoch 22/22
 - 3s - loss: 0.2924 - acc: 0.9524 - val_loss: 0.7675 - val_acc: 0.7792
{'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025648462216023524, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 96, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.10035949091721118, 'num_dense_units_0': 498, 'cnn_learning_rate': 0.000134233839888681, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 100}

 ****** MobileNet unfrozen 2 top blocks, cut_off after layer 75 ******
Epoch 1/10
 - 4s - loss: 0.1955 - acc: 0.9726 - val_loss: 0.7940 - val_acc: 0.7662
Epoch 2/10
 - 3s - loss: 0.2552 - acc: 0.9795 - val_loss: 0.7303 - val_acc: 0.7792
Epoch 3/10
 - 3s - loss: 0.2259 - acc: 0.9592 - val_loss: 0.7666 - val_acc: 0.7792
Epoch 4/10
 - 3s - loss: 0.2113 - acc: 0.9658 - val_loss: 0.7330 - val_acc: 0.7792
Epoch 5/10
 - 3s - loss: 0.2512 - acc: 0.9632 - val_loss: 0.7762 - val_acc: 0.7403
Epoch 6/10
 - 3s - loss: 0.2012 - acc: 0.9864 - val_loss: 0.8133 - val_acc: 0.7662
Epoch 7/10
 - 3s - loss: 0.1727 - acc: 0.9932 - val_loss: 0.7195 - val_acc: 0.7662
Epoch 8/10
 - 3s - loss: 0.2256 - acc: 0.9863 - val_loss: 0.8435 - val_acc: 0.7532
Epoch 9/10
 - 3s - loss: 0.1907 - acc: 0.9703 - val_loss: 0.9423 - val_acc: 0.7143
Epoch 10/10
 - 3s - loss: 0.2152 - acc: 0.9771 - val_loss: 0.7919 - val_acc: 0.7143
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 41), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 41) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 41) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 41)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025648462216023524, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 96, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.10035949091721118, 'num_dense_units_0': 498, 'cnn_learning_rate': 0.000134233839888681, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 100}, 'working_directory': '.', 'budget': 32.0}
result: {'loss': 0.2857142826179405, 'info': {'histories': {'val_loss': [2.069795038792994, 1.759915286844427, 1.5862397466387068, 1.426335771362503, 1.4343232148653502, 1.222947071124981, 1.2462356833668498, 1.0567808755032428, 1.0688012466802226, 0.9712720675901934, 1.2050698701437417, 1.0317262240818568, 0.8514715851127327, 0.8809461082730975, 0.9653090548205685, 0.8768668267634008, 1.0004094870059521, 0.720184833972485, 1.0063519152727993, 0.9472724988863066, 0.7862658191036869, 0.7674718909449392, 0.7939538769907766, 0.7303342014164119, 0.7665602603516022, 0.7330062319706012, 0.776173726304785, 0.8132543865736429, 0.7195304434794885, 0.843491986200407, 0.9422962804893394, 0.7919173898634972], 'acc': [0.20567376768969475, 0.5170068229947772, 0.6382979027768398, 0.5744681193473491, 0.7234042870237473, 0.7629630088806152, 0.7142857440880367, 0.7872340907441809, 0.808510700438885, 0.8297872771608069, 0.822695087879262, 0.8707483410835266, 0.8740741411844889, 0.8911565286772591, 0.8888889392217, 0.8775510532515389, 0.9361702432023719, 0.9148936728213696, 0.9047619615282331, 0.8652482857095435, 0.9407407879829407, 0.9523809722491673, 0.9716312428738209, 0.9787234232780782, 0.9591837014470782, 0.9645390358377011, 0.9629629996087816, 0.9863945756639753, 0.9929078107184552, 0.9858156125596229, 0.9716312314601655, 0.9787234296189978], 'loss': [2.278481052276936, 1.747207726751055, 1.335827829989981, 1.3330568988272484, 1.0883424586438117, 1.0276533232794867, 0.9694074732916695, 0.8536087274551392, 0.7635899858271822, 0.6981297408012633, 0.7094398115543609, 0.6031769556658608, 0.5560294535424974, 0.5418323150702885, 0.4353112823433346, 0.5876299675021853, 0.34228842182362335, 0.4114511082781122, 0.4275200239249638, 0.4464244132346295, 0.29820859531561533, 0.292392441204616, 0.1979222652759958, 0.2589046539778405, 0.22585018404892512, 0.2122355762948381, 0.2463621199131012, 0.2011654930455344, 0.17167979367869965, 0.22921774694894223, 0.18894191688679635, 0.2135520504510149], 'val_acc': [0.19480519751449685, 0.4025974080160067, 0.4805194867121709, 0.6103896243231637, 0.5064935126861969, 0.6753246869359698, 0.5974026020471151, 0.6623376677562665, 0.7402597441301717, 0.740259752645121, 0.5714285760730892, 0.6753246784210205, 0.7792207908320736, 0.7532467547949259, 0.688311700697069, 0.7402597433560855, 0.6753246892582286, 0.7922078038190866, 0.7402597433560855, 0.7662337693301114, 0.8051948067429778, 0.77922079160616, 0.766233778619147, 0.7792207823171244, 0.77922079160616, 0.7792207908320736, 0.7402597433560855, 0.7662337778450606, 0.7662337770709744, 0.753246765632134, 0.7142857282192676, 0.7142857173820595]}, 'runtime': 106.3915765285492}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 41)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 5)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 5) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 0
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (0, 0, 46) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 5) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 5)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004643460230695631, 'height_shift_range': 0.267, 'batch_size': 32, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.19676559174213176, 'num_dense_units_0': 605, 'cnn_learning_rate': 7.398686596837017e-05, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 51}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:02:43.919266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 4s - loss: 2.4828 - acc: 0.0649 - val_loss: 2.3658 - val_acc: 0.0938
Epoch 2/2
 - 3s - loss: 2.3274 - acc: 0.0779 - val_loss: 2.3851 - val_acc: 0.0781
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 5), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 5) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 5) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 5)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004643460230695631, 'height_shift_range': 0.267, 'batch_size': 32, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.19676559174213176, 'num_dense_units_0': 605, 'cnn_learning_rate': 7.398686596837017e-05, 'cnn_unlock_epoch': 10, 'num_dense_units_1': 51}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.921875, 'info': {'histories': {'val_loss': [2.365845799446106, 2.385140895843506], 'acc': [0.07692307692307693, 0.09230769230769231], 'loss': [2.4303735696352446, 2.3258213996887207], 'val_acc': [0.09375, 0.078125]}, 'runtime': 10.744913339614868}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 5)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (0, 0, 46)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (0, 0, 46) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (0, 0, 46) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 6) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (0, 0, 46)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00034250364632725075, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10187798747318884, 'num_dense_units_0': 102, 'cnn_learning_rate': 0.0006568568909618812, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 72}, 'working_directory': '.', 'budget': 64.0}
2018-02-08 14:02:55.236547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/26
 - 6s - loss: 2.2724 - acc: 0.2123 - val_loss: 2.1691 - val_acc: 0.1429
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/26
 - 5s - loss: 1.8716 - acc: 0.4490 - val_loss: 2.0407 - val_acc: 0.1948
Epoch 3/26
 - 5s - loss: 1.7501 - acc: 0.4788 - val_loss: 1.8473 - val_acc: 0.5325
Epoch 4/26
 - 5s - loss: 1.6125 - acc: 0.5782 - val_loss: 1.8081 - val_acc: 0.4156
Epoch 5/26
 - 5s - loss: 1.5111 - acc: 0.5459 - val_loss: 1.7385 - val_acc: 0.3896
Epoch 6/26
 - 5s - loss: 1.2993 - acc: 0.6848 - val_loss: 1.5525 - val_acc: 0.4935
Epoch 7/26
 - 5s - loss: 1.2478 - acc: 0.6916 - val_loss: 1.4726 - val_acc: 0.4416
Epoch 8/26
 - 5s - loss: 1.1769 - acc: 0.7351 - val_loss: 1.3534 - val_acc: 0.5974
Epoch 9/26
 - 5s - loss: 1.1101 - acc: 0.7669 - val_loss: 1.2399 - val_acc: 0.6753
Epoch 10/26
 - 5s - loss: 1.0918 - acc: 0.6871 - val_loss: 1.1800 - val_acc: 0.6753
Epoch 11/26
 - 5s - loss: 0.9806 - acc: 0.7262 - val_loss: 1.0768 - val_acc: 0.7662
Epoch 12/26
 - 5s - loss: 1.0225 - acc: 0.7211 - val_loss: 1.0855 - val_acc: 0.6494
Epoch 13/26
 - 5s - loss: 0.9535 - acc: 0.7680 - val_loss: 1.0952 - val_acc: 0.6623
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 14/26
 - 5s - loss: 0.7989 - acc: 0.8163 - val_loss: 1.0055 - val_acc: 0.6494
Epoch 15/26
 - 5s - loss: 0.8393 - acc: 0.8069 - val_loss: 0.9051 - val_acc: 0.7922
Epoch 16/26
 - 5s - loss: 0.7311 - acc: 0.8639 - val_loss: 0.9332 - val_acc: 0.7273
Epoch 17/26
 - 5s - loss: 0.7577 - acc: 0.7850 - val_loss: 0.8355 - val_acc: 0.7792
Epoch 18/26
 - 5s - loss: 0.8307 - acc: 0.7788 - val_loss: 0.8391 - val_acc: 0.7662
Epoch 19/26
 - 5s - loss: 0.6624 - acc: 0.8299 - val_loss: 0.8098 - val_acc: 0.7403
Epoch 20/26
 - 5s - loss: 0.6034 - acc: 0.8745 - val_loss: 0.7909 - val_acc: 0.7662
Epoch 21/26
 - 5s - loss: 0.5899 - acc: 0.8690 - val_loss: 0.8076 - val_acc: 0.7532
Epoch 22/26
 - 5s - loss: 0.6984 - acc: 0.8082 - val_loss: 0.7377 - val_acc: 0.8312
Epoch 23/26
 - 5s - loss: 0.6220 - acc: 0.8435 - val_loss: 0.7711 - val_acc: 0.8442
Epoch 24/26
 - 5s - loss: 0.5474 - acc: 0.8585 - val_loss: 0.6927 - val_acc: 0.8312
Epoch 25/26
 - 5s - loss: 0.5149 - acc: 0.8701 - val_loss: 0.7039 - val_acc: 0.8052
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 26/26
 - 5s - loss: 0.6109 - acc: 0.8400 - val_loss: 0.7265 - val_acc: 0.7922
{'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00034250364632725075, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10187798747318884, 'num_dense_units_0': 102, 'cnn_learning_rate': 0.0006568568909618812, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 72}

 ****** Xception unfrozen 1 top blocks, cut_off after layer 125 ******
Epoch 1/38
 - 6s - loss: 0.5384 - acc: 0.8677 - val_loss: 0.7110 - val_acc: 0.8052
Epoch 2/38
 - 5s - loss: 0.4330 - acc: 0.9087 - val_loss: 0.6939 - val_acc: 0.8052
Epoch 3/38
 - 5s - loss: 0.4716 - acc: 0.9132 - val_loss: 0.6760 - val_acc: 0.8052
Epoch 4/38
 - 5s - loss: 0.5048 - acc: 0.9048 - val_loss: 0.6680 - val_acc: 0.8312
Epoch 5/38
 - 5s - loss: 0.4848 - acc: 0.8995 - val_loss: 0.6618 - val_acc: 0.8312
Epoch 6/38
 - 5s - loss: 0.5140 - acc: 0.8516 - val_loss: 0.6539 - val_acc: 0.8312
Epoch 7/38
 - 5s - loss: 0.4217 - acc: 0.9217 - val_loss: 0.6481 - val_acc: 0.8312
Epoch 8/38
 - 5s - loss: 0.4186 - acc: 0.9048 - val_loss: 0.6414 - val_acc: 0.8312
Epoch 9/38
 - 5s - loss: 0.3943 - acc: 0.9252 - val_loss: 0.6392 - val_acc: 0.8312
Epoch 10/38
 - 5s - loss: 0.4047 - acc: 0.9079 - val_loss: 0.6336 - val_acc: 0.8312
Epoch 11/38
 - 5s - loss: 0.4041 - acc: 0.9156 - val_loss: 0.6332 - val_acc: 0.8312
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 12/38
 - 5s - loss: 0.3756 - acc: 0.9320 - val_loss: 0.6341 - val_acc: 0.8312
Epoch 13/38
 - 5s - loss: 0.4138 - acc: 0.9011 - val_loss: 0.6324 - val_acc: 0.8312
Epoch 14/38
 - 5s - loss: 0.3981 - acc: 0.9156 - val_loss: 0.6264 - val_acc: 0.8312
Epoch 15/38
 - 5s - loss: 0.4012 - acc: 0.9184 - val_loss: 0.6233 - val_acc: 0.8312
Epoch 16/38
 - 5s - loss: 0.3827 - acc: 0.9040 - val_loss: 0.6202 - val_acc: 0.8182
Epoch 17/38
 - 5s - loss: 0.3869 - acc: 0.8971 - val_loss: 0.5602 - val_acc: 0.8571
Epoch 18/38
 - 5s - loss: 0.3910 - acc: 0.9063 - val_loss: 0.6219 - val_acc: 0.8182
Epoch 19/38
 - 5s - loss: 0.3992 - acc: 0.9132 - val_loss: 0.6196 - val_acc: 0.8182
Epoch 20/38
 - 5s - loss: 0.3654 - acc: 0.9320 - val_loss: 0.6199 - val_acc: 0.8182
Epoch 21/38
 - 5s - loss: 0.3675 - acc: 0.9316 - val_loss: 0.5165 - val_acc: 0.8701
Epoch 22/38
 - 5s - loss: 0.3713 - acc: 0.9132 - val_loss: 0.6194 - val_acc: 0.8182
Epoch 23/38
 - 5s - loss: 0.2923 - acc: 0.9726 - val_loss: 0.6173 - val_acc: 0.8182
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 24/38
 - 5s - loss: 0.3213 - acc: 0.9313 - val_loss: 0.6149 - val_acc: 0.8182
Epoch 25/38
 - 5s - loss: 0.3172 - acc: 0.9590 - val_loss: 0.6124 - val_acc: 0.8182
Epoch 26/38
 - 5s - loss: 0.3638 - acc: 0.9248 - val_loss: 0.6133 - val_acc: 0.8182
Epoch 27/38
 - 5s - loss: 0.3139 - acc: 0.9292 - val_loss: 0.6138 - val_acc: 0.8182
Epoch 28/38
 - 5s - loss: 0.2874 - acc: 0.9726 - val_loss: 0.6117 - val_acc: 0.8182
Epoch 29/38
 - 5s - loss: 0.3068 - acc: 0.9316 - val_loss: 0.6119 - val_acc: 0.8182
Epoch 30/38
 - 5s - loss: 0.3478 - acc: 0.9179 - val_loss: 0.6079 - val_acc: 0.8182
Epoch 31/38
 - 5s - loss: 0.3545 - acc: 0.9524 - val_loss: 0.6061 - val_acc: 0.8182
Epoch 32/38
 - 5s - loss: 0.3472 - acc: 0.9200 - val_loss: 0.6059 - val_acc: 0.8182
Epoch 33/38
 - 5s - loss: 0.2904 - acc: 0.9405 - val_loss: 0.6048 - val_acc: 0.8182
Epoch 34/38
 - 5s - loss: 0.2573 - acc: 0.9610 - val_loss: 0.6022 - val_acc: 0.8182
Epoch 35/38
 - 5s - loss: 0.3341 - acc: 0.9292 - val_loss: 0.6018 - val_acc: 0.8182
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 36/38
 - 5s - loss: 0.2808 - acc: 0.9863 - val_loss: 0.6010 - val_acc: 0.8182
Epoch 37/38
 - 5s - loss: 0.2420 - acc: 0.9796 - val_loss: 0.6016 - val_acc: 0.8182
Epoch 38/38
 - 5s - loss: 0.3129 - acc: 0.9497 - val_loss: 0.6063 - val_acc: 0.8182
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (0, 0, 46), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (0, 0, 46) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (0, 0, 46) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (0, 0, 46)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00034250364632725075, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.10187798747318884, 'num_dense_units_0': 102, 'cnn_learning_rate': 0.0006568568909618812, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 72}, 'working_directory': '.', 'budget': 64.0}
result: {'loss': 0.1818181787218366, 'info': {'histories': {'val_loss': [2.169084966956795, 2.040697614867966, 1.8473209158166664, 1.8081465417688543, 1.7384868612537137, 1.5524863345282418, 1.4725642095912586, 1.3533614533288139, 1.2398733906931692, 1.1799607679441377, 1.0768078147590934, 1.0855133378660524, 1.0951536259093841, 1.005505441071151, 0.9050893032705629, 0.9331950034414019, 0.8355069764248737, 0.8391181555661288, 0.8098169348456643, 0.7909259409099431, 0.8076099056702155, 0.7377311115141039, 0.7711223038760099, 0.6926628335729822, 0.7038738526307143, 0.7264983390832876, 0.7109955944024123, 0.6939491281261692, 0.6760312125280306, 0.6679841218056617, 0.6617605345589774, 0.6539338378163128, 0.6481092471581, 0.6413917433131825, 0.6391901544162205, 0.6335512887347828, 0.633217142773913, 0.6340893011588555, 0.6324217195634718, 0.6263797685697481, 0.6232656472689145, 0.6202092387459495, 0.5602206069153625, 0.6218999856478208, 0.6196327395253367, 0.6199250670222493, 0.5164656050793537, 0.6194304181383802, 0.6172822605479847, 0.6149093377125727, 0.6123832897706465, 0.6133465302454961, 0.6138226126695608, 0.6116629219674444, 0.6118940610390204, 0.6078836352794201, 0.6060720318323606, 0.6059499197192006, 0.6047650815604569, 0.6021763132764147, 0.6017793571794188, 0.6010241794895816, 0.6016172847964547, 0.606335212657978], 'acc': [0.212765966799665, 0.44897961616516113, 0.45925928677121797, 0.5782313176563808, 0.5390071260168198, 0.6879432987659535, 0.6950354969247858, 0.7375886833414118, 0.7730497033038037, 0.6870748570987156, 0.7333333743943109, 0.7210884605135236, 0.7629629996087816, 0.8163265756198338, 0.807407459947798, 0.8639456374304635, 0.7943262774893578, 0.7730496830128609, 0.8299320340156555, 0.8723404838683757, 0.8666667249467638, 0.808510700438885, 0.8435374753815787, 0.8581560786734236, 0.8652482882459113, 0.8439716760148394, 0.8652482857095435, 0.9078014835398248, 0.9148936728213696, 0.9047619615282331, 0.9007092765037049, 0.8510638982691663, 0.9259259621302287, 0.9047619700431824, 0.9251701235771179, 0.9111111481984456, 0.9148936816986571, 0.9319728357451302, 0.9037037412325541, 0.914893663944082, 0.9183673943792071, 0.9078014746625372, 0.9007092765037049, 0.9078014657852498, 0.9148936816986571, 0.931972827230181, 0.9290780627981146, 0.9148936816986571, 0.9716312339965333, 0.936170258420579, 0.9574468465561562, 0.9219858557619947, 0.9290780691390342, 0.9716312428738209, 0.929078053920827, 0.9148936664804499, 0.9523809892790658, 0.9219858709802019, 0.9432624654566988, 0.9645390421786206, 0.9290780602617467, 0.9858156214369104, 0.979591863495963, 0.9503546547382435], 'loss': [2.2725780060950744, 1.8715543406350272, 1.7667505635155571, 1.6124747480664934, 1.5184721693079521, 1.2972201692297103, 1.2487858838223396, 1.177987255948655, 1.1046592720011448, 1.0917796066829137, 0.9774965577655368, 1.0225350090435572, 0.9651059362623426, 0.7988923617771694, 0.8365690098868476, 0.7311455522264753, 0.7475432499926141, 0.8362107188143628, 0.6623854892594474, 0.6043029237300792, 0.5907520088884566, 0.7005945862607753, 0.6220141564096723, 0.5465436463660382, 0.518562061989561, 0.6019172528956799, 0.5393255739770038, 0.4357922704930001, 0.471914327525078, 0.5048073743070874, 0.4866527597954933, 0.5169494944684049, 0.4209713492128584, 0.41858873622758047, 0.3943027896540506, 0.4041002786821789, 0.40513689086792315, 0.37558235015187946, 0.4120796024799347, 0.3991754765206195, 0.40124304805483135, 0.37884577221058785, 0.3811881786331217, 0.38730100748386787, 0.3990478978512135, 0.3654190344469888, 0.3682381586825594, 0.366911362460319, 0.293339507376894, 0.3161048020454163, 0.3196995660979697, 0.36741760119478756, 0.31310572459342634, 0.29122900645783606, 0.31048820564087404, 0.35110804406886403, 0.35451644233294893, 0.34762655198574066, 0.28727680191080623, 0.25101096642778276, 0.3370533915276223, 0.28141541493699906, 0.24197092013699667, 0.3133079926384256], 'val_acc': [0.1428571433409468, 0.19480519751449685, 0.5324675464010858, 0.415584421777106, 0.38961039154560534, 0.49350649544170927, 0.4415584462029593, 0.5974026097879781, 0.6753246799691931, 0.675324687710056, 0.766233778619147, 0.6493506617360301, 0.6623376747230431, 0.6493506532210809, 0.7922078038190866, 0.7272727412062806, 0.7792207830912107, 0.7662337701041977, 0.7402597433560855, 0.7662337693301114, 0.753246765632134, 0.8311688427801256, 0.8441558565412249, 0.8311688420060394, 0.805194817580186, 0.7922078038190866, 0.805194817580186, 0.805194817580186, 0.8051948168060996, 0.8311688420060394, 0.8311688420060394, 0.831168843554212, 0.8311688311688312, 0.8311688311688312, 0.8311688427801256, 0.8311688420060394, 0.8311688420060394, 0.831168843554212, 0.8311688420060394, 0.831168843554212, 0.8311688327170038, 0.818181830567199, 0.8571428679800653, 0.8181818212781634, 0.8181818212781634, 0.8181818212781634, 0.8701298825152508, 0.8181818212781634, 0.8181818290190264, 0.818181830567199, 0.8181818297931126, 0.8181818197299908, 0.8181818181818182, 0.8181818197299908, 0.8181818212781634, 0.8181818181818182, 0.8181818297931126, 0.818181830567199, 0.8181818297931126, 0.8181818290190264, 0.8181818197299908, 0.8181818297931126, 0.8181818290190264, 0.8181818212781634]}, 'runtime': 325.2903435230255}}
exception: None

DEBUG:hpbandster:job_callback for (0, 0, 46)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 6)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 6) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 6) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 7) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 6) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 6)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.001773626189860167, 'height_shift_range': 0.267, 'batch_size': 59, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.274538304860914, 'num_dense_units_0': 859, 'cnn_learning_rate': 0.00012374211887936152, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 437}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:08:21.631191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 4.0945 - acc: 0.0877 - val_loss: 5.0501 - val_acc: 0.1250
Epoch 2/2
 - 4s - loss: 5.4601 - acc: 0.0932 - val_loss: 5.7602 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 6), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 6) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 6) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 6) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 6)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.001773626189860167, 'height_shift_range': 0.267, 'batch_size': 59, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.274538304860914, 'num_dense_units_0': 859, 'cnn_learning_rate': 0.00012374211887936152, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 437}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [5.05014181137085, 5.760192394256592], 'acc': [0.08737864309144251, 0.09322033822536469], 'loss': [3.931723701143728, 5.460136413574219], 'val_acc': [0.125, 0.09375]}, 'runtime': 19.869052171707153}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 6)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 7)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 7) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 7) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 8) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 7) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 7)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0017329097481894185, 'height_shift_range': 0.267, 'batch_size': 34, 'num_dense_units_2': 10, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.1472227313466878, 'num_dense_units_0': 185, 'cnn_learning_rate': 8.589919011604674e-05, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 74}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:08:40.583977: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.4301 - acc: 0.1765 - val_loss: 2.5944 - val_acc: 0.1250
Epoch 2/2
 - 3s - loss: 2.2560 - acc: 0.2349 - val_loss: 2.6637 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 7), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 7) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 7) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 7) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 7)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0017329097481894185, 'height_shift_range': 0.267, 'batch_size': 34, 'num_dense_units_2': 10, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.1472227313466878, 'num_dense_units_0': 185, 'cnn_learning_rate': 8.589919011604674e-05, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 74}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.5944180488586426, 2.6637412309646606], 'acc': [0.17647059122100472, 0.2333333450059096], 'loss': [2.430119216442108, 2.25035054286321], 'val_acc': [0.125, 0.09375]}, 'runtime': 13.332562923431396}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 7)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 8)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 8) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 8) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 9) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 8) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 8)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0012314290901912065, 'height_shift_range': 0.267, 'batch_size': 33, 'num_dense_units_2': 52, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.04121203951670231, 'num_dense_units_0': 240, 'cnn_learning_rate': 2.8599208739398645e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 75}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:08:54.983755: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.3007 - acc: 0.1072 - val_loss: 2.2912 - val_acc: 0.0938
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/2
 - 4s - loss: 2.3420 - acc: 0.1008 - val_loss: 2.2921 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 8), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 8) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 8) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 8) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 8)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0012314290901912065, 'height_shift_range': 0.267, 'batch_size': 33, 'num_dense_units_2': 52, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.04121203951670231, 'num_dense_units_0': 240, 'cnn_learning_rate': 2.8599208739398645e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 75}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.875, 'info': {'histories': {'val_loss': [2.291155695915222, 2.2920628786087036], 'acc': [0.10852713519057562, 0.10077519818793895], 'loss': [2.300543480141218, 2.342182985571928], 'val_acc': [0.09375, 0.125]}, 'runtime': 16.321570873260498}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 8)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 9)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 9) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 9) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 10) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 9) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 9)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0019337188863329277, 'height_shift_range': 0.267, 'batch_size': 44, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.2918873883857261, 'num_dense_units_0': 755, 'cnn_learning_rate': 3.827147124883705e-05, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 262}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:09:10.776931: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 4.3854 - acc: 0.0758 - val_loss: 3.5744 - val_acc: 0.0938
Epoch 2/2
 - 3s - loss: 2.6637 - acc: 0.2446 - val_loss: 3.0772 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 9), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 9) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 9) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 9) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 9)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0019337188863329277, 'height_shift_range': 0.267, 'batch_size': 44, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.2918873883857261, 'num_dense_units_0': 755, 'cnn_learning_rate': 3.827147124883705e-05, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 262}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.875, 'info': {'histories': {'val_loss': [3.574415683746338, 3.0771560668945312], 'acc': [0.07575757553180058, 0.2542373020265062], 'loss': [4.3853687445322675, 2.6299358020394537], 'val_acc': [0.09375, 0.125]}, 'runtime': 13.694407224655151}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 9)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 10)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 10) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 10) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 11) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 10)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0012023267914356257, 'height_shift_range': 0.267, 'batch_size': 35, 'num_dense_units_2': 12, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.11139828994742725, 'num_dense_units_0': 166, 'cnn_learning_rate': 0.00023557216832869766, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 193}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:09:23.825737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.4680 - acc: 0.0864 - val_loss: 2.3001 - val_acc: 0.0781
Epoch 2/2
 - 5s - loss: 2.3169 - acc: 0.1000 - val_loss: 2.3022 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 10), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 10) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 10) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 10)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0012023267914356257, 'height_shift_range': 0.267, 'batch_size': 35, 'num_dense_units_2': 12, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.11139828994742725, 'num_dense_units_0': 166, 'cnn_learning_rate': 0.00023557216832869766, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 193}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.890625, 'info': {'histories': {'val_loss': [2.300059676170349, 2.3021575212478638], 'acc': [0.07874015919629514, 0.10000000149011612], 'loss': [2.4248563511165107, 2.3169462084770203], 'val_acc': [0.078125, 0.109375]}, 'runtime': 16.1457040309906}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 10)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 11)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 11) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 11) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 12) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 11) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 11)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00016129613316653364, 'height_shift_range': 0.267, 'batch_size': 54, 'num_dense_units_2': 145, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.23354000302710443, 'num_dense_units_0': 193, 'cnn_learning_rate': 0.000191781242617201, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 65}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:09:40.033930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.3363 - acc: 0.1173 - val_loss: 2.2496 - val_acc: 0.1250
Epoch 2/2
 - 5s - loss: 2.1278 - acc: 0.2840 - val_loss: 2.2062 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 11), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 11) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 11) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 11) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 11)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00016129613316653364, 'height_shift_range': 0.267, 'batch_size': 54, 'num_dense_units_2': 145, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.23354000302710443, 'num_dense_units_0': 193, 'cnn_learning_rate': 0.000191781242617201, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 65}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.84375, 'info': {'histories': {'val_loss': [2.2495737075805664, 2.2062082290649414], 'acc': [0.1172839527328809, 0.2839506268501282], 'loss': [2.336304028828939, 2.1277901331583657], 'val_acc': [0.125, 0.15625]}, 'runtime': 19.187632083892822}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 11)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 12)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 12) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 12) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 13) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 12) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 12)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.001375852644601434, 'height_shift_range': 0.267, 'batch_size': 41, 'num_dense_units_2': 30, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.21569214652187058, 'num_dense_units_0': 478, 'cnn_learning_rate': 2.2338400249519212e-05, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 124}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:09:59.687028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 3.1325 - acc: 0.0992 - val_loss: 2.6826 - val_acc: 0.1250
Epoch 2/2
 - 4s - loss: 2.6912 - acc: 0.1301 - val_loss: 2.3348 - val_acc: 0.1875
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 12), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 12) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 12) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 12) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 12)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.001375852644601434, 'height_shift_range': 0.267, 'batch_size': 41, 'num_dense_units_2': 30, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.21569214652187058, 'num_dense_units_0': 478, 'cnn_learning_rate': 2.2338400249519212e-05, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 124}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.8125, 'info': {'histories': {'val_loss': [2.6826486587524414, 2.334825038909912], 'acc': [0.09917355168703174, 0.1300812934835752], 'loss': [3.13394991031363, 2.6912487347920737], 'val_acc': [0.125, 0.1875]}, 'runtime': 18.019859313964844}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 12)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 13)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 13) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 13) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 14) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 13) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 13)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0003018497801749079, 'height_shift_range': 0.267, 'batch_size': 26, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.14391620082304496, 'num_dense_units_0': 649, 'cnn_learning_rate': 0.00012108085836350304, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 391}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:10:22.250095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.4761 - acc: 0.1296 - val_loss: 2.2468 - val_acc: 0.1875
Epoch 2/2
 - 5s - loss: 2.2160 - acc: 0.2436 - val_loss: 2.1629 - val_acc: 0.2344
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 13), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 13) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 13) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 13) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 13)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0003018497801749079, 'height_shift_range': 0.267, 'batch_size': 26, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.14391620082304496, 'num_dense_units_0': 649, 'cnn_learning_rate': 0.00012108085836350304, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 391}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.765625, 'info': {'histories': {'val_loss': [2.246809959411621, 2.16292142868042], 'acc': [0.1250000088749563, 0.24358976197739443], 'loss': [2.483904200441697, 2.215984503428141], 'val_acc': [0.1875, 0.234375]}, 'runtime': 23.564865589141846}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 13)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 14)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 14) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 14) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 15) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 14) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 14)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0009522697489374414, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.22282762238898463, 'num_dense_units_0': 393, 'cnn_learning_rate': 0.0003409059968597692, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 330}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:10:42.070208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.4074 - acc: 0.1046 - val_loss: 2.3132 - val_acc: 0.2018
Epoch 2/2
 - 4s - loss: 2.2186 - acc: 0.2529 - val_loss: 2.0508 - val_acc: 0.3578
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 14), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 14) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 14) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 14) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 14)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0009522697489374414, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.22282762238898463, 'num_dense_units_0': 393, 'cnn_learning_rate': 0.0003409059968597692, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 330}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.6422018334953064, 'info': {'histories': {'val_loss': [2.313157869041513, 2.050770409610293], 'acc': [0.10489510473879901, 0.244755245797284], 'loss': [2.4079062221767185, 2.2303577894931075], 'val_acc': [0.20183486306886061, 0.3577981665046937]}, 'runtime': 16.88148784637451}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 14)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 15)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 15) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 15) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 16) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 15) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 15)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007789907756463128, 'height_shift_range': 0.267, 'batch_size': 32, 'num_dense_units_2': 87, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.2920090356238687, 'num_dense_units_0': 232, 'cnn_learning_rate': 0.0003953871895760784, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 445}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:10:58.414991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.5877 - acc: 0.1493 - val_loss: 2.5218 - val_acc: 0.0938
Epoch 2/2
 - 4s - loss: 1.9477 - acc: 0.3505 - val_loss: 2.6837 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 15), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 15) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 15) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 15) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 15)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007789907756463128, 'height_shift_range': 0.267, 'batch_size': 32, 'num_dense_units_2': 87, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.2920090356238687, 'num_dense_units_0': 232, 'cnn_learning_rate': 0.0003953871895760784, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 445}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.890625, 'info': {'histories': {'val_loss': [2.5218043327331543, 2.683678388595581], 'acc': [0.17692307692307693, 0.4153846153846154], 'loss': [2.5080705862778885, 1.877451808636005], 'val_acc': [0.09375, 0.109375]}, 'runtime': 13.734560251235962}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 15)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 16)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 16) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 16) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 17) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 16) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 16)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007913276149733557, 'height_shift_range': 0.267, 'batch_size': 56, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.07908562229832784, 'num_dense_units_0': 219, 'cnn_learning_rate': 3.0741180528454486e-05, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 157}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:11:16.603870: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.3844 - acc: 0.0982 - val_loss: 2.8695 - val_acc: 0.0000e+00
Epoch 2/2
 - 5s - loss: 2.4265 - acc: 0.0673 - val_loss: 2.3998 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 16), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 16) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 16) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 16) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 16)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007913276149733557, 'height_shift_range': 0.267, 'batch_size': 56, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.07908562229832784, 'num_dense_units_0': 219, 'cnn_learning_rate': 3.0741180528454486e-05, 'cnn_unlock_epoch': 25, 'num_dense_units_1': 157}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.875, 'info': {'histories': {'val_loss': [2.8695433139801025, 2.3998422622680664], 'acc': [0.098214291036129, 0.06603773388097871], 'loss': [2.3843674659729004, 2.425499637171907], 'val_acc': [0.0, 0.125]}, 'runtime': 25.133680820465088}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 16)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 17)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 17) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 17) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 18) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 17) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 17)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0002159889356170967, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_units_2': 100, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.29705832775137503, 'num_dense_units_0': 430, 'cnn_learning_rate': 2.9569971655701012e-05, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 253}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:11:37.537767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.3956 - acc: 0.1393 - val_loss: 2.5370 - val_acc: 0.0909
Epoch 2/2
 - 4s - loss: 1.8595 - acc: 0.3168 - val_loss: 2.5893 - val_acc: 0.0909
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 17), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 17) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 17) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 17) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 17)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0002159889356170967, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_units_2': 100, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.29705832775137503, 'num_dense_units_0': 430, 'cnn_learning_rate': 2.9569971655701012e-05, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 253}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.9090909086071052, 'info': {'histories': {'val_loss': [2.536995367570357, 2.5892719541277205], 'acc': [0.15827338362662055, 0.3167701874460493], 'loss': [2.3691006941761046, 1.8595303807939803], 'val_acc': [0.09090909139289484, 0.09090909139289484]}, 'runtime': 13.826611042022705}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 17)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 18)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 18) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 18) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 19) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 18) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 18)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007688735236682238, 'height_shift_range': 0.267, 'batch_size': 63, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.028908593488783683, 'num_dense_units_0': 268, 'cnn_learning_rate': 9.397528524880653e-05, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 193}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:11:52.108089: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.4847 - acc: 0.1450 - val_loss: 2.5600 - val_acc: 0.1562
Epoch 2/2
 - 3s - loss: 2.5186 - acc: 0.1111 - val_loss: 2.4780 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 18), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 18) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 18) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 18) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 18)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007688735236682238, 'height_shift_range': 0.267, 'batch_size': 63, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.028908593488783683, 'num_dense_units_0': 268, 'cnn_learning_rate': 9.397528524880653e-05, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 193}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.560025215148926, 2.4780237674713135], 'acc': [0.14141414788636295, 0.111111119389534], 'loss': [2.4797003919428047, 2.5185898542404175], 'val_acc': [0.15625, 0.09375]}, 'runtime': 15.034863233566284}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 18)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 19)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 19) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 20) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 19) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 19) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 19)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0024308929635706755, 'height_shift_range': 0.267, 'batch_size': 31, 'num_dense_units_2': 66, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.29319317413415363, 'num_dense_units_0': 154, 'cnn_learning_rate': 3.822536554534092e-05, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 199}, 'working_directory': '.', 'budget': 2.0}
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 14:12:11.171187: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 8s - loss: 3.1607 - acc: 0.1115 - val_loss: 2.5191 - val_acc: 0.1250
Epoch 2/2
 - 5s - loss: 2.4728 - acc: 0.1197 - val_loss: 2.3744 - val_acc: 0.2500
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 19), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 19) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 19) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 19) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 19)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0024308929635706755, 'height_shift_range': 0.267, 'batch_size': 31, 'num_dense_units_2': 66, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.29319317413415363, 'num_dense_units_0': 154, 'cnn_learning_rate': 3.822536554534092e-05, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 199}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.75, 'info': {'histories': {'val_loss': [2.5191069841384888, 2.3744157552719116], 'acc': [0.10687022639139918, 0.13740457605769615], 'loss': [3.2327351952327117, 2.45527757033137], 'val_acc': [0.125, 0.25]}, 'runtime': 22.879733562469482}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 19)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 20)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 20) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 20) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 21) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 20) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 20)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.007950523324340406, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.04777981862573932, 'num_dense_units_0': 886, 'cnn_learning_rate': 0.00027010778969882874, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 388}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:12:28.745554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.4876 - acc: 0.1039 - val_loss: 2.3389 - val_acc: 0.1429
Epoch 2/2
 - 3s - loss: 2.1720 - acc: 0.2900 - val_loss: 2.2008 - val_acc: 0.2078
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 20), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 20) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 20) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 20) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 20)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.007950523324340406, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.04777981862573932, 'num_dense_units_0': 886, 'cnn_learning_rate': 0.00027010778969882874, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 388}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.7922077917239883, 'info': {'histories': {'val_loss': [2.3389254421382755, 2.200800743970004], 'acc': [0.10389610699244908, 0.28571429044481306], 'loss': [2.4876064573015486, 2.192908684412638], 'val_acc': [0.14285714382475073, 0.20779220827601172]}, 'runtime': 11.973217487335205}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 20)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 21)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 21) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 21) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 22) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 21) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 21)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0002991838642808414, 'height_shift_range': 0.267, 'batch_size': 30, 'num_dense_units_2': 37, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.2725748727334653, 'num_dense_units_0': 114, 'cnn_learning_rate': 5.1499081835195246e-05, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 460}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:12:40.770935: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.2844 - acc: 0.1600 - val_loss: 2.2514 - val_acc: 0.1562
Epoch 2/2
 - 3s - loss: 2.0766 - acc: 0.3206 - val_loss: 2.0745 - val_acc: 0.2188
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 21), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 21) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 21) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 21) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 21)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0002991838642808414, 'height_shift_range': 0.267, 'batch_size': 30, 'num_dense_units_2': 37, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.2725748727334653, 'num_dense_units_0': 114, 'cnn_learning_rate': 5.1499081835195246e-05, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 460}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.78125, 'info': {'histories': {'val_loss': [2.251365900039673, 2.074542760848999], 'acc': [0.16000001430511473, 0.307017561636473], 'loss': [2.284386730194092, 2.0727348453120182], 'val_acc': [0.15625, 0.21875]}, 'runtime': 11.102206707000732}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 21)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 22)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 22) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 22) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 23) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 22) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 22)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00023766619778607632, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.14632002756508053, 'num_dense_units_0': 183, 'cnn_learning_rate': 0.0001855110920544726, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 52}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:12:53.798014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.3874 - acc: 0.1419 - val_loss: 2.3435 - val_acc: 0.0826
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/2
 - 5s - loss: 2.2042 - acc: 0.1603 - val_loss: 2.2365 - val_acc: 0.2018
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 22), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 22) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 22) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 22) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 22)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00023766619778607632, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.14632002756508053, 'num_dense_units_0': 183, 'cnn_learning_rate': 0.0001855110920544726, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 52}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.7981651357007683, 'info': {'histories': {'val_loss': [2.343491121169624, 2.236452236088044], 'acc': [0.1379310381052823, 0.15172414034605025], 'loss': [2.3956453208265636, 2.212293799170132], 'val_acc': [0.0825688076812193, 0.20183486429923173]}, 'runtime': 16.815466165542603}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 22)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 23)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 23) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 23) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 24) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 23) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 23)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0003413126571216017, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.044836901796435624, 'num_dense_units_0': 533, 'cnn_learning_rate': 2.5593632146578597e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 453}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:13:10.751509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 3.1494 - acc: 0.0950 - val_loss: 2.4867 - val_acc: 0.1948
Epoch 2/2
 - 4s - loss: 2.6426 - acc: 0.1393 - val_loss: 3.0138 - val_acc: 0.0909
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 23), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 23) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 23) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 23) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 23)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0003413126571216017, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.044836901796435624, 'num_dense_units_0': 533, 'cnn_learning_rate': 2.5593632146578597e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 453}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.9090909081233012, 'info': {'histories': {'val_loss': [2.4866972310202464, 3.0137714534610898], 'acc': [0.1079136692255521, 0.15827338485945042], 'loss': [3.31154849803705, 2.675495176006564], 'val_acc': [0.19480519751449685, 0.09090909187669878]}, 'runtime': 15.770341873168945}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 23)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 24)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 24) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 24) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 25) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 24) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 24)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0015084547025347405, 'height_shift_range': 0.267, 'batch_size': 61, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.25510278594596525, 'num_dense_units_0': 920, 'cnn_learning_rate': 7.92074007744679e-05, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 496}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:13:26.590537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 3.8562 - acc: 0.0904 - val_loss: 3.6399 - val_acc: 0.0938
Epoch 2/2
 - 4s - loss: 3.2721 - acc: 0.1639 - val_loss: 3.0552 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 24), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 24) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 24) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 24) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 24)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0015084547025347405, 'height_shift_range': 0.267, 'batch_size': 61, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.25510278594596525, 'num_dense_units_0': 920, 'cnn_learning_rate': 7.92074007744679e-05, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 496}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [3.639888286590576, 3.0551505088806152], 'acc': [0.08910890646500162, 0.16393442079424858], 'loss': [4.057083970249289, 3.2720773220062256], 'val_acc': [0.09375, 0.09375]}, 'runtime': 19.598952054977417}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 24)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 25)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 25) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 25) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 26) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 25) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 25)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008316085126480701, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 28, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.21998130902293425, 'num_dense_units_0': 288, 'cnn_learning_rate': 8.231586126347911e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 410}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:13:45.327719: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.7098 - acc: 0.1283 - val_loss: 2.3272 - val_acc: 0.1948
Epoch 2/2
 - 5s - loss: 2.2359 - acc: 0.1948 - val_loss: 2.0918 - val_acc: 0.2208
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 25), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 25) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 25) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 25) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 25)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008316085126480701, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 28, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.21998130902293425, 'num_dense_units_0': 288, 'cnn_learning_rate': 8.231586126347911e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 410}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.7792207782531714, 'info': {'histories': {'val_loss': [2.3272258492259237, 2.0918497853464895], 'acc': [0.128571432190282, 0.19480520061084203], 'loss': [2.69338424546378, 2.2358525480542863], 'val_acc': [0.19480519577280267, 0.22077922174682865]}, 'runtime': 15.396021604537964}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 25)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 26)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 26) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 26) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 27) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 26) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 26)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009744715612910298, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 45, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.22865801572478867, 'num_dense_units_0': 192, 'cnn_learning_rate': 0.0007097064697485972, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 163}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:14:00.163721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 4.8934 - acc: 0.1217 - val_loss: 2.9659 - val_acc: 0.1299
Epoch 2/2
 - 3s - loss: 2.8854 - acc: 0.1414 - val_loss: 2.2288 - val_acc: 0.1299
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 26), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 26) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 26) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 26) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 26)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009744715612910298, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 45, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.22865801572478867, 'num_dense_units_0': 192, 'cnn_learning_rate': 0.0007097064697485972, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 163}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.8701298691622623, 'info': {'histories': {'val_loss': [2.9659055146304043, 2.228836239158333], 'acc': [0.12142857483455113, 0.1428571445601327], 'loss': [5.0919578075408936, 2.9368257216044835], 'val_acc': [0.1298701303539338, 0.12987013083773774]}, 'runtime': 11.529037237167358}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 26)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 27)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 27) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 27) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 28) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 27) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 27)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008209161473046269, 'height_shift_range': 0.267, 'batch_size': 33, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.19998499681827744, 'num_dense_units_0': 293, 'cnn_learning_rate': 7.300822885438446e-05, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 84}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:14:12.580603: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 3.3921 - acc: 0.1659 - val_loss: 2.3697 - val_acc: 0.0625
Epoch 2/2
 - 3s - loss: 2.2430 - acc: 0.2414 - val_loss: 2.3465 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 27), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 27) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 27) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 27) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 27)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008209161473046269, 'height_shift_range': 0.267, 'batch_size': 33, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.19998499681827744, 'num_dense_units_0': 293, 'cnn_learning_rate': 7.300822885438446e-05, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 84}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.84375, 'info': {'histories': {'val_loss': [2.3697468042373657, 2.3465194702148438], 'acc': [0.1627907094567321, 0.24031008537425552], 'loss': [3.407376899275669, 2.242880943209626], 'val_acc': [0.0625, 0.15625]}, 'runtime': 12.731197834014893}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 27)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 28)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 28) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 28) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 29) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 28) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 28)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0036005478179101107, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_units_2': 39, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.13729296542761482, 'num_dense_units_0': 180, 'cnn_learning_rate': 5.826531646014584e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 121}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:14:26.069406: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.6438 - acc: 0.0864 - val_loss: 2.4751 - val_acc: 0.1468
Epoch 2/2
 - 5s - loss: 2.4190 - acc: 0.0926 - val_loss: 2.3398 - val_acc: 0.1468
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 28), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 28) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 28) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 28) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 28)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0036005478179101107, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_units_2': 39, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.13729296542761482, 'num_dense_units_0': 180, 'cnn_learning_rate': 5.826531646014584e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 121}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.8532110088325422, 'info': {'histories': {'val_loss': [2.4751319972746963, 2.339776824373718], 'acc': [0.08641975414421824, 0.09259259493814574], 'loss': [2.6438187758127847, 2.4190246529049344], 'val_acc': [0.14678899150922758, 0.14678899116745783]}, 'runtime': 17.309172868728638}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 28)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 29)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 29) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 29) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 30) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 29) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 29)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.003828225927472165, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 55, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.08684175504863828, 'num_dense_units_0': 429, 'cnn_learning_rate': 0.00019651011377052978, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 84}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:14:43.049543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 6s - loss: 2.3442 - acc: 0.1073 - val_loss: 2.3253 - val_acc: 0.1039
Epoch 2/2
 - 4s - loss: 2.2997 - acc: 0.0981 - val_loss: 2.2992 - val_acc: 0.1558
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 29), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 29) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 29) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 29) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 29)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.003828225927472165, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 55, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.08684175504863828, 'num_dense_units_0': 429, 'cnn_learning_rate': 0.00019651011377052978, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 84}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.8441558414465421, 'info': {'histories': {'val_loss': [2.3253065765678107, 2.299184684629564], 'acc': [0.10638298229017157, 0.09929078222906336], 'loss': [2.3521617169075824, 2.293167920822793], 'val_acc': [0.1038961038961039, 0.15584415855345787]}, 'runtime': 16.156209230422974}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 29)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 30)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 30) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 31) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 30) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 30) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 30)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018384570315878026, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_units_2': 130, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.08281874464133102, 'num_dense_units_0': 769, 'cnn_learning_rate': 1.1252978052325498e-05, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 50}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:14:57.803340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 5s - loss: 2.2830 - acc: 0.1734 - val_loss: 2.0182 - val_acc: 0.3119
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/2
 - 3s - loss: 1.8450 - acc: 0.3816 - val_loss: 1.9518 - val_acc: 0.3211
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 30), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 30) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 30) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 30) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 30)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018384570315878026, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_units_2': 130, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.08281874464133102, 'num_dense_units_0': 769, 'cnn_learning_rate': 1.1252978052325498e-05, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 50}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.6788990812017284, 'info': {'histories': {'val_loss': [2.0182481927609226, 1.9518423758515524], 'acc': [0.16083915927610198, 0.3815789483487606], 'loss': [2.2992707015751126, 1.8449596762657166], 'val_acc': [0.31192660741849776, 0.3211009187982717]}, 'runtime': 11.406120777130127}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 30)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 31)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 31) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 31) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 0) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 31)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00023354944563865797, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 60, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.06200883009933965, 'num_dense_units_0': 233, 'cnn_learning_rate': 0.0004317622731304309, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 264}, 'working_directory': '.', 'budget': 2.0}
2018-02-08 14:15:14.862135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/2
 - 7s - loss: 2.6355 - acc: 0.1216 - val_loss: 2.2983 - val_acc: 0.0625
Epoch 2/2
 - 5s - loss: 2.3747 - acc: 0.1621 - val_loss: 2.2216 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 31), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 31) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 31)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00023354944563865797, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 60, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.06200883009933965, 'num_dense_units_0': 233, 'cnn_learning_rate': 0.0004317622731304309, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 264}, 'working_directory': '.', 'budget': 2.0}
result: {'loss': 0.84375, 'info': {'histories': {'val_loss': [2.29827880859375, 2.221571922302246], 'acc': [0.1463414688662785, 0.19512196321312975], 'loss': [2.555811410996972, 2.364442395000923], 'val_acc': [0.0625, 0.15625]}, 'runtime': 21.93525719642639}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 31)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 0) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 22) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (2, 0, 0) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000357888533287373, 'height_shift_range': 0.267, 'batch_size': 59, 'num_dense_units_2': 12, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.1452951978638344, 'num_dense_units_0': 778, 'cnn_learning_rate': 0.0003044134208470986, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 85}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:15:32.829058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.3797 - acc: 0.1102 - val_loss: 2.4272 - val_acc: 0.1562
Epoch 2/4
 - 3s - loss: 1.9829 - acc: 0.3864 - val_loss: 2.3890 - val_acc: 0.1875
Epoch 3/4
 - 3s - loss: 1.9287 - acc: 0.3898 - val_loss: 2.0792 - val_acc: 0.3438
Epoch 4/4
 - 3s - loss: 1.7067 - acc: 0.5000 - val_loss: 2.6537 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 0)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000357888533287373, 'height_shift_range': 0.267, 'batch_size': 59, 'num_dense_units_2': 12, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.1452951978638344, 'num_dense_units_0': 778, 'cnn_learning_rate': 0.0003044134208470986, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 85}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.875, 'info': {'histories': {'val_loss': [2.427224636077881, 2.389033079147339, 2.079174757003784, 2.653688430786133], 'acc': [0.11016949266195297, 0.3863636553287506, 0.3898305296897888, 0.5000000149011612], 'loss': [2.3797366619110107, 1.9829223155975342, 1.9286978840827942, 1.706728458404541], 'val_acc': [0.15625, 0.1875, 0.34375, 0.125]}, 'runtime': 19.89360737800598}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 0)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 22)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 22) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 25) to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 22) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (1, 0, 22) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 22)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00023766619778607632, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.14632002756508053, 'num_dense_units_0': 183, 'cnn_learning_rate': 0.0001855110920544726, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 52}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:15:53.246037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.3672 - acc: 0.1406 - val_loss: 2.3074 - val_acc: 0.1193
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/4
 - 5s - loss: 2.2423 - acc: 0.2088 - val_loss: 2.2892 - val_acc: 0.1376
Epoch 3/4
 - 5s - loss: 2.1796 - acc: 0.2208 - val_loss: 2.1909 - val_acc: 0.2477
Epoch 4/4
 - 5s - loss: 2.1509 - acc: 0.2615 - val_loss: 2.1940 - val_acc: 0.2661
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 22), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 22) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 22) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 22) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 22)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00023766619778607632, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.14632002756508053, 'num_dense_units_0': 183, 'cnn_learning_rate': 0.0001855110920544726, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 52}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.7339449522145298, 'info': {'histories': {'val_loss': [2.307421644893261, 2.289193748334132, 2.190907924547108, 2.1940466373338614], 'acc': [0.131034483786287, 0.1862069013817557, 0.22068966085027003, 0.2689655226366273], 'loss': [2.377067708969116, 2.2544326280725415, 2.1800310957020725, 2.1484470186562374], 'val_acc': [0.11926605572941107, 0.1376146808129932, 0.2477064223601184, 0.26605504778547023]}, 'runtime': 26.344494581222534}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 22)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 25)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 25) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 0) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 25) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 25) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 25)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008316085126480701, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 28, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.21998130902293425, 'num_dense_units_0': 288, 'cnn_learning_rate': 8.231586126347911e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 410}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:16:18.310535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.7947 - acc: 0.1249 - val_loss: 2.4426 - val_acc: 0.1429
Epoch 2/4
 - 5s - loss: 2.3268 - acc: 0.1818 - val_loss: 2.3066 - val_acc: 0.1948
Epoch 3/4
 - 5s - loss: 2.1677 - acc: 0.2466 - val_loss: 2.0094 - val_acc: 0.2987
Epoch 4/4
 - 5s - loss: 1.8716 - acc: 0.2960 - val_loss: 1.8598 - val_acc: 0.3506
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 25), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 25) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 25) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 25) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 25)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008316085126480701, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 28, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.21998130902293425, 'num_dense_units_0': 288, 'cnn_learning_rate': 8.231586126347911e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 410}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.6493506481895199, 'info': {'histories': {'val_loss': [2.442558883072494, 2.3066292025826196, 2.009397844215492, 1.8597713662432385], 'acc': [0.13571428741727556, 0.1818181872367859, 0.2571428622518267, 0.3000000061733382], 'loss': [2.7406509808131627, 2.3267596449170793, 2.154923861367362, 1.8562868237495422], 'val_acc': [0.1428571433409468, 0.19480519528899873, 0.29870130141060075, 0.35064935181048007]}, 'runtime': 24.776026964187622}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 25)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 0) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 11) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 0)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004440858756346598, 'height_shift_range': 0.267, 'batch_size': 24, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.0038465833794067983, 'num_dense_units_0': 152, 'cnn_learning_rate': 1.3197144852527731e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 78}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:16:43.080585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.5194 - acc: 0.1667 - val_loss: 2.0080 - val_acc: 0.3117
Epoch 2/4
 - 3s - loss: 1.8296 - acc: 0.4182 - val_loss: 2.1305 - val_acc: 0.2338
Epoch 3/4
 - 3s - loss: 1.3662 - acc: 0.5000 - val_loss: 1.7247 - val_acc: 0.3247
Epoch 4/4
 - 3s - loss: 0.9991 - acc: 0.6875 - val_loss: 1.3372 - val_acc: 0.5325
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 0)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004440858756346598, 'height_shift_range': 0.267, 'batch_size': 24, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.0038465833794067983, 'num_dense_units_0': 152, 'cnn_learning_rate': 1.3197144852527731e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 78}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.4675324613397772, 'info': {'histories': {'val_loss': [2.008017109586047, 2.1304975856434214, 1.724733423877072, 1.337209371777324], 'acc': [0.1666666716337204, 0.427536239442618, 0.5000000207320504, 0.6875000298023224], 'loss': [2.517956878827966, 1.8043694081513777, 1.3750105526136316, 0.9991304675738016], 'val_acc': [0.31168831710691575, 0.2337662342500377, 0.32467532661054044, 0.5324675386602228]}, 'runtime': 17.499430418014526}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 0)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 11)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 11) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 11) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 30) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 11) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 11)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00016129613316653364, 'height_shift_range': 0.267, 'batch_size': 54, 'num_dense_units_2': 145, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.23354000302710443, 'num_dense_units_0': 193, 'cnn_learning_rate': 0.000191781242617201, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 65}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:17:01.020040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.3746 - acc: 0.0741 - val_loss: 2.3269 - val_acc: 0.0938
Epoch 2/4
 - 5s - loss: 2.1360 - acc: 0.2593 - val_loss: 2.2272 - val_acc: 0.2188
Epoch 3/4
 - 5s - loss: 1.9805 - acc: 0.4568 - val_loss: 2.1981 - val_acc: 0.1875
Epoch 4/4
 - 5s - loss: 1.9542 - acc: 0.3642 - val_loss: 2.0980 - val_acc: 0.2812
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 11), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 11) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 11) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 11) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 11)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00016129613316653364, 'height_shift_range': 0.267, 'batch_size': 54, 'num_dense_units_2': 145, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.23354000302710443, 'num_dense_units_0': 193, 'cnn_learning_rate': 0.000191781242617201, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 65}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.71875, 'info': {'histories': {'val_loss': [2.32694673538208, 2.2271668910980225, 2.1981194019317627, 2.09801983833313], 'acc': [0.0740740771094958, 0.2592592736085256, 0.45679011940956116, 0.3641975422700246], 'loss': [2.3745995362599692, 2.1360248724619546, 1.9804634253184001, 1.954177459081014], 'val_acc': [0.09375, 0.21875, 0.1875, 0.28125]}, 'runtime': 25.93458580970764}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 11)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 30)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 30) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 30) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 20) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 30) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 30)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018384570315878026, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_units_2': 130, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.08281874464133102, 'num_dense_units_0': 769, 'cnn_learning_rate': 1.1252978052325498e-05, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 50}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:17:26.117729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.5035 - acc: 0.2132 - val_loss: 2.0298 - val_acc: 0.4128
Epoch 2/4
 - 3s - loss: 1.8150 - acc: 0.3708 - val_loss: 1.6735 - val_acc: 0.3578
Epoch 3/4
 - 3s - loss: 1.7763 - acc: 0.3841 - val_loss: 1.5192 - val_acc: 0.4037
Epoch 4/4
 - 3s - loss: 1.4566 - acc: 0.4411 - val_loss: 1.5984 - val_acc: 0.4495
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 30), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 30) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 30) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 30) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 30)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018384570315878026, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_units_2': 130, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.08281874464133102, 'num_dense_units_0': 769, 'cnn_learning_rate': 1.1252978052325498e-05, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 50}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.550458711768509, 'info': {'histories': {'val_loss': [2.0297788042540943, 1.6734837752963425, 1.5191616180839889, 1.5983707532970184], 'acc': [0.20279720352663028, 0.36363636509521857, 0.37762238116531105, 0.4545454610060979], 'loss': [2.5277334943517937, 1.8228541846041912, 1.7803479074598192, 1.431363114943871], 'val_acc': [0.41284404052506896, 0.3577981670515253, 0.40366972613772123, 0.449541288231491]}, 'runtime': 17.9373619556427}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 30)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 20)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 20) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 20) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 31) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 20) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 20)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.007950523324340406, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.04777981862573932, 'num_dense_units_0': 886, 'cnn_learning_rate': 0.00027010778969882874, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 388}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:17:44.515306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.4004 - acc: 0.1052 - val_loss: 2.0411 - val_acc: 0.3117
Epoch 2/4
 - 3s - loss: 2.0818 - acc: 0.2731 - val_loss: 1.8833 - val_acc: 0.4286
Epoch 3/4
 - 3s - loss: 1.8579 - acc: 0.3683 - val_loss: 1.9113 - val_acc: 0.2987
Epoch 4/4
 - 3s - loss: 1.8049 - acc: 0.3550 - val_loss: 1.7108 - val_acc: 0.4286
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 20), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 20) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 20) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 20) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 20)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.007950523324340406, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.04777981862573932, 'num_dense_units_0': 886, 'cnn_learning_rate': 0.00027010778969882874, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 388}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.571428570267442, 'info': {'histories': {'val_loss': [2.0411017436485785, 1.8832861045738318, 1.9112622273432744, 1.7107918293445141], 'acc': [0.11428571769169399, 0.264285714498588, 0.3785714370863778, 0.3857142972094672], 'loss': [2.3898875202451433, 2.0890102573803495, 1.8384930304118565, 1.7691736885479519], 'val_acc': [0.31168831633282945, 0.42857143476411896, 0.29870130489398905, 0.428571429732558]}, 'runtime': 18.303888082504272}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 20)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 31)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 31) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 31) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 21) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 31)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00023354944563865797, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 60, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.06200883009933965, 'num_dense_units_0': 233, 'cnn_learning_rate': 0.0004317622731304309, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 264}, 'working_directory': '.', 'budget': 4.0}
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 14:18:07.537414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.6980 - acc: 0.0675 - val_loss: 2.6634 - val_acc: 0.0312
Epoch 2/4
 - 4s - loss: 2.3201 - acc: 0.2344 - val_loss: 2.2435 - val_acc: 0.2812
Epoch 3/4
 - 4s - loss: 2.1205 - acc: 0.2872 - val_loss: 2.3414 - val_acc: 0.2188
Epoch 4/4
 - 5s - loss: 2.0445 - acc: 0.3269 - val_loss: 2.0938 - val_acc: 0.3750
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 31), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 31) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 31)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00023354944563865797, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 60, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.06200883009933965, 'num_dense_units_0': 233, 'cnn_learning_rate': 0.0004317622731304309, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 264}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.625, 'info': {'histories': {'val_loss': [2.663367509841919, 2.2435319423675537, 2.3414082527160645, 2.0937604904174805], 'acc': [0.08130081643055125, 0.1463414694114429, 0.24390244956423596, 0.32692309468984604], 'loss': [2.744110799417263, 2.4105728661141743, 2.14656832741528, 2.044512540102005], 'val_acc': [0.03125, 0.28125, 0.21875, 0.375]}, 'runtime': 30.479052782058716}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 31)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 21)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 21) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 28) to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 21) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (1, 0, 21) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 21)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0002991838642808414, 'height_shift_range': 0.267, 'batch_size': 30, 'num_dense_units_2': 37, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.2725748727334653, 'num_dense_units_0': 114, 'cnn_learning_rate': 5.1499081835195246e-05, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 460}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:18:33.086810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.2421 - acc: 0.1750 - val_loss: 2.2531 - val_acc: 0.1406
Epoch 2/4
 - 3s - loss: 2.1125 - acc: 0.2515 - val_loss: 2.1843 - val_acc: 0.2031
Epoch 3/4
 - 3s - loss: 1.9659 - acc: 0.3333 - val_loss: 2.0528 - val_acc: 0.3594
Epoch 4/4
 - 3s - loss: 1.9045 - acc: 0.3908 - val_loss: 2.0032 - val_acc: 0.2344
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 21), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 21) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 21) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 21) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 21)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0002991838642808414, 'height_shift_range': 0.267, 'batch_size': 30, 'num_dense_units_2': 37, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.2725748727334653, 'num_dense_units_0': 114, 'cnn_learning_rate': 5.1499081835195246e-05, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 460}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.765625, 'info': {'histories': {'val_loss': [2.2530643939971924, 2.1843087673187256, 2.0527564883232117, 2.003246545791626], 'acc': [0.16666668179360303, 0.2424242611635815, 0.33333334922790525, 0.39473687033904226], 'loss': [2.251041802493009, 2.1085358262062073, 1.9659231185913086, 1.8919098941903365], 'val_acc': [0.140625, 0.203125, 0.359375, 0.234375]}, 'runtime': 16.457995176315308}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 21)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 28)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 28) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 28) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 14) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 28) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 28)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0036005478179101107, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_units_2': 39, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.13729296542761482, 'num_dense_units_0': 180, 'cnn_learning_rate': 5.826531646014584e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 121}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:18:51.787990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 7s - loss: 2.6452 - acc: 0.1296 - val_loss: 2.3166 - val_acc: 0.2018
Epoch 2/4
 - 5s - loss: 2.3303 - acc: 0.1420 - val_loss: 2.3032 - val_acc: 0.1376
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/4
 - 5s - loss: 2.2342 - acc: 0.1852 - val_loss: 2.3639 - val_acc: 0.1101
Epoch 4/4
 - 5s - loss: 2.2953 - acc: 0.2037 - val_loss: 2.2647 - val_acc: 0.1927
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 28), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 28) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 28) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 28) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 28)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0036005478179101107, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_units_2': 39, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.13729296542761482, 'num_dense_units_0': 180, 'cnn_learning_rate': 5.826531646014584e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 121}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.8073394488577449, 'info': {'histories': {'val_loss': [2.3166235783778197, 2.303150846323836, 2.3639389156201562, 2.264658127356013], 'acc': [0.12962963142328793, 0.14197531135545838, 0.18518518987629148, 0.20370370894670486], 'loss': [2.6451799074808755, 2.3302779462602405, 2.234194967481825, 2.2953460216522217], 'val_acc': [0.20183486272709086, 0.1376146808129932, 0.11009174380280556, 0.1926605511422551]}, 'runtime': 26.04740047454834}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 28)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 14)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 14) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 29) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 14) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 14) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 14)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0009522697489374414, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.22282762238898463, 'num_dense_units_0': 393, 'cnn_learning_rate': 0.0003409059968597692, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 330}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:19:17.665686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.4421 - acc: 0.1364 - val_loss: 2.2328 - val_acc: 0.2844
Epoch 2/4
 - 5s - loss: 2.2366 - acc: 0.1709 - val_loss: 2.1687 - val_acc: 0.1009
Epoch 3/4
 - 5s - loss: 1.9270 - acc: 0.2961 - val_loss: 2.1275 - val_acc: 0.2569
Epoch 4/4
 - 4s - loss: 1.9484 - acc: 0.3549 - val_loss: 1.8982 - val_acc: 0.3119
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 14), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 14) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 14) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 14) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 14)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0009522697489374414, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.22282762238898463, 'num_dense_units_0': 393, 'cnn_learning_rate': 0.0003409059968597692, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 330}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.6880733931283338, 'info': {'histories': {'val_loss': [2.2327607049854525, 2.168714761734009, 2.127452957520791, 1.8982352335518653], 'acc': [0.13286713099146222, 0.17482517617982585, 0.2960526291280985, 0.3731343292478305], 'loss': [2.4305221100787184, 2.2355763878855672, 1.9270282238721848, 1.90642549386665], 'val_acc': [0.28440367163868124, 0.10091743153443031, 0.25688073585886473, 0.3119266068716662]}, 'runtime': 25.443382501602173}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 14)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 29)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 29) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 29) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 12) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 29) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 29)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.003828225927472165, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 55, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.08684175504863828, 'num_dense_units_0': 429, 'cnn_learning_rate': 0.00019651011377052978, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 84}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:19:43.191667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.4114 - acc: 0.0889 - val_loss: 2.4009 - val_acc: 0.1039
Epoch 2/4
 - 4s - loss: 2.2944 - acc: 0.1439 - val_loss: 2.3556 - val_acc: 0.1299
Epoch 3/4
 - 4s - loss: 2.2823 - acc: 0.1497 - val_loss: 2.3521 - val_acc: 0.1299
Epoch 4/4
 - 4s - loss: 2.2657 - acc: 0.2066 - val_loss: 2.3061 - val_acc: 0.0909
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 29), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 29) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 29) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 29) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 29)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.003828225927472165, 'height_shift_range': 0.267, 'batch_size': 21, 'num_dense_units_2': 55, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.08684175504863828, 'num_dense_units_0': 429, 'cnn_learning_rate': 0.00019651011377052978, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 84}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.9090909081233012, 'info': {'histories': {'val_loss': [2.4009199514017476, 2.3555943687240797, 2.3520924983086524, 2.306127294317468], 'acc': [0.09219858438727703, 0.14184397799854584, 0.1496598677975791, 0.21481482386589051], 'loss': [2.409470593675654, 2.2967206315791353, 2.2822697162628174, 2.2633462958865698], 'val_acc': [0.1038961038961039, 0.12987013083773774, 0.12987013083773774, 0.09090909187669878]}, 'runtime': 24.33585286140442}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 29)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 12)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 12) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 12) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 19) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 12) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 12)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.001375852644601434, 'height_shift_range': 0.267, 'batch_size': 41, 'num_dense_units_2': 30, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.21569214652187058, 'num_dense_units_0': 478, 'cnn_learning_rate': 2.2338400249519212e-05, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 124}, 'working_directory': '.', 'budget': 4.0}
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 14:20:06.237067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 3.0049 - acc: 0.0826 - val_loss: 2.9353 - val_acc: 0.0625
Epoch 2/4
 - 4s - loss: 2.8507 - acc: 0.0813 - val_loss: 2.7168 - val_acc: 0.0625
Epoch 3/4
 - 4s - loss: 2.4959 - acc: 0.1579 - val_loss: 2.2573 - val_acc: 0.1875
Epoch 4/4
 - 4s - loss: 2.2092 - acc: 0.1975 - val_loss: 2.6788 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 12), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 12) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 12) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 12) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 12)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.001375852644601434, 'height_shift_range': 0.267, 'batch_size': 41, 'num_dense_units_2': 30, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.21569214652187058, 'num_dense_units_0': 478, 'cnn_learning_rate': 2.2338400249519212e-05, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 124}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.93532395362854, 2.7168211936950684, 2.2573130130767822, 2.6787753105163574], 'acc': [0.08264462686767263, 0.08130080997943878, 0.15702479067912772, 0.198347101403662], 'loss': [2.9964376973711753, 2.850717306137085, 2.4974004375047922, 2.206061589816385], 'val_acc': [0.0625, 0.0625, 0.1875, 0.09375]}, 'runtime': 21.79826521873474}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 12)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 19)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 19) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 13) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 19) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 19) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 19)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0024308929635706755, 'height_shift_range': 0.267, 'batch_size': 31, 'num_dense_units_2': 66, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.29319317413415363, 'num_dense_units_0': 154, 'cnn_learning_rate': 3.822536554534092e-05, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 199}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:20:33.143229: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 7s - loss: 3.0521 - acc: 0.1315 - val_loss: 2.6241 - val_acc: 0.0938
Epoch 2/4
 - 5s - loss: 2.4076 - acc: 0.1698 - val_loss: 2.7389 - val_acc: 0.1250
Epoch 3/4
 - 5s - loss: 2.4736 - acc: 0.1097 - val_loss: 2.2780 - val_acc: 0.0938
Epoch 4/4
 - 5s - loss: 2.3540 - acc: 0.1049 - val_loss: 2.3871 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 19), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 19) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 19) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 19) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 19)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0024308929635706755, 'height_shift_range': 0.267, 'batch_size': 31, 'num_dense_units_2': 66, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.29319317413415363, 'num_dense_units_0': 154, 'cnn_learning_rate': 3.822536554534092e-05, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 199}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.875, 'info': {'histories': {'val_loss': [2.6240588426589966, 2.7389421463012695, 2.2780141830444336, 2.387112855911255], 'acc': [0.12977098906768186, 0.15267175231271118, 0.1096774160861969, 0.09923663883263828], 'loss': [3.0622759611552, 2.391476450985625, 2.4736071586608888, 2.3703721643404196], 'val_acc': [0.09375, 0.125, 0.09375, 0.125]}, 'runtime': 31.89313316345215}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 19)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 13)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 13) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 13) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 27) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 13) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 13)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0003018497801749079, 'height_shift_range': 0.267, 'batch_size': 26, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.14391620082304496, 'num_dense_units_0': 649, 'cnn_learning_rate': 0.00012108085836350304, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 391}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:21:04.975819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 7s - loss: 2.4404 - acc: 0.1154 - val_loss: 2.2124 - val_acc: 0.2969
Epoch 2/4
 - 5s - loss: 2.1048 - acc: 0.3001 - val_loss: 2.2157 - val_acc: 0.2344
Epoch 3/4
 - 5s - loss: 2.0476 - acc: 0.2840 - val_loss: 2.1507 - val_acc: 0.1094
Epoch 4/4
 - 5s - loss: 2.0668 - acc: 0.2029 - val_loss: 2.0002 - val_acc: 0.2031
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 13), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 13) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 13) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 13) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 13)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0003018497801749079, 'height_shift_range': 0.267, 'batch_size': 26, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.14391620082304496, 'num_dense_units_0': 649, 'cnn_learning_rate': 0.00012108085836350304, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 391}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.796875, 'info': {'histories': {'val_loss': [2.212403416633606, 2.215664029121399, 2.1507463455200195, 2.0002487301826477], 'acc': [0.11538462154567242, 0.267241390614674, 0.25735295991248947, 0.22794119137174942], 'loss': [2.440424164136251, 2.1935204781334976, 2.084472757928512, 2.034079925102346], 'val_acc': [0.296875, 0.234375, 0.109375, 0.203125]}, 'runtime': 32.015759229660034}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 13)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 27)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 27) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 27) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (1, 0, 27) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 27)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008209161473046269, 'height_shift_range': 0.267, 'batch_size': 33, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.19998499681827744, 'num_dense_units_0': 293, 'cnn_learning_rate': 7.300822885438446e-05, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 84}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:21:32.670257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.8935 - acc: 0.1458 - val_loss: 2.4098 - val_acc: 0.0938
Epoch 2/4
 - 3s - loss: 2.2551 - acc: 0.2122 - val_loss: 2.4871 - val_acc: 0.1094
Epoch 3/4
 - 3s - loss: 1.6298 - acc: 0.5000 - val_loss: 2.4277 - val_acc: 0.1094
Epoch 4/4
 - 3s - loss: 1.5685 - acc: 0.4835 - val_loss: 2.6129 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 27), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 27) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 27) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 27) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 27)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008209161473046269, 'height_shift_range': 0.267, 'batch_size': 33, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.19998499681827744, 'num_dense_units_0': 293, 'cnn_learning_rate': 7.300822885438446e-05, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 84}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.890625, 'info': {'histories': {'val_loss': [2.409838080406189, 2.4871017932891846, 2.427730917930603, 2.6129019260406494], 'acc': [0.14728682644145433, 0.20930234498755876, 0.4999999925494194, 0.484127014875412], 'loss': [2.9013802173525787, 2.2569617143897123, 1.6297909915447235, 1.569398039863223], 'val_acc': [0.09375, 0.109375, 0.109375, 0.109375]}, 'runtime': 20.679784297943115}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 27)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 2)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 2) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 1) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 2) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004330265205617455, 'height_shift_range': 0.267, 'batch_size': 20, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.15941133930304655, 'num_dense_units_0': 129, 'cnn_learning_rate': 8.815248874546198e-05, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 60}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:21:53.420079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 9.8679 - acc: 0.1761 - val_loss: 2.4600 - val_acc: 0.1039
Epoch 2/4
 - 4s - loss: 2.7259 - acc: 0.1775 - val_loss: 2.3237 - val_acc: 0.1169
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/4
 - 4s - loss: 1.9958 - acc: 0.3500 - val_loss: 2.3783 - val_acc: 0.0909
Epoch 4/4
 - 4s - loss: 1.9246 - acc: 0.3597 - val_loss: 2.3660 - val_acc: 0.1688
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 2)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004330265205617455, 'height_shift_range': 0.267, 'batch_size': 20, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.15941133930304655, 'num_dense_units_0': 129, 'cnn_learning_rate': 8.815248874546198e-05, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 60}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.8311688284595291, 'info': {'histories': {'val_loss': [2.4599984652036198, 2.3237365066231073, 2.3782809461866106, 2.3659668557055586], 'acc': [0.08450704382758745, 0.19718310257918398, 0.3499999977648258, 0.38709677563559625], 'loss': [10.963422012515366, 2.765593710079999, 1.9957709908485413, 1.9932820796966553], 'val_acc': [0.10389610486371177, 0.11688311881833262, 0.09090909361839294, 0.16883117154047086]}, 'runtime': 20.391717433929443}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 2)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 1)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 1) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 22) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 1) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008383709547929253, 'height_shift_range': 0.267, 'batch_size': 35, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.16893901440112918, 'num_dense_units_0': 154, 'cnn_learning_rate': 0.00022435029177690212, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 439}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:22:13.519664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.4301 - acc: 0.0869 - val_loss: 2.3687 - val_acc: 0.1094
Epoch 2/4
 - 3s - loss: 2.4286 - acc: 0.0796 - val_loss: 2.4036 - val_acc: 0.1094
Epoch 3/4
 - 3s - loss: 2.4062 - acc: 0.1161 - val_loss: 2.3786 - val_acc: 0.1250
Epoch 4/4
 - 3s - loss: 2.4395 - acc: 0.0571 - val_loss: 2.3653 - val_acc: 0.1406
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 1)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008383709547929253, 'height_shift_range': 0.267, 'batch_size': 35, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.16893901440112918, 'num_dense_units_0': 154, 'cnn_learning_rate': 0.00022435029177690212, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 439}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.859375, 'info': {'histories': {'val_loss': [2.3686838150024414, 2.4036413431167603, 2.378613829612732, 2.365321397781372], 'acc': [0.08661417460699719, 0.07874015881496621, 0.11811023880177596, 0.05714285746216774], 'loss': [2.4168490424869566, 2.4229323920302503, 2.396283008920865, 2.4394585490226746], 'val_acc': [0.109375, 0.109375, 0.125, 0.140625]}, 'runtime': 16.303163051605225}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 1)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 22)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 22) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 22) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 25) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 22) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 22)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00023766619778607632, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.14632002756508053, 'num_dense_units_0': 183, 'cnn_learning_rate': 0.0001855110920544726, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 52}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 14:22:31.285660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 6s - loss: 2.4014 - acc: 0.1170 - val_loss: 2.2513 - val_acc: 0.1468
Epoch 2/8
 - 5s - loss: 2.2123 - acc: 0.1866 - val_loss: 2.2807 - val_acc: 0.1927
Epoch 3/8
 - 5s - loss: 2.1856 - acc: 0.2222 - val_loss: 2.1919 - val_acc: 0.2844
Epoch 4/8
 - 4s - loss: 2.1443 - acc: 0.2300 - val_loss: 2.1621 - val_acc: 0.2661
Epoch 5/8
 - 4s - loss: 2.0077 - acc: 0.3000 - val_loss: 2.1581 - val_acc: 0.3303
Epoch 6/8
 - 4s - loss: 1.9770 - acc: 0.3613 - val_loss: 2.0165 - val_acc: 0.4404
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 7/8
 - 5s - loss: 1.9111 - acc: 0.3660 - val_loss: 1.9438 - val_acc: 0.4128
Epoch 8/8
 - 4s - loss: 1.8246 - acc: 0.3679 - val_loss: 1.9443 - val_acc: 0.3119
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 22), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 22) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 22) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 22) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 22)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00023766619778607632, 'height_shift_range': 0.267, 'batch_size': 17, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.14632002756508053, 'num_dense_units_0': 183, 'cnn_learning_rate': 0.0001855110920544726, 'cnn_unlock_epoch': 12, 'num_dense_units_1': 52}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.6880733925815022, 'info': {'histories': {'val_loss': [2.251295643115262, 2.2806926517311585, 2.1918569311089473, 2.162139665096178, 2.158069037516183, 2.0165259728737928, 1.9437779614684778, 1.9442601389841203], 'acc': [0.11724138020955283, 0.1793103473453686, 0.22222222636143366, 0.24137931692189185, 0.3138686254838087, 0.3517241486187639, 0.3660130856765641, 0.358620701678868], 'loss': [2.4047451709878858, 2.223731989696108, 2.1856166786617703, 2.1287245026950177, 2.002995655484443, 1.988204576229227, 1.911129699812995, 1.8335077927030365], 'val_acc': [0.14678899116745783, 0.19266055080048536, 0.28440367163868124, 0.26605504723863865, 0.33027523127170877, 0.44036697439097483, 0.41284403806432673, 0.31192660741849776]}, 'runtime': 43.55982160568237}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 22)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 25)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 25) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 25) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 0) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 25) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 25)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008316085126480701, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 28, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.21998130902293425, 'num_dense_units_0': 288, 'cnn_learning_rate': 8.231586126347911e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 410}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 14:23:14.004999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 6s - loss: 2.6665 - acc: 0.1349 - val_loss: 2.1667 - val_acc: 0.1299
Epoch 2/8
 - 5s - loss: 2.2393 - acc: 0.1743 - val_loss: 2.3299 - val_acc: 0.1299
Epoch 3/8
 - 5s - loss: 1.9660 - acc: 0.2567 - val_loss: 2.0123 - val_acc: 0.2468
Epoch 4/8
 - 5s - loss: 1.9718 - acc: 0.3124 - val_loss: 2.0164 - val_acc: 0.2468
Epoch 5/8
 - 5s - loss: 1.7326 - acc: 0.3896 - val_loss: 1.9053 - val_acc: 0.3377
Epoch 6/8
 - 5s - loss: 1.4647 - acc: 0.4301 - val_loss: 1.8342 - val_acc: 0.2597
Epoch 7/8
 - 5s - loss: 1.3864 - acc: 0.5325 - val_loss: 1.4290 - val_acc: 0.5455
Epoch 8/8
 - 5s - loss: 1.2423 - acc: 0.6382 - val_loss: 1.3662 - val_acc: 0.5195
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 25), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 25) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 25) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 25) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 25)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008316085126480701, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 28, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.21998130902293425, 'num_dense_units_0': 288, 'cnn_learning_rate': 8.231586126347911e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 410}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.48051947510087645, 'info': {'histories': {'val_loss': [2.166667535707548, 2.3298781413536567, 2.012272607196461, 2.0163554030579407, 1.9053314506233512, 1.8342000617609395, 1.4290212315398376, 1.3661640650266176], 'acc': [0.1357142895460129, 0.17857143602200917, 0.23571428954601287, 0.32857144049235754, 0.38961040335042135, 0.45238095947674345, 0.5324675483363015, 0.6285714413438525], 'loss': [2.690992307662964, 2.2471087830407277, 1.994582906791142, 1.9453659772872924, 1.732607296534947, 1.4569894245692663, 1.3864045483725411, 1.2655655026435852], 'val_acc': [0.12987013083773774, 0.12987013083773774, 0.2467532529459371, 0.24675324946254878, 0.3376623403716397, 0.2597402624495618, 0.5454545500990632, 0.5194805248991236]}, 'runtime': 44.65944862365723}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 25)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 0)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 0) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 11) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004440858756346598, 'height_shift_range': 0.267, 'batch_size': 24, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.0038465833794067983, 'num_dense_units_0': 152, 'cnn_learning_rate': 1.3197144852527731e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 78}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 14:23:57.726094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 2.5122 - acc: 0.1667 - val_loss: 2.6066 - val_acc: 0.2468
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/8
 - 3s - loss: 2.0987 - acc: 0.3142 - val_loss: 2.2621 - val_acc: 0.2208
Epoch 3/8
 - 3s - loss: 1.4636 - acc: 0.5278 - val_loss: 1.4532 - val_acc: 0.5065
Epoch 4/8
 - 3s - loss: 0.9231 - acc: 0.6936 - val_loss: 2.1447 - val_acc: 0.3636
Epoch 5/8
 - 3s - loss: 0.7991 - acc: 0.7655 - val_loss: 1.4783 - val_acc: 0.5974
Epoch 6/8
 - 3s - loss: 0.8407 - acc: 0.6876 - val_loss: 1.0874 - val_acc: 0.6494
Epoch 7/8
 - 3s - loss: 0.7283 - acc: 0.7455 - val_loss: 1.6769 - val_acc: 0.5714
Epoch 8/8
 - 3s - loss: 0.5591 - acc: 0.8174 - val_loss: 1.4113 - val_acc: 0.5844
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 0)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004440858756346598, 'height_shift_range': 0.267, 'batch_size': 24, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.0038465833794067983, 'num_dense_units_0': 152, 'cnn_learning_rate': 1.3197144852527731e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 78}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.4155844144232861, 'info': {'histories': {'val_loss': [2.6066238167998077, 2.2621367504070333, 1.453233526898669, 2.144748610335511, 1.4782994908171814, 1.0873580845919522, 1.6769371357831089, 1.4113310498076599], 'acc': [0.16666667039195696, 0.31060606918551703, 0.5277778009573618, 0.6884058195611705, 0.7753623464833135, 0.6884058169696642, 0.7463768305985824, 0.8188406021698661], 'loss': [2.5121960639953613, 2.1037134690718218, 1.463610013326009, 0.9214381653329601, 0.7725826450016188, 0.8358285478923632, 0.7357862177102462, 0.5512414963349052], 'val_acc': [0.2467532472370507, 0.2207792234885228, 0.5064935111380243, 0.3636363690549677, 0.5974026020471151, 0.6493506632842027, 0.5714285752990029, 0.5844155855767139]}, 'runtime': 30.141621589660645}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 0)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 11)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 11) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 11) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 30) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 11) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 11)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00016129613316653364, 'height_shift_range': 0.267, 'batch_size': 54, 'num_dense_units_2': 145, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.23354000302710443, 'num_dense_units_0': 193, 'cnn_learning_rate': 0.000191781242617201, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 65}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 14:24:28.428641: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 7s - loss: 2.2998 - acc: 0.1975 - val_loss: 2.2586 - val_acc: 0.1875
Epoch 2/8
 - 5s - loss: 2.0694 - acc: 0.3395 - val_loss: 2.1567 - val_acc: 0.3125
Epoch 3/8
 - 5s - loss: 1.9297 - acc: 0.4691 - val_loss: 2.2381 - val_acc: 0.1562
Epoch 4/8
 - 5s - loss: 1.8247 - acc: 0.5247 - val_loss: 2.2789 - val_acc: 0.2812
Epoch 5/8
 - 5s - loss: 1.7261 - acc: 0.5926 - val_loss: 2.1376 - val_acc: 0.3125
Epoch 6/8
 - 5s - loss: 1.6995 - acc: 0.5741 - val_loss: 1.9937 - val_acc: 0.4062
Epoch 7/8
 - 5s - loss: 1.5633 - acc: 0.7037 - val_loss: 2.0216 - val_acc: 0.3125
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/8
 - 5s - loss: 1.5258 - acc: 0.6852 - val_loss: 1.9897 - val_acc: 0.3750
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 11), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 11) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 11) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 11) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 11)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00016129613316653364, 'height_shift_range': 0.267, 'batch_size': 54, 'num_dense_units_2': 145, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.23354000302710443, 'num_dense_units_0': 193, 'cnn_learning_rate': 0.000191781242617201, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 65}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.625, 'info': {'histories': {'val_loss': [2.2586147785186768, 2.156670570373535, 2.2381210327148438, 2.278919219970703, 2.137561321258545, 1.9936842918395996, 2.0215699672698975, 1.9896628856658936], 'acc': [0.19753087063630423, 0.3395061790943146, 0.4691358208656311, 0.5246913631757101, 0.5925925970077515, 0.5740740895271301, 0.7037037213643392, 0.6851851940155029], 'loss': [2.2998456160227456, 2.069392363230387, 1.9296910762786865, 1.8247390588124592, 1.7261404196421306, 1.6995402177174885, 1.5632963180541992, 1.5258469581604004], 'val_acc': [0.1875, 0.3125, 0.15625, 0.28125, 0.3125, 0.40625, 0.3125, 0.375]}, 'runtime': 43.523224115371704}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 11)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 30)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 30) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 30) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 20) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 30) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 30)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018384570315878026, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_units_2': 130, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.08281874464133102, 'num_dense_units_0': 769, 'cnn_learning_rate': 1.1252978052325498e-05, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 50}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 14:25:11.898369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 2.4675 - acc: 0.1579 - val_loss: 2.0073 - val_acc: 0.2202
Epoch 2/8
 - 3s - loss: 1.8314 - acc: 0.3282 - val_loss: 1.7239 - val_acc: 0.4128
Epoch 3/8
 - 3s - loss: 1.5570 - acc: 0.4821 - val_loss: 1.4657 - val_acc: 0.5138
Epoch 4/8
 - 3s - loss: 1.3769 - acc: 0.5066 - val_loss: 1.3390 - val_acc: 0.5505
Epoch 5/8
 - 3s - loss: 1.2287 - acc: 0.5563 - val_loss: 1.1873 - val_acc: 0.5505
Epoch 6/8
 - 3s - loss: 1.1706 - acc: 0.6188 - val_loss: 1.2013 - val_acc: 0.5229
Epoch 7/8
 - 3s - loss: 0.8528 - acc: 0.7303 - val_loss: 1.2548 - val_acc: 0.5413
Epoch 8/8
 - 3s - loss: 0.8091 - acc: 0.7562 - val_loss: 1.1492 - val_acc: 0.6514
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 30), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 30) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 30) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 30) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 30)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018384570315878026, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_units_2': 130, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.08281874464133102, 'num_dense_units_0': 769, 'cnn_learning_rate': 1.1252978052325498e-05, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 50}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.3486238504768512, 'info': {'histories': {'val_loss': [2.0073273881859737, 1.7239229307262176, 1.4656654716631687, 1.3389519682717979, 1.1873175933820392, 1.2012706131016442, 1.2547528218785557, 1.149179389717382], 'acc': [0.15789473801851273, 0.3432835833127819, 0.4755244903214328, 0.5065789520740509, 0.559440554438771, 0.6268656616335484, 0.7302631586790085, 0.7482517457508541], 'loss': [2.4675473868846893, 1.8304556421379545, 1.5784407737371804, 1.3769438117742538, 1.2222011556158532, 1.153823682176533, 0.8527994453907013, 0.8313431819002112], 'val_acc': [0.22018349061318493, 0.41284403943140574, 0.5137614711708979, 0.5504587194241515, 0.5504587183304883, 0.522935783644335, 0.5412844080443776, 0.6513761495231488]}, 'runtime': 30.75596857070923}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 30)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 20)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 20) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 31) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 20) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (1, 0, 20) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 20)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.007950523324340406, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.04777981862573932, 'num_dense_units_0': 886, 'cnn_learning_rate': 0.00027010778969882874, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 388}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 14:25:42.249007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 2.5802 - acc: 0.1086 - val_loss: 2.3506 - val_acc: 0.1299
Epoch 2/8
 - 3s - loss: 2.1675 - acc: 0.2072 - val_loss: 2.1378 - val_acc: 0.2208
Epoch 3/8
 - 3s - loss: 1.9813 - acc: 0.3182 - val_loss: 2.0840 - val_acc: 0.2078
Epoch 4/8
 - 3s - loss: 1.7077 - acc: 0.4269 - val_loss: 1.7725 - val_acc: 0.3896
Epoch 5/8
 - 3s - loss: 1.6486 - acc: 0.4545 - val_loss: 1.7033 - val_acc: 0.4416
Epoch 6/8
 - 3s - loss: 1.4287 - acc: 0.6416 - val_loss: 1.6579 - val_acc: 0.4286
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 7/8
 - 3s - loss: 1.3065 - acc: 0.6512 - val_loss: 1.4421 - val_acc: 0.5844
Epoch 8/8
 - 3s - loss: 1.2478 - acc: 0.6679 - val_loss: 1.4849 - val_acc: 0.4545
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 20), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 20) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 20) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 20) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 20)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.007950523324340406, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.04777981862573932, 'num_dense_units_0': 886, 'cnn_learning_rate': 0.00027010778969882874, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 388}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.545454539261855, 'info': {'histories': {'val_loss': [2.3505924707883366, 2.137809982547512, 2.084003457775364, 1.7725063686246996, 1.7033304007022412, 1.6579381800317146, 1.4421432173097288, 1.4848766822319526], 'acc': [0.10714285778147833, 0.2142857204590525, 0.318181825535638, 0.46031747569167425, 0.4545454723494394, 0.6214285978249141, 0.6642857262066433, 0.6500000085149492], 'loss': [2.5747255768094743, 2.165299456460135, 1.9812867982046944, 1.6768506159858099, 1.6486102512904577, 1.441690422807421, 1.2924715501921518, 1.2720730100359237], 'val_acc': [0.12987012987012986, 0.22077922174682865, 0.20779220827601172, 0.38961039580308, 0.4415584469770456, 0.42857143476411896, 0.5844155890601022, 0.4545454607381449]}, 'runtime': 28.81947159767151}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 20)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 31)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 31) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 31) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 14) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 31)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00023354944563865797, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 60, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.06200883009933965, 'num_dense_units_0': 233, 'cnn_learning_rate': 0.0004317622731304309, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 264}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 14:26:16.704353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 7s - loss: 2.4581 - acc: 0.1731 - val_loss: 2.0895 - val_acc: 0.1250
Epoch 2/8
 - 5s - loss: 2.3600 - acc: 0.1486 - val_loss: 2.2601 - val_acc: 0.0938
Epoch 3/8
 - 4s - loss: 2.0459 - acc: 0.1740 - val_loss: 2.1838 - val_acc: 0.1875
Epoch 4/8
 - 5s - loss: 2.1406 - acc: 0.1903 - val_loss: 2.4837 - val_acc: 0.0938
Epoch 5/8
 - 5s - loss: 2.0546 - acc: 0.2885 - val_loss: 2.0280 - val_acc: 0.3438
Epoch 6/8
 - 5s - loss: 1.8493 - acc: 0.4156 - val_loss: 2.1916 - val_acc: 0.1562
Epoch 7/8
 - 5s - loss: 1.7811 - acc: 0.4291 - val_loss: 2.7340 - val_acc: 0.0938
Epoch 8/8
 - 5s - loss: 1.9288 - acc: 0.3269 - val_loss: 1.8154 - val_acc: 0.4062
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 31), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 31) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 31) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 31)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00023354944563865797, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 60, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.06200883009933965, 'num_dense_units_0': 233, 'cnn_learning_rate': 0.0004317622731304309, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 264}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.59375, 'info': {'histories': {'val_loss': [2.089508056640625, 2.260084629058838, 2.1837995052337646, 2.483734607696533, 2.0280137062072754, 2.1915955543518066, 2.7339625358581543, 1.8154202699661255], 'acc': [0.17307692766189575, 0.1788617933123577, 0.17777778853972753, 0.1951219592152572, 0.28846155293285847, 0.39837399924673683, 0.41463416087918165, 0.3269230956211686], 'loss': [2.4580514430999756, 2.34733133781247, 2.1789671818415326, 2.1417306574379524, 2.054641366004944, 1.8814424857860659, 1.8052859800617869, 1.9287753105163574], 'val_acc': [0.125, 0.09375, 0.1875, 0.09375, 0.34375, 0.15625, 0.09375, 0.40625]}, 'runtime': 52.0535774230957}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 31)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 14)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 14) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 14) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 14) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 14)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0009522697489374414, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.22282762238898463, 'num_dense_units_0': 393, 'cnn_learning_rate': 0.0003409059968597692, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 330}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 14:27:05.534374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 8s - loss: 2.3885 - acc: 0.1382 - val_loss: 2.2866 - val_acc: 0.2110
Epoch 2/8
 - 4s - loss: 2.0513 - acc: 0.2910 - val_loss: 2.1181 - val_acc: 0.2844
Epoch 3/8
 - 4s - loss: 1.9298 - acc: 0.3092 - val_loss: 1.9969 - val_acc: 0.3211
Epoch 4/8
 - 4s - loss: 1.5759 - acc: 0.4842 - val_loss: 1.6865 - val_acc: 0.3761
Epoch 5/8
 - 4s - loss: 1.4903 - acc: 0.4795 - val_loss: 1.7045 - val_acc: 0.3761
Epoch 6/8
 - 4s - loss: 1.2357 - acc: 0.5920 - val_loss: 1.6087 - val_acc: 0.5505
Epoch 7/8
 - 4s - loss: 1.1783 - acc: 0.5855 - val_loss: 1.3504 - val_acc: 0.4954
Epoch 8/8
 - 4s - loss: 1.2734 - acc: 0.5364 - val_loss: 1.6426 - val_acc: 0.5138
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 14), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 14) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 14) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 14) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 14)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0009522697489374414, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.22282762238898463, 'num_dense_units_0': 393, 'cnn_learning_rate': 0.0003409059968597692, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 330}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.4862385239076177, 'info': {'histories': {'val_loss': [2.2865713889445733, 2.118090957676599, 1.9968630994131806, 1.6865337704299788, 1.704467504396351, 1.6086882123159707, 1.3503908607937873, 1.642622645841826], 'acc': [0.1381578929722309, 0.31343284249305725, 0.30921052955091, 0.5000000046705132, 0.4895104928450151, 0.5804195802111726, 0.5855263285338879, 0.5384615461726289], 'loss': [2.3884840309619904, 2.025351468306869, 1.9297648221254349, 1.567604096078161, 1.4872436640145896, 1.2564193752262143, 1.1783212795853615, 1.2746940626131071], 'val_acc': [0.21100917567900562, 0.28440367109184966, 0.3211009218058455, 0.3761467909047363, 0.3761467933654785, 0.5504587243456359, 0.49541284731768687, 0.5137614760923823]}, 'runtime': 44.10968828201294}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 14)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 2)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 2) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 25) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 2) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000159986876398245, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.17379389206881155, 'num_dense_units_0': 337, 'cnn_learning_rate': 1.286200440573248e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 313}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:27:48.885739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 7s - loss: 2.2002 - acc: 0.2099 - val_loss: 2.4355 - val_acc: 0.0734
Epoch 2/4
 - 4s - loss: 1.6972 - acc: 0.4198 - val_loss: 2.5436 - val_acc: 0.0734
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/4
 - 4s - loss: 1.3189 - acc: 0.6049 - val_loss: 2.5433 - val_acc: 0.1009
Epoch 4/4
 - 4s - loss: 1.0420 - acc: 0.7222 - val_loss: 2.6528 - val_acc: 0.0826
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 2)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000159986876398245, 'height_shift_range': 0.267, 'batch_size': 18, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.17379389206881155, 'num_dense_units_0': 337, 'cnn_learning_rate': 1.286200440573248e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 313}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.9174311926605505, 'info': {'histories': {'val_loss': [2.435452964327751, 2.5436019569361976, 2.543279063810996, 2.6528472572291664], 'acc': [0.20987654849886894, 0.4197531019647916, 0.604938288529714, 0.7222222354676988], 'loss': [2.200190875265333, 1.6971596876780193, 1.3188718557357788, 1.0420217315355937], 'val_acc': [0.07339449575461379, 0.07339449575461379, 0.10091743119266056, 0.08256880733944955]}, 'runtime': 26.713862895965576}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 25)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 25) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 25) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 0) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 25) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 25)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008316085126480701, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 28, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.21998130902293425, 'num_dense_units_0': 288, 'cnn_learning_rate': 8.231586126347911e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 410}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 14:28:15.308597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 6s - loss: 2.8236 - acc: 0.1429 - val_loss: 2.1803 - val_acc: 0.2987
Epoch 2/16
 - 5s - loss: 2.1715 - acc: 0.2532 - val_loss: 2.1762 - val_acc: 0.1299
Epoch 3/16
 - 5s - loss: 2.0806 - acc: 0.2403 - val_loss: 1.8470 - val_acc: 0.4805
Epoch 4/16
 - 4s - loss: 2.0152 - acc: 0.3833 - val_loss: 1.8538 - val_acc: 0.4935
Epoch 5/16
 - 5s - loss: 1.6522 - acc: 0.4606 - val_loss: 2.1614 - val_acc: 0.1948
Epoch 6/16
 - 5s - loss: 1.4442 - acc: 0.5330 - val_loss: 1.8620 - val_acc: 0.3766
Epoch 7/16
 - 5s - loss: 1.5274 - acc: 0.4275 - val_loss: 1.7791 - val_acc: 0.2727
Epoch 8/16
 - 5s - loss: 1.0965 - acc: 0.6429 - val_loss: 1.6356 - val_acc: 0.3766
Epoch 9/16
 - 5s - loss: 1.2658 - acc: 0.5986 - val_loss: 2.1203 - val_acc: 0.2468
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 10/16
 - 5s - loss: 1.1288 - acc: 0.6446 - val_loss: 1.5510 - val_acc: 0.4286
Epoch 11/16
 - 5s - loss: 0.8564 - acc: 0.7792 - val_loss: 1.5252 - val_acc: 0.4675
Epoch 12/16
 - 5s - loss: 0.9758 - acc: 0.6544 - val_loss: 1.7482 - val_acc: 0.3506
Epoch 13/16
 - 5s - loss: 1.0823 - acc: 0.6645 - val_loss: 1.6931 - val_acc: 0.3377
Epoch 14/16
 - 5s - loss: 0.9758 - acc: 0.6968 - val_loss: 1.2456 - val_acc: 0.5455
Epoch 15/16
 - 5s - loss: 0.9713 - acc: 0.7013 - val_loss: 1.0491 - val_acc: 0.6623
Epoch 16/16
 - 5s - loss: 0.8370 - acc: 0.7138 - val_loss: 1.0109 - val_acc: 0.6753
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 25), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 25) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 25) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 25) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 25)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008316085126480701, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 28, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.21998130902293425, 'num_dense_units_0': 288, 'cnn_learning_rate': 8.231586126347911e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 410}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.32467531228994395, 'info': {'histories': {'val_loss': [2.1803016321999684, 2.176243007957161, 1.847049161985323, 1.8537682170991774, 2.1613847713965875, 1.8620232513972692, 1.7790839826905882, 1.6355546681911914, 2.1202675785337175, 1.551011774447057, 1.5252107304412048, 1.7482033395147942, 1.6930791278938195, 1.2456110204969133, 1.0490846293313163, 1.0109315290079488], 'acc': [0.14285714711461747, 0.23015873559883662, 0.24025974103382655, 0.3730158746715576, 0.45714286054883685, 0.5142857283353806, 0.4428571603127888, 0.6428571513720921, 0.6071428720440183, 0.6571428852421897, 0.7792208109583173, 0.6785714481558118, 0.6571428707667759, 0.7222222468209645, 0.701298713684082, 0.7214286012308938], 'loss': [2.8235988276345387, 2.2137278110261946, 2.0806020157677785, 2.053731360132732, 1.6754350304603576, 1.468849652154105, 1.5278161542756217, 1.0965105550629752, 1.2355215276990619, 1.0943057579653603, 0.8563646674156189, 0.9514460844652993, 1.0838496208190918, 0.9315515311937483, 0.9712655459131513, 0.8478390063558306], 'val_acc': [0.29870130063651446, 0.12987012987012986, 0.4805194824546963, 0.4935065074400468, 0.19480519577280267, 0.376623382816067, 0.2727272736948806, 0.3766233771071806, 0.2467532486884625, 0.4285714332159464, 0.4675324721769853, 0.35064935451978213, 0.33766234230685543, 0.5454545500990632, 0.6623376669821801, 0.675324687710056]}, 'runtime': 81.62348198890686}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 25)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 0) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 30) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004440858756346598, 'height_shift_range': 0.267, 'batch_size': 24, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.0038465833794067983, 'num_dense_units_0': 152, 'cnn_learning_rate': 1.3197144852527731e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 78}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 14:29:36.006252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 5s - loss: 2.7822 - acc: 0.1437 - val_loss: 2.5706 - val_acc: 0.1948
Epoch 2/16
 - 3s - loss: 2.0038 - acc: 0.3872 - val_loss: 1.7528 - val_acc: 0.3506
Epoch 3/16
 - 3s - loss: 1.4638 - acc: 0.4631 - val_loss: 1.5314 - val_acc: 0.4805
Epoch 4/16
 - 3s - loss: 1.2415 - acc: 0.5556 - val_loss: 1.3583 - val_acc: 0.5714
Epoch 5/16
 - 3s - loss: 1.0834 - acc: 0.6344 - val_loss: 1.2461 - val_acc: 0.5325
Epoch 6/16
 - 3s - loss: 0.8493 - acc: 0.7083 - val_loss: 1.1227 - val_acc: 0.5584
Epoch 7/16
 - 3s - loss: 0.7143 - acc: 0.7685 - val_loss: 0.9498 - val_acc: 0.7273
Epoch 8/16
 - 3s - loss: 0.7575 - acc: 0.7361 - val_loss: 0.9847 - val_acc: 0.7273
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 9/16
 - 3s - loss: 0.6378 - acc: 0.7841 - val_loss: 1.0186 - val_acc: 0.7273
Epoch 10/16
 - 3s - loss: 0.4941 - acc: 0.8611 - val_loss: 1.0492 - val_acc: 0.6623
Epoch 11/16
 - 3s - loss: 0.4040 - acc: 0.8653 - val_loss: 0.6979 - val_acc: 0.8052
Epoch 12/16
 - 3s - loss: 0.3242 - acc: 0.8872 - val_loss: 1.1630 - val_acc: 0.6883
Epoch 13/16
 - 3s - loss: 0.4009 - acc: 0.8822 - val_loss: 0.9341 - val_acc: 0.7013
Epoch 14/16
 - 3s - loss: 0.3995 - acc: 0.8473 - val_loss: 1.0125 - val_acc: 0.7013
Epoch 15/16
 - 3s - loss: 0.2321 - acc: 0.9401 - val_loss: 1.0070 - val_acc: 0.6753
Epoch 16/16
 - 3s - loss: 0.2127 - acc: 0.9172 - val_loss: 1.0143 - val_acc: 0.7273
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 0)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004440858756346598, 'height_shift_range': 0.267, 'batch_size': 24, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.0038465833794067983, 'num_dense_units_0': 152, 'cnn_learning_rate': 1.3197144852527731e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 78}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.2727272696309275, 'info': {'histories': {'val_loss': [2.570636167154684, 1.7528473061400573, 1.5313607160147134, 1.358280991579031, 1.2460661847870071, 1.122665697103971, 0.9497828197169613, 0.9846644324141663, 1.0185949291501726, 1.0491858937523582, 0.6979073587950174, 1.1629738188409187, 0.9340657282185245, 1.0125389919652568, 1.006954024364422, 1.014338951606255], 'acc': [0.14492753698774005, 0.3913043633751247, 0.46376812846764276, 0.5555555721124014, 0.6212121356617321, 0.7083333532015482, 0.7681159713993901, 0.7361111243565878, 0.7803030555898492, 0.8611111442248026, 0.8623188656309376, 0.8913043737411499, 0.884057993474214, 0.8478261128715847, 0.9420289967371069, 0.9202898740768433], 'loss': [2.7929211077482803, 2.000089458797289, 1.4630927624909773, 1.2414531509081523, 1.1051429374651476, 0.8493406971295675, 0.720947908318561, 0.7574903219938278, 0.649146090854298, 0.4940939247608185, 0.4069921633471613, 0.3172331970670949, 0.3973898524823396, 0.399920888569044, 0.2300367251686428, 0.2061340815347174], 'val_acc': [0.19480519674041055, 0.350649356842041, 0.48051948168061, 0.5714285760730892, 0.5324675448529133, 0.5584415630860762, 0.7272727388840217, 0.7272727303690725, 0.727272739658108, 0.6623376654340075, 0.8051948160320134, 0.6883116999229828, 0.701298713684082, 0.7012987043950465, 0.6753246799691931, 0.7272727303690725]}, 'runtime': 53.41997146606445}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 0)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 30)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 30) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 30) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 14) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 30) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 30)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018384570315878026, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_units_2': 130, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.08281874464133102, 'num_dense_units_0': 769, 'cnn_learning_rate': 1.1252978052325498e-05, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 50}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 14:30:29.917480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 5s - loss: 2.4986 - acc: 0.1524 - val_loss: 2.4019 - val_acc: 0.1835
Epoch 2/16
 - 3s - loss: 2.2056 - acc: 0.1987 - val_loss: 1.8623 - val_acc: 0.4128
Epoch 3/16
 - 3s - loss: 1.7417 - acc: 0.4080 - val_loss: 1.6321 - val_acc: 0.4679
Epoch 4/16
 - 3s - loss: 1.4025 - acc: 0.5263 - val_loss: 1.3473 - val_acc: 0.5138
Epoch 5/16
 - 3s - loss: 1.2668 - acc: 0.5259 - val_loss: 1.3111 - val_acc: 0.5229
Epoch 6/16
 - 3s - loss: 1.1237 - acc: 0.5657 - val_loss: 1.6286 - val_acc: 0.5688
Epoch 7/16
 - 3s - loss: 0.9899 - acc: 0.6742 - val_loss: 1.3003 - val_acc: 0.5780
Epoch 8/16
 - 3s - loss: 0.8010 - acc: 0.7007 - val_loss: 0.9391 - val_acc: 0.7248
Epoch 9/16
 - 3s - loss: 0.5846 - acc: 0.8252 - val_loss: 1.0177 - val_acc: 0.6330
Epoch 10/16
 - 3s - loss: 0.3556 - acc: 0.9271 - val_loss: 0.9942 - val_acc: 0.6881
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 11/16
 - 3s - loss: 0.5463 - acc: 0.8120 - val_loss: 1.3121 - val_acc: 0.6514
Epoch 12/16
 - 3s - loss: 0.3183 - acc: 0.9152 - val_loss: 1.2511 - val_acc: 0.6697
Epoch 13/16
 - 3s - loss: 0.4536 - acc: 0.8238 - val_loss: 1.2229 - val_acc: 0.6606
Epoch 14/16
 - 3s - loss: 0.5645 - acc: 0.8224 - val_loss: 1.2008 - val_acc: 0.6881
Epoch 15/16
 - 3s - loss: 0.6302 - acc: 0.7629 - val_loss: 1.2712 - val_acc: 0.6422
Epoch 16/16
 - 3s - loss: 0.4410 - acc: 0.8622 - val_loss: 1.4722 - val_acc: 0.6147
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 30), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 30) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 30) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 30) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 30)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018384570315878026, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_units_2': 130, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.08281874464133102, 'num_dense_units_0': 769, 'cnn_learning_rate': 1.1252978052325498e-05, 'cnn_unlock_epoch': 22, 'num_dense_units_1': 50}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.38532109654277835, 'info': {'histories': {'val_loss': [2.4018782891264747, 1.862300733907507, 1.6321186056924522, 1.3472969947604958, 1.3111231152070772, 1.6285867712913302, 1.3003198903635007, 0.9390582950837022, 1.0177336395333667, 0.9942174865565169, 1.3121345065055636, 1.2511145062402849, 1.222892614679599, 1.200800293082491, 1.271207105129137, 1.4721881971446746], 'acc': [0.16083916401738055, 0.2097902083834568, 0.4195804247906158, 0.526315800845623, 0.5384615372110914, 0.580419593340867, 0.6783216758207842, 0.7062937000414709, 0.8321678371696205, 0.9230769472522335, 0.8181818290190264, 0.9160839227529672, 0.8251748455987944, 0.822368435561657, 0.7552447735846459, 0.8601398743115939], 'loss': [2.5064620738262895, 2.1883291131132965, 1.7251131284486998, 1.402541160583496, 1.2640680633224808, 1.0967655086017156, 0.9543434631574405, 0.7944013643098045, 0.5452274111184207, 0.35995259422522324, 0.5369139632561823, 0.3077619488422687, 0.4556209352258202, 0.5644526220858097, 0.6475201749301457, 0.4457652141581048], 'val_acc': [0.1834862392156496, 0.41284404052506896, 0.46788990907712813, 0.5137614711708979, 0.5229357806367612, 0.5688073416368677, 0.5779816535634732, 0.7247706449359929, 0.6330275311382538, 0.6880733972295708, 0.6513761495231488, 0.6697247728295282, 0.6605504609029228, 0.6880734032447186, 0.642201843611691, 0.6146789034572216]}, 'runtime': 56.25172233581543}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 30)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 14)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 14) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 14) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 3) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 14) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 14)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0009522697489374414, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.22282762238898463, 'num_dense_units_0': 393, 'cnn_learning_rate': 0.0003409059968597692, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 330}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 14:31:27.642552: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 6s - loss: 2.4454 - acc: 0.1789 - val_loss: 2.4114 - val_acc: 0.1193
Epoch 2/16
 - 4s - loss: 2.2741 - acc: 0.2013 - val_loss: 2.1856 - val_acc: 0.1927
Epoch 3/16
 - 5s - loss: 2.0062 - acc: 0.2632 - val_loss: 2.2295 - val_acc: 0.2661
Epoch 4/16
 - 4s - loss: 1.8409 - acc: 0.3431 - val_loss: 1.8926 - val_acc: 0.3853
Epoch 5/16
 - 4s - loss: 1.5510 - acc: 0.4755 - val_loss: 1.7726 - val_acc: 0.4587
Epoch 6/16
 - 4s - loss: 1.4856 - acc: 0.4690 - val_loss: 1.7131 - val_acc: 0.4587
Epoch 7/16
 - 4s - loss: 1.3505 - acc: 0.6212 - val_loss: 1.5977 - val_acc: 0.4771
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/16
 - 5s - loss: 1.0487 - acc: 0.6842 - val_loss: 1.5488 - val_acc: 0.5321
Epoch 9/16
 - 4s - loss: 0.9512 - acc: 0.7218 - val_loss: 1.2985 - val_acc: 0.5872
Epoch 10/16
 - 4s - loss: 1.1905 - acc: 0.6292 - val_loss: 1.1451 - val_acc: 0.6789
Epoch 11/16
 - 4s - loss: 0.8300 - acc: 0.6966 - val_loss: 1.1580 - val_acc: 0.5780
Epoch 12/16
 - 5s - loss: 0.7703 - acc: 0.7566 - val_loss: 1.3782 - val_acc: 0.5780
Epoch 13/16
 - 4s - loss: 0.9572 - acc: 0.7400 - val_loss: 1.2776 - val_acc: 0.6239
Epoch 14/16
 - 4s - loss: 0.6914 - acc: 0.8357 - val_loss: 1.0992 - val_acc: 0.6239
Epoch 15/16
 - 5s - loss: 0.5353 - acc: 0.8487 - val_loss: 1.0415 - val_acc: 0.6606
Epoch 16/16
 - 4s - loss: 0.6749 - acc: 0.8106 - val_loss: 1.5573 - val_acc: 0.4954
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 14), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 14) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 14) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 14) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 14)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0009522697489374414, 'height_shift_range': 0.267, 'batch_size': 19, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.22282762238898463, 'num_dense_units_0': 393, 'cnn_learning_rate': 0.0003409059968597692, 'cnn_unlock_epoch': 23, 'num_dense_units_1': 330}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.5045871545962237, 'info': {'histories': {'val_loss': [2.4114424416778286, 2.185582786525061, 2.229539077216332, 1.8926160335540771, 1.772604063016559, 1.7131480350406891, 1.5976999484070944, 1.5488037570900874, 1.2984945741268472, 1.1450788340437303, 1.1579521238257031, 1.3781764529166964, 1.277554623577573, 1.0991502453427795, 1.0414679247304934, 1.5572668434283055], 'acc': [0.18881119120787906, 0.19580419497056442, 0.2631578929722309, 0.35664335737278413, 0.46853147040713916, 0.48951050211916436, 0.6119403094053268, 0.684210516512394, 0.7062937179645459, 0.6363636349047814, 0.6853146853146853, 0.7565789520740509, 0.7388059790454694, 0.8321678263324124, 0.8486842066049576, 0.8059701523674068], 'loss': [2.450798304764541, 2.2710795602598393, 2.0061998069286346, 1.8165584802627563, 1.5485817319029695, 1.4534475319869036, 1.3660430321052892, 1.0487026795744896, 0.963349028483971, 1.1860380806289352, 0.8506349112604048, 0.7702812552452087, 0.9078184370674304, 0.7075535067311534, 0.5352504514157772, 0.6837324773642555], 'val_acc': [0.11926605538764132, 0.1926605518257946, 0.26605504621332937, 0.3853211022845102, 0.45871560070492806, 0.45871559961126485, 0.47706422346447586, 0.5321100955709405, 0.5871559720520579, 0.6788990924117762, 0.5779816612191156, 0.5779816546571364, 0.6238532142901639, 0.6238532192116484, 0.660550467464902, 0.4954128454037763]}, 'runtime': 79.91854119300842}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 14)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 3)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 3) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 3) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 25) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 3) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 3)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00036925746793634875, 'height_shift_range': 0.267, 'batch_size': 57, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.27858313369105064, 'num_dense_units_0': 380, 'cnn_learning_rate': 5.280656076249799e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 415}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:32:47.101262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 4s - loss: 2.4122 - acc: 0.1250 - val_loss: 2.4205 - val_acc: 0.1250
Epoch 2/4
 - 3s - loss: 2.4552 - acc: 0.1091 - val_loss: 2.4608 - val_acc: 0.0312
Epoch 3/4
 - 3s - loss: 2.4103 - acc: 0.1053 - val_loss: 2.4351 - val_acc: 0.1250
Epoch 4/4
 - 3s - loss: 2.4377 - acc: 0.0965 - val_loss: 2.4107 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 3) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 3)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00036925746793634875, 'height_shift_range': 0.267, 'batch_size': 57, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.27858313369105064, 'num_dense_units_0': 380, 'cnn_learning_rate': 5.280656076249799e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 415}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.420464038848877, 2.460793972015381, 2.4350523948669434, 2.41074275970459], 'acc': [0.12380952877657754, 0.10476190490382058, 0.10526315867900848, 0.09649122878909111], 'loss': [2.409192977632795, 2.4560101236615863, 2.410260796546936, 2.437744140625], 'val_acc': [0.125, 0.03125, 0.125, 0.09375]}, 'runtime': 18.560062408447266}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 3)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 25)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 25) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 25) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 0) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 25) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 25)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008316085126480701, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 28, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.21998130902293425, 'num_dense_units_0': 288, 'cnn_learning_rate': 8.231586126347911e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 410}, 'working_directory': '.', 'budget': 32.0}
2018-02-08 14:33:05.387204: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/29
 - 7s - loss: 2.7850 - acc: 0.1039 - val_loss: 2.3593 - val_acc: 0.1818
Epoch 2/29
 - 5s - loss: 2.2776 - acc: 0.1976 - val_loss: 2.1084 - val_acc: 0.2727
Epoch 3/29
 - 5s - loss: 1.9977 - acc: 0.3597 - val_loss: 2.0573 - val_acc: 0.1429
Epoch 4/29
 - 5s - loss: 2.0611 - acc: 0.3223 - val_loss: 1.8866 - val_acc: 0.2468
Epoch 5/29
 - 5s - loss: 1.8057 - acc: 0.3914 - val_loss: 2.0889 - val_acc: 0.2078
Epoch 6/29
 - 5s - loss: 1.5881 - acc: 0.4112 - val_loss: 1.9819 - val_acc: 0.3117
Epoch 7/29
 - 5s - loss: 1.2754 - acc: 0.5779 - val_loss: 1.8068 - val_acc: 0.3506
Epoch 8/29
 - 5s - loss: 1.0401 - acc: 0.6480 - val_loss: 1.8109 - val_acc: 0.3636
Epoch 9/29
 - 5s - loss: 1.1700 - acc: 0.6558 - val_loss: 1.4769 - val_acc: 0.4675
Epoch 10/29
 - 5s - loss: 1.1424 - acc: 0.6086 - val_loss: 1.3759 - val_acc: 0.4935
Epoch 11/29
 - 5s - loss: 0.9316 - acc: 0.6974 - val_loss: 1.7363 - val_acc: 0.3117
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 12/29
 - 5s - loss: 1.0514 - acc: 0.6135 - val_loss: 1.0224 - val_acc: 0.7792
Epoch 13/29
 - 5s - loss: 0.9743 - acc: 0.6753 - val_loss: 1.5644 - val_acc: 0.4286
Epoch 14/29
 - 5s - loss: 1.2042 - acc: 0.5168 - val_loss: 1.2714 - val_acc: 0.6494
Epoch 15/29
 - 5s - loss: 0.7854 - acc: 0.7338 - val_loss: 0.9927 - val_acc: 0.7013
Epoch 16/29
 - 5s - loss: 0.9345 - acc: 0.7073 - val_loss: 1.1084 - val_acc: 0.6883
Epoch 17/29
 - 5s - loss: 0.7311 - acc: 0.8157 - val_loss: 1.1359 - val_acc: 0.5714
Epoch 18/29
 - 5s - loss: 0.9601 - acc: 0.6546 - val_loss: 0.9511 - val_acc: 0.6883
Epoch 19/29
 - 5s - loss: 0.6207 - acc: 0.8182 - val_loss: 0.9632 - val_acc: 0.7143
Epoch 20/29
 - 5s - loss: 0.7935 - acc: 0.7631 - val_loss: 0.8642 - val_acc: 0.7273
Epoch 21/29
 - 5s - loss: 0.6978 - acc: 0.8387 - val_loss: 1.0554 - val_acc: 0.6494
Epoch 22/29
 - 5s - loss: 0.7719 - acc: 0.7799 - val_loss: 0.9851 - val_acc: 0.7143
Epoch 23/29
 - 5s - loss: 0.7624 - acc: 0.7631 - val_loss: 0.9266 - val_acc: 0.7143
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 24/29
 - 5s - loss: 0.6454 - acc: 0.8117 - val_loss: 0.9647 - val_acc: 0.6753
Epoch 25/29
 - 5s - loss: 0.5919 - acc: 0.8191 - val_loss: 0.7808 - val_acc: 0.7792
Epoch 26/29
 - 5s - loss: 0.8817 - acc: 0.7006 - val_loss: 0.9988 - val_acc: 0.6623
Epoch 27/29
 - 5s - loss: 0.6351 - acc: 0.7829 - val_loss: 0.9260 - val_acc: 0.6623
Epoch 28/29
 - 5s - loss: 0.6569 - acc: 0.8117 - val_loss: 0.7767 - val_acc: 0.7662
Epoch 29/29
 - 5s - loss: 0.4216 - acc: 0.8749 - val_loss: 0.7743 - val_acc: 0.7403
{'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008316085126480701, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 28, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.21998130902293425, 'num_dense_units_0': 288, 'cnn_learning_rate': 8.231586126347911e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 410}

 ****** Xception unfrozen 2 top blocks, cut_off after layer 115 ******
Epoch 1/3
 - 6s - loss: 0.5135 - acc: 0.8882 - val_loss: 0.7662 - val_acc: 0.7403
Epoch 2/3
 - 5s - loss: 0.5593 - acc: 0.8518 - val_loss: 0.7542 - val_acc: 0.7532
Epoch 3/3
 - 5s - loss: 0.5075 - acc: 0.8783 - val_loss: 0.7447 - val_acc: 0.7273
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 25), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 25) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 25) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 25) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 25)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008316085126480701, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 28, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.21998130902293425, 'num_dense_units_0': 288, 'cnn_learning_rate': 8.231586126347911e-05, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 410}, 'working_directory': '.', 'budget': 32.0}
result: {'loss': 0.27272726111597834, 'info': {'histories': {'val_loss': [2.359307128113586, 2.1083652756430884, 2.057266885584051, 1.886593261322418, 2.0888975409718302, 1.981895214551455, 1.8068069637595834, 1.8109132748145562, 1.4768563090980826, 1.3758786359390656, 1.736280902639612, 1.0224459449966232, 1.5643730844770158, 1.2713990017965242, 0.9927154175646893, 1.1084432632892163, 1.135947054082697, 0.9510794367109027, 0.9632370286173635, 0.8641628561081824, 1.0553960026084603, 0.9850756224099692, 0.9266236354778339, 0.9646614364215306, 0.7807633311717541, 0.9988157671767396, 0.9259925198245358, 0.7766825905093899, 0.7743050533455688, 0.7661750316619873, 0.7541978428890179, 0.7446532272673273], 'acc': [0.10389610699244908, 0.17142857568604605, 0.3095238111794941, 0.32857143559626173, 0.3928571539265769, 0.4142857259937695, 0.5779220972742353, 0.6500000136239188, 0.6558441690036229, 0.6071428741727557, 0.6928571598870413, 0.6349206623576936, 0.6753246869359698, 0.5317460407340338, 0.7337662577629089, 0.6928571666990008, 0.8214286063398634, 0.6571428780044828, 0.8181818468230111, 0.7642857193946838, 0.8571428886481693, 0.7619047865035042, 0.764285728761128, 0.8116883380072457, 0.8142857440880367, 0.70714288183621, 0.785714317219598, 0.8116883380072457, 0.8857143061501639, 0.8785714507102966, 0.8714285893099648, 0.8785714532647814], 'loss': [2.7850116661616733, 2.303317642211914, 2.0824146687038363, 2.0613389577184407, 1.8083003793443952, 1.5885025773729597, 1.2754207338605608, 1.0431116257395063, 1.1700490372521537, 1.154475837945938, 0.9426120059830801, 1.0270884765519037, 0.9742865988186428, 1.187157812572661, 0.7853579521179199, 0.9564080459730966, 0.6938202440738678, 0.9580491219248091, 0.6207083463668823, 0.7921311003821236, 0.6430338914905276, 0.8286016791585892, 0.7554817101785115, 0.6453643654073987, 0.6022416080747331, 0.884477322442191, 0.6396805822849274, 0.6569060725825173, 0.4261878775698798, 0.5262538126536778, 0.49421187724385945, 0.4854387313127518], 'val_acc': [0.18181818801087218, 0.2727272746624885, 0.14285714382475073, 0.24675324946254878, 0.20779220875981566, 0.31168831265591956, 0.35064935335865266, 0.36363636402340677, 0.4675324706288127, 0.4935065074400468, 0.31168831362352745, 0.7792207908320736, 0.428571429732558, 0.6493506617360301, 0.701298713684082, 0.6883116929562061, 0.5714285768471755, 0.6883116929562061, 0.7142857181561457, 0.7272727303690725, 0.6493506547692535, 0.7142857181561457, 0.7142857173820595, 0.675324687710056, 0.7792207823171244, 0.6623376747230431, 0.6623376762712156, 0.766233778619147, 0.7402597518710347, 0.7402597541932936, 0.7532467563430985, 0.7272727388840217]}, 'runtime': 167.56963348388672}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 25)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 0) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 4) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004440858756346598, 'height_shift_range': 0.267, 'batch_size': 24, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.0038465833794067983, 'num_dense_units_0': 152, 'cnn_learning_rate': 1.3197144852527731e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 78}, 'working_directory': '.', 'budget': 32.0}
2018-02-08 14:35:52.030374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/21
 - 5s - loss: 2.6303 - acc: 0.1826 - val_loss: 2.0041 - val_acc: 0.2078
Epoch 2/21
 - 3s - loss: 1.9335 - acc: 0.4092 - val_loss: 1.9804 - val_acc: 0.2078
Epoch 3/21
 - 3s - loss: 1.3265 - acc: 0.5688 - val_loss: 1.5401 - val_acc: 0.5325
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/21
 - 3s - loss: 0.8992 - acc: 0.7014 - val_loss: 1.4664 - val_acc: 0.4805
Epoch 5/21
 - 3s - loss: 0.8455 - acc: 0.7376 - val_loss: 1.2350 - val_acc: 0.6234
Epoch 6/21
 - 3s - loss: 0.5651 - acc: 0.8233 - val_loss: 1.0023 - val_acc: 0.6494
Epoch 7/21
 - 3s - loss: 0.7301 - acc: 0.7355 - val_loss: 1.2536 - val_acc: 0.6104
Epoch 8/21
 - 3s - loss: 0.6572 - acc: 0.7500 - val_loss: 0.8348 - val_acc: 0.7662
Epoch 9/21
 - 3s - loss: 0.7858 - acc: 0.7630 - val_loss: 0.9955 - val_acc: 0.7013
Epoch 10/21
 - 3s - loss: 0.7036 - acc: 0.7639 - val_loss: 0.9364 - val_acc: 0.7013
Epoch 11/21
 - 3s - loss: 0.4821 - acc: 0.8034 - val_loss: 0.8646 - val_acc: 0.7532
Epoch 12/21
 - 3s - loss: 0.5333 - acc: 0.8104 - val_loss: 0.7544 - val_acc: 0.7662
Epoch 13/21
 - 3s - loss: 0.4089 - acc: 0.8653 - val_loss: 0.8157 - val_acc: 0.7792
Epoch 14/21
 - 3s - loss: 0.3137 - acc: 0.9212 - val_loss: 1.0484 - val_acc: 0.7662
Epoch 15/21
 - 3s - loss: 0.3148 - acc: 0.8819 - val_loss: 0.8553 - val_acc: 0.7403
Epoch 16/21
 - 3s - loss: 0.1919 - acc: 0.9448 - val_loss: 1.0867 - val_acc: 0.7403
Epoch 17/21
 - 3s - loss: 0.1852 - acc: 0.9441 - val_loss: 0.8525 - val_acc: 0.7662
Epoch 18/21
 - 3s - loss: 0.2154 - acc: 0.8853 - val_loss: 0.8963 - val_acc: 0.7662
Epoch 19/21
 - 3s - loss: 0.2245 - acc: 0.9306 - val_loss: 1.0710 - val_acc: 0.7662
Epoch 20/21
 - 3s - loss: 0.3174 - acc: 0.9152 - val_loss: 0.6917 - val_acc: 0.8442
Epoch 21/21
 - 3s - loss: 0.1456 - acc: 0.9651 - val_loss: 0.9324 - val_acc: 0.8312
{'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004440858756346598, 'height_shift_range': 0.267, 'batch_size': 24, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.0038465833794067983, 'num_dense_units_0': 152, 'cnn_learning_rate': 1.3197144852527731e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 78}

 ****** MobileNet no layers unfrozen
Epoch 1/11
 - 4s - loss: 0.1293 - acc: 0.9631 - val_loss: 0.9320 - val_acc: 0.8052
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/11
 - 3s - loss: 0.0921 - acc: 0.9840 - val_loss: 0.6530 - val_acc: 0.8182
Epoch 3/11
 - 3s - loss: 0.1080 - acc: 0.9651 - val_loss: 0.6397 - val_acc: 0.8312
Epoch 4/11
 - 3s - loss: 0.1384 - acc: 0.9720 - val_loss: 1.1455 - val_acc: 0.6623
Epoch 5/11
 - 3s - loss: 0.2245 - acc: 0.8958 - val_loss: 0.9656 - val_acc: 0.7792
Epoch 6/11
 - 3s - loss: 0.1971 - acc: 0.9032 - val_loss: 0.8056 - val_acc: 0.7532
Epoch 7/11
 - 3s - loss: 0.2943 - acc: 0.9262 - val_loss: 1.5085 - val_acc: 0.7013
Epoch 8/11
 - 3s - loss: 0.2297 - acc: 0.9471 - val_loss: 1.1626 - val_acc: 0.7143
Epoch 9/11
 - 3s - loss: 0.3065 - acc: 0.8733 - val_loss: 0.9931 - val_acc: 0.7662
Epoch 10/11
 - 3s - loss: 0.1988 - acc: 0.9401 - val_loss: 1.1380 - val_acc: 0.7013
Epoch 11/11
 - 3s - loss: 0.1620 - acc: 0.9371 - val_loss: 1.0535 - val_acc: 0.7792
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 0)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004440858756346598, 'height_shift_range': 0.267, 'batch_size': 24, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.0038465833794067983, 'num_dense_units_0': 152, 'cnn_learning_rate': 1.3197144852527731e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 78}, 'working_directory': '.', 'budget': 32.0}
result: {'loss': 0.22077920839384002, 'info': {'histories': {'val_loss': [2.0040594169071744, 1.9804175302579805, 1.540091929497657, 1.466353125386424, 1.234990525555301, 1.0022989062519816, 1.2536020186040309, 0.8348410671407526, 0.9955194894369547, 0.9363787065852772, 0.8646444345449472, 0.7544440580652906, 0.815725987414261, 1.0483919567876048, 0.8553021418583857, 1.0867384981799435, 0.8525399310248238, 0.8962907109941755, 1.0710262122092309, 0.6917435581033881, 0.9324283359886764, 0.9320268754835253, 0.6529629260495111, 0.639721498086855, 1.1454762994468985, 0.9656440236351707, 0.8056180477142334, 1.508493381661254, 1.1625876891148554, 0.9931047845196415, 1.1380014419555664, 1.0535490404475818], 'acc': [0.18115942244944366, 0.4057971135429714, 0.5652174094448918, 0.7013889054457346, 0.7463768254155698, 0.8188405866208284, 0.7318840804307357, 0.750000019868215, 0.7575757828625765, 0.7638889153798422, 0.8043478312699691, 0.811594211536905, 0.8768116183902906, 0.9202898792598558, 0.8819444676240286, 0.9469697204503146, 0.9420290096946384, 0.8913043633751248, 0.9305555721124014, 0.9202898740768433, 0.963768140129421, 0.9637681297633959, 0.9855072498321533, 0.9637681297633959, 0.9710145100303318, 0.8958333631356558, 0.9057971239089966, 0.9275362465692603, 0.9492753873700681, 0.8768116028412528, 0.9420290174691573, 0.9347826294277025], 'loss': [2.6320172807444697, 1.9408278517101123, 1.3238670929618503, 0.8992351194222769, 0.8301623696866243, 0.572053603504015, 0.7360275517339292, 0.6572029789288839, 0.801359003240412, 0.7035852173964182, 0.4841493290403615, 0.5335259489391161, 0.37770265340805054, 0.3154092197832854, 0.31476795425017673, 0.19433032043955542, 0.18813255137723425, 0.20176813848640607, 0.22447815413276354, 0.3003086344055507, 0.14701292631418808, 0.12911006613917972, 0.09186039670653966, 0.1099561958209328, 0.14023283545089804, 0.22445903594295183, 0.19215519143187482, 0.28842255084410956, 0.21643445543620898, 0.2936892522417981, 0.198109974031863, 0.16438334402830704], 'val_acc': [0.20779220895333725, 0.20779220972742354, 0.5324675371120502, 0.4805194867121709, 0.6233766272470549, 0.6493506532210809, 0.6103896150341281, 0.766233778619147, 0.701298713684082, 0.7012987059432191, 0.753246765632134, 0.7662337778450606, 0.7792207900579874, 0.766233770878284, 0.740259752645121, 0.7402597518710347, 0.7662337770709744, 0.7662337693301114, 0.7662337770709744, 0.8441558549930523, 0.8311688327170038, 0.8051948168060996, 0.8181818290190264, 0.8311688420060394, 0.6623376662080939, 0.77922079160616, 0.753246765632134, 0.7012987051691327, 0.714285726671095, 0.7662337778450606, 0.7012987152322546, 0.77922079160616]}, 'runtime': 106.317791223526}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 0)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 4)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 4) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 1
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (1, 0, 0) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 4) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 4)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.003549822023388685, 'height_shift_range': 0.267, 'batch_size': 42, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.15618362105538683, 'num_dense_units_0': 376, 'cnn_learning_rate': 5.089609499393947e-05, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 388}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:37:38.857380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 4s - loss: 2.4059 - acc: 0.1275 - val_loss: 2.6191 - val_acc: 0.0312
Epoch 2/4
 - 3s - loss: 2.4713 - acc: 0.1349 - val_loss: 2.6887 - val_acc: 0.0625
Epoch 3/4
 - 3s - loss: 2.4253 - acc: 0.0422 - val_loss: 2.3383 - val_acc: 0.0938
Epoch 4/4
 - 3s - loss: 2.3420 - acc: 0.1114 - val_loss: 2.3556 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 4)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.003549822023388685, 'height_shift_range': 0.267, 'batch_size': 42, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.15618362105538683, 'num_dense_units_0': 376, 'cnn_learning_rate': 5.089609499393947e-05, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 388}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.6190857887268066, 2.6886966228485107, 2.338261842727661, 2.3556339740753174], 'acc': [0.12500000223517418, 0.13492063929637274, 0.041666667256504294, 0.10833333525806665], 'loss': [2.4094141840934755, 2.471266428629557, 2.4263257503509523, 2.3416651487350464], 'val_acc': [0.03125, 0.0625, 0.09375, 0.09375]}, 'runtime': 15.712897300720215}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 4)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (1, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (1, 0, 0) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (1, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 5) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (1, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004440858756346598, 'height_shift_range': 0.267, 'batch_size': 24, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.0038465833794067983, 'num_dense_units_0': 152, 'cnn_learning_rate': 1.3197144852527731e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 78}, 'working_directory': '.', 'budget': 64.0}
2018-02-08 14:37:54.128000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/21
 - 5s - loss: 2.8339 - acc: 0.1319 - val_loss: 2.3060 - val_acc: 0.2468
Epoch 2/21
 - 3s - loss: 1.9246 - acc: 0.4026 - val_loss: 1.8595 - val_acc: 0.3506
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/21
 - 3s - loss: 1.4894 - acc: 0.4583 - val_loss: 1.2909 - val_acc: 0.6623
Epoch 4/21
 - 3s - loss: 1.1162 - acc: 0.6457 - val_loss: 1.1508 - val_acc: 0.6104
Epoch 5/21
 - 3s - loss: 0.9120 - acc: 0.6826 - val_loss: 1.6721 - val_acc: 0.5455
Epoch 6/21
 - 3s - loss: 0.8397 - acc: 0.7425 - val_loss: 1.3012 - val_acc: 0.5844
Epoch 7/21
 - 3s - loss: 0.8649 - acc: 0.6806 - val_loss: 1.6225 - val_acc: 0.4935
Epoch 8/21
 - 3s - loss: 0.5950 - acc: 0.8024 - val_loss: 1.0333 - val_acc: 0.6364
Epoch 9/21
 - 3s - loss: 0.4924 - acc: 0.8194 - val_loss: 1.0643 - val_acc: 0.5844
Epoch 10/21
 - 3s - loss: 0.3758 - acc: 0.8694 - val_loss: 1.3630 - val_acc: 0.5844
Epoch 11/21
 - 3s - loss: 0.3419 - acc: 0.8889 - val_loss: 1.0200 - val_acc: 0.7662
Epoch 12/21
 - 3s - loss: 0.3298 - acc: 0.8842 - val_loss: 0.9963 - val_acc: 0.7013
Epoch 13/21
 - 3s - loss: 0.3142 - acc: 0.8912 - val_loss: 1.3434 - val_acc: 0.7273
Epoch 14/21
 - 3s - loss: 0.2695 - acc: 0.9172 - val_loss: 1.1555 - val_acc: 0.6883
Epoch 15/21
 - 3s - loss: 0.3677 - acc: 0.8493 - val_loss: 0.8787 - val_acc: 0.7792
Epoch 16/21
 - 3s - loss: 0.3738 - acc: 0.8584 - val_loss: 0.9591 - val_acc: 0.7273
Epoch 17/21
 - 3s - loss: 0.2424 - acc: 0.9028 - val_loss: 1.2881 - val_acc: 0.6753
Epoch 18/21
 - 3s - loss: 0.3659 - acc: 0.8683 - val_loss: 0.8469 - val_acc: 0.7662
Epoch 19/21
 - 3s - loss: 0.3754 - acc: 0.8725 - val_loss: 0.9868 - val_acc: 0.7922
Epoch 20/21
 - 3s - loss: 0.1966 - acc: 0.9583 - val_loss: 0.9326 - val_acc: 0.7403
Epoch 21/21
 - 3s - loss: 0.1761 - acc: 0.9471 - val_loss: 1.2926 - val_acc: 0.7662
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
{'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004440858756346598, 'height_shift_range': 0.267, 'batch_size': 24, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.0038465833794067983, 'num_dense_units_0': 152, 'cnn_learning_rate': 1.3197144852527731e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 78}

 ****** MobileNet no layers unfrozen
Epoch 1/43
 - 4s - loss: 0.2097 - acc: 0.9301 - val_loss: 1.2086 - val_acc: 0.6753
Epoch 2/43
 - 3s - loss: 0.1401 - acc: 0.9583 - val_loss: 1.2569 - val_acc: 0.6883
Epoch 3/43
 - 3s - loss: 0.2051 - acc: 0.9437 - val_loss: 1.6077 - val_acc: 0.6753
Epoch 4/43
 - 3s - loss: 0.1784 - acc: 0.9375 - val_loss: 1.0971 - val_acc: 0.7013
Epoch 5/43
 - 3s - loss: 0.1732 - acc: 0.9288 - val_loss: 1.0408 - val_acc: 0.7922
Epoch 6/43
 - 3s - loss: 0.1984 - acc: 0.9167 - val_loss: 1.1715 - val_acc: 0.7273
Epoch 7/43
 - 3s - loss: 0.2124 - acc: 0.9142 - val_loss: 0.8429 - val_acc: 0.7922
Epoch 8/43
 - 3s - loss: 0.1346 - acc: 0.9651 - val_loss: 1.4926 - val_acc: 0.7143
Epoch 9/43
 - 3s - loss: 0.2945 - acc: 0.8923 - val_loss: 1.0111 - val_acc: 0.7273
Epoch 10/43
 - 3s - loss: 0.2414 - acc: 0.9161 - val_loss: 1.1131 - val_acc: 0.7143
Epoch 11/43
 - 3s - loss: 0.1834 - acc: 0.9581 - val_loss: 1.1911 - val_acc: 0.7532
Epoch 12/43
 - 3s - loss: 0.1333 - acc: 0.9561 - val_loss: 0.9025 - val_acc: 0.7922
Epoch 13/43
 - 3s - loss: 0.1319 - acc: 0.9581 - val_loss: 1.0736 - val_acc: 0.7403
Epoch 14/43
 - 3s - loss: 0.1230 - acc: 0.9514 - val_loss: 1.5004 - val_acc: 0.7403
Epoch 15/43
 - 3s - loss: 0.1166 - acc: 0.9561 - val_loss: 1.1046 - val_acc: 0.7532
Epoch 16/43
 - 3s - loss: 0.1785 - acc: 0.9514 - val_loss: 1.5578 - val_acc: 0.7403
Epoch 17/43
 - 3s - loss: 0.1782 - acc: 0.9437 - val_loss: 1.2269 - val_acc: 0.7532
Epoch 18/43
 - 3s - loss: 0.0979 - acc: 0.9720 - val_loss: 1.9007 - val_acc: 0.6753
Epoch 19/43
 - 3s - loss: 0.2182 - acc: 0.9306 - val_loss: 1.1571 - val_acc: 0.7922
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 20/43
 - 3s - loss: 0.1891 - acc: 0.9471 - val_loss: 1.2303 - val_acc: 0.7532
Epoch 21/43
 - 3s - loss: 0.1820 - acc: 0.9351 - val_loss: 1.4267 - val_acc: 0.6753
Epoch 22/43
 - 3s - loss: 0.1205 - acc: 0.9631 - val_loss: 1.6625 - val_acc: 0.6623
Epoch 23/43
 - 3s - loss: 0.0808 - acc: 0.9790 - val_loss: 1.0447 - val_acc: 0.8052
Epoch 24/43
 - 3s - loss: 0.0822 - acc: 0.9653 - val_loss: 1.2621 - val_acc: 0.7403
Epoch 25/43
 - 3s - loss: 0.1738 - acc: 0.9491 - val_loss: 1.3460 - val_acc: 0.7013
Epoch 26/43
 - 3s - loss: 0.0761 - acc: 0.9859 - val_loss: 1.1354 - val_acc: 0.7403
Epoch 27/43
 - 3s - loss: 0.0675 - acc: 0.9792 - val_loss: 1.3906 - val_acc: 0.7143
Epoch 28/43
 - 3s - loss: 0.1617 - acc: 0.9511 - val_loss: 1.4999 - val_acc: 0.7403
Epoch 29/43
 - 3s - loss: 0.1245 - acc: 0.9561 - val_loss: 1.1169 - val_acc: 0.7792
Epoch 30/43
 - 3s - loss: 0.0818 - acc: 0.9651 - val_loss: 1.3790 - val_acc: 0.6623
Epoch 31/43
 - 3s - loss: 0.1079 - acc: 0.9541 - val_loss: 1.4097 - val_acc: 0.7532
Epoch 32/43
 - 3s - loss: 0.2970 - acc: 0.9097 - val_loss: 1.4166 - val_acc: 0.6623
Epoch 33/43
 - 3s - loss: 0.1782 - acc: 0.9441 - val_loss: 1.3343 - val_acc: 0.7532
Epoch 34/43
 - 3s - loss: 0.2272 - acc: 0.9312 - val_loss: 1.9832 - val_acc: 0.6494
Epoch 35/43
 - 3s - loss: 0.0742 - acc: 0.9720 - val_loss: 1.1555 - val_acc: 0.7013
Epoch 36/43
 - 3s - loss: 0.3009 - acc: 0.9172 - val_loss: 1.1758 - val_acc: 0.7532
Epoch 37/43
 - 3s - loss: 0.1675 - acc: 0.9451 - val_loss: 1.9803 - val_acc: 0.7013
Epoch 38/43
 - 3s - loss: 0.1766 - acc: 0.9375 - val_loss: 1.2582 - val_acc: 0.7792
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 39/43
 - 3s - loss: 0.1636 - acc: 0.9358 - val_loss: 1.1940 - val_acc: 0.7532
Epoch 40/43
 - 3s - loss: 0.1195 - acc: 0.9491 - val_loss: 1.2976 - val_acc: 0.7273
Epoch 41/43
 - 3s - loss: 0.0821 - acc: 0.9861 - val_loss: 1.8300 - val_acc: 0.6753
Epoch 42/43
 - 3s - loss: 0.1021 - acc: 0.9701 - val_loss: 1.5515 - val_acc: 0.7532
Epoch 43/43
 - 3s - loss: 0.0674 - acc: 0.9771 - val_loss: 1.1980 - val_acc: 0.7662
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (1, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (1, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (1, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (1, 0, 0)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.004440858756346598, 'height_shift_range': 0.267, 'batch_size': 24, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.0038465833794067983, 'num_dense_units_0': 152, 'cnn_learning_rate': 1.3197144852527731e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 78}, 'working_directory': '.', 'budget': 64.0}
result: {'loss': 0.23376622215493936, 'info': {'histories': {'val_loss': [2.3060391413701047, 1.8595072232283556, 1.2908643097072452, 1.1508473761670002, 1.6721342507894936, 1.3012127303457879, 1.6225036893572127, 1.0333268379236196, 1.0643112613009167, 1.3630300373226016, 1.0200309188334973, 0.9963431226742732, 1.3433698957616633, 1.155519454510181, 0.8787373273403614, 0.959133225601989, 1.2881088938031877, 0.8468839278468838, 0.9868212048109476, 0.9325825920352688, 1.29262646452173, 1.2085837048369568, 1.256886541069328, 1.6077317881893802, 1.0970758869276418, 1.0408066526635902, 1.1714500080455432, 0.8429361937882064, 1.4925786922504376, 1.0111058006038913, 1.1130751293975036, 1.191052200732293, 0.9024697944715425, 1.0736029984115005, 1.5003630882733827, 1.104580681045334, 1.55782996524464, 1.2269381737554228, 1.9006841554270162, 1.157147883207767, 1.230286429454754, 1.4267406494586499, 1.662481097431926, 1.0446806619693707, 1.2620795996158154, 1.345952962900137, 1.1354102608445402, 1.3905521027453533, 1.499900729625256, 1.1169001003364465, 1.3790250428311237, 1.4097277669163493, 1.416553986536992, 1.33430138501254, 1.9831960789569012, 1.1555268903831384, 1.1758051847482656, 1.980280046339159, 1.258192183135392, 1.1939849311655217, 1.2975679682446766, 1.8299794661534297, 1.5514886688876461, 1.1979813668634984], 'acc': [0.1319444477558136, 0.40151516415856103, 0.4583333482344945, 0.6449275457340738, 0.6811594341112219, 0.7391304503316465, 0.6811594367027283, 0.7971014665520709, 0.8194444676240286, 0.8636363826014779, 0.8888889054457346, 0.8840579856996951, 0.8913043763326562, 0.9202898740768433, 0.8478261232376099, 0.8695652381233547, 0.9027778009573618, 0.8695652329403422, 0.8712121383710341, 0.9583333532015482, 0.9492753847785618, 0.9275362491607666, 0.9583333631356558, 0.9393939538435503, 0.937500019868215, 0.9318182170391083, 0.9166666865348816, 0.9130434964014136, 0.9637681193973707, 0.8985507332760355, 0.9130434886268948, 0.9565217391304348, 0.9565217572709789, 0.95652174949646, 0.9513889054457346, 0.956521767637004, 0.9513889153798422, 0.9393939430063422, 0.971014520396357, 0.9305555820465088, 0.949275377004043, 0.9347826268361963, 0.9637681297633959, 0.9782608902972677, 0.9652777910232544, 0.9492753873700681, 0.9848484992980957, 0.9791666865348816, 0.9492753795955492, 0.9565217572709789, 0.9637681297633959, 0.956521767637004, 0.909722238779068, 0.9420290096946384, 0.9347826346107151, 0.971014520396357, 0.9202898740768433, 0.949275395144587, 0.9375000099341074, 0.9393939565528523, 0.949275369229524, 0.9861111243565878, 0.9710145074388256, 0.9782608877057615], 'loss': [2.8338709274927774, 1.9221294630657544, 1.489448328812917, 1.1239361244699229, 0.9163813020872034, 0.8511028756266055, 0.8699822633162789, 0.5997299396473429, 0.49239201347033185, 0.38290499963543634, 0.3419174874822299, 0.3319356545158055, 0.3131145329579063, 0.2622487195160078, 0.3734283991481947, 0.3431465444357499, 0.2424055760105451, 0.36488692268081335, 0.3809568306261843, 0.1965509901444117, 0.17359247220599133, 0.2140742715286172, 0.14006988580028215, 0.2137229127640074, 0.17841839293638864, 0.16585600917989557, 0.1984024913981557, 0.21464988330136175, 0.13681937527397406, 0.2774753220703291, 0.24869995823372965, 0.1886146907573161, 0.13494864138572113, 0.1359297463103481, 0.12298799383764465, 0.11270048242548238, 0.17846252645055452, 0.18901414932175117, 0.10006061358296353, 0.21821474935859442, 0.1841963835708473, 0.18516383206714754, 0.12244558528713557, 0.08211339702424796, 0.08216804979989926, 0.16592592389687247, 0.07893603430552916, 0.06750153998533885, 0.16656278106181518, 0.12631160830673965, 0.08324895280858745, 0.10339591554973436, 0.2969704964198172, 0.18376755082736845, 0.22267897621445035, 0.07607065594714621, 0.2937456233345944, 0.1609804827881896, 0.1765793263912201, 0.15751321478323502, 0.12203875815738803, 0.08211209221432607, 0.10192573119116866, 0.06582388200837633], 'val_acc': [0.2467532472370507, 0.3506493560679547, 0.6623376739489568, 0.6103896134859556, 0.5454545500990632, 0.5844155890601022, 0.49350649544170927, 0.6363636410081541, 0.5844155882860159, 0.5844155882860159, 0.766233778619147, 0.7012987043950465, 0.7272727311431587, 0.6883116929562061, 0.7792207900579874, 0.7272727412062806, 0.6753246784210205, 0.766233778619147, 0.7922078038190866, 0.740259744904258, 0.7662337693301114, 0.6753246799691931, 0.6883117022452416, 0.6753246799691931, 0.7012987129099957, 0.7922078038190866, 0.7272727303690725, 0.7922077937559648, 0.7142857181561457, 0.7272727303690725, 0.7142857173820595, 0.7532467648580476, 0.7922078038190866, 0.740259752645121, 0.740259752645121, 0.7532467547949259, 0.7402597418079129, 0.7532467648580476, 0.6753246784210205, 0.7922078038190866, 0.753246765632134, 0.6753246799691931, 0.6623376669821801, 0.805194817580186, 0.7402597518710347, 0.7012987043950465, 0.740259752645121, 0.714285726671095, 0.7402597433560855, 0.77922079160616, 0.6623376654340075, 0.753246765632134, 0.6623376762712156, 0.7532467563430985, 0.6493506555433397, 0.701298713684082, 0.7532467648580476, 0.7012987051691327, 0.77922079160616, 0.7532467648580476, 0.7272727303690725, 0.6753246784210205, 0.753246765632134, 0.7662337778450606]}, 'runtime': 206.97804284095764}}
exception: None

DEBUG:hpbandster:job_callback for (1, 0, 0)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 5)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 5) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 6) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 5) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 5)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.007985255741819025, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.25532759512202996, 'num_dense_units_0': 130, 'cnn_learning_rate': 6.989110699041067e-05, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 200}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:41:25.981264: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 7s - loss: 2.3119 - acc: 0.1330 - val_loss: 2.2816 - val_acc: 0.1818
Epoch 2/4
 - 5s - loss: 2.2548 - acc: 0.2589 - val_loss: 2.2795 - val_acc: 0.1429
Epoch 3/4
 - 5s - loss: 2.2014 - acc: 0.2272 - val_loss: 2.2861 - val_acc: 0.1429
Epoch 4/4
 - 5s - loss: 2.1996 - acc: 0.2336 - val_loss: 2.2863 - val_acc: 0.1429
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 5), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 5) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 5) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 5)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.007985255741819025, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.25532759512202996, 'num_dense_units_0': 130, 'cnn_learning_rate': 6.989110699041067e-05, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 200}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.8571428571428572, 'info': {'histories': {'val_loss': [2.2815553832363773, 2.279530766722444, 2.2861102494326504, 2.286311502580519], 'acc': [0.15107914012113063, 0.15827338102695754, 0.12230215918460338, 0.1294964045393381], 'loss': [2.303260086251677, 2.296656689197897, 2.2869683744238434, 2.300446034335404], 'val_acc': [0.18181818452748386, 0.1428571433409468, 0.14285714382475073, 0.14285714285714285]}, 'runtime': 33.316192626953125}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 5)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 6)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 6) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 6) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 7) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 6)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.007182635529222077, 'height_shift_range': 0.267, 'batch_size': 59, 'num_dense_units_2': 32, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.0004072741051776574, 'num_dense_units_0': 625, 'cnn_learning_rate': 0.0003216988473151285, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 55}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:41:55.518328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 3.7923 - acc: 0.1271 - val_loss: 2.3023 - val_acc: 0.1250
Epoch 2/4
 - 3s - loss: 4.4935 - acc: 0.1023 - val_loss: 2.3313 - val_acc: 0.1562
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/4
 - 3s - loss: 3.6801 - acc: 0.0932 - val_loss: 2.4906 - val_acc: 0.0938
Epoch 4/4
 - 3s - loss: 2.5602 - acc: 0.1881 - val_loss: 2.2800 - val_acc: 0.1875
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 6), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 6) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 6)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.007182635529222077, 'height_shift_range': 0.267, 'batch_size': 59, 'num_dense_units_2': 32, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.0004072741051776574, 'num_dense_units_0': 625, 'cnn_learning_rate': 0.0003216988473151285, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 55}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.8125, 'info': {'histories': {'val_loss': [2.302253246307373, 2.3313117027282715, 2.490588665008545, 2.28003191947937], 'acc': [0.12711864709854126, 0.10227273032069206, 0.09322033822536469, 0.18446602780842086], 'loss': [3.792264223098755, 4.493460416793823, 3.6801259517669678, 2.5609187385410936], 'val_acc': [0.125, 0.15625, 0.09375, 0.1875]}, 'runtime': 18.40630054473877}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 6)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 7)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 7) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 7) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 8) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 7) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 7)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00026007948221981006, 'height_shift_range': 0.267, 'batch_size': 31, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.11562423151499168, 'num_dense_units_0': 278, 'cnn_learning_rate': 2.83106427466558e-05, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 53}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:42:13.981088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.3059 - acc: 0.2415 - val_loss: 2.5269 - val_acc: 0.0938
Epoch 2/4
 - 3s - loss: 1.9249 - acc: 0.3677 - val_loss: 2.4477 - val_acc: 0.0938
Epoch 3/4
 - 3s - loss: 1.6536 - acc: 0.4859 - val_loss: 2.5510 - val_acc: 0.0938
Epoch 4/4
 - 3s - loss: 1.4417 - acc: 0.6142 - val_loss: 2.4750 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 7), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 7) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 7) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 7) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 7)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00026007948221981006, 'height_shift_range': 0.267, 'batch_size': 31, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.11562423151499168, 'num_dense_units_0': 278, 'cnn_learning_rate': 2.83106427466558e-05, 'cnn_unlock_epoch': 17, 'num_dense_units_1': 53}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.526907205581665, 2.4476696252822876, 2.5510129928588867, 2.47498881816864], 'acc': [0.21374045414779022, 0.3677419304847717, 0.4732824309181621, 0.579439240081288], 'loss': [2.34620151082978, 1.9249267339706422, 1.6476752876325418, 1.5008780076124957], 'val_acc': [0.09375, 0.09375, 0.09375, 0.09375]}, 'runtime': 19.36007022857666}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 7)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 8)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 8) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 8) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 9) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 8) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 8)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009656515382122097, 'height_shift_range': 0.267, 'batch_size': 33, 'num_dense_units_2': 269, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.228068411889993, 'num_dense_units_0': 117, 'cnn_learning_rate': 0.0005710492783717696, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 57}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:42:34.068241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 4.2320 - acc: 0.1002 - val_loss: 6.0230 - val_acc: 0.0625
Epoch 2/4
 - 4s - loss: 7.2013 - acc: 0.0932 - val_loss: 7.3181 - val_acc: 0.0938
Epoch 3/4
 - 4s - loss: 6.8108 - acc: 0.0855 - val_loss: 4.4643 - val_acc: 0.0938
Epoch 4/4
 - 4s - loss: 5.4666 - acc: 0.1061 - val_loss: 4.4761 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 8), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 8) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 8) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 8) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 8)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.009656515382122097, 'height_shift_range': 0.267, 'batch_size': 33, 'num_dense_units_2': 269, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.228068411889993, 'num_dense_units_0': 117, 'cnn_learning_rate': 0.0005710492783717696, 'cnn_unlock_epoch': 15, 'num_dense_units_1': 57}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [6.023001670837402, 7.318136215209961, 4.464347243309021, 4.476063132286072], 'acc': [0.10077519714832306, 0.09302325997241707, 0.0852713217568952, 0.10606060922145844], 'loss': [4.216476434885069, 7.202491471933764, 6.832174290058225, 5.4666208028793335], 'val_acc': [0.0625, 0.09375, 0.09375, 0.09375]}, 'runtime': 22.621385097503662}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 8)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 9)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 9) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 9) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 10) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 9)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0004025741769331608, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 103, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.1967028679054808, 'num_dense_units_0': 170, 'cnn_learning_rate': 5.264988714256396e-05, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 54}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:42:56.915411: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.4761 - acc: 0.0620 - val_loss: 2.2468 - val_acc: 0.1875
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/4
 - 4s - loss: 2.2761 - acc: 0.1667 - val_loss: 2.2049 - val_acc: 0.1875
Epoch 3/4
 - 4s - loss: 2.0668 - acc: 0.3266 - val_loss: 2.2279 - val_acc: 0.1250
Epoch 4/4
 - 4s - loss: 2.0312 - acc: 0.3941 - val_loss: 2.0981 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 9), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 9) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 9)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0004025741769331608, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 103, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.1967028679054808, 'num_dense_units_0': 170, 'cnn_learning_rate': 5.264988714256396e-05, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 54}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.84375, 'info': {'histories': {'val_loss': [2.246816396713257, 2.204936981201172, 2.227874994277954, 2.0981431007385254], 'acc': [0.04065040717037713, 0.16666667349636555, 0.3252032624512184, 0.40650408006295924], 'loss': [2.5446449023921316, 2.2760871052742004, 2.0929130635610442, 2.0155795405550703], 'val_acc': [0.1875, 0.1875, 0.125, 0.15625]}, 'runtime': 22.01201891899109}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 9)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 10)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 10) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 10) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 11) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 10) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 10)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00022755931607171002, 'height_shift_range': 0.267, 'batch_size': 20, 'num_dense_units_2': 24, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.23346388013492506, 'num_dense_units_0': 392, 'cnn_learning_rate': 0.00045807729047802037, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 272}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:43:18.275655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.3313 - acc: 0.1188 - val_loss: 2.3821 - val_acc: 0.0909
Epoch 2/4
 - 3s - loss: 2.1556 - acc: 0.2629 - val_loss: 2.3816 - val_acc: 0.0909
Epoch 3/4
 - 4s - loss: 1.9839 - acc: 0.3875 - val_loss: 2.3771 - val_acc: 0.0909
Epoch 4/4
 - 3s - loss: 1.8400 - acc: 0.3532 - val_loss: 2.4292 - val_acc: 0.0909
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 10), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 10) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 10) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 10) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 10)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00022755931607171002, 'height_shift_range': 0.267, 'batch_size': 20, 'num_dense_units_2': 24, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.23346388013492506, 'num_dense_units_0': 392, 'cnn_learning_rate': 0.00045807729047802037, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 272}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.9090909086071052, 'info': {'histories': {'val_loss': [2.382148061479841, 2.381571391960243, 2.3770878160154663, 2.4292455338812493], 'acc': [0.11875000176951289, 0.26612903370011237, 0.38750000298023224, 0.3790322720043121], 'loss': [2.3312760293483734, 2.1508237623399302, 1.9839152544736862, 1.8126849820536952], 'val_acc': [0.09090909139289484, 0.09090909187669878, 0.09090909187669878, 0.09090909139289484]}, 'runtime': 20.72375798225403}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 10)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 11)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 11) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 11) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 12) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 11) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 11)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0012754002674200458, 'height_shift_range': 0.267, 'batch_size': 55, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.011679062610135548, 'num_dense_units_0': 277, 'cnn_learning_rate': 5.470130699590457e-05, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 180}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:43:43.136001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 7s - loss: 2.3767 - acc: 0.0843 - val_loss: 2.3172 - val_acc: 0.1562
Epoch 2/4
 - 4s - loss: 2.3294 - acc: 0.1000 - val_loss: 2.3581 - val_acc: 0.0938
Epoch 3/4
 - 4s - loss: 2.3966 - acc: 0.0748 - val_loss: 2.3944 - val_acc: 0.0938
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/4
 - 4s - loss: 2.3834 - acc: 0.0554 - val_loss: 2.4762 - val_acc: 0.0938
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 11), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 11) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 11) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 11) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 11)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0012754002674200458, 'height_shift_range': 0.267, 'batch_size': 55, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.011679062610135548, 'num_dense_units_0': 277, 'cnn_learning_rate': 5.470130699590457e-05, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 180}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.90625, 'info': {'histories': {'val_loss': [2.317189931869507, 2.358083486557007, 2.394404411315918, 2.476173162460327], 'acc': [0.08411215280539522, 0.09999999776482582, 0.0747663553490817, 0.05607476426619236], 'loss': [2.3759280498896804, 2.32941734790802, 2.3967773535541284, 2.3834450222621455], 'val_acc': [0.15625, 0.09375, 0.09375, 0.09375]}, 'runtime': 29.909993171691895}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 11)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 12)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 12) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 12) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 13) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 12)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0010192003596035026, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 140, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.05015390769595599, 'num_dense_units_0': 427, 'cnn_learning_rate': 5.93659901713247e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 245}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:44:08.322172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.7800 - acc: 0.1494 - val_loss: 2.5397 - val_acc: 0.1429
Epoch 2/4
 - 3s - loss: 2.3174 - acc: 0.1901 - val_loss: 2.2129 - val_acc: 0.1688
Epoch 3/4
 - 3s - loss: 1.9221 - acc: 0.3124 - val_loss: 1.7589 - val_acc: 0.4026
Epoch 4/4
 - 3s - loss: 1.6795 - acc: 0.4026 - val_loss: 1.4812 - val_acc: 0.4675
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 12), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 12) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 12)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0010192003596035026, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 140, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.05015390769595599, 'num_dense_units_0': 427, 'cnn_learning_rate': 5.93659901713247e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 245}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.532467528597101, 'info': {'histories': {'val_loss': [2.5397273534304134, 2.2129233781393474, 1.7588627245519068, 1.4812338104495755], 'acc': [0.14935065380164556, 0.21428571523181975, 0.3285714334675244, 0.40259741459574017], 'loss': [2.7799523898533414, 2.2570631579747276, 1.9148879051208496, 1.679508192198617], 'val_acc': [0.14285714556644488, 0.16883117076638457, 0.402597408790093, 0.467532471402899]}, 'runtime': 17.96687126159668}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 12)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 13)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 13) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 13) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 14) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 13) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 13)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0036718608729295645, 'height_shift_range': 0.267, 'batch_size': 16, 'num_dense_units_2': 26, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.15800637204459722, 'num_dense_units_0': 608, 'cnn_learning_rate': 2.6698814835988502e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 55}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:44:26.873807: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 6s - loss: 2.5933 - acc: 0.0883 - val_loss: 2.3469 - val_acc: 0.1284
Epoch 2/4
 - 5s - loss: 2.3555 - acc: 0.1280 - val_loss: 2.3174 - val_acc: 0.1193
Epoch 3/4
 - 5s - loss: 2.3419 - acc: 0.1009 - val_loss: 2.4166 - val_acc: 0.0917
Epoch 4/4
 - 5s - loss: 2.3702 - acc: 0.1072 - val_loss: 2.3686 - val_acc: 0.0826
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 13), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 13) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 13) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 13) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 13)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0036718608729295645, 'height_shift_range': 0.267, 'batch_size': 16, 'num_dense_units_2': 26, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.15800637204459722, 'num_dense_units_0': 608, 'cnn_learning_rate': 2.6698814835988502e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 55}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.9174311926605505, 'info': {'histories': {'val_loss': [2.346896084076768, 2.317411162437649, 2.4165572988877604, 2.3686333227595058], 'acc': [0.0958904109589041, 0.0958904109589041, 0.1095890410958904, 0.11643835616438356], 'loss': [2.632087981864198, 2.3743352171492904, 2.3351865925201, 2.373121549005378], 'val_acc': [0.12844036888638768, 0.11926605538764132, 0.09174312117996566, 0.08256880733944955]}, 'runtime': 26.281103134155273}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 13)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 14)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 14) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 14) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 15) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 14) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 14)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000196316894784971, 'height_shift_range': 0.267, 'batch_size': 38, 'num_dense_units_2': 21, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.08717978237230432, 'num_dense_units_0': 100, 'cnn_learning_rate': 5.4346436903413856e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 161}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:44:57.976171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 7s - loss: 2.4274 - acc: 0.0825 - val_loss: 2.3688 - val_acc: 0.0625
Epoch 2/4
 - 5s - loss: 2.2588 - acc: 0.1711 - val_loss: 2.3263 - val_acc: 0.1406
Epoch 3/4
 - 5s - loss: 2.1029 - acc: 0.2917 - val_loss: 2.2742 - val_acc: 0.1719
Epoch 4/4
 - 5s - loss: 2.1142 - acc: 0.2868 - val_loss: 2.2232 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 14), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 14) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 14) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 14) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 14)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000196316894784971, 'height_shift_range': 0.267, 'batch_size': 38, 'num_dense_units_2': 21, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.08717978237230432, 'num_dense_units_0': 100, 'cnn_learning_rate': 5.4346436903413856e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 161}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.84375, 'info': {'histories': {'val_loss': [2.368756413459778, 2.3263098001480103, 2.274171829223633, 2.2232216596603394], 'acc': [0.09677419426941103, 0.17105263844132423, 0.29032258016447865, 0.24999999927897606], 'loss': [2.4311580773322814, 2.2587581872940063, 2.0920482912371234, 2.1356351548625576], 'val_acc': [0.0625, 0.140625, 0.171875, 0.15625]}, 'runtime': 39.031376123428345}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 14)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 15)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 15) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 15) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 0) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 15) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 15)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00014126339690024241, 'height_shift_range': 0.267, 'batch_size': 37, 'num_dense_units_2': 13, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.2897140457380931, 'num_dense_units_0': 151, 'cnn_learning_rate': 0.0001231576910192151, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 497}, 'working_directory': '.', 'budget': 4.0}
2018-02-08 14:45:33.405442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/4
 - 5s - loss: 2.3396 - acc: 0.1317 - val_loss: 2.2987 - val_acc: 0.1562
Epoch 2/4
 - 3s - loss: 2.2836 - acc: 0.1554 - val_loss: 2.3028 - val_acc: 0.1250
Epoch 3/4
 - 3s - loss: 2.2137 - acc: 0.3055 - val_loss: 2.2976 - val_acc: 0.1094
Epoch 4/4
 - 3s - loss: 2.1955 - acc: 0.2905 - val_loss: 2.2995 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 15), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 15) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 15) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 15) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 15)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00014126339690024241, 'height_shift_range': 0.267, 'batch_size': 37, 'num_dense_units_2': 13, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.2897140457380931, 'num_dense_units_0': 151, 'cnn_learning_rate': 0.0001231576910192151, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 497}, 'working_directory': '.', 'budget': 4.0}
result: {'loss': 0.890625, 'info': {'histories': {'val_loss': [2.2986538410186768, 2.302820920944214, 2.2975785732269287, 2.2994658946990967], 'acc': [0.12000000753998756, 0.15540541149675846, 0.2647058972541024, 0.29054055362939835], 'loss': [2.3405817165374754, 2.2836390137672424, 2.238719388550403, 2.1955087780952454], 'val_acc': [0.15625, 0.125, 0.109375, 0.109375]}, 'runtime': 20.042715072631836}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 15)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 0) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 12) to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (3, 0, 0) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (3, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0004032591292372277, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.2442824728736464, 'num_dense_units_0': 203, 'cnn_learning_rate': 2.880793251858514e-05, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 112}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 14:45:53.991195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 6s - loss: 2.7836 - acc: 0.0950 - val_loss: 2.5468 - val_acc: 0.0909
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/8
 - 4s - loss: 2.2721 - acc: 0.1584 - val_loss: 2.3995 - val_acc: 0.1169
Epoch 3/8
 - 4s - loss: 2.3070 - acc: 0.1304 - val_loss: 2.3386 - val_acc: 0.1558
Epoch 4/8
 - 4s - loss: 2.0917 - acc: 0.2660 - val_loss: 2.1682 - val_acc: 0.2338
Epoch 5/8
 - 4s - loss: 2.0770 - acc: 0.2691 - val_loss: 2.1311 - val_acc: 0.1299
Epoch 6/8
 - 4s - loss: 1.9706 - acc: 0.2344 - val_loss: 2.0423 - val_acc: 0.2468
Epoch 7/8
 - 4s - loss: 1.8571 - acc: 0.3354 - val_loss: 1.9665 - val_acc: 0.2597
Epoch 8/8
 - 4s - loss: 1.9185 - acc: 0.3864 - val_loss: 1.8574 - val_acc: 0.3506
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (3, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (3, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (3, 0, 0)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0004032591292372277, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.2442824728736464, 'num_dense_units_0': 203, 'cnn_learning_rate': 2.880793251858514e-05, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 112}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.6493506466413473, 'info': {'histories': {'val_loss': [2.5468298305164683, 2.399520322873995, 2.3386286326817105, 2.1682027934433576, 2.131078014126072, 2.0422973508958693, 1.9665203791160089, 1.8574345018956568], 'acc': [0.10791367045838199, 0.1798561203072397, 0.13043478290949548, 0.3021582777766015, 0.1965811956896741, 0.26618705100292783, 0.33540373189108713, 0.4388489197912834], 'loss': [2.7779959706093766, 2.2440242441438083, 2.307041815349034, 2.0715215386246606, 2.033947174365704, 1.9485622738762725, 1.8571034840175085, 1.7268443330586385], 'val_acc': [0.09090909187669878, 0.11688311785072475, 0.15584415777937158, 0.23376623995892412, 0.12987013083773774, 0.24675324772085463, 0.2597402607078676, 0.35064935335865266]}, 'runtime': 41.588815689086914}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 0)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 12)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 12) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 6) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 12) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 12)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0010192003596035026, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 140, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.05015390769595599, 'num_dense_units_0': 427, 'cnn_learning_rate': 5.93659901713247e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 245}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 14:46:33.673335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 3.0299 - acc: 0.0888 - val_loss: 2.5087 - val_acc: 0.0649
Epoch 2/8
 - 3s - loss: 2.3110 - acc: 0.1644 - val_loss: 2.0448 - val_acc: 0.3377
Epoch 3/8
 - 3s - loss: 1.9075 - acc: 0.3388 - val_loss: 1.8356 - val_acc: 0.3247
Epoch 4/8
 - 3s - loss: 1.8578 - acc: 0.4481 - val_loss: 1.8691 - val_acc: 0.3636
Epoch 5/8
 - 3s - loss: 1.5040 - acc: 0.5132 - val_loss: 2.1626 - val_acc: 0.3377
Epoch 6/8
 - 3s - loss: 1.6403 - acc: 0.4026 - val_loss: 1.9688 - val_acc: 0.2727
Epoch 7/8
 - 3s - loss: 1.7981 - acc: 0.4046 - val_loss: 1.6563 - val_acc: 0.3896
Epoch 8/8
 - 3s - loss: 1.3243 - acc: 0.5526 - val_loss: 1.3793 - val_acc: 0.5714
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 12), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 12) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 12)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0010192003596035026, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 140, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.05015390769595599, 'num_dense_units_0': 427, 'cnn_learning_rate': 5.93659901713247e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 245}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.4285714146378753, 'info': {'histories': {'val_loss': [2.5087362883926985, 2.044760363442557, 1.8356245276215788, 1.8690905044605206, 2.162587187506936, 1.9688379362032011, 1.656306502106902, 1.3793147074711787], 'acc': [0.08571428805589676, 0.17857143389327185, 0.33571429273911885, 0.44805195927619934, 0.4920634991592831, 0.4025974209819521, 0.4071428662964276, 0.5571428775787354], 'loss': [3.087638807296753, 2.2569700309208462, 1.91889728478023, 1.8578063590185983, 1.5387698998526922, 1.6403460502624512, 1.7647760578564236, 1.2962524907929556], 'val_acc': [0.06493506590267281, 0.337662343855028, 0.32467532661054044, 0.3636363690549677, 0.33766233959755343, 0.2727272746624885, 0.38961039154560534, 0.5714285853621247]}, 'runtime': 29.558753728866577}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 12)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 6)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 6) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 6) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 15) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 6)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.007182635529222077, 'height_shift_range': 0.267, 'batch_size': 59, 'num_dense_units_2': 32, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.0004072741051776574, 'num_dense_units_0': 625, 'cnn_learning_rate': 0.0003216988473151285, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 55}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 14:47:04.687150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 4s - loss: 5.6292 - acc: 0.0807 - val_loss: 3.3057 - val_acc: 0.0938
Epoch 2/8
 - 3s - loss: 6.0616 - acc: 0.1949 - val_loss: 2.4719 - val_acc: 0.1250
Epoch 3/8
 - 3s - loss: 3.9224 - acc: 0.2109 - val_loss: 2.8469 - val_acc: 0.0938
Epoch 4/8
 - 3s - loss: 2.9996 - acc: 0.1854 - val_loss: 2.7392 - val_acc: 0.0312
Epoch 5/8
 - 3s - loss: 2.9703 - acc: 0.2119 - val_loss: 2.5268 - val_acc: 0.0312
Epoch 6/8
 - 3s - loss: 2.5021 - acc: 0.2947 - val_loss: 2.5232 - val_acc: 0.0625
Epoch 7/8
 - 3s - loss: 2.2264 - acc: 0.2288 - val_loss: 2.3587 - val_acc: 0.0938
Epoch 8/8
 - 3s - loss: 1.8380 - acc: 0.3685 - val_loss: 2.3133 - val_acc: 0.1250
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 6), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 6) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 6) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 6)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.007182635529222077, 'height_shift_range': 0.267, 'batch_size': 59, 'num_dense_units_2': 32, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.0004072741051776574, 'num_dense_units_0': 625, 'cnn_learning_rate': 0.0003216988473151285, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 55}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.875, 'info': {'histories': {'val_loss': [3.305690288543701, 2.4718899726867676, 2.846942901611328, 2.7391586303710938, 2.5268239974975586, 2.523230791091919, 2.358699321746826, 2.3132829666137695], 'acc': [0.07766990334663576, 0.19491524621844292, 0.21359224197933974, 0.1941747587282681, 0.2118644118309021, 0.3009708781265518, 0.2288135662674904, 0.3689320417283808], 'loss': [5.307904083751938, 6.061567544937134, 3.9379112836226677, 2.9468693131382024, 2.970270872116089, 2.4882859905946604, 2.2263861894607544, 1.8306101410134326], 'val_acc': [0.09375, 0.125, 0.09375, 0.03125, 0.03125, 0.0625, 0.09375, 0.125]}, 'runtime': 31.23398470878601}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 6)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 15)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 15) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 1) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 15) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (2, 0, 15) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 15)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00014126339690024241, 'height_shift_range': 0.267, 'batch_size': 37, 'num_dense_units_2': 13, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.2897140457380931, 'num_dense_units_0': 151, 'cnn_learning_rate': 0.0001231576910192151, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 497}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 14:47:35.912455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 2.3359 - acc: 0.1014 - val_loss: 2.3048 - val_acc: 0.0938
Epoch 2/8
 - 3s - loss: 2.2819 - acc: 0.1579 - val_loss: 2.3025 - val_acc: 0.0938
Epoch 3/8
 - 3s - loss: 2.2339 - acc: 0.1755 - val_loss: 2.3018 - val_acc: 0.1250
Epoch 4/8
 - 3s - loss: 2.2512 - acc: 0.1892 - val_loss: 2.3016 - val_acc: 0.1406
Epoch 5/8
 - 3s - loss: 2.1798 - acc: 0.2349 - val_loss: 2.3039 - val_acc: 0.1094
Epoch 6/8
 - 3s - loss: 2.1519 - acc: 0.2209 - val_loss: 2.3139 - val_acc: 0.0938
Epoch 7/8
 - 3s - loss: 2.0754 - acc: 0.2279 - val_loss: 2.3163 - val_acc: 0.0781
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/8
 - 3s - loss: 2.0303 - acc: 0.2973 - val_loss: 2.3139 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 15), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 15) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 15) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 15) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 15)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00014126339690024241, 'height_shift_range': 0.267, 'batch_size': 37, 'num_dense_units_2': 13, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.2897140457380931, 'num_dense_units_0': 151, 'cnn_learning_rate': 0.0001231576910192151, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 497}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.890625, 'info': {'histories': {'val_loss': [2.304774761199951, 2.3024762868881226, 2.301753044128418, 2.3016161918640137, 2.303894877433777, 2.3139482736587524, 2.3162546157836914, 2.313922882080078], 'acc': [0.10135135613381863, 0.16000000751018525, 0.18627451579360402, 0.18918919563293457, 0.24800001680850983, 0.23200001311302185, 0.24000000834465027, 0.29729731380939484], 'loss': [2.335936725139618, 2.283468605041504, 2.2389034663929657, 2.2511828541755676, 2.1856330509185793, 2.1430004138946535, 2.0842211894989013, 2.0302911698818207], 'val_acc': [0.09375, 0.09375, 0.125, 0.140625, 0.109375, 0.09375, 0.078125, 0.109375]}, 'runtime': 33.19541001319885}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 15)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 1)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 1) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 14) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 1) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008383709547929253, 'height_shift_range': 0.267, 'batch_size': 35, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.16893901440112918, 'num_dense_units_0': 154, 'cnn_learning_rate': 0.00022435029177690212, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 439}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 14:48:07.839697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 4s - loss: 2.4975 - acc: 0.0908 - val_loss: 2.5013 - val_acc: 0.1094
Epoch 2/8
 - 3s - loss: 2.3949 - acc: 0.0786 - val_loss: 2.5363 - val_acc: 0.0781
Epoch 3/8
 - 3s - loss: 2.4308 - acc: 0.0763 - val_loss: 2.4234 - val_acc: 0.1094
Epoch 4/8
 - 3s - loss: 2.4397 - acc: 0.0836 - val_loss: 2.4457 - val_acc: 0.0938
Epoch 5/8
 - 3s - loss: 2.3850 - acc: 0.0942 - val_loss: 2.4120 - val_acc: 0.1406
Epoch 6/8
 - 3s - loss: 2.4288 - acc: 0.0929 - val_loss: 2.4442 - val_acc: 0.1094
Epoch 7/8
 - 3s - loss: 2.3889 - acc: 0.0942 - val_loss: 2.4239 - val_acc: 0.0938
Epoch 8/8
 - 3s - loss: 2.3728 - acc: 0.0923 - val_loss: 2.3866 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 1)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0008383709547929253, 'height_shift_range': 0.267, 'batch_size': 35, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.16893901440112918, 'num_dense_units_0': 154, 'cnn_learning_rate': 0.00022435029177690212, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 439}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.890625, 'info': {'histories': {'val_loss': [2.501326084136963, 2.5362640619277954, 2.423399806022644, 2.4456576108932495, 2.412003755569458, 2.4442113637924194, 2.423884868621826, 2.386580228805542], 'acc': [0.09448819226167333, 0.0785714304074645, 0.07874015862430174, 0.08661417390300533, 0.0944881909123556, 0.0928571461699903, 0.09448819142568299, 0.09649123153404186], 'loss': [2.497856648888175, 2.394943654537201, 2.426937563212838, 2.4332228101144624, 2.3827076765495963, 2.428818106651306, 2.3933651841531587, 2.3583154176410877], 'val_acc': [0.109375, 0.078125, 0.109375, 0.09375, 0.140625, 0.109375, 0.09375, 0.109375]}, 'runtime': 27.95223331451416}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 1)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 14)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 14) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 14) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 5) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 14) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 14)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000196316894784971, 'height_shift_range': 0.267, 'batch_size': 38, 'num_dense_units_2': 21, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.08717978237230432, 'num_dense_units_0': 100, 'cnn_learning_rate': 5.4346436903413856e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 161}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 14:48:40.742841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 7s - loss: 2.4326 - acc: 0.1110 - val_loss: 2.3158 - val_acc: 0.0781
Epoch 2/8
 - 5s - loss: 2.2756 - acc: 0.1316 - val_loss: 2.3252 - val_acc: 0.1094
Epoch 3/8
 - 4s - loss: 2.1058 - acc: 0.2867 - val_loss: 2.3831 - val_acc: 0.1094
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/8
 - 5s - loss: 2.1524 - acc: 0.1974 - val_loss: 2.2989 - val_acc: 0.1562
Epoch 5/8
 - 5s - loss: 2.0583 - acc: 0.3124 - val_loss: 2.1706 - val_acc: 0.2812
Epoch 6/8
 - 5s - loss: 2.0238 - acc: 0.3173 - val_loss: 2.3000 - val_acc: 0.1250
Epoch 7/8
 - 5s - loss: 1.9867 - acc: 0.4013 - val_loss: 2.2181 - val_acc: 0.1406
Epoch 8/8
 - 5s - loss: 1.8624 - acc: 0.5000 - val_loss: 2.1719 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 14), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 14) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 14) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 14) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 14)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000196316894784971, 'height_shift_range': 0.267, 'batch_size': 38, 'num_dense_units_2': 21, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.08717978237230432, 'num_dense_units_0': 100, 'cnn_learning_rate': 5.4346436903413856e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 161}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.84375, 'info': {'histories': {'val_loss': [2.3157548904418945, 2.3251510858535767, 2.383071184158325, 2.2989221811294556, 2.1705775260925293, 2.2999868392944336, 2.21811580657959, 2.171888589859009], 'acc': [0.11290322784935275, 0.1315789483487606, 0.3229166686845322, 0.19736842066049576, 0.3145161275902102, 0.3548387112396379, 0.4013157784938812, 0.5], 'loss': [2.395670167861446, 2.2756265997886658, 2.1071142653624215, 2.1524049639701843, 2.0644438805118686, 2.011617097162431, 1.9866662621498108, 1.860179893432125], 'val_acc': [0.078125, 0.109375, 0.109375, 0.15625, 0.28125, 0.125, 0.140625, 0.15625]}, 'runtime': 51.183332204818726}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 14)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 5)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 5) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 0) to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (2, 0, 5) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 5)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.007985255741819025, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.25532759512202996, 'num_dense_units_0': 130, 'cnn_learning_rate': 6.989110699041067e-05, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 200}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 14:49:32.351554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 7s - loss: 2.3671 - acc: 0.0633 - val_loss: 2.3152 - val_acc: 0.0909
Epoch 2/8
 - 5s - loss: 2.2773 - acc: 0.2272 - val_loss: 2.3120 - val_acc: 0.0779
Epoch 3/8
 - 6s - loss: 2.3189 - acc: 0.0807 - val_loss: 2.2986 - val_acc: 0.1299
Epoch 4/8
 - 5s - loss: 2.2473 - acc: 0.2146 - val_loss: 2.2862 - val_acc: 0.1169
Epoch 5/8
 - 5s - loss: 2.3198 - acc: 0.0950 - val_loss: 2.2622 - val_acc: 0.1558
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 6/8
 - 5s - loss: 2.2682 - acc: 0.1393 - val_loss: 2.2341 - val_acc: 0.1429
Epoch 7/8
 - 5s - loss: 2.3238 - acc: 0.1267 - val_loss: 2.2336 - val_acc: 0.1429
Epoch 8/8
 - 5s - loss: 2.2677 - acc: 0.1900 - val_loss: 2.2004 - val_acc: 0.2468
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 5), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 5) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 5) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 5)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.007985255741819025, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.25532759512202996, 'num_dense_units_0': 130, 'cnn_learning_rate': 6.989110699041067e-05, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 200}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.7532467522791454, 'info': {'histories': {'val_loss': [2.315205394447624, 2.312048555968644, 2.298577358196308, 2.286246120155632, 2.26220982105701, 2.2340897151402066, 2.2335868532007392, 2.200448955808367], 'acc': [0.07194244615036807, 0.1223021579517735, 0.08074534152235303, 0.10791366847513391, 0.10791367045838199, 0.1582733860922803, 0.14388489414998096, 0.21582734338242374], 'loss': [2.328152431858529, 2.3084105004509574, 2.318918602807181, 2.296142335418317, 2.2975677208934755, 2.2822632017753106, 2.2848250076925156, 2.242865342888043], 'val_acc': [0.09090909090909091, 0.07792207840588186, 0.12987013257943192, 0.11688311881833262, 0.15584415584415584, 0.14285714382475073, 0.1428571447923586, 0.24675324772085463]}, 'runtime': 54.4990017414093}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 5)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 0) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 9) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (2, 0, 0) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 0)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000357888533287373, 'height_shift_range': 0.267, 'batch_size': 59, 'num_dense_units_2': 12, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.1452951978638344, 'num_dense_units_0': 778, 'cnn_learning_rate': 0.0003044134208470986, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 85}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 14:50:22.765065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 4s - loss: 2.4028 - acc: 0.1410 - val_loss: 2.3684 - val_acc: 0.1562
Epoch 2/8
 - 3s - loss: 2.0102 - acc: 0.3152 - val_loss: 2.3365 - val_acc: 0.1562
Epoch 3/8
 - 3s - loss: 1.9726 - acc: 0.3390 - val_loss: 2.4570 - val_acc: 0.1250
Epoch 4/8
 - 3s - loss: 1.6724 - acc: 0.5400 - val_loss: 2.4348 - val_acc: 0.1875
Epoch 5/8
 - 3s - loss: 1.6677 - acc: 0.5424 - val_loss: 2.4874 - val_acc: 0.0938
Epoch 6/8
 - 3s - loss: 1.5111 - acc: 0.5616 - val_loss: 2.4872 - val_acc: 0.1250
Epoch 7/8
 - 3s - loss: 1.4625 - acc: 0.6080 - val_loss: 2.5422 - val_acc: 0.0625
Epoch 8/8
 - 3s - loss: 1.4232 - acc: 0.6525 - val_loss: 2.4669 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 0)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000357888533287373, 'height_shift_range': 0.267, 'batch_size': 59, 'num_dense_units_2': 12, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.1452951978638344, 'num_dense_units_0': 778, 'cnn_learning_rate': 0.0003044134208470986, 'cnn_unlock_epoch': 30, 'num_dense_units_1': 85}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.84375, 'info': {'histories': {'val_loss': [2.3684167861938477, 2.336493968963623, 2.456982374191284, 2.4347786903381348, 2.4874205589294434, 2.487213373184204, 2.542243003845215, 2.466865062713623], 'acc': [0.14563106825050798, 0.31067961656931536, 0.33898304402828217, 0.5436893146014908, 0.5423728823661804, 0.5631067972738766, 0.6116504646042018, 0.6525423526763916], 'loss': [2.400383930761837, 2.0211071736604262, 1.9725828170776367, 1.6775122047628013, 1.6676673293113708, 1.5174727324143196, 1.459403431531295, 1.4232027530670166], 'val_acc': [0.15625, 0.15625, 0.125, 0.1875, 0.09375, 0.125, 0.0625, 0.15625]}, 'runtime': 30.133443355560303}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 0)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 9)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 9) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 9) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 1) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 9)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0004025741769331608, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 103, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.1967028679054808, 'num_dense_units_0': 170, 'cnn_learning_rate': 5.264988714256396e-05, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 54}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 14:50:53.600894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 2.3198 - acc: 0.1228 - val_loss: 2.3383 - val_acc: 0.0938
Epoch 2/8
 - 4s - loss: 2.2304 - acc: 0.2884 - val_loss: 2.3528 - val_acc: 0.2188
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/8
 - 4s - loss: 2.0930 - acc: 0.2821 - val_loss: 2.1722 - val_acc: 0.1875
Epoch 4/8
 - 3s - loss: 2.0439 - acc: 0.3604 - val_loss: 2.2044 - val_acc: 0.1562
Epoch 5/8
 - 4s - loss: 1.9717 - acc: 0.3548 - val_loss: 2.2421 - val_acc: 0.2188
Epoch 6/8
 - 3s - loss: 1.7794 - acc: 0.4696 - val_loss: 2.1277 - val_acc: 0.1875
Epoch 7/8
 - 3s - loss: 1.7806 - acc: 0.4549 - val_loss: 1.9522 - val_acc: 0.4062
Epoch 8/8
 - 4s - loss: 1.6037 - acc: 0.5449 - val_loss: 1.9444 - val_acc: 0.3750
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 9), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 9) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 9)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0004025741769331608, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 103, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.1967028679054808, 'num_dense_units_0': 170, 'cnn_learning_rate': 5.264988714256396e-05, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 54}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.625, 'info': {'histories': {'val_loss': [2.3383278846740723, 2.352813482284546, 2.172201156616211, 2.2043914794921875, 2.242051124572754, 2.1276652812957764, 1.9521510601043701, 1.9444043636322021], 'acc': [0.11382114396589559, 0.21138212302835976, 0.28205129504203796, 0.36585367598184726, 0.3252032624512184, 0.46341464577651603, 0.4796748263079946, 0.5448718219995499], 'loss': [2.3310032414226995, 2.290177467392712, 2.0930325388908386, 2.007938338489067, 1.9687275246876041, 1.8157079772251408, 1.772554132996536, 1.6036773025989532], 'val_acc': [0.09375, 0.21875, 0.1875, 0.15625, 0.21875, 0.1875, 0.40625, 0.375]}, 'runtime': 35.751485109329224}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 9)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 1)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 1) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 12) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (3, 0, 1) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (3, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000364016336662245, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 24, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.17071923687657745, 'num_dense_units_0': 346, 'cnn_learning_rate': 5.041181762400048e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 276}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 14:51:27.959575: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 2.2939 - acc: 0.1418 - val_loss: 2.2058 - val_acc: 0.2188
Epoch 2/8
 - 3s - loss: 2.1485 - acc: 0.2118 - val_loss: 1.9149 - val_acc: 0.5000
Epoch 3/8
 - 3s - loss: 1.8557 - acc: 0.4103 - val_loss: 1.8009 - val_acc: 0.5000
Epoch 4/8
 - 2s - loss: 2.0717 - acc: 0.3468 - val_loss: 2.3914 - val_acc: 0.1250
Epoch 5/8
 - 3s - loss: 1.7503 - acc: 0.4231 - val_loss: 1.9842 - val_acc: 0.2188
Epoch 6/8
 - 2s - loss: 1.6656 - acc: 0.4402 - val_loss: 1.8342 - val_acc: 0.3438
Epoch 7/8
 - 3s - loss: 1.4667 - acc: 0.5385 - val_loss: 1.4537 - val_acc: 0.5625
Epoch 8/8
 - 2s - loss: 1.5999 - acc: 0.5225 - val_loss: 1.6646 - val_acc: 0.4375
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (3, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (3, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (3, 0, 1)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000364016336662245, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 24, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.17071923687657745, 'num_dense_units_0': 346, 'cnn_learning_rate': 5.041181762400048e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 276}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.5625, 'info': {'histories': {'val_loss': [2.2057816982269287, 1.914892315864563, 1.800896167755127, 2.3914408683776855, 1.9841864109039307, 1.8341665267944336, 1.4536851644515991, 1.6645828485488892], 'acc': [0.1707317160397041, 0.18699187912592075, 0.41025643050670624, 0.3111111169060071, 0.42307694628834724, 0.49593498721355345, 0.5384615585207939, 0.5609756344702186], 'loss': [2.2934181515763448, 2.1898312743117168, 1.855676531791687, 2.0193762461344402, 1.7502506375312805, 1.5445818319553282, 1.4666794538497925, 1.5216851583341273], 'val_acc': [0.21875, 0.5, 0.5, 0.125, 0.21875, 0.34375, 0.5625, 0.4375]}, 'runtime': 26.53735637664795}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 1)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 12)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 12) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 12) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 14) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 12)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0010192003596035026, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 140, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.05015390769595599, 'num_dense_units_0': 427, 'cnn_learning_rate': 5.93659901713247e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 245}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 14:51:54.537545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 5s - loss: 3.0641 - acc: 0.1677 - val_loss: 2.3025 - val_acc: 0.2338
Epoch 2/16
 - 3s - loss: 2.2122 - acc: 0.1512 - val_loss: 2.0194 - val_acc: 0.2857
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/16
 - 3s - loss: 1.8350 - acc: 0.3896 - val_loss: 1.7940 - val_acc: 0.4156
Epoch 4/16
 - 3s - loss: 1.4967 - acc: 0.4500 - val_loss: 1.6745 - val_acc: 0.3506
Epoch 5/16
 - 3s - loss: 1.5942 - acc: 0.4607 - val_loss: 1.4342 - val_acc: 0.5065
Epoch 6/16
 - 3s - loss: 1.5253 - acc: 0.5130 - val_loss: 1.1675 - val_acc: 0.6364
Epoch 7/16
 - 3s - loss: 1.1962 - acc: 0.6547 - val_loss: 1.0678 - val_acc: 0.7013
Epoch 8/16
 - 3s - loss: 0.9979 - acc: 0.6875 - val_loss: 1.6903 - val_acc: 0.4675
Epoch 9/16
 - 3s - loss: 1.1092 - acc: 0.5657 - val_loss: 1.2255 - val_acc: 0.6234
Epoch 10/16
 - 3s - loss: 1.0232 - acc: 0.6249 - val_loss: 1.2383 - val_acc: 0.6494
Epoch 11/16
 - 3s - loss: 1.0790 - acc: 0.6039 - val_loss: 0.9877 - val_acc: 0.7013
Epoch 12/16
 - 3s - loss: 0.6961 - acc: 0.7598 - val_loss: 1.0643 - val_acc: 0.7143
Epoch 13/16
 - 3s - loss: 1.0373 - acc: 0.6709 - val_loss: 0.8788 - val_acc: 0.7143
Epoch 14/16
 - 3s - loss: 0.9089 - acc: 0.6345 - val_loss: 0.7788 - val_acc: 0.7013
Epoch 15/16
 - 3s - loss: 0.6158 - acc: 0.8518 - val_loss: 0.8315 - val_acc: 0.7403
Epoch 16/16
 - 3s - loss: 0.6149 - acc: 0.7927 - val_loss: 0.9499 - val_acc: 0.7403
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 12), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 12) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 12)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0010192003596035026, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 140, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.05015390769595599, 'num_dense_units_0': 427, 'cnn_learning_rate': 5.93659901713247e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 245}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.259740247354879, 'info': {'histories': {'val_loss': [2.3024903799032237, 2.0193971844462606, 1.7940236624185142, 1.6744731045388557, 1.434216864697345, 1.1675382976408128, 1.0678126688127394, 1.6902979457533205, 1.2254632045696308, 1.2382611531715888, 0.9876821675857941, 1.0643263188275425, 0.8787613565271551, 0.7788185469515911, 0.831521048174276, 0.949855123247419], 'acc': [0.17142857866627828, 0.16428571918181012, 0.3896103969642094, 0.4523809485965305, 0.4357142903975078, 0.5129870261464801, 0.6357142984867096, 0.6928571624415262, 0.5714285829237529, 0.6357143061501639, 0.6038961282798222, 0.7714285816465105, 0.6857143099818911, 0.6785714532647814, 0.8714285893099648, 0.8071428707667759], 'loss': [2.9335116965430124, 2.174638845239367, 1.8350059304918562, 1.5108445844953022, 1.6293276139668056, 1.5252585411071777, 1.2258559780461447, 0.9359446772507258, 1.118544157913753, 0.9865394404956273, 1.0790447337286813, 0.6699457968984331, 0.9881999850273132, 0.8243263508592333, 0.5882984378508159, 0.5855950432164329], 'val_acc': [0.2337662357014495, 0.2857142866818936, 0.4155844194548471, 0.3506493560679547, 0.5064935111380243, 0.6363636487490171, 0.7012987129099957, 0.4675324737251579, 0.6233766272470549, 0.6493506524469945, 0.7012987121359094, 0.7142857181561457, 0.7142857181561457, 0.7012987043950465, 0.7402597433560855, 0.740259752645121]}, 'runtime': 56.068997383117676}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 12)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 14)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 14) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 5) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 14) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 14) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 14)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000196316894784971, 'height_shift_range': 0.267, 'batch_size': 38, 'num_dense_units_2': 21, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.08717978237230432, 'num_dense_units_0': 100, 'cnn_learning_rate': 5.4346436903413856e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 161}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 14:52:56.143660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 7s - loss: 2.3250 - acc: 0.0904 - val_loss: 2.3285 - val_acc: 0.1562
Epoch 2/16
 - 5s - loss: 2.1887 - acc: 0.2230 - val_loss: 2.2437 - val_acc: 0.2031
Epoch 3/16
 - 5s - loss: 2.2176 - acc: 0.2004 - val_loss: 2.2331 - val_acc: 0.2500
Epoch 4/16
 - 5s - loss: 2.0785 - acc: 0.3289 - val_loss: 2.1866 - val_acc: 0.2344
Epoch 5/16
 - 5s - loss: 2.0707 - acc: 0.3261 - val_loss: 2.1227 - val_acc: 0.2656
Epoch 6/16
 - 5s - loss: 1.9847 - acc: 0.3674 - val_loss: 2.0590 - val_acc: 0.3281
Epoch 7/16
 - 5s - loss: 1.9454 - acc: 0.3947 - val_loss: 2.0411 - val_acc: 0.3281
Epoch 8/16
 - 5s - loss: 1.8849 - acc: 0.4371 - val_loss: 1.9679 - val_acc: 0.3594
Epoch 9/16
 - 5s - loss: 1.8028 - acc: 0.3969 - val_loss: 1.9809 - val_acc: 0.3594
Epoch 10/16
 - 5s - loss: 1.8723 - acc: 0.4784 - val_loss: 1.8674 - val_acc: 0.3906
Epoch 11/16
 - 5s - loss: 1.7922 - acc: 0.4519 - val_loss: 1.8285 - val_acc: 0.5156
Epoch 12/16
 - 5s - loss: 1.7312 - acc: 0.4931 - val_loss: 1.8677 - val_acc: 0.4062
Epoch 13/16
 - 5s - loss: 1.6401 - acc: 0.6385 - val_loss: 1.8280 - val_acc: 0.3438
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 14/16
 - 5s - loss: 1.7206 - acc: 0.4646 - val_loss: 1.8264 - val_acc: 0.4688
Epoch 15/16
 - 5s - loss: 1.6419 - acc: 0.5789 - val_loss: 1.7300 - val_acc: 0.5312
Epoch 16/16
 - 5s - loss: 1.6669 - acc: 0.5285 - val_loss: 1.7502 - val_acc: 0.4219
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 14), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 14) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 14) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 14) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 14)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000196316894784971, 'height_shift_range': 0.267, 'batch_size': 38, 'num_dense_units_2': 21, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.08717978237230432, 'num_dense_units_0': 100, 'cnn_learning_rate': 5.4346436903413856e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 161}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.578125, 'info': {'histories': {'val_loss': [2.328474998474121, 2.243744969367981, 2.2331180572509766, 2.186555504798889, 2.1227259635925293, 2.0589890480041504, 2.0410545468330383, 1.9679034352302551, 1.9808690547943115, 1.8673699498176575, 1.828479528427124, 1.8676567673683167, 1.8279833793640137, 1.8264331221580505, 1.7299580574035645, 1.750156283378601], 'acc': [0.08870967585713632, 0.20967742055654526, 0.21774193944950257, 0.32894736528396606, 0.3306451713846576, 0.3790322571031509, 0.3947368487715721, 0.44354838950018727, 0.37903226287134234, 0.4919354934846201, 0.443548392384283, 0.49193549636871586, 0.6451612989748677, 0.47580646795611226, 0.5789473652839661, 0.5161290399489864], 'loss': [2.3534831731550154, 2.210666691103289, 2.199387119662377, 2.0785043835639954, 2.0648369827578144, 1.9897910721840397, 1.9453844130039215, 1.8861215729867258, 1.8312525864570373, 1.8639409234446864, 1.797535986669602, 1.7182924612875907, 1.6232319031992266, 1.7007343711391572, 1.6418873071670532, 1.6630556717995675], 'val_acc': [0.15625, 0.203125, 0.25, 0.234375, 0.265625, 0.328125, 0.328125, 0.359375, 0.359375, 0.390625, 0.515625, 0.40625, 0.34375, 0.46875, 0.53125, 0.421875]}, 'runtime': 90.12547516822815}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 14)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 5)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 5) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 9) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 5) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 5)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.007985255741819025, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.25532759512202996, 'num_dense_units_0': 130, 'cnn_learning_rate': 6.989110699041067e-05, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 200}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 14:54:26.174612: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 7s - loss: 2.3365 - acc: 0.0570 - val_loss: 2.2881 - val_acc: 0.0649
Epoch 2/16
 - 6s - loss: 2.3140 - acc: 0.0932 - val_loss: 2.2719 - val_acc: 0.1429
Epoch 3/16
 - 5s - loss: 2.2909 - acc: 0.1393 - val_loss: 2.2679 - val_acc: 0.1558
Epoch 4/16
 - 5s - loss: 2.2944 - acc: 0.1203 - val_loss: 2.2741 - val_acc: 0.1558
Epoch 5/16
 - 5s - loss: 2.2657 - acc: 0.1041 - val_loss: 2.2484 - val_acc: 0.1429
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 6/16
 - 6s - loss: 2.2766 - acc: 0.1267 - val_loss: 2.2455 - val_acc: 0.1948
Epoch 7/16
 - 6s - loss: 2.2574 - acc: 0.1988 - val_loss: 2.2312 - val_acc: 0.2208
Epoch 8/16
 - 5s - loss: 2.2608 - acc: 0.1013 - val_loss: 2.2375 - val_acc: 0.2078
Epoch 9/16
 - 6s - loss: 2.2077 - acc: 0.1393 - val_loss: 2.2320 - val_acc: 0.1429
Epoch 10/16
 - 5s - loss: 2.1900 - acc: 0.1393 - val_loss: 2.2372 - val_acc: 0.1688
Epoch 11/16
 - 6s - loss: 2.2719 - acc: 0.1584 - val_loss: 2.2206 - val_acc: 0.1558
Epoch 12/16
 - 5s - loss: 2.1844 - acc: 0.2716 - val_loss: 2.2116 - val_acc: 0.1818
Epoch 13/16
 - 6s - loss: 2.2133 - acc: 0.1739 - val_loss: 2.1706 - val_acc: 0.2338
Epoch 14/16
 - 6s - loss: 2.2348 - acc: 0.2280 - val_loss: 2.1600 - val_acc: 0.3247
Epoch 15/16
 - 5s - loss: 2.2598 - acc: 0.2787 - val_loss: 2.1494 - val_acc: 0.3377
Epoch 16/16
 - 5s - loss: 2.1842 - acc: 0.2280 - val_loss: 2.1453 - val_acc: 0.2597
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 5), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 5) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 5) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 5)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.007985255741819025, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.25532759512202996, 'num_dense_units_0': 130, 'cnn_learning_rate': 6.989110699041067e-05, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 200}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.7402597383245245, 'info': {'histories': {'val_loss': [2.288146043752695, 2.2719367541276014, 2.2678690761714786, 2.274050935522302, 2.248375836904947, 2.245451759982419, 2.2312466943418823, 2.2375286647251675, 2.231987377265831, 2.2372056601883528, 2.2206496511186873, 2.2115925256308024, 2.17055505281919, 2.160024881362915, 2.1493502096696333, 2.1452818505175704], 'acc': [0.06474820202846321, 0.09316770253436905, 0.1582733817773757, 0.13669064817883128, 0.13675213783469975, 0.14388489291715106, 0.1987577708704131, 0.11510791396387189, 0.15827338547586536, 0.1582733830102056, 0.1798561159923351, 0.1726618729692569, 0.17391304246016911, 0.2589928118123425, 0.3165467610890917, 0.25899281427800225], 'loss': [2.3373764075821253, 2.3139703954969133, 2.246533755775836, 2.3014198052797386, 2.240258885245038, 2.2649601449211723, 2.25740419115339, 2.2331510156178647, 2.225042416895036, 2.1995976417184733, 2.2410393876137493, 2.231867036373495, 2.2132773399353027, 2.1764205702774815, 2.1921867518116245, 2.16379182973354], 'val_acc': [0.06493506541886887, 0.1428571433409468, 0.15584415681176372, 0.15584415632795978, 0.14285714556644488, 0.19480519528899873, 0.2207792227144365, 0.20779220827601172, 0.1428571433409468, 0.16883116931497277, 0.15584415681176372, 0.18181818230198576, 0.23376623473384164, 0.32467532661054044, 0.3376623403716397, 0.2597402616754755]}, 'runtime': 102.0229423046112}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 5)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 9)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 9) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 9) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 9)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0004025741769331608, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 103, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.1967028679054808, 'num_dense_units_0': 170, 'cnn_learning_rate': 5.264988714256396e-05, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 54}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 14:56:04.697464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 6s - loss: 2.4524 - acc: 0.1498 - val_loss: 2.3644 - val_acc: 0.1562
Epoch 2/16
 - 4s - loss: 2.2153 - acc: 0.1633 - val_loss: 2.3463 - val_acc: 0.0625
Epoch 3/16
 - 4s - loss: 2.1594 - acc: 0.1667 - val_loss: 2.2082 - val_acc: 0.1562
Epoch 4/16
 - 3s - loss: 2.1123 - acc: 0.2181 - val_loss: 2.1292 - val_acc: 0.2188
Epoch 5/16
 - 4s - loss: 1.9159 - acc: 0.4167 - val_loss: 2.1327 - val_acc: 0.1250
Epoch 6/16
 - 3s - loss: 1.9451 - acc: 0.3174 - val_loss: 2.1153 - val_acc: 0.1875
Epoch 7/16
 - 3s - loss: 1.8433 - acc: 0.4211 - val_loss: 2.0534 - val_acc: 0.2500
Epoch 8/16
 - 4s - loss: 1.6245 - acc: 0.5513 - val_loss: 1.8041 - val_acc: 0.3438
Epoch 9/16
 - 3s - loss: 1.6067 - acc: 0.5157 - val_loss: 1.9861 - val_acc: 0.3125
Epoch 10/16
 - 4s - loss: 1.5784 - acc: 0.5495 - val_loss: 1.9714 - val_acc: 0.1562
Epoch 11/16
 - 3s - loss: 1.5251 - acc: 0.5586 - val_loss: 1.8573 - val_acc: 0.2812
Epoch 12/16
 - 3s - loss: 1.3822 - acc: 0.6814 - val_loss: 1.8912 - val_acc: 0.3125
Epoch 13/16
 - 4s - loss: 1.4526 - acc: 0.6026 - val_loss: 1.6869 - val_acc: 0.4062
Epoch 14/16
 - 4s - loss: 1.3076 - acc: 0.5900 - val_loss: 1.7371 - val_acc: 0.4375
Epoch 15/16
 - 3s - loss: 1.2333 - acc: 0.7489 - val_loss: 1.6530 - val_acc: 0.2812
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 16/16
 - 3s - loss: 1.3012 - acc: 0.6623 - val_loss: 1.6082 - val_acc: 0.3438
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 9), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 9) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 9) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 9)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0004025741769331608, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 103, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.1967028679054808, 'num_dense_units_0': 170, 'cnn_learning_rate': 5.264988714256396e-05, 'cnn_unlock_epoch': 16, 'num_dense_units_1': 54}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.65625, 'info': {'histories': {'val_loss': [2.364356756210327, 2.346266984939575, 2.208207607269287, 2.1292476654052734, 2.132733106613159, 2.1152703762054443, 2.0534064769744873, 1.80405855178833, 1.9861159324645996, 1.97141695022583, 1.85733962059021, 1.891223669052124, 1.6868844032287598, 1.737094759941101, 1.6530206203460693, 1.6082217693328857], 'acc': [0.14634146723078517, 0.1626016324067988, 0.1666666716337204, 0.24444445123275121, 0.416666679084301, 0.38211383616052025, 0.4390244127773657, 0.5512820780277252, 0.5528455442044793, 0.5934959577351082, 0.5365853934753232, 0.6504065263562087, 0.602564126253128, 0.6422764426324425, 0.7317073345184326, 0.5934959497393631], 'loss': [2.422683820491884, 2.212728401509727, 2.1594345569610596, 2.117487366994222, 1.9158807694911957, 1.8580164967513666, 1.8487639717939424, 1.6244883835315704, 1.608481732810416, 1.5062370561971896, 1.5583127824271596, 1.4291323045404947, 1.4525937736034393, 1.2304512960154836, 1.197709016683625, 1.3660127854928739], 'val_acc': [0.15625, 0.0625, 0.15625, 0.21875, 0.125, 0.1875, 0.25, 0.34375, 0.3125, 0.15625, 0.28125, 0.3125, 0.40625, 0.4375, 0.28125, 0.34375]}, 'runtime': 64.28141951560974}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 9)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 2)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 2) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 12) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (3, 0, 2) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (3, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000868440879631394, 'height_shift_range': 0.267, 'batch_size': 26, 'num_dense_units_2': 57, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.062292327256539444, 'num_dense_units_0': 407, 'cnn_learning_rate': 1.5705998919914355e-05, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 119}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 14:57:08.931792: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 8s - loss: 2.3906 - acc: 0.0962 - val_loss: 2.3141 - val_acc: 0.0781
Epoch 2/8
 - 4s - loss: 2.3003 - acc: 0.1577 - val_loss: 2.2675 - val_acc: 0.2500
Epoch 3/8
 - 4s - loss: 2.1740 - acc: 0.1688 - val_loss: 2.1296 - val_acc: 0.1719
Epoch 4/8
 - 4s - loss: 2.0384 - acc: 0.2932 - val_loss: 2.0402 - val_acc: 0.2031
Epoch 5/8
 - 5s - loss: 1.9034 - acc: 0.3077 - val_loss: 1.9861 - val_acc: 0.2969
Epoch 6/8
 - 4s - loss: 1.6930 - acc: 0.4686 - val_loss: 1.6973 - val_acc: 0.5469
Epoch 7/8
 - 5s - loss: 1.7866 - acc: 0.3992 - val_loss: 1.7881 - val_acc: 0.2969
Epoch 8/8
 - 5s - loss: 1.4279 - acc: 0.5256 - val_loss: 1.8502 - val_acc: 0.2969
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (3, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (3, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (3, 0, 2)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000868440879631394, 'height_shift_range': 0.267, 'batch_size': 26, 'num_dense_units_2': 57, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.062292327256539444, 'num_dense_units_0': 407, 'cnn_learning_rate': 1.5705998919914355e-05, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 119}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.703125, 'info': {'histories': {'val_loss': [2.314143657684326, 2.2674665451049805, 2.1296147108078003, 2.04016649723053, 1.9860620498657227, 1.6973029971122742, 1.788057565689087, 1.850168764591217], 'acc': [0.0961538515985012, 0.15517242362016234, 0.16911766042604165, 0.3088235572418746, 0.30769232163826626, 0.4852941327673547, 0.4485294249127893, 0.52564104894797], 'loss': [2.3905842304229736, 2.318565845489502, 2.194178619805504, 2.0478676399763893, 1.903368314107259, 1.6663018079365002, 1.7271245893310099, 1.427881399790446], 'val_acc': [0.078125, 0.25, 0.171875, 0.203125, 0.296875, 0.546875, 0.296875, 0.296875]}, 'runtime': 46.56470227241516}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 12)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 12) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 12) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 14) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 12)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0010192003596035026, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 140, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.05015390769595599, 'num_dense_units_0': 427, 'cnn_learning_rate': 5.93659901713247e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 245}, 'working_directory': '.', 'budget': 32.0}
2018-02-08 14:57:54.296865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/27
 - 5s - loss: 2.9798 - acc: 0.1414 - val_loss: 2.2099 - val_acc: 0.1299
Epoch 2/27
 - 3s - loss: 2.2758 - acc: 0.1843 - val_loss: 1.9662 - val_acc: 0.2597
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/27
 - 3s - loss: 1.8169 - acc: 0.3896 - val_loss: 2.0193 - val_acc: 0.2727
Epoch 4/27
 - 3s - loss: 1.8352 - acc: 0.3468 - val_loss: 1.9376 - val_acc: 0.2597
Epoch 5/27
 - 3s - loss: 1.6412 - acc: 0.4474 - val_loss: 1.4279 - val_acc: 0.5325
Epoch 6/27
 - 3s - loss: 1.3142 - acc: 0.6104 - val_loss: 1.1878 - val_acc: 0.7013
Epoch 7/27
 - 3s - loss: 1.2811 - acc: 0.5565 - val_loss: 1.1290 - val_acc: 0.6364
Epoch 8/27
 - 3s - loss: 1.0396 - acc: 0.6883 - val_loss: 1.3448 - val_acc: 0.5065
Epoch 9/27
 - 3s - loss: 0.9202 - acc: 0.7072 - val_loss: 1.8422 - val_acc: 0.4156
Epoch 10/27
 - 3s - loss: 1.0813 - acc: 0.6743 - val_loss: 0.8596 - val_acc: 0.7403
Epoch 11/27
 - 3s - loss: 0.6557 - acc: 0.8182 - val_loss: 0.8991 - val_acc: 0.7532
Epoch 12/27
 - 3s - loss: 0.9769 - acc: 0.6731 - val_loss: 0.7448 - val_acc: 0.7662
Epoch 13/27
 - 3s - loss: 0.7805 - acc: 0.7273 - val_loss: 1.1763 - val_acc: 0.6104
Epoch 14/27
 - 3s - loss: 0.7539 - acc: 0.7599 - val_loss: 0.7657 - val_acc: 0.7403
Epoch 15/27
 - 3s - loss: 0.7978 - acc: 0.7235 - val_loss: 0.8119 - val_acc: 0.7532
Epoch 16/27
 - 3s - loss: 0.7158 - acc: 0.7500 - val_loss: 0.8520 - val_acc: 0.7532
Epoch 17/27
 - 3s - loss: 0.5345 - acc: 0.8312 - val_loss: 0.6283 - val_acc: 0.8052
Epoch 18/27
 - 3s - loss: 0.6658 - acc: 0.7766 - val_loss: 0.9885 - val_acc: 0.7143
Epoch 19/27
 - 3s - loss: 0.3730 - acc: 0.8520 - val_loss: 1.1957 - val_acc: 0.6753
Epoch 20/27
 - 3s - loss: 0.4675 - acc: 0.8156 - val_loss: 2.7694 - val_acc: 0.4286
Epoch 21/27
 - 3s - loss: 1.0040 - acc: 0.7402 - val_loss: 0.9255 - val_acc: 0.7273
Epoch 22/27
 - 3s - loss: 0.4695 - acc: 0.8701 - val_loss: 1.3212 - val_acc: 0.6104
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 23/27
 - 3s - loss: 0.9074 - acc: 0.7335 - val_loss: 1.3961 - val_acc: 0.6883
Epoch 24/27
 - 3s - loss: 0.2809 - acc: 0.8914 - val_loss: 0.9519 - val_acc: 0.8052
Epoch 25/27
 - 3s - loss: 0.5518 - acc: 0.8223 - val_loss: 0.9087 - val_acc: 0.7532
Epoch 26/27
 - 3s - loss: 0.2010 - acc: 0.9408 - val_loss: 1.1223 - val_acc: 0.7532
Epoch 27/27
 - 3s - loss: 0.4226 - acc: 0.8685 - val_loss: 1.0920 - val_acc: 0.7403
{'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0010192003596035026, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 140, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.05015390769595599, 'num_dense_units_0': 427, 'cnn_learning_rate': 5.93659901713247e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 245}

 ****** MobileNet unfrozen 1 top blocks, cut_off after layer 78 ******
Epoch 1/5
 - 5s - loss: 0.3052 - acc: 0.9026 - val_loss: 1.1280 - val_acc: 0.7143
Epoch 2/5
 - 3s - loss: 0.2826 - acc: 0.9233 - val_loss: 1.0333 - val_acc: 0.7403
Epoch 3/5
 - 3s - loss: 0.1609 - acc: 0.9416 - val_loss: 1.2542 - val_acc: 0.7013
Epoch 4/5
 - 3s - loss: 0.2396 - acc: 0.9533 - val_loss: 1.2256 - val_acc: 0.7013
Epoch 5/5
 - 3s - loss: 0.2111 - acc: 0.9343 - val_loss: 1.1273 - val_acc: 0.6494
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 12), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 12) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 12)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0010192003596035026, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 140, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.05015390769595599, 'num_dense_units_0': 427, 'cnn_learning_rate': 5.93659901713247e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 245}, 'working_directory': '.', 'budget': 32.0}
result: {'loss': 0.35064934523074653, 'info': {'histories': {'val_loss': [2.209861934959114, 1.9661638705761402, 2.019277659329501, 1.9376052571581555, 1.4279090568616792, 1.1878233884836171, 1.128973183693824, 1.344806595282121, 1.842212032962155, 0.8595975799994036, 0.8990565491961194, 0.7448351499322173, 1.1762745837112525, 0.7657383664861902, 0.8119324329611542, 0.8520273512059992, 0.6282695245433163, 0.9885477679116386, 1.1956915979261522, 2.769412390597455, 0.925511022666832, 1.3212442305180934, 1.3961087960701484, 0.9519497403850803, 0.9087346668367262, 1.1223072688300888, 1.0920041629246302, 1.127972083432334, 1.0333395190053172, 1.2542194871159342, 1.225556519124415, 1.1272761233441242], 'acc': [0.14285714690174375, 0.17857143112591334, 0.38961039909294676, 0.3650793776152626, 0.44285714817898614, 0.610389632838113, 0.5317460449915083, 0.6883117088249752, 0.7142857321671077, 0.6785714524132865, 0.8181818383080619, 0.6349206557349553, 0.7272727404321943, 0.7500000255448478, 0.7428571547780718, 0.7500000187328884, 0.8311688559395927, 0.769841300116645, 0.8500000425747463, 0.8428571718079704, 0.7285714370863778, 0.8701298918042865, 0.7428571615900312, 0.8928571726594653, 0.8285714566707612, 0.9357143095561437, 0.8571428903511592, 0.9025974273681641, 0.9206349471258739, 0.941558471747807, 0.9444444662048703, 0.92857146859169], 'loss': [2.9710516010011947, 2.2703405346189225, 1.8169031143188477, 1.8341135127203805, 1.6458150846617563, 1.3142252819878715, 1.3409855744195363, 1.0395519988877433, 0.883984078679766, 1.0889692544937133, 0.6556751940931592, 1.0196777033427404, 0.7805471675736564, 0.7660998054913112, 0.7847981776509966, 0.6894255152770451, 0.5345303245953151, 0.6858035784865183, 0.3713516392878124, 0.4559913599065372, 1.055701750091144, 0.4694505695785795, 0.839672161425863, 0.2838491759129933, 0.544072125852108, 0.20386534205504825, 0.45648809682045666, 0.30524235325200216, 0.28380196293195087, 0.1609032473393849, 0.24120497206846872, 0.2209556364587375], 'val_acc': [0.12987013083773774, 0.2597402616754755, 0.27272727543657477, 0.2597402616754755, 0.5324675371120502, 0.7012987043950465, 0.6363636394599815, 0.5064935111380243, 0.415584421777106, 0.7402597433560855, 0.753246765632134, 0.766233778619147, 0.6103896150341281, 0.7402597433560855, 0.7532467648580476, 0.753246765632134, 0.8051948168060996, 0.7142857189302321, 0.6753246799691931, 0.42857143399003267, 0.7272727311431587, 0.6103896134859556, 0.6883116921821197, 0.8051948168060996, 0.7532467671803066, 0.7532467648580476, 0.7402597433560855, 0.714285726671095, 0.740259752645121, 0.7012987152322546, 0.7012987051691327, 0.6493506547692535]}, 'runtime': 101.96421098709106}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 12)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 14)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 14) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 14) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 3) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 14) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 14)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000196316894784971, 'height_shift_range': 0.267, 'batch_size': 38, 'num_dense_units_2': 21, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.08717978237230432, 'num_dense_units_0': 100, 'cnn_learning_rate': 5.4346436903413856e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 161}, 'working_directory': '.', 'budget': 32.0}
2018-02-08 14:59:41.125158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/27
 - 7s - loss: 2.3775 - acc: 0.0658 - val_loss: 2.2948 - val_acc: 0.1250
Epoch 2/27
 - 4s - loss: 2.2712 - acc: 0.1691 - val_loss: 2.2667 - val_acc: 0.2344
Epoch 3/27
 - 5s - loss: 2.1542 - acc: 0.2039 - val_loss: 2.1830 - val_acc: 0.2656
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/27
 - 5s - loss: 2.0210 - acc: 0.2986 - val_loss: 2.1856 - val_acc: 0.1875
Epoch 5/27
 - 5s - loss: 2.0517 - acc: 0.2986 - val_loss: 2.1448 - val_acc: 0.2344
Epoch 6/27
 - 5s - loss: 1.9535 - acc: 0.3802 - val_loss: 2.0599 - val_acc: 0.2812
Epoch 7/27
 - 5s - loss: 2.0410 - acc: 0.3085 - val_loss: 2.0686 - val_acc: 0.2656
Epoch 8/27
 - 5s - loss: 1.9173 - acc: 0.3816 - val_loss: 1.9415 - val_acc: 0.3906
Epoch 9/27
 - 5s - loss: 1.8579 - acc: 0.3978 - val_loss: 2.0382 - val_acc: 0.2812
Epoch 10/27
 - 5s - loss: 1.9463 - acc: 0.3674 - val_loss: 1.9082 - val_acc: 0.3281
Epoch 11/27
 - 5s - loss: 1.7547 - acc: 0.5491 - val_loss: 1.8465 - val_acc: 0.3750
Epoch 12/27
 - 5s - loss: 1.7222 - acc: 0.5354 - val_loss: 1.9147 - val_acc: 0.2969
Epoch 13/27
 - 5s - loss: 1.8505 - acc: 0.4028 - val_loss: 1.8702 - val_acc: 0.3594
Epoch 14/27
 - 5s - loss: 1.6280 - acc: 0.6118 - val_loss: 1.9086 - val_acc: 0.3750
Epoch 15/27
 - 5s - loss: 1.7380 - acc: 0.5481 - val_loss: 1.8651 - val_acc: 0.3438
Epoch 16/27
 - 5s - loss: 1.6508 - acc: 0.5658 - val_loss: 1.8376 - val_acc: 0.3750
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 17/27
 - 4s - loss: 1.7337 - acc: 0.4559 - val_loss: 1.8500 - val_acc: 0.4219
Epoch 18/27
 - 5s - loss: 1.6212 - acc: 0.5395 - val_loss: 1.8713 - val_acc: 0.4219
Epoch 19/27
 - 5s - loss: 1.6352 - acc: 0.5629 - val_loss: 1.7259 - val_acc: 0.3906
Epoch 20/27
 - 5s - loss: 1.5574 - acc: 0.5835 - val_loss: 1.8068 - val_acc: 0.4062
Epoch 21/27
 - 5s - loss: 1.4426 - acc: 0.6798 - val_loss: 1.7041 - val_acc: 0.4375
Epoch 22/27
 - 5s - loss: 1.5325 - acc: 0.5921 - val_loss: 1.5583 - val_acc: 0.4688
Epoch 23/27
 - 5s - loss: 1.4678 - acc: 0.6523 - val_loss: 1.6311 - val_acc: 0.4531
Epoch 24/27
 - 5s - loss: 1.4791 - acc: 0.6238 - val_loss: 1.6179 - val_acc: 0.4531
Epoch 25/27
 - 5s - loss: 1.3964 - acc: 0.7033 - val_loss: 1.7916 - val_acc: 0.3750
Epoch 26/27
 - 5s - loss: 1.4098 - acc: 0.6581 - val_loss: 1.4573 - val_acc: 0.5156
Epoch 27/27
 - 5s - loss: 1.3853 - acc: 0.6807 - val_loss: 1.5421 - val_acc: 0.5156
{'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000196316894784971, 'height_shift_range': 0.267, 'batch_size': 38, 'num_dense_units_2': 21, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.08717978237230432, 'num_dense_units_0': 100, 'cnn_learning_rate': 5.4346436903413856e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 161}

 ****** InceptionResNetV2 unfrozen 3 top blocks, cut_off after layer 728 ******
Epoch 1/5
 - 7s - loss: 1.3457 - acc: 0.7161 - val_loss: 1.5377 - val_acc: 0.5156
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/5
 - 5s - loss: 1.3883 - acc: 0.6611 - val_loss: 1.5390 - val_acc: 0.5000
Epoch 3/5
 - 5s - loss: 1.3151 - acc: 0.7024 - val_loss: 1.5070 - val_acc: 0.5156
Epoch 4/5
 - 5s - loss: 1.2651 - acc: 0.7358 - val_loss: 1.4654 - val_acc: 0.5312
Epoch 5/5
 - 5s - loss: 1.3872 - acc: 0.6645 - val_loss: 1.5097 - val_acc: 0.5000
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 14), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 14) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 14) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 14) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 14)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000196316894784971, 'height_shift_range': 0.267, 'batch_size': 38, 'num_dense_units_2': 21, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.08717978237230432, 'num_dense_units_0': 100, 'cnn_learning_rate': 5.4346436903413856e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 161}, 'working_directory': '.', 'budget': 32.0}
result: {'loss': 0.5, 'info': {'histories': {'val_loss': [2.2948105335235596, 2.266738176345825, 2.1829785108566284, 2.185561180114746, 2.144800543785095, 2.059938073158264, 2.068583369255066, 1.941490352153778, 2.0382049083709717, 1.9081789255142212, 1.846508502960205, 1.914700210094452, 1.8702017068862915, 1.9085775017738342, 1.865085482597351, 1.8376460075378418, 1.8499674797058105, 1.871254801750183, 1.7259293794631958, 1.806799829006195, 1.7041208744049072, 1.5583285689353943, 1.6310843229293823, 1.617924690246582, 1.7916375994682312, 1.457283616065979, 1.542106568813324, 1.5376907587051392, 1.53900808095932, 1.507041335105896, 1.4654099345207214, 1.5097464323043823], 'acc': [0.06578947138041258, 0.15625, 0.20394737273454666, 0.29838709749521747, 0.29838711119467215, 0.4112903223403038, 0.25806453103019344, 0.38157894089818, 0.3629032426303433, 0.3790322616696358, 0.5403226056406575, 0.5241935435802706, 0.403225811979463, 0.6118421107530594, 0.5564516167486867, 0.5657894760370255, 0.4583333469927311, 0.5394736751914024, 0.5564516311691653, 0.5806451785948968, 0.6935483755603913, 0.5921052768826485, 0.6612903427693152, 0.6451612845543893, 0.6693548252505641, 0.6854838575086286, 0.6774193644523621, 0.7016129032258065, 0.6370967828458355, 0.685483859431359, 0.7419354483004539, 0.6644737124443054], 'loss': [2.3775174617767334, 2.2667867640654245, 2.15422260761261, 2.0161494824194137, 2.0838040920995895, 1.9257817768281507, 2.0913092820875105, 1.9172584414482117, 1.8747622755266005, 1.913267933553265, 1.770913464407767, 1.7493227912533669, 1.839552173691411, 1.628049612045288, 1.7070336918677054, 1.6507855355739594, 1.6970810070633888, 1.6211993396282196, 1.6116731897477181, 1.5430301754705367, 1.4324300058426396, 1.532474160194397, 1.446291144817106, 1.4575130804892509, 1.4386736385283931, 1.3770303918469338, 1.401330324911302, 1.358669032973628, 1.3807286947004256, 1.3279068489228525, 1.2640534466312778, 1.3872147500514984], 'val_acc': [0.125, 0.234375, 0.265625, 0.1875, 0.234375, 0.28125, 0.265625, 0.390625, 0.28125, 0.328125, 0.375, 0.296875, 0.359375, 0.375, 0.34375, 0.375, 0.421875, 0.421875, 0.390625, 0.40625, 0.4375, 0.46875, 0.453125, 0.453125, 0.375, 0.515625, 0.515625, 0.515625, 0.5, 0.515625, 0.53125, 0.5]}, 'runtime': 171.48258018493652}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 14)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 3)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 3) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 2
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 3) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (2, 0, 12) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (3, 0, 3) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (3, 0, 3)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018078045931979642, 'height_shift_range': 0.267, 'batch_size': 29, 'num_dense_units_2': 102, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.055067939320804615, 'num_dense_units_0': 115, 'cnn_learning_rate': 0.000313840334378048, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 142}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 15:02:28.500448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 7s - loss: 2.3115 - acc: 0.1034 - val_loss: 2.3015 - val_acc: 0.1406
Epoch 2/8
 - 4s - loss: 2.3212 - acc: 0.0763 - val_loss: 2.3017 - val_acc: 0.1406
Epoch 3/8
 - 5s - loss: 2.2826 - acc: 0.1586 - val_loss: 2.3011 - val_acc: 0.1562
Epoch 4/8
 - 5s - loss: 2.2990 - acc: 0.1323 - val_loss: 2.2978 - val_acc: 0.1406
Epoch 5/8
 - 5s - loss: 2.2919 - acc: 0.1102 - val_loss: 2.3024 - val_acc: 0.1562
Epoch 6/8
 - 5s - loss: 2.2949 - acc: 0.1061 - val_loss: 2.2991 - val_acc: 0.1406
Epoch 7/8
 - 5s - loss: 2.3058 - acc: 0.1103 - val_loss: 2.3031 - val_acc: 0.1562
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/8
 - 4s - loss: 2.3027 - acc: 0.0834 - val_loss: 2.2983 - val_acc: 0.1875
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (3, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (3, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 3) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (3, 0, 3)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018078045931979642, 'height_shift_range': 0.267, 'batch_size': 29, 'num_dense_units_2': 102, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.055067939320804615, 'num_dense_units_0': 115, 'cnn_learning_rate': 0.000313840334378048, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 142}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.8125, 'info': {'histories': {'val_loss': [2.3014832735061646, 2.301732063293457, 2.301080822944641, 2.297774314880371, 2.302386999130249, 2.299124002456665, 2.303074598312378, 2.2982789278030396], 'acc': [0.10344827547669411, 0.07438016430405546, 0.1586206905543804, 0.12030075151557312, 0.10526315652226147, 0.10526315599007714, 0.11034482419490814, 0.08264462886886163], 'loss': [2.311536741256714, 2.3220914986507952, 2.2825559616088866, 2.3008948878238074, 2.293527020547623, 2.296646777848552, 2.3057563304901123, 2.3023185020635935], 'val_acc': [0.140625, 0.140625, 0.15625, 0.140625, 0.15625, 0.140625, 0.15625, 0.1875]}, 'runtime': 42.636802434921265}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 3)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (2, 0, 12)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (2, 0, 12) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:DISPATCHER: starting job (2, 0, 12) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 4) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (2, 0, 12)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0010192003596035026, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 140, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.05015390769595599, 'num_dense_units_0': 427, 'cnn_learning_rate': 5.93659901713247e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 245}, 'working_directory': '.', 'budget': 64.0}
2018-02-08 15:03:10.657464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/27
 - 5s - loss: 3.1512 - acc: 0.0823 - val_loss: 2.1748 - val_acc: 0.1948
Epoch 2/27
 - 3s - loss: 2.1967 - acc: 0.2072 - val_loss: 2.0353 - val_acc: 0.2727
Epoch 3/27
 - 3s - loss: 1.9355 - acc: 0.2792 - val_loss: 2.1510 - val_acc: 0.1299
Epoch 4/27
 - 3s - loss: 1.8505 - acc: 0.3751 - val_loss: 1.4945 - val_acc: 0.4935
Epoch 5/27
 - 3s - loss: 1.6249 - acc: 0.4405 - val_loss: 1.3475 - val_acc: 0.5974
Epoch 6/27
 - 3s - loss: 1.4018 - acc: 0.5494 - val_loss: 1.6344 - val_acc: 0.3377
Epoch 7/27
 - 3s - loss: 1.4116 - acc: 0.5327 - val_loss: 1.2900 - val_acc: 0.5195
Epoch 8/27
 - 3s - loss: 1.6186 - acc: 0.4737 - val_loss: 0.9292 - val_acc: 0.7532
Epoch 9/27
 - 3s - loss: 0.9186 - acc: 0.7107 - val_loss: 1.0158 - val_acc: 0.6753
Epoch 10/27
 - 3s - loss: 1.1255 - acc: 0.6514 - val_loss: 1.2412 - val_acc: 0.5844
Epoch 11/27
 - 3s - loss: 0.7498 - acc: 0.7338 - val_loss: 0.8842 - val_acc: 0.7403
Epoch 12/27
 - 3s - loss: 1.0576 - acc: 0.6216 - val_loss: 0.9136 - val_acc: 0.6494
Epoch 13/27
 - 3s - loss: 0.9766 - acc: 0.6565 - val_loss: 0.7207 - val_acc: 0.7013
Epoch 14/27
 - 3s - loss: 0.8898 - acc: 0.7273 - val_loss: 0.9091 - val_acc: 0.7013
Epoch 15/27
 - 3s - loss: 0.5109 - acc: 0.8520 - val_loss: 0.9497 - val_acc: 0.6623
Epoch 16/27
 - 3s - loss: 1.0132 - acc: 0.6676 - val_loss: 0.6965 - val_acc: 0.7532
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 17/27
 - 3s - loss: 1.0517 - acc: 0.6708 - val_loss: 0.6041 - val_acc: 0.7792
Epoch 18/27
 - 3s - loss: 0.4211 - acc: 0.8783 - val_loss: 0.9401 - val_acc: 0.6753
Epoch 19/27
 - 3s - loss: 0.4105 - acc: 0.8749 - val_loss: 0.7040 - val_acc: 0.7532
Epoch 20/27
 - 3s - loss: 0.3227 - acc: 0.8961 - val_loss: 0.6247 - val_acc: 0.8052
Epoch 21/27
 - 3s - loss: 0.8625 - acc: 0.7763 - val_loss: 0.6594 - val_acc: 0.7792
Epoch 22/27
 - 3s - loss: 0.7249 - acc: 0.7991 - val_loss: 0.5951 - val_acc: 0.7662
Epoch 23/27
 - 3s - loss: 0.3918 - acc: 0.8948 - val_loss: 0.9086 - val_acc: 0.7013
Epoch 24/27
 - 3s - loss: 0.3530 - acc: 0.8783 - val_loss: 0.7920 - val_acc: 0.7273
Epoch 25/27
 - 3s - loss: 0.4925 - acc: 0.8124 - val_loss: 0.9756 - val_acc: 0.7143
Epoch 26/27
 - 3s - loss: 0.2267 - acc: 0.9221 - val_loss: 0.5131 - val_acc: 0.8182
Epoch 27/27
 - 3s - loss: 0.5325 - acc: 0.8500 - val_loss: 0.5366 - val_acc: 0.7922
{'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0010192003596035026, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 140, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.05015390769595599, 'num_dense_units_0': 427, 'cnn_learning_rate': 5.93659901713247e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 245}

 ****** MobileNet unfrozen 1 top blocks, cut_off after layer 78 ******
Epoch 1/37
 - 5s - loss: 0.1558 - acc: 0.9737 - val_loss: 0.3876 - val_acc: 0.8701
Epoch 2/37
 - 3s - loss: 0.1728 - acc: 0.9606 - val_loss: 0.4934 - val_acc: 0.8182
Epoch 3/37
 - 3s - loss: 0.2157 - acc: 0.9606 - val_loss: 0.4944 - val_acc: 0.8182
Epoch 4/37
 - 3s - loss: 0.1801 - acc: 0.9341 - val_loss: 0.5191 - val_acc: 0.8052
Epoch 5/37
 - 3s - loss: 0.1767 - acc: 0.9474 - val_loss: 0.4869 - val_acc: 0.8312
Epoch 6/37
 - 3s - loss: 0.1367 - acc: 0.9740 - val_loss: 0.5479 - val_acc: 0.7922
Epoch 7/37
 - 3s - loss: 0.1828 - acc: 0.9572 - val_loss: 0.5960 - val_acc: 0.7922
Epoch 8/37
 - 3s - loss: 0.1715 - acc: 0.9671 - val_loss: 0.6774 - val_acc: 0.7403
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 9/37
 - 3s - loss: 0.1599 - acc: 0.9606 - val_loss: 0.5027 - val_acc: 0.8052
Epoch 10/37
 - 3s - loss: 0.1880 - acc: 0.9606 - val_loss: 0.5459 - val_acc: 0.8182
Epoch 11/37
 - 3s - loss: 0.1316 - acc: 0.9803 - val_loss: 0.6233 - val_acc: 0.7792
Epoch 12/37
 - 3s - loss: 0.1364 - acc: 0.9737 - val_loss: 0.5788 - val_acc: 0.8052
Epoch 13/37
 - 3s - loss: 0.2465 - acc: 0.9078 - val_loss: 0.5952 - val_acc: 0.7922
Epoch 14/37
 - 3s - loss: 0.1327 - acc: 0.9740 - val_loss: 0.5372 - val_acc: 0.8182
Epoch 15/37
 - 3s - loss: 0.0909 - acc: 0.9934 - val_loss: 0.5808 - val_acc: 0.7662
Epoch 16/37
 - 3s - loss: 0.1968 - acc: 0.9572 - val_loss: 0.5981 - val_acc: 0.8052
Epoch 17/37
 - 3s - loss: 0.2503 - acc: 0.9076 - val_loss: 0.5857 - val_acc: 0.7922
Epoch 18/37
 - 3s - loss: 0.0911 - acc: 0.9869 - val_loss: 0.5592 - val_acc: 0.7922
Epoch 19/37
 - 3s - loss: 0.1408 - acc: 0.9737 - val_loss: 0.4851 - val_acc: 0.7922
Epoch 20/37
 - 3s - loss: 0.1260 - acc: 0.9610 - val_loss: 0.6027 - val_acc: 0.7922
Epoch 21/37
 - 3s - loss: 0.1260 - acc: 0.9869 - val_loss: 0.7110 - val_acc: 0.7403
Epoch 22/37
 - 3s - loss: 0.1085 - acc: 0.9666 - val_loss: 0.5795 - val_acc: 0.7792
Epoch 23/37
 - 3s - loss: 0.1129 - acc: 0.9740 - val_loss: 0.6905 - val_acc: 0.7662
Epoch 24/37
 - 3s - loss: 0.1603 - acc: 0.9606 - val_loss: 0.5632 - val_acc: 0.7922
Epoch 25/37
 - 3s - loss: 0.1201 - acc: 0.9572 - val_loss: 0.6287 - val_acc: 0.7662
Epoch 26/37
 - 3s - loss: 0.1920 - acc: 0.9506 - val_loss: 0.7418 - val_acc: 0.7403
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 27/37
 - 3s - loss: 0.1321 - acc: 0.9675 - val_loss: 0.5698 - val_acc: 0.7922
Epoch 28/37
 - 3s - loss: 0.1823 - acc: 0.9572 - val_loss: 0.6759 - val_acc: 0.7532
Epoch 29/37
 - 3s - loss: 0.1238 - acc: 0.9703 - val_loss: 0.6179 - val_acc: 0.7662
Epoch 30/37
 - 3s - loss: 0.1993 - acc: 0.9601 - val_loss: 0.6922 - val_acc: 0.7662
Epoch 31/37
 - 3s - loss: 0.1085 - acc: 0.9805 - val_loss: 0.7358 - val_acc: 0.7143
Epoch 32/37
 - 3s - loss: 0.1301 - acc: 0.9540 - val_loss: 0.5725 - val_acc: 0.7662
Epoch 33/37
 - 3s - loss: 0.1715 - acc: 0.9572 - val_loss: 0.6150 - val_acc: 0.7662
Epoch 34/37
 - 3s - loss: 0.1534 - acc: 0.9506 - val_loss: 0.7795 - val_acc: 0.7273
Epoch 35/37
 - 3s - loss: 0.0954 - acc: 1.0000 - val_loss: 0.6535 - val_acc: 0.7532
Epoch 36/37
 - 3s - loss: 0.1267 - acc: 0.9572 - val_loss: 0.6318 - val_acc: 0.7662
Epoch 37/37
 - 3s - loss: 0.1090 - acc: 0.9737 - val_loss: 0.5337 - val_acc: 0.8052
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (2, 0, 12), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (2, 0, 12) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (2, 0, 12) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (2, 0, 12)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0010192003596035026, 'height_shift_range': 0.267, 'batch_size': 22, 'num_dense_units_2': 140, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.05015390769595599, 'num_dense_units_0': 427, 'cnn_learning_rate': 5.93659901713247e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 245}, 'working_directory': '.', 'budget': 64.0}
result: {'loss': 0.19480518396798663, 'info': {'histories': {'val_loss': [2.1747628342021597, 2.0353017101040134, 2.1510456692088735, 1.4944546315577123, 1.347498673897285, 1.634400414181994, 1.2899887933359517, 0.9292387977823034, 1.0157820404349984, 1.2412015400923693, 0.8841675984395014, 0.9136237509838947, 0.7206899879814742, 0.909068674236149, 0.9497475639566199, 0.6964639413666416, 0.6040974599974496, 0.9401227560910311, 0.703996594850119, 0.6246835651335778, 0.6594051602598908, 0.595127557005201, 0.9085747638306061, 0.7919519690724163, 0.9755975936914419, 0.5131401969240857, 0.5366313302671755, 0.3875820416134673, 0.4934338948556355, 0.4944423468081982, 0.5190691731192849, 0.4869063001174431, 0.5479165826525006, 0.5960080840370872, 0.6774294113183951, 0.5026618211300342, 0.545871301130815, 0.6233075377228973, 0.578764487396587, 0.5952035471216425, 0.5371927735093353, 0.5808384135946051, 0.5981114599611852, 0.5857089781141901, 0.5592290379784324, 0.4851247130276321, 0.6027137157204864, 0.7110443270051634, 0.5794738654966478, 0.6904789395146556, 0.5632308063569007, 0.6286846917945069, 0.7417760653929277, 0.5697778721714949, 0.6758638933881537, 0.6179319144069374, 0.6921789622926092, 0.7358366049729385, 0.5724621542862484, 0.6150404996686167, 0.779451517315654, 0.6534581935250914, 0.6318216014218021, 0.5337201174977538], 'acc': [0.07857143070016588, 0.2142857204590525, 0.27922078328473227, 0.36428572194916864, 0.4785714451755796, 0.542857167337622, 0.5571428733212608, 0.47142858462674275, 0.6857142997639519, 0.6428571607385363, 0.7337662747928074, 0.6428571684019906, 0.6269841373912872, 0.7272727574620929, 0.8500000144754137, 0.6928571488176073, 0.7071428801332201, 0.8785714532647814, 0.8857143248830522, 0.896103927067348, 0.778571457522256, 0.835714305298669, 0.8857143104076386, 0.8785714532647814, 0.8285714498588017, 0.9220779453005109, 0.8571428770110721, 0.9714285986764091, 0.957142869915281, 0.9571428792817253, 0.9500000246933529, 0.9428571692534855, 0.9740259987967355, 0.9642857321671077, 0.9642857389790671, 0.9571428792817253, 0.9571428792817253, 0.9785714490073067, 0.9714285986764091, 0.9214285952704293, 0.9740259902817863, 0.9928571496691022, 0.9642857321671077, 0.9428571607385363, 0.9857142993382045, 0.9714285893099649, 0.9610389726502555, 0.9857142993382045, 0.9603174773473588, 0.9740259902817863, 0.957142869915281, 0.9642857321671077, 0.9571428631033216, 0.9675324899809701, 0.9642857415335518, 0.9785714328289032, 0.9761904837593199, 0.9805194990975517, 0.9500000195843833, 0.9642857321671077, 0.95714288183621, 1.0, 0.9642857228006635, 0.9714285893099649], 'loss': [3.1961604629244125, 2.2010509065219335, 1.935543349811009, 1.8518105455807277, 1.5131283828190394, 1.4200972923210688, 1.317843976191112, 1.5936181374958582, 0.9572770510401044, 1.142982044816017, 0.7498452918870109, 1.0269581828798566, 1.0419743647651067, 0.8898476106779916, 0.5199170776775905, 1.0071852262531007, 0.9330282892499652, 0.4198895535298756, 0.3613676301070622, 0.32265979264463696, 0.8490472823381424, 0.6338899197322981, 0.4079138268317495, 0.353893338569573, 0.46979870700410437, 0.22667723149061203, 0.4805800097565802, 0.1590438472373145, 0.18229713317539012, 0.22401756191892283, 0.15457858384719916, 0.18468708034072603, 0.136692898614066, 0.16818648225494792, 0.16230073911803108, 0.1616128156227725, 0.20029907934367658, 0.13869298776345593, 0.14169089879308427, 0.20782277679869107, 0.13265512404697283, 0.09449362573879105, 0.16913804028715407, 0.1804636056934084, 0.09605826432151454, 0.14900479497654098, 0.12595882745725767, 0.11848316767386027, 0.108082605851075, 0.11291321579899107, 0.16741377168468066, 0.11033991697643485, 0.18005334830709865, 0.13210848239915712, 0.1804660418203899, 0.10662836554859366, 0.13115387569580758, 0.10852614045143127, 0.13658498248883655, 0.14035575868827957, 0.14410323830587524, 0.09540391713380814, 0.11930878577487809, 0.1079161427382912], 'val_acc': [0.19480519577280267, 0.27272727543657477, 0.12987013083773774, 0.49350649544170927, 0.5974026020471151, 0.337662343855028, 0.519480520641649, 0.7532467648580476, 0.6753246784210205, 0.5844155983491377, 0.7402597541932936, 0.6493506532210809, 0.7012987043950465, 0.701298713684082, 0.6623376747230431, 0.7532467648580476, 0.7792207908320736, 0.6753246807432794, 0.7532467563430985, 0.805194817580186, 0.7792207908320736, 0.7662337778450606, 0.7012987059432191, 0.7272727319172451, 0.7142857173820595, 0.8181818197299908, 0.7922078038190866, 0.8701298809670782, 0.8181818290190264, 0.8181818297931126, 0.805194817580186, 0.8311688420060394, 0.7922078038190866, 0.7922078038190866, 0.7402597433560855, 0.805194817580186, 0.818181830567199, 0.7792207908320736, 0.8051948168060996, 0.7922078038190866, 0.8181818297931126, 0.766233778619147, 0.8051948168060996, 0.7922078038190866, 0.7922077953041374, 0.792207804593173, 0.7922078038190866, 0.740259752645121, 0.7792207807689518, 0.7662337801673196, 0.792207804593173, 0.766233778619147, 0.7402597433560855, 0.7922077922077922, 0.7532467640839614, 0.766233778619147, 0.766233778619147, 0.7142857189302321, 0.766233778619147, 0.7662337778450606, 0.727272739658108, 0.7532467648580476, 0.766233778619147, 0.8051948160320134]}, 'runtime': 208.97763562202454}}
exception: None

DEBUG:hpbandster:job_callback for (2, 0, 12)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 4)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 4) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 5) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (3, 0, 4) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (3, 0, 4)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0064412187884267495, 'height_shift_range': 0.267, 'batch_size': 54, 'num_dense_units_2': 31, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.2056520052558552, 'num_dense_units_0': 344, 'cnn_learning_rate': 4.783765259215468e-05, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 55}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 15:06:45.134216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 8s - loss: 2.8627 - acc: 0.1173 - val_loss: 2.5823 - val_acc: 0.0938
Epoch 2/8
 - 5s - loss: 2.4197 - acc: 0.0741 - val_loss: 2.3622 - val_acc: 0.1562
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/8
 - 5s - loss: 2.3315 - acc: 0.0679 - val_loss: 2.3554 - val_acc: 0.1250
Epoch 4/8
 - 5s - loss: 2.3188 - acc: 0.1235 - val_loss: 2.3466 - val_acc: 0.0938
Epoch 5/8
 - 5s - loss: 2.3232 - acc: 0.1173 - val_loss: 2.3508 - val_acc: 0.1250
Epoch 6/8
 - 5s - loss: 2.3035 - acc: 0.1358 - val_loss: 2.3113 - val_acc: 0.0938
Epoch 7/8
 - 5s - loss: 2.3097 - acc: 0.1420 - val_loss: 2.3010 - val_acc: 0.0938
Epoch 8/8
 - 5s - loss: 2.2881 - acc: 0.1296 - val_loss: 2.3102 - val_acc: 0.1562
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (3, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (3, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (3, 0, 4)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0064412187884267495, 'height_shift_range': 0.267, 'batch_size': 54, 'num_dense_units_2': 31, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.2056520052558552, 'num_dense_units_0': 344, 'cnn_learning_rate': 4.783765259215468e-05, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 55}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.84375, 'info': {'histories': {'val_loss': [2.5822761058807373, 2.362177848815918, 2.3554368019104004, 2.346621036529541, 2.350782871246338, 2.3112776279449463, 2.300963878631592, 2.3101541996002197], 'acc': [0.11728395521640778, 0.07407407586773236, 0.06790123507380486, 0.12345679601033528, 0.11728395521640778, 0.13580246766408285, 0.1419753059744835, 0.1296296293536822], 'loss': [2.8626720110575357, 2.419658342997233, 2.3314549922943115, 2.3187742233276367, 2.3232309818267822, 2.303548574447632, 2.3096839586893716, 2.2881413300832114], 'val_acc': [0.09375, 0.15625, 0.125, 0.09375, 0.125, 0.09375, 0.09375, 0.15625]}, 'runtime': 54.10353112220764}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 4)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 5)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 5) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 6) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (3, 0, 5) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (3, 0, 5)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.005264106174594648, 'height_shift_range': 0.267, 'batch_size': 37, 'num_dense_units_2': 283, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.28074665633599216, 'num_dense_units_0': 661, 'cnn_learning_rate': 6.258964269865545e-05, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 61}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 15:07:34.070750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 6s - loss: 11.3539 - acc: 0.0719 - val_loss: 14.3552 - val_acc: 0.1094
Epoch 2/8
 - 3s - loss: 14.5934 - acc: 0.0946 - val_loss: 14.1033 - val_acc: 0.1250
Epoch 3/8
 - 3s - loss: 14.8820 - acc: 0.0767 - val_loss: 14.1033 - val_acc: 0.1250
Epoch 4/8
 - 3s - loss: 13.8311 - acc: 0.1419 - val_loss: 14.3552 - val_acc: 0.1094
Epoch 5/8
 - 3s - loss: 13.9727 - acc: 0.1331 - val_loss: 14.3552 - val_acc: 0.1094
Epoch 6/8
 - 3s - loss: 14.5373 - acc: 0.0981 - val_loss: 13.8515 - val_acc: 0.1406
Epoch 7/8
 - 3s - loss: 13.6865 - acc: 0.1509 - val_loss: 14.1033 - val_acc: 0.1250
Epoch 8/8
 - 3s - loss: 14.5934 - acc: 0.0946 - val_loss: 14.3552 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (3, 0, 5), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (3, 0, 5) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 5) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (3, 0, 5)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.005264106174594648, 'height_shift_range': 0.267, 'batch_size': 37, 'num_dense_units_2': 283, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.28074665633599216, 'num_dense_units_0': 661, 'cnn_learning_rate': 6.258964269865545e-05, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 61}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.890625, 'info': {'histories': {'val_loss': [14.355178833007812, 14.103333473205566, 14.103332996368408, 14.355178356170654, 14.355178356170654, 13.85148811340332, 14.103333473205566, 14.355178356170654], 'acc': [0.07200000245869159, 0.09459459781646729, 0.078431376201265, 0.14189189858734608, 0.15200000423192978, 0.11200000271201134, 0.15200000786781312, 0.09459459688514471], 'loss': [10.840965545654297, 14.59341025352478, 14.853930800568824, 13.83106803894043, 13.66814476776123, 14.31286875152588, 13.668144485473633, 14.593410968780518], 'val_acc': [0.109375, 0.125, 0.125, 0.109375, 0.109375, 0.140625, 0.125, 0.109375]}, 'runtime': 30.136809587478638}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 5)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 6)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 6) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 6) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 7) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (3, 0, 6) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (3, 0, 6)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0023678225740047477, 'height_shift_range': 0.267, 'batch_size': 42, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.12644562854153454, 'num_dense_units_0': 340, 'cnn_learning_rate': 0.00035994493120058784, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 55}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 15:08:04.811232: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 8s - loss: 2.2910 - acc: 0.1415 - val_loss: 2.3118 - val_acc: 0.1562
Epoch 2/8
 - 4s - loss: 2.0640 - acc: 0.3333 - val_loss: 1.9402 - val_acc: 0.3438
Epoch 3/8
 - 4s - loss: 1.6524 - acc: 0.4338 - val_loss: 2.0383 - val_acc: 0.1562
Epoch 4/8
 - 4s - loss: 1.3290 - acc: 0.5873 - val_loss: 1.7738 - val_acc: 0.4688
Epoch 5/8
 - 4s - loss: 1.2769 - acc: 0.6035 - val_loss: 1.7871 - val_acc: 0.3125
Epoch 6/8
 - 4s - loss: 1.0107 - acc: 0.7222 - val_loss: 1.9583 - val_acc: 0.3438
Epoch 7/8
 - 4s - loss: 1.0072 - acc: 0.7215 - val_loss: 1.9782 - val_acc: 0.2812
Epoch 8/8
 - 4s - loss: 1.1003 - acc: 0.6429 - val_loss: 2.4808 - val_acc: 0.1875
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (3, 0, 6), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (3, 0, 6) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 6) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 6) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (3, 0, 6)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0023678225740047477, 'height_shift_range': 0.267, 'batch_size': 42, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.12644562854153454, 'num_dense_units_0': 340, 'cnn_learning_rate': 0.00035994493120058784, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 55}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.8125, 'info': {'histories': {'val_loss': [2.3118362426757812, 1.9402135610580444, 2.0383105278015137, 1.7737948894500732, 1.7871067523956299, 1.9582889080047607, 1.9782297611236572, 2.4807538986206055], 'acc': [0.13333334075286984, 0.3333333631356557, 0.4298245797031804, 0.5873015920321146, 0.6083333522081376, 0.7222222288449606, 0.7192982717564231, 0.6428571939468384], 'loss': [2.2975205898284914, 2.0639708439509072, 1.6609687993400974, 1.3290120760599773, 1.266230934858322, 1.0107111136118572, 1.0159379620301097, 1.100321114063263], 'val_acc': [0.15625, 0.34375, 0.15625, 0.46875, 0.3125, 0.34375, 0.28125, 0.1875]}, 'runtime': 43.40588188171387}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 6)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 7)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 7) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 7) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 0) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (3, 0, 7) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (3, 0, 7)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00036333137839504294, 'height_shift_range': 0.267, 'batch_size': 37, 'num_dense_units_2': 293, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.11038062439156761, 'num_dense_units_0': 412, 'cnn_learning_rate': 2.6804670396135513e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 273}, 'working_directory': '.', 'budget': 8.0}
2018-02-08 15:08:49.061893: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/8
 - 5s - loss: 2.3874 - acc: 0.1757 - val_loss: 2.3645 - val_acc: 0.1250
Epoch 2/8
 - 3s - loss: 2.0472 - acc: 0.2684 - val_loss: 2.3693 - val_acc: 0.0781
Epoch 3/8
 - 3s - loss: 1.6421 - acc: 0.5270 - val_loss: 2.3530 - val_acc: 0.1562
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/8
 - 3s - loss: 1.5690 - acc: 0.4932 - val_loss: 2.3884 - val_acc: 0.0938
Epoch 5/8
 - 3s - loss: 1.2365 - acc: 0.6002 - val_loss: 2.4533 - val_acc: 0.0625
Epoch 6/8
 - 3s - loss: 1.0059 - acc: 0.7333 - val_loss: 2.4051 - val_acc: 0.1250
Epoch 7/8
 - 3s - loss: 1.1786 - acc: 0.6123 - val_loss: 2.5671 - val_acc: 0.0938
Epoch 8/8
 - 3s - loss: 1.0809 - acc: 0.6216 - val_loss: 2.5983 - val_acc: 0.1094
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (3, 0, 7), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (3, 0, 7) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 7) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 7) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (3, 0, 7)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00036333137839504294, 'height_shift_range': 0.267, 'batch_size': 37, 'num_dense_units_2': 293, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.11038062439156761, 'num_dense_units_0': 412, 'cnn_learning_rate': 2.6804670396135513e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 273}, 'working_directory': '.', 'budget': 8.0}
result: {'loss': 0.890625, 'info': {'histories': {'val_loss': [2.3644940853118896, 2.3693262338638306, 2.352970600128174, 2.3884100914001465, 2.453346848487854, 2.4051235914230347, 2.567103862762451, 2.5983318090438843], 'acc': [0.1756756789982319, 0.2745098129791372, 0.527027077972889, 0.47200002312660216, 0.5840000102519989, 0.7360000343322753, 0.6080000567436218, 0.621621660888195], 'loss': [2.387378990650177, 2.043803147241181, 1.6421182751655579, 1.6154175472259522, 1.2455544633865356, 0.9884266881942749, 1.1958644285202027, 1.0809348970651627], 'val_acc': [0.125, 0.078125, 0.15625, 0.09375, 0.0625, 0.125, 0.09375, 0.109375]}, 'runtime': 33.253841400146484}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 7)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 0) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (4, 0, 0) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (4, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0004270940151758905, 'height_shift_range': 0.267, 'batch_size': 20, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.2589256965667774, 'num_dense_units_0': 940, 'cnn_learning_rate': 7.493497574751008e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 358}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 15:09:22.366248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 5s - loss: 2.3982 - acc: 0.1514 - val_loss: 2.4083 - val_acc: 0.0909
Epoch 2/16
 - 4s - loss: 2.4774 - acc: 0.0507 - val_loss: 2.3351 - val_acc: 0.1429
Epoch 3/16
 - 4s - loss: 2.4304 - acc: 0.0697 - val_loss: 2.4151 - val_acc: 0.0909
Epoch 4/16
 - 4s - loss: 2.4035 - acc: 0.1000 - val_loss: 2.4534 - val_acc: 0.0649
Epoch 5/16
 - 4s - loss: 2.3054 - acc: 0.1768 - val_loss: 2.3833 - val_acc: 0.0909
Epoch 6/16
 - 4s - loss: 2.3641 - acc: 0.1697 - val_loss: 2.4010 - val_acc: 0.0909
Epoch 7/16
 - 4s - loss: 2.3158 - acc: 0.0710 - val_loss: 2.3986 - val_acc: 0.0909
Epoch 8/16
 - 4s - loss: 2.3398 - acc: 0.1188 - val_loss: 2.3233 - val_acc: 0.1169
Epoch 9/16
 - 4s - loss: 2.3258 - acc: 0.1394 - val_loss: 2.3636 - val_acc: 0.0779
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 10/16
 - 4s - loss: 2.3410 - acc: 0.1204 - val_loss: 2.3080 - val_acc: 0.1169
Epoch 11/16
 - 4s - loss: 2.3600 - acc: 0.0951 - val_loss: 2.3233 - val_acc: 0.0779
Epoch 12/16
 - 4s - loss: 2.3071 - acc: 0.1458 - val_loss: 2.3242 - val_acc: 0.0909
Epoch 13/16
 - 4s - loss: 2.3182 - acc: 0.1141 - val_loss: 2.3216 - val_acc: 0.0909
Epoch 14/16
 - 4s - loss: 2.2550 - acc: 0.1711 - val_loss: 2.3155 - val_acc: 0.0909
Epoch 15/16
 - 4s - loss: 2.2663 - acc: 0.1813 - val_loss: 2.3121 - val_acc: 0.0909
Epoch 16/16
 - 4s - loss: 2.1655 - acc: 0.2718 - val_loss: 2.2472 - val_acc: 0.1039
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (4, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (4, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (4, 0, 0)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0004270940151758905, 'height_shift_range': 0.267, 'batch_size': 20, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.2589256965667774, 'num_dense_units_0': 940, 'cnn_learning_rate': 7.493497574751008e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 358}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.8961038951362882, 'info': {'histories': {'val_loss': [2.4082504619251597, 2.335085487984992, 2.415061891853035, 2.453380727148675, 2.38334339315241, 2.400960857217962, 2.3986158123264065, 2.3232585795513994, 2.363583502831397, 2.3080214277490394, 2.323316053910689, 2.3241726701909844, 2.3215689256593777, 2.3155212278489943, 2.3121027574910746, 2.247156434244924], 'acc': [0.11267605896147204, 0.056338029533204895, 0.07746479041139845, 0.1000000024214387, 0.1408450734657301, 0.07746479020152293, 0.08870967994293859, 0.11875000456348062, 0.1549295802981081, 0.1338028188952258, 0.10563380544034529, 0.16197183812168284, 0.1267605668432276, 0.19014084790374192, 0.18125000316649675, 0.24647887680732028], 'loss': [2.45601251259656, 2.463114446317646, 2.4212566664521122, 2.4034628570079803, 2.3534079706165154, 2.4278262400291335, 2.326129613384124, 2.339832454919815, 2.3409835922885947, 2.343233645801813, 2.3287472590594223, 2.2833883426558805, 2.301602685955209, 2.245308261522105, 2.2662703096866608, 2.1823302893571452], 'val_acc': [0.09090909090909091, 0.1428571447923586, 0.09090909187669878, 0.06493506590267281, 0.09090909139289484, 0.09090909139289484, 0.09090909139289484, 0.11688311785072475, 0.07792207792207792, 0.11688311785072475, 0.07792207792207792, 0.09090909139289484, 0.09090909139289484, 0.09090909187669878, 0.09090909361839294, 0.10389610486371177]}, 'runtime': 69.54804682731628}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 0)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 2)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 2) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 0) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (3, 0, 2) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (3, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000868440879631394, 'height_shift_range': 0.267, 'batch_size': 26, 'num_dense_units_2': 57, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.062292327256539444, 'num_dense_units_0': 407, 'cnn_learning_rate': 1.5705998919914355e-05, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 119}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 15:10:31.132370: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/13
 - 6s - loss: 2.2894 - acc: 0.2115 - val_loss: 2.2376 - val_acc: 0.1875
Epoch 2/13
 - 5s - loss: 2.2575 - acc: 0.2212 - val_loss: 2.2399 - val_acc: 0.2188
Epoch 3/13
 - 4s - loss: 1.9002 - acc: 0.3759 - val_loss: 2.0739 - val_acc: 0.2344
Epoch 4/13
 - 5s - loss: 1.8327 - acc: 0.3910 - val_loss: 2.0279 - val_acc: 0.4375
Epoch 5/13
 - 4s - loss: 1.7113 - acc: 0.3808 - val_loss: 2.0742 - val_acc: 0.2031
Epoch 6/13
 - 5s - loss: 1.6952 - acc: 0.4295 - val_loss: 1.7739 - val_acc: 0.4531
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 7/13
 - 5s - loss: 1.3662 - acc: 0.5824 - val_loss: 1.6834 - val_acc: 0.4844
Epoch 8/13
 - 5s - loss: 1.4435 - acc: 0.5916 - val_loss: 2.0610 - val_acc: 0.2812
Epoch 9/13
 - 5s - loss: 1.4285 - acc: 0.5641 - val_loss: 1.3911 - val_acc: 0.5469
Epoch 10/13
 - 4s - loss: 1.1497 - acc: 0.6626 - val_loss: 1.5801 - val_acc: 0.4844
Epoch 11/13
 - 5s - loss: 1.1361 - acc: 0.6282 - val_loss: 1.4130 - val_acc: 0.5156
Epoch 12/13
 - 5s - loss: 0.9868 - acc: 0.6741 - val_loss: 1.4831 - val_acc: 0.5156
Epoch 13/13
 - 5s - loss: 0.9395 - acc: 0.7147 - val_loss: 1.4837 - val_acc: 0.4844
{'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000868440879631394, 'height_shift_range': 0.267, 'batch_size': 26, 'num_dense_units_2': 57, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.062292327256539444, 'num_dense_units_0': 407, 'cnn_learning_rate': 1.5705998919914355e-05, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 119}

 ****** Xception no layers unfrozen
Epoch 1/3
 - 6s - loss: 1.0179 - acc: 0.6923 - val_loss: 1.3487 - val_acc: 0.5156
Epoch 2/3
 - 5s - loss: 0.9726 - acc: 0.6754 - val_loss: 0.9873 - val_acc: 0.7188
Epoch 3/3
 - 5s - loss: 1.1844 - acc: 0.5969 - val_loss: 1.2575 - val_acc: 0.5781
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (3, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (3, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (3, 0, 2)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000868440879631394, 'height_shift_range': 0.267, 'batch_size': 26, 'num_dense_units_2': 57, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.062292327256539444, 'num_dense_units_0': 407, 'cnn_learning_rate': 1.5705998919914355e-05, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 119}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.421875, 'info': {'histories': {'val_loss': [2.23761248588562, 2.2399404048919678, 2.073899745941162, 2.0278972387313843, 2.074207901954651, 1.7739132046699524, 1.6834020614624023, 2.061008930206299, 1.3910856246948242, 1.5800841450691223, 1.4130446910858154, 1.4830655455589294, 1.4837276935577393, 1.3487113118171692, 0.9872603714466095, 1.2575297951698303], 'acc': [0.21153847376505533, 0.22794118918040218, 0.38793106120208215, 0.3910256624221802, 0.37068968291940363, 0.429487203558286, 0.5514706162845388, 0.6029412159148384, 0.5641026099522909, 0.6379310776447428, 0.6282051602999369, 0.6544117866193547, 0.7205882747383678, 0.6923077255487442, 0.6764706189141554, 0.5882353357532445], 'loss': [2.289406736691793, 2.2694086572703194, 1.9130719612384666, 1.8327269355456035, 1.7651210694477475, 1.695192813873291, 1.399947192739038, 1.375975845491185, 1.428458034992218, 1.1644936121743301, 1.1361295183499653, 1.0286933253793156, 0.9301340834182852, 1.0179184277852376, 0.9299524321275598, 1.181800703792011], 'val_acc': [0.1875, 0.21875, 0.234375, 0.4375, 0.203125, 0.453125, 0.484375, 0.28125, 0.546875, 0.484375, 0.515625, 0.515625, 0.484375, 0.515625, 0.71875, 0.578125]}, 'runtime': 80.22908544540405}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 2)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 0) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 3) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (3, 0, 0) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (3, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0004032591292372277, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.2442824728736464, 'num_dense_units_0': 203, 'cnn_learning_rate': 2.880793251858514e-05, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 112}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 15:11:52.972589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 7s - loss: 2.4960 - acc: 0.1242 - val_loss: 2.2946 - val_acc: 0.0909
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/16
 - 4s - loss: 2.5243 - acc: 0.1976 - val_loss: 2.4700 - val_acc: 0.0909
Epoch 3/16
 - 4s - loss: 2.3062 - acc: 0.1584 - val_loss: 2.1178 - val_acc: 0.2857
Epoch 4/16
 - 4s - loss: 2.1590 - acc: 0.3159 - val_loss: 2.4534 - val_acc: 0.0909
Epoch 5/16
 - 4s - loss: 2.0401 - acc: 0.2981 - val_loss: 2.1784 - val_acc: 0.2857
Epoch 6/16
 - 4s - loss: 2.0459 - acc: 0.2090 - val_loss: 2.1582 - val_acc: 0.1299
Epoch 7/16
 - 4s - loss: 1.9585 - acc: 0.2787 - val_loss: 2.0976 - val_acc: 0.1169
Epoch 8/16
 - 4s - loss: 1.9544 - acc: 0.1900 - val_loss: 1.8665 - val_acc: 0.4545
Epoch 9/16
 - 4s - loss: 1.7901 - acc: 0.3789 - val_loss: 1.7529 - val_acc: 0.4286
Epoch 10/16
 - 4s - loss: 1.7189 - acc: 0.3927 - val_loss: 1.9416 - val_acc: 0.2078
Epoch 11/16
 - 4s - loss: 1.8537 - acc: 0.2977 - val_loss: 1.8820 - val_acc: 0.2987
Epoch 12/16
 - 4s - loss: 1.4923 - acc: 0.4783 - val_loss: 1.6710 - val_acc: 0.4545
Epoch 13/16
 - 4s - loss: 1.6832 - acc: 0.4751 - val_loss: 1.6658 - val_acc: 0.3896
Epoch 14/16
 - 4s - loss: 1.4129 - acc: 0.5503 - val_loss: 1.6457 - val_acc: 0.3896
Epoch 15/16
 - 4s - loss: 1.4780 - acc: 0.4814 - val_loss: 1.4717 - val_acc: 0.5195
Epoch 16/16
 - 4s - loss: 1.7475 - acc: 0.3864 - val_loss: 1.5699 - val_acc: 0.4805
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (3, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (3, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (3, 0, 0)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0004032591292372277, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.2442824728736464, 'num_dense_units_0': 203, 'cnn_learning_rate': 2.880793251858514e-05, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 112}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.5194805140619154, 'info': {'histories': {'val_loss': [2.294602883326543, 2.4699881912825945, 2.1177894914305053, 2.4534484039653432, 2.178350269020378, 2.1581573486328125, 2.0976061449422465, 1.8664895172242995, 1.7528715458783237, 1.9415561688410772, 1.8819674795324153, 1.6710352402228814, 1.665794655874178, 1.6456908746199175, 1.47174173825747, 1.5699453663516354], 'acc': [0.12422360320176397, 0.10256410431530741, 0.17985611845799487, 0.22302158737032535, 0.29813664725848604, 0.23741007698096817, 0.3165467660204112, 0.2158273446152536, 0.37888198665210177, 0.35897436623389906, 0.33812949961895566, 0.47826087049075533, 0.5395683448949307, 0.4892086365240083, 0.5467625927153251, 0.4388489247226029], 'loss': [2.49604446547372, 2.652721150308593, 2.160036783424213, 2.3052638983554976, 2.040148036820548, 2.033815742396622, 1.8920708628867169, 1.892353892326355, 1.790127464703151, 1.7639633529206626, 1.763423767878855, 1.4922716447285242, 1.4780778198791065, 1.415551918873684, 1.3367823190826307, 1.5898157563998545], 'val_acc': [0.09090909139289484, 0.09090909187669878, 0.28571428764950146, 0.09090909139289484, 0.28571429113288976, 0.12987013257943192, 0.11688311688311688, 0.4545454599640586, 0.428571429732558, 0.20779220875981566, 0.29870130063651446, 0.4545454599640586, 0.38961039154560534, 0.38961039231969163, 0.5194805334140729, 0.4805194859380846]}, 'runtime': 76.06915307044983}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 0)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 3)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 3) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 1) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 3) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (3, 0, 3) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (3, 0, 3)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018078045931979642, 'height_shift_range': 0.267, 'batch_size': 29, 'num_dense_units_2': 102, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.055067939320804615, 'num_dense_units_0': 115, 'cnn_learning_rate': 0.000313840334378048, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 142}, 'working_directory': '.', 'budget': 16.0}
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 15:13:08.136985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 6s - loss: 2.3097 - acc: 0.0741 - val_loss: 2.3291 - val_acc: 0.0781
Epoch 2/16
 - 5s - loss: 2.3095 - acc: 0.0881 - val_loss: 2.3220 - val_acc: 0.0938
Epoch 3/16
 - 5s - loss: 2.3184 - acc: 0.1021 - val_loss: 2.3166 - val_acc: 0.0781
Epoch 4/16
 - 5s - loss: 2.3218 - acc: 0.0828 - val_loss: 2.3115 - val_acc: 0.0938
Epoch 5/16
 - 5s - loss: 2.3037 - acc: 0.0951 - val_loss: 2.3150 - val_acc: 0.0938
Epoch 6/16
 - 4s - loss: 2.3039 - acc: 0.0910 - val_loss: 2.3075 - val_acc: 0.0938
Epoch 7/16
 - 5s - loss: 2.3031 - acc: 0.1172 - val_loss: 2.3063 - val_acc: 0.0625
Epoch 8/16
 - 4s - loss: 2.3085 - acc: 0.0620 - val_loss: 2.3060 - val_acc: 0.0781
Epoch 9/16
 - 5s - loss: 2.3080 - acc: 0.1341 - val_loss: 2.3048 - val_acc: 0.0781
Epoch 10/16
 - 5s - loss: 2.3050 - acc: 0.0759 - val_loss: 2.3049 - val_acc: 0.0625
Epoch 11/16
 - 5s - loss: 2.3091 - acc: 0.0910 - val_loss: 2.2995 - val_acc: 0.0781
Epoch 12/16
 - 5s - loss: 2.3008 - acc: 0.1072 - val_loss: 2.3034 - val_acc: 0.0625
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 13/16
 - 4s - loss: 2.2961 - acc: 0.1201 - val_loss: 2.3127 - val_acc: 0.0469
Epoch 14/16
 - 5s - loss: 2.2975 - acc: 0.0897 - val_loss: 2.3018 - val_acc: 0.0938
Epoch 15/16
 - 4s - loss: 2.3021 - acc: 0.1048 - val_loss: 2.2972 - val_acc: 0.0938
Epoch 16/16
 - 5s - loss: 2.3038 - acc: 0.0741 - val_loss: 2.3017 - val_acc: 0.0781
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (3, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (3, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 3) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (3, 0, 3)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0018078045931979642, 'height_shift_range': 0.267, 'batch_size': 29, 'num_dense_units_2': 102, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.055067939320804615, 'num_dense_units_0': 115, 'cnn_learning_rate': 0.000313840334378048, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 142}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.921875, 'info': {'histories': {'val_loss': [2.3291114568710327, 2.3220220804214478, 2.316606640815735, 2.311493158340454, 2.314988374710083, 2.307495951652527, 2.3062593936920166, 2.3059794902801514, 2.304763078689575, 2.3048735857009888, 2.2995327711105347, 2.30338191986084, 2.31269109249115, 2.3018070459365845, 2.2971962690353394, 2.3016778230667114], 'acc': [0.07518796807617173, 0.09022556444195877, 0.10526315837090176, 0.0827586181461811, 0.09774436059414893, 0.09774435972584818, 0.11724137887358665, 0.05785123874579579, 0.13533834384796314, 0.07586206793785095, 0.09774435972584818, 0.0977443599499258, 0.1203007491067388, 0.0896551713347435, 0.10743801363489845, 0.07518796807617173], 'loss': [2.3102466432671798, 2.3111797920743324, 2.3192316643277504, 2.321810579299927, 2.303543494160014, 2.301895702691903, 2.3030885219573975, 2.309358659854605, 2.308827889593024, 2.3049831867218016, 2.306530136811106, 2.3023822791594313, 2.2959209492332056, 2.2975490570068358, 2.3009769719494275, 2.3035901309852314], 'val_acc': [0.078125, 0.09375, 0.078125, 0.09375, 0.09375, 0.09375, 0.0625, 0.078125, 0.078125, 0.0625, 0.078125, 0.0625, 0.046875, 0.09375, 0.09375, 0.078125]}, 'runtime': 77.90641236305237}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 3)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 1)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 1) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 1) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (3, 0, 1) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (3, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000364016336662245, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 24, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.17071923687657745, 'num_dense_units_0': 346, 'cnn_learning_rate': 5.041181762400048e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 276}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 15:14:24.996995: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 4s - loss: 2.4559 - acc: 0.1216 - val_loss: 2.3005 - val_acc: 0.0625
Epoch 2/16
 - 3s - loss: 2.2151 - acc: 0.2590 - val_loss: 2.3959 - val_acc: 0.0938
Epoch 3/16
 - 3s - loss: 2.1354 - acc: 0.2118 - val_loss: 2.1717 - val_acc: 0.1250
Epoch 4/16
 - 3s - loss: 1.9295 - acc: 0.3654 - val_loss: 2.2588 - val_acc: 0.1250
Epoch 5/16
 - 3s - loss: 2.0377 - acc: 0.2432 - val_loss: 1.9080 - val_acc: 0.3750
Epoch 6/16
 - 3s - loss: 1.6920 - acc: 0.4819 - val_loss: 1.7213 - val_acc: 0.5312
Epoch 7/16
 - 3s - loss: 1.7246 - acc: 0.4088 - val_loss: 1.8302 - val_acc: 0.2500
Epoch 8/16
 - 3s - loss: 1.7258 - acc: 0.4423 - val_loss: 1.8338 - val_acc: 0.3125
Epoch 9/16
 - 2s - loss: 1.7208 - acc: 0.4350 - val_loss: 1.4434 - val_acc: 0.5938
Epoch 10/16
 - 3s - loss: 1.3469 - acc: 0.5962 - val_loss: 1.6246 - val_acc: 0.4375
Epoch 11/16
 - 3s - loss: 1.1804 - acc: 0.6795 - val_loss: 1.8630 - val_acc: 0.3125
Epoch 12/16
 - 2s - loss: 1.3441 - acc: 0.6545 - val_loss: 1.8516 - val_acc: 0.2812
Epoch 13/16
 - 3s - loss: 1.1485 - acc: 0.6317 - val_loss: 1.5754 - val_acc: 0.5000
Epoch 14/16
 - 3s - loss: 1.1881 - acc: 0.6182 - val_loss: 1.8422 - val_acc: 0.5312
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 15/16
 - 3s - loss: 1.0964 - acc: 0.6987 - val_loss: 1.4531 - val_acc: 0.5000
Epoch 16/16
 - 3s - loss: 0.9631 - acc: 0.7207 - val_loss: 1.8078 - val_acc: 0.3438
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (3, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (3, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (3, 0, 1)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000364016336662245, 'height_shift_range': 0.267, 'batch_size': 39, 'num_dense_units_2': 24, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.17071923687657745, 'num_dense_units_0': 346, 'cnn_learning_rate': 5.041181762400048e-05, 'cnn_unlock_epoch': 26, 'num_dense_units_1': 276}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.65625, 'info': {'histories': {'val_loss': [2.3005478382110596, 2.395857810974121, 2.171738862991333, 2.258790969848633, 1.9080039262771606, 1.7213140726089478, 1.8301796913146973, 1.8338063955307007, 1.443427324295044, 1.6245839595794678, 1.8630187511444092, 1.8515663146972656, 1.5753589868545532, 1.8421530723571777, 1.4530543088912964, 1.8077861070632935], 'acc': [0.14634146650389926, 0.24390244956423596, 0.1869918744011623, 0.36538462340831757, 0.292682937732557, 0.5121951495728841, 0.3902439184305144, 0.442307710647583, 0.4444444606701533, 0.5961538627743721, 0.6794871985912323, 0.4777777959903081, 0.6585366042648874, 0.6422764426324425, 0.6987179666757584, 0.7317073330646608], 'loss': [2.441577103079819, 2.2176480700330035, 2.157179751047274, 1.9294669926166534, 1.9740879419373303, 1.6294260025024414, 1.7999508787946004, 1.725838452577591, 1.6333463231722514, 1.346873939037323, 1.1804039478302002, 1.7176897644996643, 1.1582551584011171, 1.1513325993607684, 1.096407413482666, 0.9435033231246762], 'val_acc': [0.0625, 0.09375, 0.125, 0.125, 0.375, 0.53125, 0.25, 0.3125, 0.59375, 0.4375, 0.3125, 0.28125, 0.5, 0.53125, 0.5, 0.34375]}, 'runtime': 46.97479271888733}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 1)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 1)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 1) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (4, 0, 1) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (4, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.008134440548722746, 'height_shift_range': 0.267, 'batch_size': 28, 'num_dense_units_2': 297, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.13209987280665508, 'num_dense_units_0': 256, 'cnn_learning_rate': 0.0002459909810587713, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 128}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 15:15:16.994963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 7s - loss: 3.8291 - acc: 0.0929 - val_loss: 2.6426 - val_acc: 0.0938
Epoch 2/16
 - 5s - loss: 2.4897 - acc: 0.1632 - val_loss: 2.5046 - val_acc: 0.1406
Epoch 3/16
 - 5s - loss: 2.4431 - acc: 0.0840 - val_loss: 2.1291 - val_acc: 0.3125
Epoch 4/16
 - 5s - loss: 2.3017 - acc: 0.1632 - val_loss: 2.2500 - val_acc: 0.1562
Epoch 5/16
 - 5s - loss: 2.3162 - acc: 0.1024 - val_loss: 2.2562 - val_acc: 0.1250
Epoch 6/16
 - 5s - loss: 2.2442 - acc: 0.1553 - val_loss: 2.1852 - val_acc: 0.2500
Epoch 7/16
 - 5s - loss: 2.1911 - acc: 0.2047 - val_loss: 2.2506 - val_acc: 0.1250
Epoch 8/16
 - 5s - loss: 1.9998 - acc: 0.2857 - val_loss: 1.9619 - val_acc: 0.3438
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 9/16
 - 5s - loss: 1.8970 - acc: 0.3008 - val_loss: 1.8370 - val_acc: 0.3906
Epoch 10/16
 - 5s - loss: 1.9183 - acc: 0.3357 - val_loss: 1.7917 - val_acc: 0.4062
Epoch 11/16
 - 5s - loss: 1.8814 - acc: 0.3168 - val_loss: 2.2689 - val_acc: 0.2812
Epoch 12/16
 - 5s - loss: 1.8137 - acc: 0.2799 - val_loss: 1.6708 - val_acc: 0.4062
Epoch 13/16
 - 5s - loss: 1.7733 - acc: 0.3080 - val_loss: 1.6744 - val_acc: 0.3750
Epoch 14/16
 - 5s - loss: 1.5341 - acc: 0.4214 - val_loss: 1.6022 - val_acc: 0.4062
Epoch 15/16
 - 5s - loss: 1.5389 - acc: 0.4540 - val_loss: 1.4027 - val_acc: 0.5000
Epoch 16/16
 - 5s - loss: 1.5845 - acc: 0.4000 - val_loss: 1.3651 - val_acc: 0.4688
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (4, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (4, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (4, 0, 1)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.008134440548722746, 'height_shift_range': 0.267, 'batch_size': 28, 'num_dense_units_2': 297, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.13209987280665508, 'num_dense_units_0': 256, 'cnn_learning_rate': 0.0002459909810587713, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 128}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.53125, 'info': {'histories': {'val_loss': [2.642617106437683, 2.504642963409424, 2.1290680170059204, 2.249986171722412, 2.256171703338623, 2.1852413415908813, 2.250625252723694, 1.9618982672691345, 1.8370263576507568, 1.7917065620422363, 2.2689379453659058, 1.6708351373672485, 1.6744035482406616, 1.6022114753723145, 1.4027185440063477, 1.365052580833435], 'acc': [0.09285714775323868, 0.1641791153754761, 0.08208955713172457, 0.16417910914812514, 0.10447761805644676, 0.14925373556898602, 0.20895523455605577, 0.28571429550647737, 0.3046875090803951, 0.3357142984867096, 0.3134328473859759, 0.2835820971140221, 0.3059701643772979, 0.42142857909202575, 0.46093751303851604, 0.4000000059604645], 'loss': [3.829077959060669, 2.492301015711542, 2.436442973008796, 2.300541112672037, 2.3163883436971635, 2.2432894315292584, 2.1902094919290116, 1.9997578620910645, 1.89151500351727, 1.9182828664779663, 1.8855006854925582, 1.8088946840656337, 1.7706474421629266, 1.5340609550476074, 1.5193080343306065, 1.584513211250305], 'val_acc': [0.09375, 0.140625, 0.3125, 0.15625, 0.125, 0.25, 0.125, 0.34375, 0.390625, 0.40625, 0.28125, 0.40625, 0.375, 0.40625, 0.5, 0.46875]}, 'runtime': 91.13650059700012}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 1)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 2)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 2) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 0) to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (3, 0, 2) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (3, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000868440879631394, 'height_shift_range': 0.267, 'batch_size': 26, 'num_dense_units_2': 57, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.062292327256539444, 'num_dense_units_0': 407, 'cnn_learning_rate': 1.5705998919914355e-05, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 119}, 'working_directory': '.', 'budget': 32.0}
2018-02-08 15:16:43.877171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/13
 - 6s - loss: 2.5533 - acc: 0.0916 - val_loss: 2.2749 - val_acc: 0.1406
Epoch 2/13
 - 5s - loss: 2.1676 - acc: 0.2821 - val_loss: 2.2440 - val_acc: 0.2188
Epoch 3/13
 - 4s - loss: 2.1923 - acc: 0.2048 - val_loss: 2.1891 - val_acc: 0.2188
Epoch 4/13
 - 5s - loss: 1.8293 - acc: 0.3974 - val_loss: 2.1759 - val_acc: 0.3125
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 5/13
 - 4s - loss: 1.6340 - acc: 0.4847 - val_loss: 2.0593 - val_acc: 0.1875
Epoch 6/13
 - 5s - loss: 1.6344 - acc: 0.4487 - val_loss: 1.8295 - val_acc: 0.3750
Epoch 7/13
 - 5s - loss: 1.5979 - acc: 0.5052 - val_loss: 1.7507 - val_acc: 0.4219
Epoch 8/13
 - 5s - loss: 1.4029 - acc: 0.5314 - val_loss: 1.8913 - val_acc: 0.2656
Epoch 9/13
 - 5s - loss: 1.2296 - acc: 0.6538 - val_loss: 1.6639 - val_acc: 0.3594
Epoch 10/13
 - 5s - loss: 1.2545 - acc: 0.5393 - val_loss: 1.3006 - val_acc: 0.6094
Epoch 11/13
 - 5s - loss: 1.1643 - acc: 0.5589 - val_loss: 1.4559 - val_acc: 0.5312
Epoch 12/13
 - 5s - loss: 0.9910 - acc: 0.6950 - val_loss: 1.0929 - val_acc: 0.7031
Epoch 13/13
 - 5s - loss: 1.5663 - acc: 0.4909 - val_loss: 1.3865 - val_acc: 0.4531
{'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000868440879631394, 'height_shift_range': 0.267, 'batch_size': 26, 'num_dense_units_2': 57, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.062292327256539444, 'num_dense_units_0': 407, 'cnn_learning_rate': 1.5705998919914355e-05, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 119}

 ****** Xception no layers unfrozen
Epoch 1/19
 - 6s - loss: 0.9713 - acc: 0.7308 - val_loss: 1.0372 - val_acc: 0.6875
Epoch 2/19
 - 4s - loss: 0.8091 - acc: 0.7530 - val_loss: 1.3497 - val_acc: 0.5312
Epoch 3/19
 - 5s - loss: 0.9349 - acc: 0.6544 - val_loss: 0.8713 - val_acc: 0.7500
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/19
 - 5s - loss: 0.7943 - acc: 0.7756 - val_loss: 1.0767 - val_acc: 0.6094
Epoch 5/19
 - 5s - loss: 0.8026 - acc: 0.7670 - val_loss: 1.0402 - val_acc: 0.6719
Epoch 6/19
 - 4s - loss: 1.3032 - acc: 0.6125 - val_loss: 1.2622 - val_acc: 0.5000
Epoch 7/19
 - 5s - loss: 0.7373 - acc: 0.7885 - val_loss: 0.8151 - val_acc: 0.7031
Epoch 8/19
 - 4s - loss: 0.8250 - acc: 0.6950 - val_loss: 0.8330 - val_acc: 0.7031
Epoch 9/19
 - 5s - loss: 0.7496 - acc: 0.7343 - val_loss: 0.6840 - val_acc: 0.7812
Epoch 10/19
 - 5s - loss: 0.6625 - acc: 0.7788 - val_loss: 0.7200 - val_acc: 0.7500
Epoch 11/19
 - 5s - loss: 0.6342 - acc: 0.7756 - val_loss: 0.9573 - val_acc: 0.6562
Epoch 12/19
 - 4s - loss: 0.8957 - acc: 0.6633 - val_loss: 1.4104 - val_acc: 0.4531
Epoch 13/19
 - 5s - loss: 0.7504 - acc: 0.7709 - val_loss: 0.8257 - val_acc: 0.7344
Epoch 14/19
 - 5s - loss: 0.7085 - acc: 0.7885 - val_loss: 0.7059 - val_acc: 0.7344
Epoch 15/19
 - 5s - loss: 0.5586 - acc: 0.8077 - val_loss: 0.7239 - val_acc: 0.7500
Epoch 16/19
 - 5s - loss: 0.8093 - acc: 0.7055 - val_loss: 0.7738 - val_acc: 0.7656
Epoch 17/19
 - 4s - loss: 0.6451 - acc: 0.7739 - val_loss: 0.6292 - val_acc: 0.8281
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 18/19
 - 5s - loss: 0.6380 - acc: 0.8076 - val_loss: 1.8344 - val_acc: 0.3438
Epoch 19/19
 - 5s - loss: 0.7547 - acc: 0.7756 - val_loss: 0.9896 - val_acc: 0.6719
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (3, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (3, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (3, 0, 2)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000868440879631394, 'height_shift_range': 0.267, 'batch_size': 26, 'num_dense_units_2': 57, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.062292327256539444, 'num_dense_units_0': 407, 'cnn_learning_rate': 1.5705998919914355e-05, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 119}, 'working_directory': '.', 'budget': 32.0}
result: {'loss': 0.328125, 'info': {'histories': {'val_loss': [2.2748849391937256, 2.2440056800842285, 2.18914794921875, 2.1759454011917114, 2.05934476852417, 1.8295477032661438, 1.7507380247116089, 1.8913081884384155, 1.663892149925232, 1.3005626201629639, 1.4558609127998352, 1.092850148677826, 1.3864898085594177, 1.0372443199157715, 1.3496984243392944, 0.8713284432888031, 1.0767309069633484, 1.0402321815490723, 1.262243390083313, 0.8151319026947021, 0.8329886198043823, 0.6840425133705139, 0.7199517041444778, 0.9573250412940979, 1.4104479551315308, 0.8256926834583282, 0.7058971524238586, 0.7239136695861816, 0.7737813144922256, 0.629166841506958, 1.8344159126281738, 0.9895636439323425], 'acc': [0.10294118244200945, 0.28205129069586593, 0.21551726013422012, 0.39743592341740924, 0.45689656919446486, 0.44871796667575836, 0.4852941454771687, 0.5147058998837191, 0.6538461943467458, 0.5441176672192181, 0.5661765065263299, 0.6985294582212672, 0.5514706066426109, 0.730769286553065, 0.706896590775457, 0.6323529814972597, 0.7756410737832388, 0.779411800643977, 0.6206896895992344, 0.7884615858395895, 0.6985294525237644, 0.7426471026504741, 0.7720588840105954, 0.7756410737832388, 0.7327586736144691, 0.7426471026504741, 0.7884615659713745, 0.8076923588911692, 0.7720588465385577, 0.8275862356712078, 0.845588265972979, 0.7756410638491312], 'loss': [2.52902148401036, 2.167606314023336, 2.182666934769729, 1.8293290535608928, 1.6968601798189098, 1.6344012419382732, 1.633500775870155, 1.413026725544649, 1.2295643091201782, 1.2612856819349176, 1.161797953002593, 0.9569911036421271, 1.3761367955628563, 0.971342126528422, 0.8490221675099998, 0.9754469745299396, 0.7943070530891418, 0.7797657908762202, 1.3700784424255634, 0.7372812777757645, 0.8253680160816979, 0.7597320973873138, 0.6533453902777504, 0.634235014518102, 0.8060676948777561, 0.7937250597512021, 0.7085119386514028, 0.5586082885662714, 0.6964218480622067, 0.5889846258636179, 0.4912330008604947, 0.7547287593285242], 'val_acc': [0.140625, 0.21875, 0.21875, 0.3125, 0.1875, 0.375, 0.421875, 0.265625, 0.359375, 0.609375, 0.53125, 0.703125, 0.453125, 0.6875, 0.53125, 0.75, 0.609375, 0.671875, 0.5, 0.703125, 0.703125, 0.78125, 0.75, 0.65625, 0.453125, 0.734375, 0.734375, 0.75, 0.765625, 0.828125, 0.34375, 0.671875]}, 'runtime': 153.91507244110107}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 2)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 0) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (3, 0, 0) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (3, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0004032591292372277, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.2442824728736464, 'num_dense_units_0': 203, 'cnn_learning_rate': 2.880793251858514e-05, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 112}, 'working_directory': '.', 'budget': 32.0}
2018-02-08 15:19:19.624603: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/28
 - 7s - loss: 2.7447 - acc: 0.1077 - val_loss: 2.4074 - val_acc: 0.1299
Epoch 2/28
 - 4s - loss: 2.3877 - acc: 0.1584 - val_loss: 2.5897 - val_acc: 0.0909
Epoch 3/28
 - 4s - loss: 2.3797 - acc: 0.1118 - val_loss: 2.2285 - val_acc: 0.2208
Epoch 4/28
 - 4s - loss: 2.1975 - acc: 0.3167 - val_loss: 2.2025 - val_acc: 0.1039
Epoch 5/28
 - 4s - loss: 2.0317 - acc: 0.2843 - val_loss: 2.2215 - val_acc: 0.1039
Epoch 6/28
 - 4s - loss: 2.1401 - acc: 0.2724 - val_loss: 2.0481 - val_acc: 0.3766
Epoch 7/28
 - 4s - loss: 2.0102 - acc: 0.2470 - val_loss: 2.0373 - val_acc: 0.2208
Epoch 8/28
 - 4s - loss: 1.8245 - acc: 0.4109 - val_loss: 1.7246 - val_acc: 0.2597
Epoch 9/28
 - 4s - loss: 1.8050 - acc: 0.3539 - val_loss: 1.7822 - val_acc: 0.3636
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 10/28
 - 4s - loss: 1.6086 - acc: 0.5590 - val_loss: 1.7527 - val_acc: 0.4545
Epoch 11/28
 - 4s - loss: 1.7736 - acc: 0.4863 - val_loss: 2.0907 - val_acc: 0.1688
Epoch 12/28
 - 4s - loss: 1.7051 - acc: 0.3294 - val_loss: 1.6672 - val_acc: 0.4416
Epoch 13/28
 - 4s - loss: 1.7605 - acc: 0.3789 - val_loss: 1.5271 - val_acc: 0.5584
Epoch 14/28
 - 4s - loss: 1.6213 - acc: 0.4751 - val_loss: 1.6262 - val_acc: 0.4286
Epoch 15/28
 - 4s - loss: 1.3438 - acc: 0.5629 - val_loss: 1.5525 - val_acc: 0.5195
Epoch 16/28
 - 4s - loss: 1.5383 - acc: 0.3864 - val_loss: 1.6211 - val_acc: 0.4805
Epoch 17/28
 - 4s - loss: 1.4564 - acc: 0.4624 - val_loss: 1.5674 - val_acc: 0.3766
Epoch 18/28
 - 4s - loss: 1.3884 - acc: 0.5004 - val_loss: 1.4977 - val_acc: 0.5195
Epoch 19/28
 - 4s - loss: 1.5323 - acc: 0.4497 - val_loss: 1.7791 - val_acc: 0.3896
Epoch 20/28
 - 4s - loss: 1.3421 - acc: 0.5280 - val_loss: 1.5600 - val_acc: 0.5065
Epoch 21/28
 - 4s - loss: 1.5935 - acc: 0.4941 - val_loss: 1.4425 - val_acc: 0.5195
Epoch 22/28
 - 4s - loss: 1.3890 - acc: 0.5701 - val_loss: 1.6915 - val_acc: 0.4805
Epoch 23/28
 - 4s - loss: 1.5916 - acc: 0.4877 - val_loss: 1.3326 - val_acc: 0.6623
Epoch 24/28
 - 4s - loss: 1.5673 - acc: 0.3674 - val_loss: 1.5689 - val_acc: 0.4286
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 25/28
 - 4s - loss: 1.3975 - acc: 0.4751 - val_loss: 1.5313 - val_acc: 0.4935
Epoch 26/28
 - 4s - loss: 1.1894 - acc: 0.6522 - val_loss: 1.2924 - val_acc: 0.6234
Epoch 27/28
 - 4s - loss: 1.1799 - acc: 0.6463 - val_loss: 1.6090 - val_acc: 0.3896
Epoch 28/28
 - 4s - loss: 1.2849 - acc: 0.5342 - val_loss: 1.3399 - val_acc: 0.5844
{'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0004032591292372277, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.2442824728736464, 'num_dense_units_0': 203, 'cnn_learning_rate': 2.880793251858514e-05, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 112}

 ****** InceptionV3 unfrozen 2 top blocks, cut_off after layer 248 ******
Epoch 1/4
 - 6s - loss: 1.2252 - acc: 0.6587 - val_loss: 1.3333 - val_acc: 0.5844
Epoch 2/4
 - 4s - loss: 1.1407 - acc: 0.6397 - val_loss: 1.3323 - val_acc: 0.5844
Epoch 3/4
 - 5s - loss: 0.9788 - acc: 0.7329 - val_loss: 1.3247 - val_acc: 0.5714
Epoch 4/4
 - 4s - loss: 1.0644 - acc: 0.5658 - val_loss: 1.3201 - val_acc: 0.5844
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (3, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (3, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (3, 0, 0)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0004032591292372277, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.2442824728736464, 'num_dense_units_0': 203, 'cnn_learning_rate': 2.880793251858514e-05, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 112}, 'working_directory': '.', 'budget': 32.0}
result: {'loss': 0.41558441093989784, 'info': {'histories': {'val_loss': [2.4074155943734303, 2.589684604050277, 2.228452979744255, 2.202503758591491, 2.221507097219492, 2.048104865210397, 2.0372605509572215, 1.7245895150419954, 1.782226206420304, 1.75266847362766, 2.090742876003315, 1.6672342442846917, 1.5270935962726544, 1.626206295830863, 1.5524543632160535, 1.6210663581823375, 1.5674454484667097, 1.49770035991421, 1.77913782039246, 1.559974232277313, 1.4425183828774986, 1.691545820855475, 1.3325644328996733, 1.568864978753127, 1.531303150313241, 1.2924193964376078, 1.6090373172388448, 1.3398949356822225, 1.3332734386642258, 1.3322678254796314, 1.3247382640838623, 1.3201106182940594], 'acc': [0.12230215993502157, 0.17985611660875006, 0.11180124112537929, 0.3597122332175001, 0.1870503642951413, 0.3093525206656765, 0.2805755392467375, 0.33093524796606827, 0.2661870477868499, 0.5590062183993203, 0.324786340770049, 0.3741007263926293, 0.37888198665210177, 0.5395683744828478, 0.5035971370961169, 0.4388489197912834, 0.525179844322822, 0.5683453361765086, 0.5107913684073112, 0.5279503166675568, 0.5611511031500727, 0.6474820178189724, 0.5539568405357196, 0.4172661886583987, 0.5395683350322915, 0.6521739193371364, 0.6923077167608799, 0.5341614953109196, 0.7482014675792172, 0.7266187191867143, 0.7329192757606506, 0.7435897889300289], 'loss': [2.8029224169340066, 2.354297735708223, 2.3797475269862582, 2.0831384898947296, 2.106436505592127, 2.0364773693702203, 1.998083610328839, 1.8423719766328661, 1.900076811262172, 1.608636464391436, 1.8295976606189694, 1.5882460796575752, 1.7605056081499373, 1.4955400528667642, 1.3755691334498015, 1.4676081456726404, 1.4042340774330304, 1.284137141361511, 1.3866276290776918, 1.3421204771314348, 1.4181274836011928, 1.1525813967203922, 1.3053612674740578, 1.539194888348202, 1.3158658897276405, 1.1894118360110693, 1.0601472090452144, 1.2848988601139613, 0.963545921037523, 0.9932208803060244, 0.9787699835641044, 0.8919766957943256], 'val_acc': [0.12987013083773774, 0.09090909187669878, 0.2207792227144365, 0.1038961038961039, 0.10389610437990783, 0.37662337855859235, 0.2207792234885228, 0.2597402624495618, 0.36363636460397153, 0.4545454599640586, 0.16883116979877671, 0.4415584434936573, 0.5584415638601625, 0.42857143399003267, 0.5194805248991236, 0.4805194944530338, 0.37662337855859235, 0.5194805334140729, 0.38961039580308, 0.5064935126861969, 0.519480523350951, 0.4805194851639983, 0.6623376654340075, 0.4285714332159464, 0.4935065058918742, 0.6233766373101767, 0.38961039077151904, 0.5844155863508002, 0.5844155882860159, 0.5844155968009651, 0.5714285745249166, 0.5844155890601022]}, 'runtime': 147.60551500320435}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 0)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 2)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 2) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 3
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (3, 0, 2) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (4, 0, 2) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (4, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.007718585026206239, 'height_shift_range': 0.267, 'batch_size': 51, 'num_dense_units_2': 15, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.24820020339661122, 'num_dense_units_0': 270, 'cnn_learning_rate': 1.0867347824320923e-05, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 298}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 15:21:46.508260: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 4s - loss: 6.0626 - acc: 0.0930 - val_loss: 2.2736 - val_acc: 0.0000e+00
Epoch 2/16
 - 3s - loss: 2.4279 - acc: 0.1046 - val_loss: 2.3042 - val_acc: 0.1250
Epoch 3/16
 - 3s - loss: 2.3041 - acc: 0.0572 - val_loss: 2.3016 - val_acc: 0.1250
Epoch 4/16
 - 3s - loss: 2.3062 - acc: 0.0572 - val_loss: 2.3030 - val_acc: 0.1562
Epoch 5/16
 - 3s - loss: 2.3035 - acc: 0.0944 - val_loss: 2.3105 - val_acc: 0.0625
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 6/16
 - 3s - loss: 2.3018 - acc: 0.1087 - val_loss: 2.3006 - val_acc: 0.1562
Epoch 7/16
 - 3s - loss: 2.3014 - acc: 0.1438 - val_loss: 2.3068 - val_acc: 0.1250
Epoch 8/16
 - 3s - loss: 2.3055 - acc: 0.0944 - val_loss: 2.2978 - val_acc: 0.1562
Epoch 9/16
 - 3s - loss: 2.3023 - acc: 0.1388 - val_loss: 2.3013 - val_acc: 0.0625
Epoch 10/16
 - 3s - loss: 2.3006 - acc: 0.1159 - val_loss: 2.3039 - val_acc: 0.1562
Epoch 11/16
 - 3s - loss: 2.3063 - acc: 0.0715 - val_loss: 2.2966 - val_acc: 0.1250
Epoch 12/16
 - 3s - loss: 2.2996 - acc: 0.1176 - val_loss: 2.2987 - val_acc: 0.1250
Epoch 13/16
 - 3s - loss: 2.3067 - acc: 0.0715 - val_loss: 2.2917 - val_acc: 0.1562
Epoch 14/16
 - 3s - loss: 2.2995 - acc: 0.1087 - val_loss: 2.2908 - val_acc: 0.0000e+00
Epoch 15/16
 - 3s - loss: 2.2982 - acc: 0.1242 - val_loss: 2.3011 - val_acc: 0.0938
Epoch 16/16
 - 3s - loss: 2.3078 - acc: 0.0930 - val_loss: 2.2929 - val_acc: 0.1875
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (4, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (4, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (4, 0, 2)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.007718585026206239, 'height_shift_range': 0.267, 'batch_size': 51, 'num_dense_units_2': 15, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.24820020339661122, 'num_dense_units_0': 270, 'cnn_learning_rate': 1.0867347824320923e-05, 'cnn_unlock_epoch': 28, 'num_dense_units_1': 298}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.8125, 'info': {'histories': {'val_loss': [2.2736148834228516, 2.3041648864746094, 2.3016438484191895, 2.303004503250122, 2.3105132579803467, 2.300621747970581, 2.306793689727783, 2.2977633476257324, 2.3012800216674805, 2.303860664367676, 2.296597957611084, 2.298732280731201, 2.2916970252990723, 2.2907772064208984, 2.301062822341919, 2.292903423309326], 'acc': [0.11711712725259163, 0.10457517206668854, 0.07207207462272129, 0.07207207804596102, 0.09009009559412261, 0.10810811253818306, 0.1437908560037613, 0.0900900930266928, 0.11711712503755414, 0.11711712443345301, 0.09009009499002148, 0.11764706671237946, 0.09009009499002148, 0.10810811253818306, 0.12418301651875178, 0.11711712725259163], 'loss': [5.739563246031065, 2.427896420160929, 2.303938582136824, 2.3059459634729333, 2.3038008728542843, 2.3037472673364587, 2.3014374574025473, 2.305179602391011, 2.3023000407863305, 2.300179642599982, 2.3040400453515955, 2.2996100584665933, 2.3008561907587826, 2.2982473566725448, 2.298177162806193, 2.300031198037637], 'val_acc': [0.0, 0.125, 0.125, 0.15625, 0.0625, 0.15625, 0.125, 0.15625, 0.0625, 0.15625, 0.125, 0.125, 0.15625, 0.0, 0.09375, 0.1875]}, 'runtime': 53.89794063568115}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (3, 0, 2)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (3, 0, 2) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (3, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 3) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (3, 0, 2) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (3, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000868440879631394, 'height_shift_range': 0.267, 'batch_size': 26, 'num_dense_units_2': 57, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.062292327256539444, 'num_dense_units_0': 407, 'cnn_learning_rate': 1.5705998919914355e-05, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 119}, 'working_directory': '.', 'budget': 64.0}
2018-02-08 15:22:40.074192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/13
 - 7s - loss: 2.4086 - acc: 0.1230 - val_loss: 2.2658 - val_acc: 0.1875
Epoch 2/13
 - 5s - loss: 2.2671 - acc: 0.1795 - val_loss: 2.3040 - val_acc: 0.2188
Epoch 3/13
 - 4s - loss: 2.2702 - acc: 0.1510 - val_loss: 2.2315 - val_acc: 0.1406
Epoch 4/13
 - 5s - loss: 2.0453 - acc: 0.3141 - val_loss: 2.2999 - val_acc: 0.1250
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 5/13
 - 4s - loss: 2.0695 - acc: 0.2268 - val_loss: 2.1550 - val_acc: 0.2344
Epoch 6/13
 - 5s - loss: 1.9275 - acc: 0.2578 - val_loss: 2.1539 - val_acc: 0.0938
Epoch 7/13
 - 5s - loss: 1.7865 - acc: 0.3846 - val_loss: 2.0526 - val_acc: 0.3125
Epoch 8/13
 - 4s - loss: 1.8368 - acc: 0.4490 - val_loss: 1.9366 - val_acc: 0.2969
Epoch 9/13
 - 5s - loss: 1.7642 - acc: 0.3639 - val_loss: 1.8211 - val_acc: 0.4219
Epoch 10/13
 - 5s - loss: 1.6225 - acc: 0.4948 - val_loss: 1.7151 - val_acc: 0.4219
Epoch 11/13
 - 5s - loss: 1.3540 - acc: 0.5321 - val_loss: 1.7097 - val_acc: 0.4844
Epoch 12/13
 - 4s - loss: 1.5747 - acc: 0.4443 - val_loss: 1.4832 - val_acc: 0.5625
Epoch 13/13
 - 5s - loss: 1.2622 - acc: 0.6154 - val_loss: 1.3321 - val_acc: 0.6875
{'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000868440879631394, 'height_shift_range': 0.267, 'batch_size': 26, 'num_dense_units_2': 57, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.062292327256539444, 'num_dense_units_0': 407, 'cnn_learning_rate': 1.5705998919914355e-05, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 119}

 ****** Xception no layers unfrozen
Epoch 1/51
 - 5s - loss: 1.1910 - acc: 0.6309 - val_loss: 1.3866 - val_acc: 0.4531
Epoch 2/51
 - 5s - loss: 0.9775 - acc: 0.6923 - val_loss: 1.1828 - val_acc: 0.6562
Epoch 3/51
 - 4s - loss: 1.1823 - acc: 0.6623 - val_loss: 1.0986 - val_acc: 0.7344
Epoch 4/51
 - 5s - loss: 0.9037 - acc: 0.6819 - val_loss: 1.5461 - val_acc: 0.4375
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 5/51
 - 4s - loss: 1.1241 - acc: 0.6442 - val_loss: 1.4920 - val_acc: 0.4844
Epoch 6/51
 - 5s - loss: 0.9709 - acc: 0.6538 - val_loss: 0.8804 - val_acc: 0.7812
Epoch 7/51
 - 5s - loss: 0.8835 - acc: 0.6885 - val_loss: 0.9752 - val_acc: 0.6562
Epoch 8/51
 - 5s - loss: 0.9134 - acc: 0.7238 - val_loss: 0.9259 - val_acc: 0.7188
Epoch 9/51
 - 5s - loss: 0.5664 - acc: 0.8639 - val_loss: 1.6931 - val_acc: 0.4062
Epoch 10/51
 - 5s - loss: 1.0579 - acc: 0.6178 - val_loss: 0.9472 - val_acc: 0.6875
Epoch 11/51
 - 5s - loss: 1.1550 - acc: 0.6519 - val_loss: 0.9011 - val_acc: 0.7812
Epoch 12/51
 - 5s - loss: 0.4646 - acc: 0.8835 - val_loss: 1.0137 - val_acc: 0.6406
Epoch 13/51
 - 5s - loss: 0.8057 - acc: 0.7372 - val_loss: 0.7243 - val_acc: 0.7656
Epoch 14/51
 - 5s - loss: 0.8085 - acc: 0.7160 - val_loss: 0.8807 - val_acc: 0.7656
Epoch 15/51
 - 4s - loss: 0.6222 - acc: 0.7605 - val_loss: 0.9022 - val_acc: 0.7500
Epoch 16/51
 - 5s - loss: 0.6002 - acc: 0.7885 - val_loss: 0.7546 - val_acc: 0.7969
Epoch 17/51
 - 4s - loss: 0.7202 - acc: 0.7347 - val_loss: 0.8234 - val_acc: 0.7969
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 18/51
 - 5s - loss: 0.5296 - acc: 0.8233 - val_loss: 0.7690 - val_acc: 0.6875
Epoch 19/51
 - 5s - loss: 0.6721 - acc: 0.7749 - val_loss: 1.4810 - val_acc: 0.5625
Epoch 20/51
 - 5s - loss: 0.5841 - acc: 0.8333 - val_loss: 0.9274 - val_acc: 0.6719
Epoch 21/51
 - 5s - loss: 0.4720 - acc: 0.8377 - val_loss: 0.7399 - val_acc: 0.7188
Epoch 22/51
 - 5s - loss: 0.6271 - acc: 0.7932 - val_loss: 0.7766 - val_acc: 0.7344
Epoch 23/51
 - 5s - loss: 0.3288 - acc: 0.9103 - val_loss: 0.7285 - val_acc: 0.7500
Epoch 24/51
 - 5s - loss: 0.3252 - acc: 0.9346 - val_loss: 0.7296 - val_acc: 0.7344
Epoch 25/51
 - 5s - loss: 0.6797 - acc: 0.7853 - val_loss: 0.7980 - val_acc: 0.7812
Epoch 26/51
 - 4s - loss: 0.9104 - acc: 0.6846 - val_loss: 1.2822 - val_acc: 0.5625
Epoch 27/51
 - 5s - loss: 0.4468 - acc: 0.8782 - val_loss: 0.8109 - val_acc: 0.6719
Epoch 28/51
 - 5s - loss: 0.6209 - acc: 0.8194 - val_loss: 0.9431 - val_acc: 0.7031
Epoch 29/51
 - 5s - loss: 0.3496 - acc: 0.8770 - val_loss: 0.8972 - val_acc: 0.6719
Epoch 30/51
 - 5s - loss: 0.7105 - acc: 0.7487 - val_loss: 0.9126 - val_acc: 0.7031
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 31/51
 - 5s - loss: 0.6618 - acc: 0.7605 - val_loss: 0.8549 - val_acc: 0.6875
Epoch 32/51
 - 5s - loss: 0.2798 - acc: 0.9231 - val_loss: 0.9668 - val_acc: 0.6719
Epoch 33/51
 - 4s - loss: 0.4145 - acc: 0.8442 - val_loss: 1.8720 - val_acc: 0.5000
Epoch 34/51
 - 5s - loss: 0.4737 - acc: 0.8526 - val_loss: 0.8985 - val_acc: 0.7344
Epoch 35/51
 - 5s - loss: 0.4054 - acc: 0.8639 - val_loss: 1.2133 - val_acc: 0.6406
Epoch 36/51
 - 5s - loss: 0.5927 - acc: 0.8115 - val_loss: 0.8617 - val_acc: 0.7344
Epoch 37/51
 - 5s - loss: 0.3090 - acc: 0.9295 - val_loss: 0.7561 - val_acc: 0.7188
Epoch 38/51
 - 5s - loss: 0.3757 - acc: 0.8770 - val_loss: 0.9003 - val_acc: 0.6562
Epoch 39/51
 - 4s - loss: 0.6232 - acc: 0.7690 - val_loss: 0.7480 - val_acc: 0.7344
Epoch 40/51
 - 5s - loss: 0.4357 - acc: 0.8462 - val_loss: 0.8056 - val_acc: 0.7344
Epoch 41/51
 - 5s - loss: 0.3327 - acc: 0.8652 - val_loss: 0.7866 - val_acc: 0.7812
Epoch 42/51
 - 5s - loss: 0.9761 - acc: 0.7553 - val_loss: 0.9972 - val_acc: 0.6719
Epoch 43/51
 - 5s - loss: 0.5835 - acc: 0.7997 - val_loss: 0.6918 - val_acc: 0.7344
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 44/51
 - 5s - loss: 0.2579 - acc: 0.9411 - val_loss: 0.8532 - val_acc: 0.7500
Epoch 45/51
 - 5s - loss: 0.3208 - acc: 0.8718 - val_loss: 0.8425 - val_acc: 0.7344
Epoch 46/51
 - 5s - loss: 0.3250 - acc: 0.9084 - val_loss: 1.0101 - val_acc: 0.6875
Epoch 47/51
 - 5s - loss: 0.2234 - acc: 0.9411 - val_loss: 0.8388 - val_acc: 0.7344
Epoch 48/51
 - 5s - loss: 0.6949 - acc: 0.8076 - val_loss: 1.0532 - val_acc: 0.7500
Epoch 49/51
 - 5s - loss: 0.4909 - acc: 0.8639 - val_loss: 1.1343 - val_acc: 0.7031
Epoch 50/51
 - 5s - loss: 0.3118 - acc: 0.9346 - val_loss: 0.8599 - val_acc: 0.6875
Epoch 51/51
 - 5s - loss: 0.1261 - acc: 0.9607 - val_loss: 1.2238 - val_acc: 0.6094
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (3, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (3, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (3, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (3, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (3, 0, 2)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000868440879631394, 'height_shift_range': 0.267, 'batch_size': 26, 'num_dense_units_2': 57, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.062292327256539444, 'num_dense_units_0': 407, 'cnn_learning_rate': 1.5705998919914355e-05, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 119}, 'working_directory': '.', 'budget': 64.0}
result: {'loss': 0.390625, 'info': {'histories': {'val_loss': [2.265837788581848, 2.304039478302002, 2.231478214263916, 2.299903631210327, 2.1550021171569824, 2.1539446115493774, 2.052581310272217, 1.9365696907043457, 1.821116864681244, 1.7150802612304688, 1.7096850872039795, 1.4831860065460205, 1.3320934176445007, 1.386553704738617, 1.1828003525733948, 1.098618745803833, 1.5460516214370728, 1.492020845413208, 0.8804378509521484, 0.9752229154109955, 0.9258765280246735, 1.6931148767471313, 0.9472286701202393, 0.9010856449604034, 1.0137469172477722, 0.7242993116378784, 0.8807108402252197, 0.9022126197814941, 0.7545717358589172, 0.8233816027641296, 0.7690434157848358, 1.4809769988059998, 0.9273760616779327, 0.7399237751960754, 0.7765740156173706, 0.7285223007202148, 0.7296283692121506, 0.7979680299758911, 1.282210648059845, 0.8108866214752197, 0.9430564343929291, 0.897204577922821, 0.9125568568706512, 0.8549000322818756, 0.9668099880218506, 1.8719621896743774, 0.8985095918178558, 1.213255524635315, 0.8617280125617981, 0.7560971975326538, 0.9002865552902222, 0.7479839026927948, 0.8055827617645264, 0.7865689396858215, 0.997249037027359, 0.6918342411518097, 0.8532408177852631, 0.8425427675247192, 1.0101304054260254, 0.8387744426727295, 1.0532334446907043, 1.1343389749526978, 0.859946072101593, 1.2238314747810364], 'acc': [0.11764706528800375, 0.17948718865712485, 0.14655173030392876, 0.3141025851170222, 0.26724140423125237, 0.22794118983780637, 0.3846154014269511, 0.4632353020064971, 0.36764708095613646, 0.5147059242076734, 0.5320513099431992, 0.4051724310065138, 0.6153846681118011, 0.647058871739051, 0.6923077205816904, 0.6617647317402503, 0.6838235653498593, 0.637931096142736, 0.6538462241490682, 0.6911765231805689, 0.7720588642884704, 0.867647119304713, 0.632352978867643, 0.691176510470755, 0.8897059244268081, 0.7371795276800791, 0.7426471070331686, 0.7720588428132674, 0.7884615858395895, 0.7068965856371254, 0.8014706285560832, 0.8088235907694873, 0.8333333730697632, 0.8382353449569029, 0.8088235863867927, 0.9102564652760824, 0.9264706268030054, 0.7794118304462994, 0.6896552109512789, 0.8782051702340444, 0.8382353265495861, 0.8823529893861097, 0.7794118050266715, 0.7720588656032786, 0.9230769574642181, 0.8706896880577351, 0.852564146121343, 0.8676470965147018, 0.8088235592140871, 0.9294872184594473, 0.8823529779911041, 0.8448276206337172, 0.8461538950602213, 0.8897059288095025, 0.7867647286723641, 0.8161764986374799, 0.9338235732387093, 0.8717949092388153, 0.8970588752452064, 0.9338235732387093, 0.8455882773679846, 0.867647119304713, 0.9264706268030054, 0.9558823783608044], 'loss': [2.3797233595567593, 2.2671424945195517, 2.2777986978662423, 2.045271893342336, 2.0391836186935164, 1.9629472161040586, 1.7864861289660137, 1.7929747542914223, 1.793078981778201, 1.5534017752198612, 1.3539591034253438, 1.6105396788695763, 1.2621943751970928, 1.207483353860238, 0.9775357743104299, 1.2040551918394424, 0.9210593156954822, 1.1297339632593353, 0.9708759685357412, 0.8696268358651329, 0.7640495896339417, 0.5652188882231712, 1.0630120152936262, 1.0474147919346304, 0.45769476276986737, 0.8056939641634623, 0.7640389541492743, 0.6285072521251791, 0.6001694649457932, 0.7543925704627201, 0.5516990655485321, 0.5588654538287836, 0.5841278185447057, 0.4669734176029177, 0.5512161495931008, 0.3287762527664502, 0.3240876837688334, 0.6367516806896996, 0.9884759095208399, 0.446763997276624, 0.5263913429396994, 0.3561196022612207, 0.6566018153201131, 0.6066459921353003, 0.27981409182151157, 0.3513273288463724, 0.4737129757801692, 0.4057668017990449, 0.5825030735748655, 0.3089869370063146, 0.3722410931744996, 0.45724275425590316, 0.4356567660967509, 0.2966439612209797, 0.9685960925896379, 0.5413949031601933, 0.2635629402802271, 0.3207520395517349, 0.33751195033683495, 0.2345751594094669, 0.622062756186899, 0.4507553239955622, 0.3161909540786463, 0.1336726954973796], 'val_acc': [0.1875, 0.21875, 0.140625, 0.125, 0.234375, 0.09375, 0.3125, 0.296875, 0.421875, 0.421875, 0.484375, 0.5625, 0.6875, 0.453125, 0.65625, 0.734375, 0.4375, 0.484375, 0.78125, 0.65625, 0.71875, 0.40625, 0.6875, 0.78125, 0.640625, 0.765625, 0.765625, 0.75, 0.796875, 0.796875, 0.6875, 0.5625, 0.671875, 0.71875, 0.734375, 0.75, 0.734375, 0.78125, 0.5625, 0.671875, 0.703125, 0.671875, 0.703125, 0.6875, 0.671875, 0.5, 0.734375, 0.640625, 0.734375, 0.71875, 0.65625, 0.734375, 0.734375, 0.78125, 0.671875, 0.734375, 0.75, 0.734375, 0.6875, 0.734375, 0.75, 0.703125, 0.6875, 0.609375]}, 'runtime': 302.4299383163452}}
exception: None

DEBUG:hpbandster:job_callback for (3, 0, 2)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 3)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 3) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 3) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 4) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (4, 0, 3) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (4, 0, 3)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0003088106616919352, 'height_shift_range': 0.267, 'batch_size': 35, 'num_dense_units_2': 266, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.04867229980383107, 'num_dense_units_0': 205, 'cnn_learning_rate': 7.672411366113951e-05, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 436}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 15:27:42.040247: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 6s - loss: 2.2911 - acc: 0.0857 - val_loss: 2.3013 - val_acc: 0.0625
Epoch 2/16
 - 4s - loss: 2.2335 - acc: 0.2905 - val_loss: 2.2847 - val_acc: 0.1562
Epoch 3/16
 - 4s - loss: 2.1575 - acc: 0.3460 - val_loss: 2.2352 - val_acc: 0.2031
Epoch 4/16
 - 5s - loss: 2.0510 - acc: 0.4500 - val_loss: 2.1795 - val_acc: 0.3906
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 5/16
 - 4s - loss: 1.8862 - acc: 0.5036 - val_loss: 2.0951 - val_acc: 0.4219
Epoch 6/16
 - 5s - loss: 1.7762 - acc: 0.4643 - val_loss: 2.0387 - val_acc: 0.3906
Epoch 7/16
 - 4s - loss: 1.6281 - acc: 0.5799 - val_loss: 1.9956 - val_acc: 0.4375
Epoch 8/16
 - 4s - loss: 1.5357 - acc: 0.6124 - val_loss: 1.8762 - val_acc: 0.4062
Epoch 9/16
 - 4s - loss: 1.2956 - acc: 0.6489 - val_loss: 1.7707 - val_acc: 0.4062
Epoch 10/16
 - 4s - loss: 1.2296 - acc: 0.6556 - val_loss: 1.7796 - val_acc: 0.4375
Epoch 11/16
 - 5s - loss: 1.1319 - acc: 0.6929 - val_loss: 1.6272 - val_acc: 0.4375
Epoch 12/16
 - 4s - loss: 1.0062 - acc: 0.7619 - val_loss: 1.5831 - val_acc: 0.4375
Epoch 13/16
 - 4s - loss: 0.8677 - acc: 0.8183 - val_loss: 1.7104 - val_acc: 0.3750
Epoch 14/16
 - 4s - loss: 0.8754 - acc: 0.7785 - val_loss: 1.6328 - val_acc: 0.4219
Epoch 15/16
 - 5s - loss: 0.7958 - acc: 0.8071 - val_loss: 1.3967 - val_acc: 0.5312
Epoch 16/16
 - 5s - loss: 0.7603 - acc: 0.7786 - val_loss: 1.5455 - val_acc: 0.4531
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (4, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (4, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 3) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (4, 0, 3)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0003088106616919352, 'height_shift_range': 0.267, 'batch_size': 35, 'num_dense_units_2': 266, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.04867229980383107, 'num_dense_units_0': 205, 'cnn_learning_rate': 7.672411366113951e-05, 'cnn_unlock_epoch': 19, 'num_dense_units_1': 436}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.546875, 'info': {'histories': {'val_loss': [2.3012880086898804, 2.2846877574920654, 2.2352415323257446, 2.179485321044922, 2.095111131668091, 2.038727283477783, 1.9955549240112305, 1.876150131225586, 1.7706509232521057, 1.7796102166175842, 1.6271864771842957, 1.5831241607666016, 1.7104234099388123, 1.6327959895133972, 1.3966553211212158, 1.5455281734466553], 'acc': [0.08571428712457418, 0.2992126039397998, 0.3508772013480203, 0.45000001788139343, 0.5039370322790672, 0.4642857313156128, 0.5826771883513984, 0.6141732527515081, 0.653543329145026, 0.6535433253904027, 0.6928571611642838, 0.7719298365869021, 0.8110236370657372, 0.771653557386924, 0.8071428686380386, 0.7785714417695999], 'loss': [2.2910545468330383, 2.22980726046825, 2.154622201333966, 2.0510362684726715, 1.883129645520308, 1.7762277722358704, 1.6182583570480347, 1.5306102403505581, 1.2798074652829508, 1.23326063813187, 1.1318927556276321, 0.9862369591729683, 0.8641506330234798, 0.8875260629991847, 0.7957853674888611, 0.7602742612361908], 'val_acc': [0.0625, 0.15625, 0.203125, 0.390625, 0.421875, 0.390625, 0.4375, 0.40625, 0.40625, 0.4375, 0.4375, 0.4375, 0.375, 0.421875, 0.53125, 0.453125]}, 'runtime': 77.30169939994812}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 3)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 4)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 4) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 5) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (4, 0, 4) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (4, 0, 4)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0016300434539378834, 'height_shift_range': 0.267, 'batch_size': 33, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.01619592738073965, 'num_dense_units_0': 145, 'cnn_learning_rate': 1.134874168789118e-05, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 294}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 15:28:59.389752: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/14
 - 6s - loss: 2.5185 - acc: 0.1288 - val_loss: 2.2743 - val_acc: 0.1094
Epoch 2/14
 - 5s - loss: 2.1941 - acc: 0.2231 - val_loss: 2.3295 - val_acc: 0.2344
Epoch 3/14
 - 4s - loss: 2.1036 - acc: 0.2548 - val_loss: 2.0584 - val_acc: 0.2656
Epoch 4/14
 - 4s - loss: 2.0252 - acc: 0.2208 - val_loss: 2.0194 - val_acc: 0.2188
Epoch 5/14
 - 5s - loss: 1.7682 - acc: 0.4394 - val_loss: 1.8487 - val_acc: 0.3906
Epoch 6/14
 - 4s - loss: 1.4269 - acc: 0.5531 - val_loss: 2.0602 - val_acc: 0.2812
Epoch 7/14
 - 4s - loss: 1.4185 - acc: 0.5437 - val_loss: 1.9349 - val_acc: 0.1562
Epoch 8/14
 - 4s - loss: 1.3915 - acc: 0.4804 - val_loss: 1.8383 - val_acc: 0.3906
Epoch 9/14
 - 5s - loss: 1.1771 - acc: 0.6364 - val_loss: 2.0371 - val_acc: 0.3281
Epoch 10/14
 - 4s - loss: 1.3611 - acc: 0.5695 - val_loss: 1.7391 - val_acc: 0.4062
Epoch 11/14
 - 4s - loss: 1.1476 - acc: 0.5957 - val_loss: 1.6022 - val_acc: 0.4062
Epoch 12/14
 - 4s - loss: 1.0071 - acc: 0.6210 - val_loss: 1.6831 - val_acc: 0.4219
Epoch 13/14
 - 4s - loss: 0.9804 - acc: 0.6825 - val_loss: 1.5385 - val_acc: 0.4219
Epoch 14/14
 - 5s - loss: 1.0925 - acc: 0.6742 - val_loss: 1.3749 - val_acc: 0.5156
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
{'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0016300434539378834, 'height_shift_range': 0.267, 'batch_size': 33, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.01619592738073965, 'num_dense_units_0': 145, 'cnn_learning_rate': 1.134874168789118e-05, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 294}

 ****** Xception no layers unfrozen
Epoch 1/2
 - 5s - loss: 0.6686 - acc: 0.7452 - val_loss: 1.5925 - val_acc: 0.4219
Epoch 2/2
 - 5s - loss: 0.9038 - acc: 0.7212 - val_loss: 1.1922 - val_acc: 0.5781
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (4, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (4, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (4, 0, 4)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0016300434539378834, 'height_shift_range': 0.267, 'batch_size': 33, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.01619592738073965, 'num_dense_units_0': 145, 'cnn_learning_rate': 1.134874168789118e-05, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 294}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.421875, 'info': {'histories': {'val_loss': [2.274309515953064, 2.3294572830200195, 2.0584189891815186, 2.0193578600883484, 1.8487369418144226, 2.0602328777313232, 1.9349061250686646, 1.8383008241653442, 2.037135362625122, 1.7390754222869873, 1.6022369861602783, 1.6830536127090454, 1.5385119915008545, 1.3749038577079773, 1.592545211315155, 1.1922134160995483], 'acc': [0.12878788262605667, 0.22480620894321177, 0.2558139638845311, 0.22222223168327696, 0.43939395248889923, 0.5503876195397488, 0.5426356612249862, 0.4806201735208201, 0.6363636553287506, 0.5658915160700332, 0.5968992377436438, 0.620155040607896, 0.6821705768274706, 0.6742424368858337, 0.7441860797793366, 0.7209302588950756], 'loss': [2.518471121788025, 2.1876243269720743, 2.1006208103756574, 2.019055868898119, 1.7682329416275024, 1.432582090067309, 1.4201684081277182, 1.391225446102231, 1.1771057844161987, 1.3706207247667535, 1.14524539958599, 1.009442307228266, 0.9770025804985402, 1.092458724975586, 0.6705738735753436, 0.9041457883147306], 'val_acc': [0.109375, 0.234375, 0.265625, 0.21875, 0.390625, 0.28125, 0.15625, 0.390625, 0.328125, 0.40625, 0.40625, 0.421875, 0.421875, 0.515625, 0.421875, 0.578125]}, 'runtime': 78.81493806838989}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 4)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 5)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 5) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 6) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (4, 0, 5) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (4, 0, 5)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025552720420642577, 'height_shift_range': 0.267, 'batch_size': 25, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1237095677878801, 'num_dense_units_0': 337, 'cnn_learning_rate': 9.394238019451583e-05, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 488}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 15:30:18.875369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 6s - loss: 2.3830 - acc: 0.1733 - val_loss: 2.2272 - val_acc: 0.1039
Epoch 2/16
 - 5s - loss: 1.8620 - acc: 0.3970 - val_loss: 2.0683 - val_acc: 0.2987
Epoch 3/16
 - 5s - loss: 1.5276 - acc: 0.5633 - val_loss: 1.8911 - val_acc: 0.3377
Epoch 4/16
 - 5s - loss: 1.3686 - acc: 0.6200 - val_loss: 1.7134 - val_acc: 0.3896
Epoch 5/16
 - 5s - loss: 1.2628 - acc: 0.6391 - val_loss: 1.8192 - val_acc: 0.3506
Epoch 6/16
 - 5s - loss: 1.0568 - acc: 0.7102 - val_loss: 1.6018 - val_acc: 0.4935
Epoch 7/16
 - 5s - loss: 1.0881 - acc: 0.6667 - val_loss: 1.6039 - val_acc: 0.3766
Epoch 8/16
 - 5s - loss: 0.7983 - acc: 0.8452 - val_loss: 1.3720 - val_acc: 0.4545
Epoch 9/16
 - 5s - loss: 0.9394 - acc: 0.7376 - val_loss: 1.1895 - val_acc: 0.5974
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 10/16
 - 5s - loss: 0.8085 - acc: 0.7573 - val_loss: 1.1745 - val_acc: 0.5584
Epoch 11/16
 - 5s - loss: 0.6110 - acc: 0.8600 - val_loss: 1.2257 - val_acc: 0.5455
Epoch 12/16
 - 5s - loss: 0.6559 - acc: 0.8043 - val_loss: 1.0230 - val_acc: 0.6234
Epoch 13/16
 - 5s - loss: 0.6452 - acc: 0.8000 - val_loss: 0.9844 - val_acc: 0.6494
Epoch 14/16
 - 5s - loss: 0.6295 - acc: 0.8176 - val_loss: 1.1212 - val_acc: 0.5325
Epoch 15/16
 - 5s - loss: 0.5721 - acc: 0.8328 - val_loss: 0.9788 - val_acc: 0.6104
Epoch 16/16
 - 5s - loss: 0.6253 - acc: 0.7996 - val_loss: 0.9495 - val_acc: 0.7013
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (4, 0, 5), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (4, 0, 5) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 5) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (4, 0, 5)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025552720420642577, 'height_shift_range': 0.267, 'batch_size': 25, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1237095677878801, 'num_dense_units_0': 337, 'cnn_learning_rate': 9.394238019451583e-05, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 488}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.29870128631591797, 'info': {'histories': {'val_loss': [2.2271971516794973, 2.0683016002952277, 1.8910908513254934, 1.7134071511107605, 1.819239987955465, 1.6018132544183112, 1.6039197228171609, 1.3720438480377197, 1.1894553636575673, 1.174533944625359, 1.2257471425192696, 1.022993018100788, 0.9844342849471353, 1.1211814787480738, 0.9788282660694866, 0.9494570044728069], 'acc': [0.173333328217268, 0.40875912495773203, 0.5161290262495318, 0.6199999650319418, 0.6569342713286407, 0.7177419186599793, 0.6666666269302368, 0.8394160322899366, 0.7299269825002573, 0.7445255248215947, 0.8599999745686849, 0.8064515946372863, 0.7999999821186066, 0.8029196893211699, 0.8394160275041622, 0.8102189589590922], 'loss': [2.3830306132634482, 1.8403238197312737, 1.5594696969755235, 1.3686454097429912, 1.2278929331006796, 1.045981147596913, 1.0881086091200511, 0.8101790229769519, 0.9537462940181258, 0.8177234969870018, 0.6110491752624512, 0.6713956656955904, 0.6451690594355265, 0.6481991271032904, 0.5727947628411063, 0.6088013840417792], 'val_acc': [0.10389610486371177, 0.29870129918510263, 0.33766233959755343, 0.38961039154560534, 0.350649356842041, 0.4935065074400468, 0.37662337855859235, 0.454545458415886, 0.5974026113361507, 0.5584415615379036, 0.5454545473897612, 0.6233766342138315, 0.6493506617360301, 0.5324675355638776, 0.6103896227749911, 0.701298713684082]}, 'runtime': 83.08111190795898}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 5)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 6)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 6) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 6) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 7) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (4, 0, 6) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (4, 0, 6)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007810663342339422, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1329855592526113, 'num_dense_units_0': 151, 'cnn_learning_rate': 1.3671518696923568e-05, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 222}, 'working_directory': '.', 'budget': 16.0}
2018-02-08 15:31:41.416533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/11
 - 6s - loss: 2.3836 - acc: 0.1584 - val_loss: 2.4338 - val_acc: 0.0909
Epoch 2/11
 - 5s - loss: 1.9807 - acc: 0.3420 - val_loss: 1.9229 - val_acc: 0.2857
Epoch 3/11
 - 5s - loss: 1.6370 - acc: 0.4348 - val_loss: 1.9262 - val_acc: 0.3117
Epoch 4/11
 - 5s - loss: 1.5061 - acc: 0.4252 - val_loss: 1.9618 - val_acc: 0.3117
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 5/11
 - 5s - loss: 1.5001 - acc: 0.5257 - val_loss: 1.6999 - val_acc: 0.3766
Epoch 6/11
 - 5s - loss: 1.2436 - acc: 0.5466 - val_loss: 1.6234 - val_acc: 0.4026
Epoch 7/11
 - 5s - loss: 1.0361 - acc: 0.7973 - val_loss: 1.4193 - val_acc: 0.5065
Epoch 8/11
 - 5s - loss: 1.0149 - acc: 0.6841 - val_loss: 1.3403 - val_acc: 0.5195
Epoch 9/11
 - 5s - loss: 0.8224 - acc: 0.7910 - val_loss: 1.2987 - val_acc: 0.4935
Epoch 10/11
 - 5s - loss: 1.1879 - acc: 0.6207 - val_loss: 1.7544 - val_acc: 0.4156
Epoch 11/11
 - 5s - loss: 1.1432 - acc: 0.5714 - val_loss: 1.2376 - val_acc: 0.6234
{'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007810663342339422, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1329855592526113, 'num_dense_units_0': 151, 'cnn_learning_rate': 1.3671518696923568e-05, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 222}

 ****** Xception unfrozen 1 top blocks, cut_off after layer 125 ******
Epoch 1/5
 - 6s - loss: 0.9976 - acc: 0.7094 - val_loss: 1.2141 - val_acc: 0.6364
Epoch 2/5
 - 5s - loss: 0.7611 - acc: 0.8036 - val_loss: 1.1945 - val_acc: 0.6104
Epoch 3/5
 - 5s - loss: 0.7086 - acc: 0.8480 - val_loss: 1.1725 - val_acc: 0.6104
Epoch 4/5
 - 5s - loss: 0.9412 - acc: 0.6904 - val_loss: 1.1543 - val_acc: 0.5974
Epoch 5/5
 - 5s - loss: 0.9716 - acc: 0.6524 - val_loss: 1.1402 - val_acc: 0.6104
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (4, 0, 6), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (4, 0, 6) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 6) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 6) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (4, 0, 6)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007810663342339422, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1329855592526113, 'num_dense_units_0': 151, 'cnn_learning_rate': 1.3671518696923568e-05, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 222}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.3896103756768363, 'info': {'histories': {'val_loss': [2.4338438603785133, 1.9228727910425756, 1.9262443548673158, 1.9617630847088703, 1.6998700600165826, 1.6234196579301512, 1.419311785078668, 1.3403412691958538, 1.298706615125978, 1.7544381928134274, 1.2375631765885786, 1.2141028751026501, 1.1944851627597561, 1.1725010020392281, 1.1542864945027735, 1.1401524775988097], 'acc': [0.17985611414309027, 0.38848921217077925, 0.43478261147226605, 0.4017094017094017, 0.5971223175954475, 0.5465838653700692, 0.7697841880990447, 0.7769784489981562, 0.7625899649352479, 0.7050359905194893, 0.5714285799435207, 0.8057554304170952, 0.7769784507133978, 0.8273381607995617, 0.7841727017498702, 0.7410072246901422], 'loss': [2.273850614218403, 1.844495007460066, 1.6369964565549577, 1.5605459799114456, 1.3615929034116456, 1.2436024120875768, 0.9315971492005767, 0.8492015209987009, 0.8285679126814972, 0.8662743752808879, 1.1432128037725175, 0.7086306158587229, 0.6837502820886296, 0.6131259057161619, 0.6525822654902507, 0.8016264957489727], 'val_acc': [0.09090909090909091, 0.2857142866818936, 0.31168831362352745, 0.3116883121721156, 0.3766233797197218, 0.40259740453261833, 0.5064935119121106, 0.5194805225768646, 0.49350649544170927, 0.4155844175196313, 0.6233766264729685, 0.6363636402340679, 0.6103896115507398, 0.6103896243231637, 0.5974026004989426, 0.6103896243231637]}, 'runtime': 85.35743355751038}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 6)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 7)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 7) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 5
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 7) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (5, 0, 0) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (4, 0, 7) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (4, 0, 7)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00665424056987208, 'height_shift_range': 0.267, 'batch_size': 35, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.05501722926251359, 'num_dense_units_0': 230, 'cnn_learning_rate': 2.279950941597938e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 99}, 'working_directory': '.', 'budget': 16.0}
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
2018-02-08 15:33:08.403591: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionV3
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/16
 - 6s - loss: 2.3465 - acc: 0.0786 - val_loss: 2.3639 - val_acc: 0.1250
Epoch 2/16
 - 4s - loss: 2.2713 - acc: 0.1214 - val_loss: 2.3953 - val_acc: 0.1094
Epoch 3/16
 - 4s - loss: 2.3093 - acc: 0.1286 - val_loss: 2.3623 - val_acc: 0.1250
Epoch 4/16
 - 4s - loss: 2.2814 - acc: 0.0836 - val_loss: 2.3455 - val_acc: 0.1562
Epoch 5/16
 - 4s - loss: 2.2643 - acc: 0.1710 - val_loss: 2.3603 - val_acc: 0.1562
Epoch 6/16
 - 4s - loss: 2.2627 - acc: 0.1346 - val_loss: 2.3408 - val_acc: 0.1562
Epoch 7/16
 - 4s - loss: 2.2212 - acc: 0.2316 - val_loss: 2.2929 - val_acc: 0.2031
Epoch 8/16
 - 4s - loss: 2.2056 - acc: 0.2535 - val_loss: 2.2754 - val_acc: 0.1875
Epoch 9/16
 - 4s - loss: 2.2295 - acc: 0.2143 - val_loss: 2.2869 - val_acc: 0.1719
Epoch 10/16
 - 4s - loss: 2.2127 - acc: 0.1957 - val_loss: 2.2544 - val_acc: 0.2031
Epoch 11/16
 - 4s - loss: 2.2044 - acc: 0.2210 - val_loss: 2.2535 - val_acc: 0.2500
Epoch 12/16
 - 4s - loss: 2.1731 - acc: 0.2143 - val_loss: 2.2249 - val_acc: 0.2344
Epoch 13/16
 - 4s - loss: 2.1703 - acc: 0.2530 - val_loss: 2.2350 - val_acc: 0.2188
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 14/16
 - 4s - loss: 2.1291 - acc: 0.3006 - val_loss: 2.2502 - val_acc: 0.2656
Epoch 15/16
 - 4s - loss: 2.1428 - acc: 0.2249 - val_loss: 2.2659 - val_acc: 0.2031
Epoch 16/16
 - 4s - loss: 2.1491 - acc: 0.3298 - val_loss: 2.2324 - val_acc: 0.2344
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (4, 0, 7), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (4, 0, 7) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 7) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 7) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (4, 0, 7)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00665424056987208, 'height_shift_range': 0.267, 'batch_size': 35, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'InceptionV3', 'rotation_range': 24, 'unfreeze_percentage': 0.05501722926251359, 'num_dense_units_0': 230, 'cnn_learning_rate': 2.279950941597938e-05, 'cnn_unlock_epoch': 21, 'num_dense_units_1': 99}, 'working_directory': '.', 'budget': 16.0}
result: {'loss': 0.765625, 'info': {'histories': {'val_loss': [2.3638532161712646, 2.395277976989746, 2.3623493909835815, 2.345533847808838, 2.360336184501648, 2.3408284187316895, 2.292940616607666, 2.2753623723983765, 2.2869324684143066, 2.254396438598633, 2.253482460975647, 2.224946618080139, 2.2349804639816284, 2.2502458095550537, 2.265899181365967, 2.2323505878448486], 'acc': [0.07857142994180322, 0.12280702100772607, 0.12857143068686128, 0.08661417492966014, 0.1811023685406512, 0.14173228598720444, 0.22834646373283207, 0.2519685095689428, 0.2142857201397419, 0.19685039915672436, 0.22047244364351737, 0.2142857201397419, 0.24409449569822297, 0.2992126034704719, 0.22834646643146755, 0.33070866458528625], 'loss': [2.3465009927749634, 2.2781798128496136, 2.3092989325523376, 2.2761965999453087, 2.257327903912762, 2.2600400823307787, 2.21990284957285, 2.202480276738565, 2.2295077443122864, 2.211615688218845, 2.206453041767511, 2.173050284385681, 2.1795472272737757, 2.130836441760927, 2.1419570652518685, 2.1495442183937614], 'val_acc': [0.125, 0.109375, 0.125, 0.15625, 0.15625, 0.15625, 0.203125, 0.1875, 0.171875, 0.203125, 0.25, 0.234375, 0.21875, 0.265625, 0.203125, 0.234375]}, 'runtime': 69.9828953742981}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 7)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (5, 0, 0)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (5, 0, 0) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:DISPATCHER: starting job (5, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 1) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (5, 0, 0) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (5, 0, 0)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.001817726137721805, 'height_shift_range': 0.267, 'batch_size': 27, 'num_dense_units_2': 19, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.25361788718705813, 'num_dense_units_0': 834, 'cnn_learning_rate': 0.0004465841422553361, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 127}, 'working_directory': '.', 'budget': 32.0}
2018-02-08 15:34:21.463655: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/13
 - 7s - loss: 2.3025 - acc: 0.1296 - val_loss: 2.3051 - val_acc: 0.2031
Epoch 2/13
 - 5s - loss: 2.3708 - acc: 0.1543 - val_loss: 2.2548 - val_acc: 0.1250
Epoch 3/13
 - 5s - loss: 2.2100 - acc: 0.2407 - val_loss: 2.3161 - val_acc: 0.1406
Epoch 4/13
 - 5s - loss: 2.2404 - acc: 0.1975 - val_loss: 2.1733 - val_acc: 0.1406
Epoch 5/13
 - 5s - loss: 2.2946 - acc: 0.1173 - val_loss: 2.2637 - val_acc: 0.1094
Epoch 6/13
 - 5s - loss: 2.2710 - acc: 0.1235 - val_loss: 2.2473 - val_acc: 0.0938
Epoch 7/13
 - 5s - loss: 2.2323 - acc: 0.1481 - val_loss: 2.2000 - val_acc: 0.2500
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/13
 - 5s - loss: 2.1611 - acc: 0.1914 - val_loss: 2.1098 - val_acc: 0.1562
Epoch 9/13
 - 5s - loss: 2.0981 - acc: 0.2346 - val_loss: 3.6187 - val_acc: 0.1719
Epoch 10/13
 - 5s - loss: 2.2122 - acc: 0.2160 - val_loss: 2.0732 - val_acc: 0.2812
Epoch 11/13
 - 5s - loss: 2.1134 - acc: 0.2407 - val_loss: 2.2152 - val_acc: 0.1250
Epoch 12/13
 - 5s - loss: 2.0890 - acc: 0.2222 - val_loss: 2.2255 - val_acc: 0.2500
Epoch 13/13
 - 5s - loss: 1.9992 - acc: 0.2778 - val_loss: 2.2737 - val_acc: 0.2656
{'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.001817726137721805, 'height_shift_range': 0.267, 'batch_size': 27, 'num_dense_units_2': 19, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.25361788718705813, 'num_dense_units_0': 834, 'cnn_learning_rate': 0.0004465841422553361, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 127}

 ****** InceptionResNetV2 unfrozen 10 top blocks, cut_off after layer 617 ******
Epoch 1/19
 - 8s - loss: 1.9728 - acc: 0.2469 - val_loss: 2.4030 - val_acc: 0.2500
Epoch 2/19
 - 6s - loss: 1.9547 - acc: 0.2469 - val_loss: 2.4764 - val_acc: 0.2812
Epoch 3/19
 - 6s - loss: 1.9161 - acc: 0.2901 - val_loss: 2.3143 - val_acc: 0.2969
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/19
 - 6s - loss: 1.8749 - acc: 0.3025 - val_loss: 2.2301 - val_acc: 0.3125
Epoch 5/19
 - 6s - loss: 1.8926 - acc: 0.3210 - val_loss: 2.3487 - val_acc: 0.2812
Epoch 6/19
 - 6s - loss: 1.8818 - acc: 0.3148 - val_loss: 2.2021 - val_acc: 0.2812
Epoch 7/19
 - 6s - loss: 1.8402 - acc: 0.2963 - val_loss: 2.1084 - val_acc: 0.3125
Epoch 8/19
 - 6s - loss: 1.8785 - acc: 0.2531 - val_loss: 2.1327 - val_acc: 0.2812
Epoch 9/19
 - 6s - loss: 1.8819 - acc: 0.2840 - val_loss: 2.1215 - val_acc: 0.2812
Epoch 10/19
 - 6s - loss: 1.8482 - acc: 0.2963 - val_loss: 1.9618 - val_acc: 0.2969
Epoch 11/19
 - 6s - loss: 1.8258 - acc: 0.2963 - val_loss: 2.1107 - val_acc: 0.2500
Epoch 12/19
 - 6s - loss: 1.8258 - acc: 0.2778 - val_loss: 1.9553 - val_acc: 0.2969
Epoch 13/19
 - 6s - loss: 1.8205 - acc: 0.3086 - val_loss: 2.0443 - val_acc: 0.2500
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 14/19
 - 6s - loss: 1.7977 - acc: 0.3148 - val_loss: 2.0712 - val_acc: 0.2812
Epoch 15/19
 - 6s - loss: 1.8046 - acc: 0.3025 - val_loss: 2.0667 - val_acc: 0.2812
Epoch 16/19
 - 6s - loss: 1.7961 - acc: 0.2963 - val_loss: 2.0456 - val_acc: 0.2969
Epoch 17/19
 - 6s - loss: 1.7752 - acc: 0.3148 - val_loss: 2.0550 - val_acc: 0.2656
Epoch 18/19
 - 6s - loss: 1.7648 - acc: 0.3025 - val_loss: 1.9237 - val_acc: 0.2969
Epoch 19/19
 - 6s - loss: 1.7627 - acc: 0.3148 - val_loss: 1.9390 - val_acc: 0.3125
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (5, 0, 0), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (5, 0, 0) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (5, 0, 0) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (5, 0, 0) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (5, 0, 0)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.001817726137721805, 'height_shift_range': 0.267, 'batch_size': 27, 'num_dense_units_2': 19, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.25361788718705813, 'num_dense_units_0': 834, 'cnn_learning_rate': 0.0004465841422553361, 'cnn_unlock_epoch': 13, 'num_dense_units_1': 127}, 'working_directory': '.', 'budget': 32.0}
result: {'loss': 0.6875, 'info': {'histories': {'val_loss': [2.3051021099090576, 2.2548224925994873, 2.316114068031311, 2.1732585430145264, 2.2637312412261963, 2.2473230361938477, 2.1999733448028564, 2.10981822013855, 3.61871600151062, 2.0732008814811707, 2.2152349948883057, 2.225491523742676, 2.273664355278015, 2.40297794342041, 2.47636878490448, 2.3143376111984253, 2.230134129524231, 2.34869647026062, 2.2020812034606934, 2.1084227561950684, 2.132700204849243, 2.1214981079101562, 1.9618151187896729, 2.1106584072113037, 1.9552759528160095, 2.044324278831482, 2.07117623090744, 2.066684603691101, 2.0455715656280518, 2.055008292198181, 1.9237319231033325, 1.938974380493164], 'acc': [0.12962963183720908, 0.1543209912876288, 0.2407407450179259, 0.19753086318572363, 0.11728395521640778, 0.12345679228504498, 0.14814814801017442, 0.19135802735884985, 0.2345679017404715, 0.21604938556750616, 0.24074074998497963, 0.22222222511967024, 0.2777777860562007, 0.24691358705361685, 0.24691358705361685, 0.29012346019347507, 0.3024691392978032, 0.32098766167958576, 0.31481481591860455, 0.29629629974563915, 0.2530864228804906, 0.2839506243666013, 0.29629630347092945, 0.2962963084379832, 0.2777777810891469, 0.3086419776082039, 0.31481482088565826, 0.3024691417813301, 0.29629629850387573, 0.31481483081976575, 0.3024691417813301, 0.31481481716036797], 'loss': [2.3025273084640503, 2.370829224586487, 2.2100099325180054, 2.240447163581848, 2.2946293354034424, 2.2710131406784058, 2.2322558959325156, 2.161119302113851, 2.0981165170669556, 2.2122018337249756, 2.1133938233057656, 2.0889734824498496, 1.9991939663887024, 1.9728416005770366, 1.9547435839970906, 1.9161235094070435, 1.8748563130696614, 1.8926486372947693, 1.881829599539439, 1.8402302265167236, 1.8785368204116821, 1.881946623325348, 1.8481969237327576, 1.8258394598960876, 1.8257750074068706, 1.8204514781634014, 1.7976723313331604, 1.8046023448308308, 1.7961178024609883, 1.7751972675323486, 1.7647996544837952, 1.7627048095067341], 'val_acc': [0.203125, 0.125, 0.140625, 0.140625, 0.109375, 0.09375, 0.25, 0.15625, 0.171875, 0.28125, 0.125, 0.25, 0.265625, 0.25, 0.28125, 0.296875, 0.3125, 0.28125, 0.28125, 0.3125, 0.28125, 0.28125, 0.296875, 0.25, 0.296875, 0.25, 0.28125, 0.28125, 0.296875, 0.265625, 0.296875, 0.3125]}, 'runtime': 202.2028453350067}}
exception: None

DEBUG:hpbandster:job_callback for (5, 0, 0)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 1)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 1) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 4) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (4, 0, 1) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (4, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.008134440548722746, 'height_shift_range': 0.267, 'batch_size': 28, 'num_dense_units_2': 297, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.13209987280665508, 'num_dense_units_0': 256, 'cnn_learning_rate': 0.0002459909810587713, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 128}, 'working_directory': '.', 'budget': 32.0}
2018-02-08 15:37:44.736464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/18
 - 7s - loss: 3.4364 - acc: 0.0896 - val_loss: 2.6909 - val_acc: 0.1094
Epoch 2/18
 - 5s - loss: 2.5658 - acc: 0.0736 - val_loss: 2.3237 - val_acc: 0.0625
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/18
 - 5s - loss: 2.2931 - acc: 0.1096 - val_loss: 2.4599 - val_acc: 0.1094
Epoch 4/18
 - 5s - loss: 2.3437 - acc: 0.1643 - val_loss: 2.3536 - val_acc: 0.1406
Epoch 5/18
 - 5s - loss: 2.3212 - acc: 0.1056 - val_loss: 2.3133 - val_acc: 0.0781
Epoch 6/18
 - 5s - loss: 2.2229 - acc: 0.2152 - val_loss: 2.1964 - val_acc: 0.1562
Epoch 7/18
 - 5s - loss: 2.2636 - acc: 0.2080 - val_loss: 2.0903 - val_acc: 0.2188
Epoch 8/18
 - 5s - loss: 2.2573 - acc: 0.1143 - val_loss: 2.3386 - val_acc: 0.1250
Epoch 9/18
 - 5s - loss: 2.2939 - acc: 0.1200 - val_loss: 2.2746 - val_acc: 0.1406
Epoch 10/18
 - 5s - loss: 2.1299 - acc: 0.2168 - val_loss: 2.1820 - val_acc: 0.2344
Epoch 11/18
 - 5s - loss: 2.0019 - acc: 0.2799 - val_loss: 1.8549 - val_acc: 0.2812
Epoch 12/18
 - 5s - loss: 1.8768 - acc: 0.2744 - val_loss: 2.2247 - val_acc: 0.1719
Epoch 13/18
 - 5s - loss: 1.9500 - acc: 0.3401 - val_loss: 2.5761 - val_acc: 0.1719
Epoch 14/18
 - 5s - loss: 1.8627 - acc: 0.3480 - val_loss: 2.0321 - val_acc: 0.3281
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 15/18
 - 5s - loss: 1.6890 - acc: 0.3786 - val_loss: 2.1711 - val_acc: 0.3438
Epoch 16/18
 - 5s - loss: 1.6177 - acc: 0.3669 - val_loss: 1.7623 - val_acc: 0.3750
Epoch 17/18
 - 5s - loss: 1.6561 - acc: 0.3624 - val_loss: 1.9200 - val_acc: 0.3438
Epoch 18/18
 - 5s - loss: 1.5162 - acc: 0.4500 - val_loss: 1.7749 - val_acc: 0.3594
{'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.008134440548722746, 'height_shift_range': 0.267, 'batch_size': 28, 'num_dense_units_2': 297, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.13209987280665508, 'num_dense_units_0': 256, 'cnn_learning_rate': 0.0002459909810587713, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 128}

 ****** InceptionResNetV2 unfrozen 5 top blocks, cut_off after layer 696 ******
Epoch 1/14
 - 7s - loss: 1.5432 - acc: 0.4039 - val_loss: 1.7663 - val_acc: 0.3438
Epoch 2/14
 - 5s - loss: 1.3603 - acc: 0.4745 - val_loss: 1.5363 - val_acc: 0.3906
Epoch 3/14
 - 5s - loss: 1.3430 - acc: 0.5281 - val_loss: 1.4905 - val_acc: 0.4375
Epoch 4/14
 - 5s - loss: 1.2477 - acc: 0.5143 - val_loss: 1.4623 - val_acc: 0.3906
Epoch 5/14
 - 5s - loss: 1.2849 - acc: 0.5088 - val_loss: 1.4328 - val_acc: 0.4062
Epoch 6/14
 - 5s - loss: 1.2650 - acc: 0.4807 - val_loss: 1.4367 - val_acc: 0.3906
Epoch 7/14
 - 5s - loss: 1.2869 - acc: 0.5000 - val_loss: 1.4675 - val_acc: 0.3594
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/14
 - 5s - loss: 1.2123 - acc: 0.5383 - val_loss: 1.3809 - val_acc: 0.3906
Epoch 9/14
 - 5s - loss: 1.2102 - acc: 0.5643 - val_loss: 1.4402 - val_acc: 0.4062
Epoch 10/14
 - 5s - loss: 1.1389 - acc: 0.5540 - val_loss: 1.3077 - val_acc: 0.4219
Epoch 11/14
 - 5s - loss: 1.2025 - acc: 0.5500 - val_loss: 1.4147 - val_acc: 0.4062
Epoch 12/14
 - 5s - loss: 1.1309 - acc: 0.5801 - val_loss: 1.3872 - val_acc: 0.4375
Epoch 13/14
 - 5s - loss: 1.1776 - acc: 0.5576 - val_loss: 1.2967 - val_acc: 0.4688
Epoch 14/14
 - 5s - loss: 1.1995 - acc: 0.5071 - val_loss: 1.3492 - val_acc: 0.4375
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (4, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (4, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (4, 0, 1)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.008134440548722746, 'height_shift_range': 0.267, 'batch_size': 28, 'num_dense_units_2': 297, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.13209987280665508, 'num_dense_units_0': 256, 'cnn_learning_rate': 0.0002459909810587713, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 128}, 'working_directory': '.', 'budget': 32.0}
result: {'loss': 0.5625, 'info': {'histories': {'val_loss': [2.6908657550811768, 2.323654890060425, 2.459948778152466, 2.3536230325698853, 2.313328742980957, 2.1964324712753296, 2.0902531147003174, 2.3385543823242188, 2.274568796157837, 2.1819939613342285, 1.8549453020095825, 2.2246817350387573, 2.5760657787323, 2.032130718231201, 2.171088457107544, 1.7622799277305603, 1.920037865638733, 1.7749327421188354, 1.7663050293922424, 1.5362508893013, 1.490544319152832, 1.4623138904571533, 1.43283611536026, 1.436674952507019, 1.4674965739250183, 1.380936086177826, 1.4401846528053284, 1.3076540231704712, 1.4147068858146667, 1.3871773481369019, 1.2966572046279907, 1.3491849899291992], 'acc': [0.08955224180844293, 0.0746268704533577, 0.11194030184354355, 0.16428572237491607, 0.10447761627720363, 0.21641791111497738, 0.20895522810629943, 0.11428572088479996, 0.11940298930032929, 0.21641791956638223, 0.2835820971140221, 0.27611941477256036, 0.3358208990808743, 0.35074627977698597, 0.3785714447498322, 0.36718751210719347, 0.3656716520216928, 0.450000011920929, 0.4104477774296234, 0.47014926796528833, 0.5223880579222494, 0.5142857253551483, 0.5074626954633799, 0.4850746499958323, 0.5000000186820528, 0.5447761514293614, 0.5642857372760772, 0.554687513038516, 0.5500000178813934, 0.5746268825744515, 0.559701513888231, 0.5071428894996644], 'loss': [3.4763184768050466, 2.5639354435365593, 2.2883293735447214, 2.3437084197998046, 2.3150004415369745, 2.223111504939065, 2.263372289600657, 2.2572929859161377, 2.2956103744791516, 2.126523466252569, 1.9998166205278083, 1.8699241075942765, 1.950543106491886, 1.8472665139098665, 1.6889856338500977, 1.6135361548513174, 1.6541143798116427, 1.51624276638031, 1.5366165815894284, 1.3719980182932383, 1.3570317581518372, 1.24771249294281, 1.2863801130607946, 1.258412007075637, 1.282251349136011, 1.2032084820875482, 1.2101789951324462, 1.1392976101487875, 1.2024547576904296, 1.1416811302526673, 1.1780617379430514, 1.1994808673858643], 'val_acc': [0.109375, 0.0625, 0.109375, 0.140625, 0.078125, 0.15625, 0.21875, 0.125, 0.140625, 0.234375, 0.28125, 0.171875, 0.171875, 0.328125, 0.34375, 0.375, 0.34375, 0.359375, 0.34375, 0.390625, 0.4375, 0.390625, 0.40625, 0.390625, 0.359375, 0.390625, 0.40625, 0.421875, 0.40625, 0.4375, 0.46875, 0.4375]}, 'runtime': 182.52365374565125}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 1)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 4)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 4) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 6) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (4, 0, 4) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (4, 0, 4)
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0016300434539378834, 'height_shift_range': 0.267, 'batch_size': 33, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.01619592738073965, 'num_dense_units_0': 145, 'cnn_learning_rate': 1.134874168789118e-05, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 294}, 'working_directory': '.', 'budget': 32.0}
2018-02-08 15:40:42.265415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/14
 - 6s - loss: 2.4559 - acc: 0.1705 - val_loss: 2.2766 - val_acc: 0.2500
Epoch 2/14
 - 5s - loss: 2.0950 - acc: 0.2630 - val_loss: 2.0048 - val_acc: 0.2656
Epoch 3/14
 - 5s - loss: 1.8678 - acc: 0.3561 - val_loss: 2.1899 - val_acc: 0.3281
Epoch 4/14
 - 4s - loss: 1.7909 - acc: 0.4463 - val_loss: 1.7868 - val_acc: 0.3438
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 5/14
 - 4s - loss: 1.5322 - acc: 0.4998 - val_loss: 2.3072 - val_acc: 0.2188
Epoch 6/14
 - 4s - loss: 1.5578 - acc: 0.4317 - val_loss: 1.8707 - val_acc: 0.3281
Epoch 7/14
 - 5s - loss: 1.3196 - acc: 0.6136 - val_loss: 1.6223 - val_acc: 0.3125
Epoch 8/14
 - 4s - loss: 0.9847 - acc: 0.7382 - val_loss: 1.6140 - val_acc: 0.4375
Epoch 9/14
 - 4s - loss: 1.4628 - acc: 0.4718 - val_loss: 1.6806 - val_acc: 0.4531
Epoch 10/14
 - 5s - loss: 0.9308 - acc: 0.6818 - val_loss: 1.3784 - val_acc: 0.4375
Epoch 11/14
 - 4s - loss: 1.0965 - acc: 0.5817 - val_loss: 1.4418 - val_acc: 0.4375
Epoch 12/14
 - 4s - loss: 0.8918 - acc: 0.7382 - val_loss: 1.2054 - val_acc: 0.5781
Epoch 13/14
 - 4s - loss: 0.8259 - acc: 0.7546 - val_loss: 2.0008 - val_acc: 0.2812
Epoch 14/14
 - 4s - loss: 1.1816 - acc: 0.5747 - val_loss: 1.2515 - val_acc: 0.5625
{'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0016300434539378834, 'height_shift_range': 0.267, 'batch_size': 33, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.01619592738073965, 'num_dense_units_0': 145, 'cnn_learning_rate': 1.134874168789118e-05, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 294}

 ****** Xception no layers unfrozen
Epoch 1/18
 - 5s - loss: 1.0221 - acc: 0.5982 - val_loss: 1.0583 - val_acc: 0.7031
Epoch 2/18
 - 5s - loss: 0.7305 - acc: 0.7652 - val_loss: 0.9856 - val_acc: 0.7031
Epoch 3/18
 - 4s - loss: 0.9421 - acc: 0.6926 - val_loss: 1.0953 - val_acc: 0.6562
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/18
 - 5s - loss: 0.6739 - acc: 0.7727 - val_loss: 1.2370 - val_acc: 0.5156
Epoch 5/18
 - 4s - loss: 0.6082 - acc: 0.7833 - val_loss: 0.8334 - val_acc: 0.7344
Epoch 6/18
 - 4s - loss: 0.6714 - acc: 0.7592 - val_loss: 1.1374 - val_acc: 0.6562
Epoch 7/18
 - 4s - loss: 0.8348 - acc: 0.7212 - val_loss: 1.0920 - val_acc: 0.6094
Epoch 8/18
 - 5s - loss: 0.4467 - acc: 0.8333 - val_loss: 1.5743 - val_acc: 0.4531
Epoch 9/18
 - 4s - loss: 0.6886 - acc: 0.7921 - val_loss: 0.9742 - val_acc: 0.7031
Epoch 10/18
 - 4s - loss: 0.4014 - acc: 0.8600 - val_loss: 1.0117 - val_acc: 0.6875
Epoch 11/18
 - 4s - loss: 0.6530 - acc: 0.7364 - val_loss: 0.8392 - val_acc: 0.7656
Epoch 12/18
 - 4s - loss: 0.4284 - acc: 0.8447 - val_loss: 1.0709 - val_acc: 0.6250
Epoch 13/18
 - 5s - loss: 0.5749 - acc: 0.7424 - val_loss: 1.1207 - val_acc: 0.7031
Epoch 14/18
 - 4s - loss: 0.7050 - acc: 0.7833 - val_loss: 1.1264 - val_acc: 0.6719
Epoch 15/18
 - 4s - loss: 0.6787 - acc: 0.8149 - val_loss: 0.8958 - val_acc: 0.7344
Epoch 16/18
 - 5s - loss: 0.4842 - acc: 0.8682 - val_loss: 1.0072 - val_acc: 0.6562
Epoch 17/18
 - 5s - loss: 0.3099 - acc: 0.9167 - val_loss: 0.6673 - val_acc: 0.7969
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 18/18
 - 4s - loss: 0.5256 - acc: 0.8043 - val_loss: 0.9377 - val_acc: 0.7344
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (4, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (4, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (4, 0, 4)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0016300434539378834, 'height_shift_range': 0.267, 'batch_size': 33, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.01619592738073965, 'num_dense_units_0': 145, 'cnn_learning_rate': 1.134874168789118e-05, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 294}, 'working_directory': '.', 'budget': 32.0}
result: {'loss': 0.265625, 'info': {'histories': {'val_loss': [2.2766071557998657, 2.0048261284828186, 2.1898531913757324, 1.7867547273635864, 2.307193398475647, 1.8707327842712402, 1.622261106967926, 1.6140158772468567, 1.6805716753005981, 1.3783603310585022, 1.441790521144867, 1.2054463624954224, 2.0007874369621277, 1.251502811908722, 1.0583170652389526, 0.9856416285037994, 1.095279037952423, 1.2370325922966003, 0.8333678841590881, 1.1374324560165405, 1.0920137166976929, 1.5743241906166077, 0.9741739928722382, 1.0116832256317139, 0.8392121195793152, 1.0709131360054016, 1.120686411857605, 1.1263564825057983, 0.8957635164260864, 1.0072320699691772, 0.6673154532909393, 0.9376856982707977], 'acc': [0.17054264420686766, 0.26356590140697567, 0.35606061667203903, 0.44961239501487377, 0.49612403678339584, 0.4341085407623025, 0.6136363595724106, 0.7364341491876647, 0.46825399356228964, 0.6818181872367859, 0.5813953523025956, 0.736434118692265, 0.7519380380940992, 0.5736434431963189, 0.59689924883288, 0.7651515305042267, 0.6904762131827218, 0.7727273106575012, 0.7829457632330961, 0.7596899437349897, 0.7209302436473758, 0.8333333134651184, 0.7906977076863133, 0.8604651301406151, 0.7364341214645741, 0.8449612689572711, 0.7424242347478867, 0.7829457632330961, 0.8139534994613292, 0.8682170440984327, 0.9166666865348816, 0.8062015882758207], 'loss': [2.4575660173283067, 2.0946966825529585, 1.8678222000598907, 1.7846325220063675, 1.5367900465810023, 1.5507315341816392, 1.3195976912975311, 0.9877777903579003, 1.4705431631633215, 0.9308360517024994, 1.0980902591417, 0.8961318246153898, 0.8286124966865362, 1.1884346590485684, 1.0266988208127577, 0.7305112928152084, 0.9443173082101912, 0.673947736620903, 0.6096556228260661, 0.670502585727115, 0.839767059614492, 0.446727454662323, 0.691133999547293, 0.4018017836781435, 0.6528291924055233, 0.4302558760310328, 0.5749297514557838, 0.7056110930997271, 0.6832032148228135, 0.482850733191468, 0.3098842538893223, 0.5197886339453763], 'val_acc': [0.25, 0.265625, 0.328125, 0.34375, 0.21875, 0.328125, 0.3125, 0.4375, 0.453125, 0.4375, 0.4375, 0.578125, 0.28125, 0.5625, 0.703125, 0.703125, 0.65625, 0.515625, 0.734375, 0.65625, 0.609375, 0.453125, 0.703125, 0.6875, 0.765625, 0.625, 0.703125, 0.671875, 0.734375, 0.65625, 0.796875, 0.734375]}, 'runtime': 150.79414868354797}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 4)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 6)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 6) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 5) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 6) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (4, 0, 6) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (4, 0, 6)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007810663342339422, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1329855592526113, 'num_dense_units_0': 151, 'cnn_learning_rate': 1.3671518696923568e-05, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 222}, 'working_directory': '.', 'budget': 32.0}
2018-02-08 15:43:13.134365: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/11
 - 6s - loss: 2.4683 - acc: 0.0887 - val_loss: 2.3564 - val_acc: 0.1688
Epoch 2/11
 - 5s - loss: 2.3300 - acc: 0.1710 - val_loss: 2.3548 - val_acc: 0.1169
Epoch 3/11
 - 5s - loss: 1.9554 - acc: 0.2787 - val_loss: 2.0798 - val_acc: 0.1818
Epoch 4/11
 - 5s - loss: 1.6625 - acc: 0.5004 - val_loss: 1.9562 - val_acc: 0.1688
Epoch 5/11
 - 5s - loss: 1.4424 - acc: 0.5629 - val_loss: 1.8515 - val_acc: 0.2857
Epoch 6/11
 - 5s - loss: 1.5927 - acc: 0.3737 - val_loss: 1.6639 - val_acc: 0.4156
Epoch 7/11
 - 5s - loss: 1.3528 - acc: 0.5528 - val_loss: 1.4974 - val_acc: 0.4416
Epoch 8/11
 - 5s - loss: 1.2297 - acc: 0.6081 - val_loss: 1.4944 - val_acc: 0.4675
Epoch 9/11
 - 5s - loss: 1.1656 - acc: 0.6390 - val_loss: 1.3098 - val_acc: 0.5195
Epoch 10/11
 - 5s - loss: 1.1063 - acc: 0.6334 - val_loss: 1.4082 - val_acc: 0.4935
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 11/11
 - 5s - loss: 1.1385 - acc: 0.5714 - val_loss: 1.2190 - val_acc: 0.6623
{'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007810663342339422, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1329855592526113, 'num_dense_units_0': 151, 'cnn_learning_rate': 1.3671518696923568e-05, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 222}

 ****** Xception unfrozen 1 top blocks, cut_off after layer 125 ******
Epoch 1/21
 - 6s - loss: 0.7717 - acc: 0.8607 - val_loss: 1.1751 - val_acc: 0.6753
Epoch 2/21
 - 5s - loss: 0.7222 - acc: 0.7826 - val_loss: 1.1269 - val_acc: 0.6753
Epoch 3/21
 - 5s - loss: 1.4746 - acc: 0.5723 - val_loss: 1.1044 - val_acc: 0.6753
Epoch 4/21
 - 5s - loss: 0.8785 - acc: 0.7411 - val_loss: 1.0678 - val_acc: 0.6753
Epoch 5/21
 - 5s - loss: 0.7944 - acc: 0.7888 - val_loss: 1.0046 - val_acc: 0.6883
Epoch 6/21
 - 5s - loss: 1.0749 - acc: 0.7094 - val_loss: 1.0138 - val_acc: 0.7143
Epoch 7/21
 - 5s - loss: 1.0799 - acc: 0.6904 - val_loss: 0.9954 - val_acc: 0.7143
Epoch 8/21
 - 5s - loss: 0.9012 - acc: 0.6777 - val_loss: 0.9704 - val_acc: 0.7273
Epoch 9/21
 - 5s - loss: 0.9014 - acc: 0.7031 - val_loss: 0.9557 - val_acc: 0.7273
Epoch 10/21
 - 5s - loss: 0.8959 - acc: 0.6651 - val_loss: 0.9421 - val_acc: 0.7143
Epoch 11/21
 - 5s - loss: 0.7462 - acc: 0.8199 - val_loss: 0.9270 - val_acc: 0.7143
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 12/21
 - 5s - loss: 0.8585 - acc: 0.6904 - val_loss: 0.9206 - val_acc: 0.7143
Epoch 13/21
 - 5s - loss: 0.9612 - acc: 0.6461 - val_loss: 0.9158 - val_acc: 0.7143
Epoch 14/21
 - 5s - loss: 1.0080 - acc: 0.5918 - val_loss: 0.9104 - val_acc: 0.7013
Epoch 15/21
 - 5s - loss: 0.7663 - acc: 0.7888 - val_loss: 0.9021 - val_acc: 0.7143
Epoch 16/21
 - 5s - loss: 1.0164 - acc: 0.7284 - val_loss: 0.8994 - val_acc: 0.7143
Epoch 17/21
 - 5s - loss: 0.9958 - acc: 0.6587 - val_loss: 0.9026 - val_acc: 0.7143
Epoch 18/21
 - 5s - loss: 0.8424 - acc: 0.7157 - val_loss: 0.8991 - val_acc: 0.7273
Epoch 19/21
 - 5s - loss: 1.0313 - acc: 0.6714 - val_loss: 0.8975 - val_acc: 0.7143
Epoch 20/21
 - 5s - loss: 0.7201 - acc: 0.7888 - val_loss: 0.8951 - val_acc: 0.7273
Epoch 21/21
 - 5s - loss: 0.9069 - acc: 0.8699 - val_loss: 0.8994 - val_acc: 0.7143
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (4, 0, 6), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (4, 0, 6) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 6) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 6) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (4, 0, 6)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007810663342339422, 'height_shift_range': 0.267, 'batch_size': 23, 'num_dense_layers': 2, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1329855592526113, 'num_dense_units_0': 151, 'cnn_learning_rate': 1.3671518696923568e-05, 'cnn_unlock_epoch': 11, 'num_dense_units_1': 222}, 'working_directory': '.', 'budget': 32.0}
result: {'loss': 0.28571427410299133, 'info': {'histories': {'val_loss': [2.3563962230434665, 2.354848168113015, 2.0797814486862776, 1.9561968902488807, 1.851457149951489, 1.6638940882373165, 1.4973568823430445, 1.4944258634146157, 1.3097866572342909, 1.4081595253634762, 1.2190095170751793, 1.1750535330215057, 1.1269229991095406, 1.1044379302433558, 1.0677566768287063, 1.0045517946218516, 1.0137872881703562, 0.9954441956111363, 0.9703965357371739, 0.9557029256572971, 0.9420673785271583, 0.927006839157699, 0.9205600038751379, 0.9157705833385517, 0.9104427362417246, 0.9020531967088774, 0.8993990080697196, 0.9025938007738683, 0.8991268331354315, 0.8975472728927414, 0.8950810385988904, 0.8994422315003036], 'acc': [0.10071942572006219, 0.19424461163312412, 0.3165467660204112, 0.568345311519911, 0.5035971321647973, 0.42446043647879317, 0.5527950312410083, 0.6906474850160612, 0.5899280616276555, 0.7194244861602783, 0.5714285756860461, 0.8417266367150725, 0.7826087304524013, 0.7521367602878146, 0.8417266448624701, 0.7888199090957642, 0.8057554304170952, 0.7841727017498702, 0.7697842061090813, 0.7985611678027421, 0.7553957006056532, 0.8198758108275277, 0.7841726918872312, 0.7338129916637064, 0.7777778032498482, 0.7888199090957642, 0.8273381689469591, 0.7482014577165782, 0.8129496831688092, 0.7625899730826453, 0.7888199176107135, 0.8290598698151417], 'loss': [2.4148001430703583, 2.1104857098284384, 1.971392917976105, 1.5551400647746574, 1.4052164125785553, 1.584937515876276, 1.3527959755488805, 1.0250085154883295, 1.1954984840729255, 0.9009279930334297, 1.1385265759059362, 0.6830301996615293, 0.7222203186580113, 0.862069542081947, 0.7269262933044982, 0.7944486481802804, 0.8166724220454264, 0.8032420702117811, 0.7640034877996651, 0.7449749287941473, 0.7429582446599178, 0.7461832889488765, 0.7398138963918892, 0.8629908758959324, 0.7112883472035074, 0.7662967784064156, 0.7461243863586041, 0.7709468684608131, 0.6847459536662205, 0.7587961623136946, 0.7200932332447597, 0.7223571172127357], 'val_acc': [0.16883116979877671, 0.11688311959241891, 0.18181818278578968, 0.16883116883116883, 0.28571428842358776, 0.4155844175196313, 0.4415584469770456, 0.4675324694676833, 0.519480520641649, 0.49350649892509757, 0.6623376739489568, 0.6753246784210205, 0.6753246799691931, 0.6753246764858047, 0.6753246784210205, 0.6883116921821197, 0.7142857173820595, 0.714285726671095, 0.7272727303690725, 0.7272727388840217, 0.7142857189302321, 0.7142857181561457, 0.7142857189302321, 0.7142857173820595, 0.7012987152322546, 0.7142857173820595, 0.714285726671095, 0.7142857173820595, 0.727272739658108, 0.7142857173820595, 0.7272727303690725, 0.7142857258970087]}, 'runtime': 162.50388979911804}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 6)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 5)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 5) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 5
DEBUG:hpbandster:HBMASTER: submitting job (5, 0, 1) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (4, 0, 5) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (4, 0, 5)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025552720420642577, 'height_shift_range': 0.267, 'batch_size': 25, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1237095677878801, 'num_dense_units_0': 337, 'cnn_learning_rate': 9.394238019451583e-05, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 488}, 'working_directory': '.', 'budget': 32.0}
2018-02-08 15:45:56.659236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/18
 - 7s - loss: 2.4472 - acc: 0.1467 - val_loss: 2.1814 - val_acc: 0.3117
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/18
 - 5s - loss: 1.9632 - acc: 0.3448 - val_loss: 2.0264 - val_acc: 0.2468
Epoch 3/18
 - 5s - loss: 1.6970 - acc: 0.4867 - val_loss: 1.7690 - val_acc: 0.4286
Epoch 4/18
 - 5s - loss: 1.4671 - acc: 0.5398 - val_loss: 1.7894 - val_acc: 0.2468
Epoch 5/18
 - 5s - loss: 1.3137 - acc: 0.6467 - val_loss: 1.6899 - val_acc: 0.3896
Epoch 6/18
 - 5s - loss: 1.2100 - acc: 0.6655 - val_loss: 1.4977 - val_acc: 0.4545
Epoch 7/18
 - 5s - loss: 1.1154 - acc: 0.6712 - val_loss: 1.2732 - val_acc: 0.5325
Epoch 8/18
 - 5s - loss: 0.9429 - acc: 0.6926 - val_loss: 1.1515 - val_acc: 0.6623
Epoch 9/18
 - 5s - loss: 1.0068 - acc: 0.7033 - val_loss: 1.1438 - val_acc: 0.5974
Epoch 10/18
 - 5s - loss: 0.7483 - acc: 0.8046 - val_loss: 1.0571 - val_acc: 0.7013
Epoch 11/18
 - 5s - loss: 0.7742 - acc: 0.7860 - val_loss: 0.9872 - val_acc: 0.6883
Epoch 12/18
 - 5s - loss: 0.8277 - acc: 0.8114 - val_loss: 0.8428 - val_acc: 0.7922
Epoch 13/18
 - 5s - loss: 0.6131 - acc: 0.8467 - val_loss: 0.7918 - val_acc: 0.8052
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 14/18
 - 5s - loss: 0.6688 - acc: 0.8390 - val_loss: 0.9101 - val_acc: 0.7013
Epoch 15/18
 - 5s - loss: 0.5272 - acc: 0.8867 - val_loss: 0.7044 - val_acc: 0.8182
Epoch 16/18
 - 5s - loss: 0.7527 - acc: 0.7706 - val_loss: 0.6952 - val_acc: 0.8312
Epoch 17/18
 - 5s - loss: 0.5626 - acc: 0.8592 - val_loss: 0.6763 - val_acc: 0.7532
Epoch 18/18
 - 5s - loss: 0.4074 - acc: 0.8727 - val_loss: 0.6928 - val_acc: 0.7792
{'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025552720420642577, 'height_shift_range': 0.267, 'batch_size': 25, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1237095677878801, 'num_dense_units_0': 337, 'cnn_learning_rate': 9.394238019451583e-05, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 488}

 ****** Xception unfrozen 1 top blocks, cut_off after layer 125 ******
Epoch 1/14
 - 6s - loss: 0.4170 - acc: 0.8733 - val_loss: 0.6905 - val_acc: 0.7662
Epoch 2/14
 - 5s - loss: 0.4723 - acc: 0.9127 - val_loss: 0.6872 - val_acc: 0.7662
Epoch 3/14
 - 5s - loss: 0.3603 - acc: 0.9465 - val_loss: 0.6833 - val_acc: 0.7403
Epoch 4/14
 - 5s - loss: 0.3795 - acc: 0.9200 - val_loss: 0.6787 - val_acc: 0.7532
Epoch 5/14
 - 5s - loss: 0.4278 - acc: 0.8936 - val_loss: 0.6759 - val_acc: 0.7532
Epoch 6/14
 - 5s - loss: 0.3228 - acc: 0.9595 - val_loss: 0.6728 - val_acc: 0.7532
Epoch 7/14
 - 5s - loss: 0.4037 - acc: 0.9324 - val_loss: 0.6727 - val_acc: 0.7532
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/14
 - 5s - loss: 0.3619 - acc: 0.9195 - val_loss: 0.6708 - val_acc: 0.7532
Epoch 9/14
 - 5s - loss: 0.4664 - acc: 0.8992 - val_loss: 0.6695 - val_acc: 0.7532
Epoch 10/14
 - 5s - loss: 0.3947 - acc: 0.8925 - val_loss: 0.6700 - val_acc: 0.7532
Epoch 11/14
 - 5s - loss: 0.4132 - acc: 0.8795 - val_loss: 0.6689 - val_acc: 0.7532
Epoch 12/14
 - 5s - loss: 0.3767 - acc: 0.9133 - val_loss: 0.6693 - val_acc: 0.7662
Epoch 13/14
 - 5s - loss: 0.3230 - acc: 0.9668 - val_loss: 0.6694 - val_acc: 0.7662
Epoch 14/14
 - 5s - loss: 0.3605 - acc: 0.9262 - val_loss: 0.6704 - val_acc: 0.7532
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (4, 0, 5), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (4, 0, 5) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 5) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (4, 0, 5)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025552720420642577, 'height_shift_range': 0.267, 'batch_size': 25, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1237095677878801, 'num_dense_units_0': 337, 'cnn_learning_rate': 9.394238019451583e-05, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 488}, 'working_directory': '.', 'budget': 32.0}
result: {'loss': 0.2467532328196934, 'info': {'histories': {'val_loss': [2.1813902204686944, 2.0263717809280792, 1.769034398066533, 1.7894262988846024, 1.6898500145255746, 1.4976776451259464, 1.2731512305024382, 1.1515008319507947, 1.1438344376427787, 1.05711178500931, 0.9871529518783867, 0.842836430320492, 0.7918494877877174, 0.9101325165141713, 0.7044411611247372, 0.6952245320592608, 0.6763495624839485, 0.6928208238118655, 0.6904778078004912, 0.6872279597567273, 0.6833270261814068, 0.678694308578194, 0.6759394678202543, 0.6728460076567414, 0.6727044466253999, 0.6707522466585234, 0.66948114587115, 0.66997682274162, 0.6688759218562733, 0.6693363994747014, 0.6694074156996491, 0.6704161786413813], 'acc': [0.1466666633884112, 0.34677417864722593, 0.48666665330529213, 0.5322580659581769, 0.6466666460037231, 0.6788320876386044, 0.6715328401892725, 0.7080291727163496, 0.6861313655428642, 0.7956204209884588, 0.7956204001050796, 0.802919694977085, 0.8466666539510092, 0.8394160379458518, 0.8866666356722513, 0.774193525314331, 0.8613138490349707, 0.8759123861354633, 0.88321166055916, 0.9124087395459196, 0.9489050986122911, 0.9199999868869781, 0.9051094607715189, 0.9562043669450022, 0.927007281867257, 0.9197080026577859, 0.897810202445427, 0.8905109284568007, 0.8832116601240896, 0.9133333166440328, 0.97080290970141, 0.9270072875231722], 'loss': [2.4471502701441445, 1.9443379736715747, 1.696987271308899, 1.4760232154400117, 1.3137113451957703, 1.1783498603932179, 1.1076041107630208, 0.9314330642240761, 1.020271997382171, 0.759837219749924, 0.7700655721399906, 0.8186155522826815, 0.6130966991186142, 0.6613748935017273, 0.52715103328228, 0.7380488630264036, 0.5617601895419351, 0.39873906534953707, 0.40051520871419977, 0.46898142482242444, 0.3528156985331626, 0.3795137405395508, 0.41458007541016073, 0.33039947071649733, 0.4116920110953115, 0.35682935436276625, 0.4781544926392771, 0.40447235411971155, 0.4035188183732276, 0.3767353594303131, 0.3195325902996272, 0.37620899189997764], 'val_acc': [0.31168831362352745, 0.2467532486884625, 0.4285714332159464, 0.2467532486884625, 0.38961039580308, 0.4545454599640586, 0.5324675371120502, 0.6623376662080939, 0.5974026012730289, 0.7012987028468739, 0.6883116914080335, 0.792207804593173, 0.805194817580186, 0.7012987059432191, 0.818181830567199, 0.831168843554212, 0.753246765632134, 0.7792207908320736, 0.7662337701041977, 0.7662337778450606, 0.7402597510969484, 0.7532467547949259, 0.7532467671803066, 0.753246765632134, 0.753246765632134, 0.7532467640839614, 0.7532467563430985, 0.7532467648580476, 0.7532467563430985, 0.7662337693301114, 0.766233778619147, 0.7532467671803066]}, 'runtime': 167.16009831428528}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 5)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (5, 0, 1)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (5, 0, 1) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 4) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (5, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (5, 0, 1) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (5, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00042410173759327153, 'height_shift_range': 0.267, 'batch_size': 32, 'num_dense_units_2': 166, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.0225853473275863, 'num_dense_units_0': 699, 'cnn_learning_rate': 6.61813807267213e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 101}, 'working_directory': '.', 'budget': 32.0}
2018-02-08 15:48:42.945333: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/20
 - 6s - loss: 2.5698 - acc: 0.0844 - val_loss: 2.2860 - val_acc: 0.1562
Epoch 2/20
 - 5s - loss: 2.1102 - acc: 0.2875 - val_loss: 2.0865 - val_acc: 0.3281
Epoch 3/20
 - 4s - loss: 1.8419 - acc: 0.3556 - val_loss: 2.2349 - val_acc: 0.1562
Epoch 4/20
 - 5s - loss: 1.7665 - acc: 0.3563 - val_loss: 2.0847 - val_acc: 0.2031
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 5/20
 - 5s - loss: 1.5484 - acc: 0.4935 - val_loss: 2.0581 - val_acc: 0.1875
Epoch 6/20
 - 5s - loss: 1.5570 - acc: 0.4805 - val_loss: 1.6723 - val_acc: 0.4375
Epoch 7/20
 - 5s - loss: 1.5734 - acc: 0.4868 - val_loss: 2.0391 - val_acc: 0.2656
Epoch 8/20
 - 5s - loss: 1.1637 - acc: 0.6688 - val_loss: 1.8761 - val_acc: 0.3125
Epoch 9/20
 - 4s - loss: 1.5300 - acc: 0.3781 - val_loss: 2.1900 - val_acc: 0.2031
Epoch 10/20
 - 5s - loss: 1.4587 - acc: 0.4562 - val_loss: 1.5776 - val_acc: 0.4219
Epoch 11/20
 - 5s - loss: 1.2824 - acc: 0.5257 - val_loss: 1.5158 - val_acc: 0.4375
Epoch 12/20
 - 5s - loss: 1.2866 - acc: 0.5262 - val_loss: 1.5122 - val_acc: 0.4531
Epoch 13/20
 - 5s - loss: 1.3934 - acc: 0.6036 - val_loss: 1.6605 - val_acc: 0.3906
Epoch 14/20
 - 5s - loss: 1.3076 - acc: 0.5841 - val_loss: 1.4466 - val_acc: 0.5000
Epoch 15/20
 - 5s - loss: 0.8911 - acc: 0.7812 - val_loss: 1.4755 - val_acc: 0.4375
Epoch 16/20
 - 5s - loss: 0.9413 - acc: 0.7012 - val_loss: 1.2922 - val_acc: 0.5312
Epoch 17/20
 - 5s - loss: 0.9639 - acc: 0.6750 - val_loss: 1.2521 - val_acc: 0.5312
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 18/20
 - 5s - loss: 0.7453 - acc: 0.7596 - val_loss: 1.0717 - val_acc: 0.6250
Epoch 19/20
 - 5s - loss: 0.8237 - acc: 0.7791 - val_loss: 1.2252 - val_acc: 0.5625
Epoch 20/20
 - 5s - loss: 0.8071 - acc: 0.7401 - val_loss: 1.1496 - val_acc: 0.6250
{'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00042410173759327153, 'height_shift_range': 0.267, 'batch_size': 32, 'num_dense_units_2': 166, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.0225853473275863, 'num_dense_units_0': 699, 'cnn_learning_rate': 6.61813807267213e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 101}

 ****** Xception no layers unfrozen
Epoch 1/12
 - 5s - loss: 0.8024 - acc: 0.7337 - val_loss: 1.2091 - val_acc: 0.5469
Epoch 2/12
 - 5s - loss: 0.9653 - acc: 0.5841 - val_loss: 1.1044 - val_acc: 0.6719
Epoch 3/12
 - 5s - loss: 0.7612 - acc: 0.7142 - val_loss: 1.1532 - val_acc: 0.5312
Epoch 4/12
 - 5s - loss: 0.6078 - acc: 0.8312 - val_loss: 1.1893 - val_acc: 0.5781
Epoch 5/12
 - 5s - loss: 0.5653 - acc: 0.8312 - val_loss: 1.0084 - val_acc: 0.6562
Epoch 6/12
 - 5s - loss: 0.5382 - acc: 0.8050 - val_loss: 0.8011 - val_acc: 0.7656
Epoch 7/12
 - 5s - loss: 0.6085 - acc: 0.8050 - val_loss: 1.0981 - val_acc: 0.6250
Epoch 8/12
 - 5s - loss: 0.8995 - acc: 0.6945 - val_loss: 1.1852 - val_acc: 0.5781
Epoch 9/12
 - 5s - loss: 0.6761 - acc: 0.7791 - val_loss: 0.9734 - val_acc: 0.6875
Epoch 10/12
 - 5s - loss: 0.7170 - acc: 0.6945 - val_loss: 0.9727 - val_acc: 0.6406
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 11/12
 - 5s - loss: 0.5488 - acc: 0.8438 - val_loss: 1.2333 - val_acc: 0.5469
Epoch 12/12
 - 5s - loss: 0.5210 - acc: 0.8310 - val_loss: 0.8951 - val_acc: 0.7031
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (5, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (5, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (5, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (5, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (5, 0, 1)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00042410173759327153, 'height_shift_range': 0.267, 'batch_size': 32, 'num_dense_units_2': 166, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.0225853473275863, 'num_dense_units_0': 699, 'cnn_learning_rate': 6.61813807267213e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 101}, 'working_directory': '.', 'budget': 32.0}
result: {'loss': 0.296875, 'info': {'histories': {'val_loss': [2.2859991788864136, 2.086487889289856, 2.2348885536193848, 2.0846951007843018, 2.058145046234131, 1.6723206043243408, 2.0391345024108887, 1.8761346936225891, 2.189992666244507, 1.5775993466377258, 1.5157599449157715, 1.5122488737106323, 1.6605097651481628, 1.446606457233429, 1.4755430221557617, 1.2922027111053467, 1.2520763874053955, 1.0717365741729736, 1.2252391576766968, 1.1495980024337769, 1.209141492843628, 1.1043953895568848, 1.15321683883667, 1.1893065571784973, 1.0084059238433838, 0.8010871708393097, 1.098090797662735, 1.1851885318756104, 0.9734029173851013, 0.9726557433605194, 1.233323097229004, 0.895143449306488], 'acc': [0.1, 0.2875, 0.29, 0.35625, 0.49230769230769234, 0.47692307692307695, 0.5769230769230769, 0.66875, 0.55, 0.45625, 0.6230769230769231, 0.43846153846153846, 0.7153846153846154, 0.6923076923076923, 0.78125, 0.7384615384615385, 0.8, 0.8076923076923077, 0.8307692307692308, 0.7846153846153846, 0.7769230769230769, 0.6923076923076923, 0.7538461538461538, 0.8, 0.83125, 0.8615384615384616, 0.8615384615384616, 0.823076923076923, 0.8307692307692308, 0.823076923076923, 0.84375, 0.8923076923076924], 'loss': [2.538941449385423, 2.1102015018463134, 1.8786518669128418, 1.7664528608322143, 1.4376375308403602, 1.4979566904214712, 1.3715165578402007, 1.1637264370918274, 1.2115456008911132, 1.4587237119674683, 1.0808465297405536, 1.4462118433072018, 1.0782582209660456, 1.090515870314378, 0.8910907745361328, 0.871004660312946, 0.7338851268474872, 0.7025194113071148, 0.6407251321352445, 0.7303185242872972, 0.7251213788986206, 0.8068668768956111, 0.6874297985663781, 0.6869106902525975, 0.5653478443622589, 0.4775515391276433, 0.46170840996962326, 0.6200080504784218, 0.5058398540203388, 0.5423667394197904, 0.5488035619258881, 0.4377715642635639], 'val_acc': [0.15625, 0.328125, 0.15625, 0.203125, 0.1875, 0.4375, 0.265625, 0.3125, 0.203125, 0.421875, 0.4375, 0.453125, 0.390625, 0.5, 0.4375, 0.53125, 0.53125, 0.625, 0.5625, 0.625, 0.546875, 0.671875, 0.53125, 0.578125, 0.65625, 0.765625, 0.625, 0.578125, 0.6875, 0.640625, 0.546875, 0.703125]}, 'runtime': 154.15403842926025}}
exception: None

DEBUG:hpbandster:job_callback for (5, 0, 1)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 4)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 4) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 4
DEBUG:hpbandster:HBMASTER: submitting job (4, 0, 5) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (4, 0, 4) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (4, 0, 4)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0016300434539378834, 'height_shift_range': 0.267, 'batch_size': 33, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.01619592738073965, 'num_dense_units_0': 145, 'cnn_learning_rate': 1.134874168789118e-05, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 294}, 'working_directory': '.', 'budget': 64.0}
2018-02-08 15:51:17.158741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/14
 - 6s - loss: 2.4937 - acc: 0.1066 - val_loss: 2.2531 - val_acc: 0.1562
Epoch 2/14
 - 4s - loss: 2.1830 - acc: 0.2039 - val_loss: 2.2455 - val_acc: 0.1719
Epoch 3/14
 - 4s - loss: 2.0114 - acc: 0.3540 - val_loss: 1.9630 - val_acc: 0.3438
Epoch 4/14
 - 4s - loss: 1.7336 - acc: 0.4394 - val_loss: 2.0994 - val_acc: 0.1875
Epoch 5/14
 - 4s - loss: 1.7187 - acc: 0.3744 - val_loss: 1.7893 - val_acc: 0.3906
Epoch 6/14
 - 4s - loss: 1.6491 - acc: 0.4259 - val_loss: 1.8078 - val_acc: 0.3594
Epoch 7/14
 - 4s - loss: 1.4169 - acc: 0.4848 - val_loss: 1.8330 - val_acc: 0.4062
Epoch 8/14
 - 4s - loss: 1.3801 - acc: 0.5547 - val_loss: 1.7225 - val_acc: 0.3750
Epoch 9/14
 - 4s - loss: 1.1061 - acc: 0.6210 - val_loss: 1.6540 - val_acc: 0.4062
Epoch 10/14
 - 4s - loss: 1.0255 - acc: 0.6667 - val_loss: 1.6673 - val_acc: 0.3594
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 11/14
 - 4s - loss: 1.0236 - acc: 0.6515 - val_loss: 2.3257 - val_acc: 0.1562
Epoch 12/14
 - 4s - loss: 1.0121 - acc: 0.6262 - val_loss: 1.5869 - val_acc: 0.4062
Epoch 13/14
 - 4s - loss: 1.0663 - acc: 0.6107 - val_loss: 1.2975 - val_acc: 0.5000
Epoch 14/14
 - 4s - loss: 0.8741 - acc: 0.6970 - val_loss: 1.7563 - val_acc: 0.3906
{'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0016300434539378834, 'height_shift_range': 0.267, 'batch_size': 33, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.01619592738073965, 'num_dense_units_0': 145, 'cnn_learning_rate': 1.134874168789118e-05, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 294}

 ****** Xception no layers unfrozen
Epoch 1/50
 - 5s - loss: 0.6756 - acc: 0.8167 - val_loss: 1.4842 - val_acc: 0.4844
Epoch 2/50
 - 4s - loss: 0.8238 - acc: 0.7540 - val_loss: 1.5038 - val_acc: 0.5156
Epoch 3/50
 - 4s - loss: 0.7770 - acc: 0.7492 - val_loss: 1.4069 - val_acc: 0.5000
Epoch 4/50
 - 4s - loss: 0.8084 - acc: 0.6894 - val_loss: 1.1703 - val_acc: 0.6250
Epoch 5/50
 - 4s - loss: 0.6424 - acc: 0.7878 - val_loss: 1.3867 - val_acc: 0.5000
Epoch 6/50
 - 4s - loss: 0.4767 - acc: 0.8561 - val_loss: 1.3683 - val_acc: 0.5156
Epoch 7/50
 - 4s - loss: 0.6196 - acc: 0.7979 - val_loss: 1.6346 - val_acc: 0.5000
Epoch 8/50
 - 4s - loss: 0.8613 - acc: 0.6737 - val_loss: 1.4540 - val_acc: 0.4844
Epoch 9/50
 - 4s - loss: 0.6708 - acc: 0.7084 - val_loss: 1.1390 - val_acc: 0.5312
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 10/50
 - 4s - loss: 0.5358 - acc: 0.8207 - val_loss: 1.0146 - val_acc: 0.6562
Epoch 11/50
 - 4s - loss: 0.4633 - acc: 0.8864 - val_loss: 0.9149 - val_acc: 0.7031
Epoch 12/50
 - 4s - loss: 0.4655 - acc: 0.8688 - val_loss: 1.6086 - val_acc: 0.4688
Epoch 13/50
 - 4s - loss: 0.6700 - acc: 0.7856 - val_loss: 1.0234 - val_acc: 0.6250
Epoch 14/50
 - 4s - loss: 0.5476 - acc: 0.8636 - val_loss: 1.2183 - val_acc: 0.5781
Epoch 15/50
 - 4s - loss: 0.5403 - acc: 0.8353 - val_loss: 0.9861 - val_acc: 0.6406
Epoch 16/50
 - 4s - loss: 0.3329 - acc: 0.9056 - val_loss: 1.7490 - val_acc: 0.4844
Epoch 17/50
 - 4s - loss: 0.6536 - acc: 0.7820 - val_loss: 0.8551 - val_acc: 0.7188
Epoch 18/50
 - 4s - loss: 0.6086 - acc: 0.8333 - val_loss: 0.9285 - val_acc: 0.7188
Epoch 19/50
 - 4s - loss: 0.2885 - acc: 0.9385 - val_loss: 1.2421 - val_acc: 0.6250
Epoch 20/50
 - 4s - loss: 0.5018 - acc: 0.8460 - val_loss: 0.7580 - val_acc: 0.7500
Epoch 21/50
 - 4s - loss: 0.4805 - acc: 0.8752 - val_loss: 1.0221 - val_acc: 0.7188
Epoch 22/50
 - 4s - loss: 0.5458 - acc: 0.8213 - val_loss: 0.9144 - val_acc: 0.7188
Epoch 23/50
 - 4s - loss: 0.2694 - acc: 0.8864 - val_loss: 1.4380 - val_acc: 0.5781
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 24/50
 - 4s - loss: 0.3464 - acc: 0.8694 - val_loss: 0.7524 - val_acc: 0.7500
Epoch 25/50
 - 4s - loss: 0.2142 - acc: 0.9227 - val_loss: 1.3782 - val_acc: 0.6406
Epoch 26/50
 - 4s - loss: 0.3947 - acc: 0.8752 - val_loss: 0.9089 - val_acc: 0.6719
Epoch 27/50
 - 4s - loss: 0.3671 - acc: 0.8333 - val_loss: 1.1224 - val_acc: 0.6562
Epoch 28/50
 - 4s - loss: 0.3826 - acc: 0.8986 - val_loss: 0.9245 - val_acc: 0.7344
Epoch 29/50
 - 4s - loss: 0.6998 - acc: 0.7674 - val_loss: 0.8568 - val_acc: 0.7344
Epoch 30/50
 - 4s - loss: 0.2224 - acc: 0.9157 - val_loss: 0.8431 - val_acc: 0.7031
Epoch 31/50
 - 4s - loss: 0.4354 - acc: 0.8485 - val_loss: 1.3265 - val_acc: 0.5938
Epoch 32/50
 - 4s - loss: 0.2142 - acc: 0.9370 - val_loss: 0.8105 - val_acc: 0.7344
Epoch 33/50
 - 4s - loss: 0.2864 - acc: 0.9221 - val_loss: 0.8108 - val_acc: 0.7656
Epoch 34/50
 - 4s - loss: 0.1414 - acc: 0.9621 - val_loss: 0.9459 - val_acc: 0.7031
Epoch 35/50
 - 4s - loss: 0.4100 - acc: 0.8612 - val_loss: 0.9432 - val_acc: 0.6719
Epoch 36/50
 - 4s - loss: 0.2739 - acc: 0.8910 - val_loss: 0.8316 - val_acc: 0.7031
Epoch 37/50
 - 4s - loss: 0.2402 - acc: 0.9227 - val_loss: 0.9337 - val_acc: 0.7188
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 38/50
 - 4s - loss: 0.2278 - acc: 0.9227 - val_loss: 0.8517 - val_acc: 0.7188
Epoch 39/50
 - 4s - loss: 0.2772 - acc: 0.8764 - val_loss: 1.2976 - val_acc: 0.5781
Epoch 40/50
 - 4s - loss: 0.5949 - acc: 0.8030 - val_loss: 0.8441 - val_acc: 0.7188
Epoch 41/50
 - 4s - loss: 0.1391 - acc: 0.9613 - val_loss: 1.1926 - val_acc: 0.6719
Epoch 42/50
 - 4s - loss: 0.2209 - acc: 0.9091 - val_loss: 1.2044 - val_acc: 0.7500
Epoch 43/50
 - 4s - loss: 0.2049 - acc: 0.9215 - val_loss: 1.2996 - val_acc: 0.6719
Epoch 44/50
 - 4s - loss: 0.1258 - acc: 0.9613 - val_loss: 1.2628 - val_acc: 0.6406
Epoch 45/50
 - 4s - loss: 0.2135 - acc: 0.9297 - val_loss: 1.0334 - val_acc: 0.7812
Epoch 46/50
 - 4s - loss: 0.2796 - acc: 0.9239 - val_loss: 1.1001 - val_acc: 0.6406
Epoch 47/50
 - 4s - loss: 0.1506 - acc: 0.9470 - val_loss: 0.9993 - val_acc: 0.7344
Epoch 48/50
 - 4s - loss: 0.2292 - acc: 0.9453 - val_loss: 0.8228 - val_acc: 0.7500
Epoch 49/50
 - 4s - loss: 0.1710 - acc: 0.9531 - val_loss: 1.0047 - val_acc: 0.7031
Epoch 50/50
 - 4s - loss: 0.2964 - acc: 0.9015 - val_loss: 1.3718 - val_acc: 0.6094
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (4, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (4, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (4, 0, 4)
args: ()
kwargs: {'config': {'activation': 'relu', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0016300434539378834, 'height_shift_range': 0.267, 'batch_size': 33, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.01619592738073965, 'num_dense_units_0': 145, 'cnn_learning_rate': 1.134874168789118e-05, 'cnn_unlock_epoch': 14, 'num_dense_units_1': 294}, 'working_directory': '.', 'budget': 64.0}
result: {'loss': 0.390625, 'info': {'histories': {'val_loss': [2.2531216144561768, 2.2454952001571655, 1.9630431532859802, 2.0993921756744385, 1.7893109321594238, 1.8078207969665527, 1.8329898715019226, 1.7225269079208374, 1.654035210609436, 1.6672662496566772, 2.325698137283325, 1.5869357585906982, 1.2975409626960754, 1.7563494443893433, 1.484179437160492, 1.503766417503357, 1.4068652391433716, 1.1702917218208313, 1.3866731524467468, 1.368293821811676, 1.634577453136444, 1.4539695382118225, 1.1389654874801636, 1.0146445035934448, 0.9149462282657623, 1.6085726618766785, 1.0234422087669373, 1.2183066010475159, 0.9860820174217224, 1.7489834427833557, 0.8550922870635986, 0.9285290837287903, 1.2421411573886871, 0.7580036222934723, 1.0220987796783447, 0.9143916368484497, 1.4379998445510864, 0.7524105608463287, 1.3781654238700867, 0.9089049100875854, 1.1223540008068085, 0.9245223104953766, 0.8567991852760315, 0.8431317210197449, 1.3264855742454529, 0.8105402588844299, 0.8107848763465881, 0.9458683729171753, 0.9431669116020203, 0.831635981798172, 0.9337405562400818, 0.851727306842804, 1.2975926399230957, 0.844098687171936, 1.192597508430481, 1.20435431599617, 1.2996474504470825, 1.262802004814148, 1.0334216952323914, 1.1000534892082214, 0.9992873668670654, 0.8227932453155518, 1.0046916902065277, 1.3718487620353699], 'acc': [0.1085271350173063, 0.2015504005343415, 0.34883722732233446, 0.43939395993947983, 0.3720930447412092, 0.42635659977447155, 0.4848484918475151, 0.5555555855944043, 0.620155040607896, 0.6666666716337204, 0.6515151560306549, 0.6279069906057313, 0.6111111541589102, 0.6969697177410126, 0.8139535133228746, 0.751937979875609, 0.7519380159156267, 0.6893939524888992, 0.7906976827355319, 0.8560605943202972, 0.7984496410502944, 0.6744186323742534, 0.7054263658301775, 0.8217054771822553, 0.8863636553287506, 0.8682170884553776, 0.785714308420817, 0.8636363744735718, 0.8372093245040538, 0.9069767746814462, 0.7829457660054051, 0.8333333432674408, 0.9379845247712246, 0.8449612966803617, 0.8759690218193587, 0.8217054771822553, 0.886363685131073, 0.8682170732076778, 0.9224806635878807, 0.8759690218193587, 0.8333333432674408, 0.8992248135943746, 0.7674418715543525, 0.9147287329962087, 0.8484848737716675, 0.9365079658372062, 0.9224806497263354, 0.9621212184429169, 0.860465127368306, 0.8914729121119477, 0.9224806635878807, 0.9224806330924811, 0.8759690190470496, 0.8030303120613098, 0.9612403470416402, 0.9090909361839294, 0.9224806358647901, 0.9612403470416402, 0.9302326094272525, 0.9224806330924811, 0.9469697177410126, 0.9444444662048703, 0.9534884164499682, 0.9015151709318161], 'loss': [2.4958173729652584, 2.1866872587869333, 2.017378707264745, 1.7335608899593353, 1.7231645417767902, 1.649083789004836, 1.416866809129715, 1.375796874364217, 1.106796690197878, 1.0254870504140854, 1.0236318707466125, 1.0054872742919034, 1.0638358805860793, 0.874053567647934, 0.6804372086081394, 0.8299633888311164, 0.775565505027771, 0.8083833605051041, 0.6375037916871005, 0.47666043043136597, 0.6185595420903938, 0.8632931196412374, 0.6762843949850216, 0.5349424474461134, 0.4633062332868576, 0.4657731194828832, 0.6747607595863796, 0.5476436242461205, 0.5353963991930318, 0.32959551658741265, 0.6490862154683401, 0.6085686311125755, 0.2890497203483138, 0.5034595152666402, 0.48020651382069257, 0.5437147714370905, 0.26938464120030403, 0.3479941092258276, 0.21486001340455788, 0.39200564040694125, 0.3671182468533516, 0.3792007128859675, 0.6958735169366349, 0.22362573340881703, 0.4354211054742336, 0.2140954268120584, 0.2858806668325912, 0.14144541695713997, 0.41180934115897777, 0.27133168938548063, 0.24171776237875917, 0.22809903185034908, 0.275592744696972, 0.5949437990784645, 0.13873490050088527, 0.2208665870130062, 0.20377758353255515, 0.12499730340963186, 0.21221990086311518, 0.2829973621423854, 0.1505527887493372, 0.2313115852219718, 0.1707605477855649, 0.29635162744671106], 'val_acc': [0.15625, 0.171875, 0.34375, 0.1875, 0.390625, 0.359375, 0.40625, 0.375, 0.40625, 0.359375, 0.15625, 0.40625, 0.5, 0.390625, 0.484375, 0.515625, 0.5, 0.625, 0.5, 0.515625, 0.5, 0.484375, 0.53125, 0.65625, 0.703125, 0.46875, 0.625, 0.578125, 0.640625, 0.484375, 0.71875, 0.71875, 0.625, 0.75, 0.71875, 0.71875, 0.578125, 0.75, 0.640625, 0.671875, 0.65625, 0.734375, 0.734375, 0.703125, 0.59375, 0.734375, 0.765625, 0.703125, 0.671875, 0.703125, 0.71875, 0.71875, 0.578125, 0.71875, 0.671875, 0.75, 0.671875, 0.640625, 0.78125, 0.640625, 0.734375, 0.75, 0.703125, 0.609375]}, 'runtime': 286.77670454978943}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 4)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (4, 0, 5)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (4, 0, 5) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (4, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 5
DEBUG:hpbandster:HBMASTER: submitting job (5, 0, 2) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (4, 0, 5) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (4, 0, 5)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025552720420642577, 'height_shift_range': 0.267, 'batch_size': 25, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1237095677878801, 'num_dense_units_0': 337, 'cnn_learning_rate': 9.394238019451583e-05, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 488}, 'working_directory': '.', 'budget': 64.0}
2018-02-08 15:56:04.596011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/18
 - 6s - loss: 2.2830 - acc: 0.1948 - val_loss: 2.4743 - val_acc: 0.0909
Epoch 2/18
 - 5s - loss: 1.8127 - acc: 0.3885 - val_loss: 1.9786 - val_acc: 0.2468
Epoch 3/18
 - 5s - loss: 1.5438 - acc: 0.5298 - val_loss: 2.0317 - val_acc: 0.1948
Epoch 4/18
 - 5s - loss: 1.3762 - acc: 0.6171 - val_loss: 1.8865 - val_acc: 0.2727
Epoch 5/18
 - 5s - loss: 1.1510 - acc: 0.6903 - val_loss: 1.6159 - val_acc: 0.4286
Epoch 6/18
 - 5s - loss: 1.1789 - acc: 0.6667 - val_loss: 1.5712 - val_acc: 0.4545
Epoch 7/18
 - 5s - loss: 1.1106 - acc: 0.6858 - val_loss: 1.5530 - val_acc: 0.4026
Epoch 8/18
 - 5s - loss: 0.8837 - acc: 0.7867 - val_loss: 1.3843 - val_acc: 0.5325
Epoch 9/18
 - 5s - loss: 0.8739 - acc: 0.7438 - val_loss: 1.2706 - val_acc: 0.5714
Epoch 10/18
 - 5s - loss: 0.7911 - acc: 0.7667 - val_loss: 1.2713 - val_acc: 0.5714
Epoch 11/18
 - 5s - loss: 0.6864 - acc: 0.8297 - val_loss: 1.1335 - val_acc: 0.5584
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 12/18
 - 5s - loss: 0.5476 - acc: 0.8800 - val_loss: 1.1912 - val_acc: 0.5714
Epoch 13/18
 - 5s - loss: 0.6063 - acc: 0.8407 - val_loss: 1.0530 - val_acc: 0.5844
Epoch 14/18
 - 5s - loss: 0.6545 - acc: 0.8052 - val_loss: 0.9780 - val_acc: 0.6753
Epoch 15/18
 - 5s - loss: 0.4716 - acc: 0.8654 - val_loss: 0.8918 - val_acc: 0.7013
Epoch 16/18
 - 5s - loss: 0.4655 - acc: 0.8795 - val_loss: 0.9426 - val_acc: 0.6623
Epoch 17/18
 - 5s - loss: 0.5902 - acc: 0.8200 - val_loss: 0.9007 - val_acc: 0.6753
Epoch 18/18
 - 5s - loss: 0.5125 - acc: 0.8649 - val_loss: 0.7248 - val_acc: 0.7403
{'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025552720420642577, 'height_shift_range': 0.267, 'batch_size': 25, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1237095677878801, 'num_dense_units_0': 337, 'cnn_learning_rate': 9.394238019451583e-05, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 488}

 ****** Xception unfrozen 1 top blocks, cut_off after layer 125 ******
Epoch 1/46
 - 6s - loss: 0.3549 - acc: 0.9003 - val_loss: 0.7124 - val_acc: 0.7532
Epoch 2/46
 - 5s - loss: 0.3975 - acc: 0.9336 - val_loss: 0.7041 - val_acc: 0.7532
Epoch 3/46
 - 5s - loss: 0.3850 - acc: 0.9000 - val_loss: 0.7807 - val_acc: 0.7532
Epoch 4/46
 - 5s - loss: 0.3678 - acc: 0.9203 - val_loss: 0.6916 - val_acc: 0.7662
Epoch 5/46
 - 5s - loss: 0.2955 - acc: 0.9667 - val_loss: 0.6867 - val_acc: 0.7662
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 6/46
 - 5s - loss: 0.3875 - acc: 0.9060 - val_loss: 0.6834 - val_acc: 0.7792
Epoch 7/46
 - 5s - loss: 0.3618 - acc: 0.9133 - val_loss: 0.6801 - val_acc: 0.7792
Epoch 8/46
 - 5s - loss: 0.3806 - acc: 0.9262 - val_loss: 0.6795 - val_acc: 0.7792
Epoch 9/46
 - 5s - loss: 0.3323 - acc: 0.9257 - val_loss: 0.6778 - val_acc: 0.7792
Epoch 10/46
 - 5s - loss: 0.4335 - acc: 0.8727 - val_loss: 0.6711 - val_acc: 0.8182
Epoch 11/46
 - 5s - loss: 0.3605 - acc: 0.9133 - val_loss: 0.6791 - val_acc: 0.7792
Epoch 12/46
 - 5s - loss: 0.2775 - acc: 0.9526 - val_loss: 0.6804 - val_acc: 0.7792
Epoch 13/46
 - 5s - loss: 0.3564 - acc: 0.9333 - val_loss: 0.6807 - val_acc: 0.7662
Epoch 14/46
 - 5s - loss: 0.3433 - acc: 0.9257 - val_loss: 0.6820 - val_acc: 0.7662
Epoch 15/46
 - 5s - loss: 0.3397 - acc: 0.9392 - val_loss: 0.6856 - val_acc: 0.7662
Epoch 16/46
 - 5s - loss: 0.4150 - acc: 0.8733 - val_loss: 0.6869 - val_acc: 0.7662
Epoch 17/46
 - 5s - loss: 0.2956 - acc: 0.9327 - val_loss: 0.6902 - val_acc: 0.7792
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 18/46
 - 5s - loss: 0.3244 - acc: 0.9400 - val_loss: 0.6916 - val_acc: 0.7922
Epoch 19/46
 - 5s - loss: 0.3799 - acc: 0.9060 - val_loss: 0.6944 - val_acc: 0.7922
Epoch 20/46
 - 5s - loss: 0.3863 - acc: 0.8992 - val_loss: 0.6971 - val_acc: 0.7922
Epoch 21/46
 - 5s - loss: 0.3420 - acc: 0.9268 - val_loss: 0.7011 - val_acc: 0.7792
Epoch 22/46
 - 5s - loss: 0.3202 - acc: 0.9398 - val_loss: 0.7043 - val_acc: 0.7792
Epoch 23/46
 - 5s - loss: 0.2828 - acc: 0.9600 - val_loss: 0.7081 - val_acc: 0.7662
Epoch 24/46
 - 5s - loss: 0.3616 - acc: 0.9190 - val_loss: 0.7110 - val_acc: 0.7662
Epoch 25/46
 - 5s - loss: 0.3440 - acc: 0.9200 - val_loss: 0.7130 - val_acc: 0.7662
Epoch 26/46
 - 5s - loss: 0.2905 - acc: 0.9114 - val_loss: 0.7155 - val_acc: 0.7662
Epoch 27/46
 - 5s - loss: 0.3109 - acc: 0.9533 - val_loss: 0.7167 - val_acc: 0.7662
Epoch 28/46
 - 5s - loss: 0.3686 - acc: 0.9127 - val_loss: 0.7193 - val_acc: 0.7662
Epoch 29/46
 - 5s - loss: 0.3599 - acc: 0.9257 - val_loss: 0.7208 - val_acc: 0.7532
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 30/46
 - 5s - loss: 0.3368 - acc: 0.9189 - val_loss: 0.7218 - val_acc: 0.7662
Epoch 31/46
 - 5s - loss: 0.3255 - acc: 0.9195 - val_loss: 0.7224 - val_acc: 0.7532
Epoch 32/46
 - 5s - loss: 0.4408 - acc: 0.8667 - val_loss: 0.7236 - val_acc: 0.7662
Epoch 33/46
 - 5s - loss: 0.3113 - acc: 0.9398 - val_loss: 0.7246 - val_acc: 0.7662
Epoch 34/46
 - 5s - loss: 0.3326 - acc: 0.9133 - val_loss: 0.7276 - val_acc: 0.7532
Epoch 35/46
 - 5s - loss: 0.3862 - acc: 0.9003 - val_loss: 0.7304 - val_acc: 0.7403
Epoch 36/46
 - 5s - loss: 0.3711 - acc: 0.9267 - val_loss: 0.7525 - val_acc: 0.7662
Epoch 37/46
 - 5s - loss: 0.3899 - acc: 0.9065 - val_loss: 0.7344 - val_acc: 0.7403
Epoch 38/46
 - 5s - loss: 0.3770 - acc: 0.9065 - val_loss: 0.7353 - val_acc: 0.7403
Epoch 39/46
 - 5s - loss: 0.3606 - acc: 0.9077 - val_loss: 0.7359 - val_acc: 0.7403
Epoch 40/46
 - 5s - loss: 0.3150 - acc: 0.9334 - val_loss: 0.7364 - val_acc: 0.7273
Epoch 41/46
 - 5s - loss: 0.3530 - acc: 0.9067 - val_loss: 0.7383 - val_acc: 0.7273
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 42/46
 - 5s - loss: 0.3390 - acc: 0.9195 - val_loss: 0.7382 - val_acc: 0.7273
Epoch 43/46
 - 5s - loss: 0.3240 - acc: 0.9459 - val_loss: 0.7400 - val_acc: 0.7273
Epoch 44/46
 - 5s - loss: 0.3132 - acc: 0.9459 - val_loss: 0.7399 - val_acc: 0.7273
Epoch 45/46
 - 5s - loss: 0.3896 - acc: 0.8722 - val_loss: 0.7395 - val_acc: 0.7273
Epoch 46/46
 - 5s - loss: 0.3340 - acc: 0.8857 - val_loss: 0.7406 - val_acc: 0.7273
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (4, 0, 5), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (4, 0, 5) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (4, 0, 5) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (4, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (4, 0, 5)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00025552720420642577, 'height_shift_range': 0.267, 'batch_size': 25, 'num_dense_layers': 2, 'optimizer': 'RMSProp', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.1237095677878801, 'num_dense_units_0': 337, 'cnn_learning_rate': 9.394238019451583e-05, 'cnn_unlock_epoch': 18, 'num_dense_units_1': 488}, 'working_directory': '.', 'budget': 64.0}
result: {'loss': 0.27272726808275494, 'info': {'histories': {'val_loss': [2.4743492138850223, 1.9786196993542957, 2.031675050785015, 1.886499516375653, 1.6159149516712537, 1.5711894716535295, 1.5530197357202504, 1.3843132559355202, 1.2705772782300975, 1.2712700893352558, 1.133538732280979, 1.1911811580905667, 1.0529516455415007, 0.9780180763888668, 0.8918017118008106, 0.9426442005417563, 0.9007282868608252, 0.7248061314805762, 0.7123999409861379, 0.7041411562399431, 0.780739832234073, 0.6916437698649122, 0.6867486590688879, 0.683394303569546, 0.6801211632691421, 0.6795318637575422, 0.6778267358804678, 0.6711047810393495, 0.6791159827987869, 0.680393842907695, 0.6807388105949799, 0.6820055045090713, 0.6855822894480321, 0.6868943200482951, 0.6901506495166134, 0.6916220079768788, 0.6944116384952099, 0.6970698701870905, 0.7010799545746345, 0.7043454716731976, 0.7081200124381425, 0.7110077591685505, 0.7130091484490927, 0.7154768682145453, 0.7167003201199816, 0.7192868334906442, 0.7207532563766876, 0.7218164956414854, 0.722381225654057, 0.7235802365587903, 0.7245863428363553, 0.7275731687421922, 0.7303674964161663, 0.7524985686525122, 0.7344133397201439, 0.7352501076537293, 0.7359072140284947, 0.7363938348633903, 0.7383292340613031, 0.7382170720533892, 0.7400166663256559, 0.7399481898778445, 0.7394776661674698, 0.740604213305882], 'acc': [0.1970802856078983, 0.37956202677349105, 0.5255474286140317, 0.613138680910542, 0.6788321026485332, 0.6666666517655054, 0.7007299096044832, 0.7866666316986084, 0.7499999879829345, 0.7666666656732559, 0.8145161141310969, 0.879999965429306, 0.8613138499051115, 0.8029196897562403, 0.8613138433790555, 0.8832116601240896, 0.8199999829133352, 0.854014574611274, 0.9124087347601452, 0.94160581940282, 0.8999999761581421, 0.9354838613540896, 0.9666666487852732, 0.9051094655572933, 0.9197080083137011, 0.9270072766464122, 0.9197079970018707, 0.8759123861354633, 0.9133333067099253, 0.951612883517819, 0.9333333075046539, 0.9197079970018707, 0.9343065449791234, 0.8733333150545756, 0.935483860873407, 0.9399999777475992, 0.9051094655572933, 0.897810191568667, 0.9343065562909537, 0.9416058355004248, 0.9599999785423279, 0.9193548199630552, 0.9199999769528707, 0.903225784820895, 0.9533333082993826, 0.9124087395459196, 0.9197080078786307, 0.9124087338900044, 0.9197080135345459, 0.8666666547457377, 0.9416058355004248, 0.9197080191904611, 0.9124087456369052, 0.926666647195816, 0.9124087452018348, 0.9124087452018348, 0.927007288393313, 0.9435483818092654, 0.9066666464010874, 0.9197080026577859, 0.9416058189677496, 0.9416058189677496, 0.8686131064909218, 0.8832116653449344], 'loss': [2.308792798188481, 1.8215817230461289, 1.5470523494873605, 1.3774061951324017, 1.1746964089191743, 1.1788938840230305, 1.0849866275369686, 0.8837339580059052, 0.8441794625213069, 0.7910776833693186, 0.712731112876246, 0.5476098110278448, 0.5917920059096204, 0.6451152280299333, 0.4741029619735523, 0.4503042643522694, 0.5901820063591003, 0.5303563586551777, 0.34771870914166864, 0.3793511643026867, 0.3850292315085729, 0.3382253519469692, 0.29552361617485684, 0.3831673157911231, 0.35212505005136896, 0.36591172936188915, 0.33599715794089935, 0.43128716554084834, 0.36050264288981754, 0.2797670623948497, 0.3563876375555992, 0.35581447194962607, 0.34316763205684886, 0.4150126526753108, 0.28819569981386584, 0.3244371861219406, 0.3754756990140372, 0.389347653536901, 0.33588772598844374, 0.3222712488287557, 0.2827730178833008, 0.3623238684188935, 0.3439659873644511, 0.30674896905979804, 0.31089592973391217, 0.36584048897680577, 0.36185255994761945, 0.3504666542484812, 0.32189718128120814, 0.440795694788297, 0.31140275832510345, 0.32249109892949573, 0.36738095405328014, 0.3710819333791733, 0.37425346987960983, 0.36956285690739205, 0.3336835854897534, 0.30372770370975616, 0.3530071477095286, 0.33395044842775723, 0.33605871104846036, 0.30963394252488213, 0.3806699523090446, 0.3385629612598976], 'val_acc': [0.09090909139289484, 0.2467532529459371, 0.19480519480519481, 0.27272727543657477, 0.4285714312807306, 0.4545454599640586, 0.4025974053067046, 0.5324675440788269, 0.5714285745249166, 0.5714285745249166, 0.5584415615379036, 0.5714285760730892, 0.5844155890601022, 0.6753246815173657, 0.7012987043950465, 0.6623376654340075, 0.675324687710056, 0.7402597510969484, 0.7532467563430985, 0.7532467563430985, 0.7532467563430985, 0.7662337778450606, 0.7662337778450606, 0.7792207900579874, 0.7792207908320736, 0.7792207908320736, 0.779220783865297, 0.8181818297931126, 0.7792207908320736, 0.7792207908320736, 0.7662337778450606, 0.766233778619147, 0.766233778619147, 0.7662337778450606, 0.77922079160616, 0.7922078038190866, 0.7922078030450004, 0.7922078038190866, 0.77922079160616, 0.7792207908320736, 0.7662337770709744, 0.766233770878284, 0.7662337770709744, 0.7662337693301114, 0.766233778619147, 0.7662337801673196, 0.7532467648580476, 0.766233778619147, 0.7532467648580476, 0.7662337693301114, 0.766233778619147, 0.753246765632134, 0.7402597433560855, 0.7662337778450606, 0.7402597541932936, 0.7402597433560855, 0.7402597433560855, 0.7272727303690725, 0.7272727303690725, 0.7272727412062806, 0.7272727303690725, 0.7272727381099354, 0.7272727303690725, 0.7272727319172451]}, 'runtime': 326.8711462020874}}
exception: None

DEBUG:hpbandster:job_callback for (4, 0, 5)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (5, 0, 2)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (5, 0, 2) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 5
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (5, 0, 3) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (5, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (5, 0, 2) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (5, 0, 2)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00016064634883598665, 'height_shift_range': 0.267, 'batch_size': 44, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.0801402706163908, 'num_dense_units_0': 455, 'cnn_learning_rate': 6.51402026530474e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 313}, 'working_directory': '.', 'budget': 32.0}
2018-02-08 16:01:31.246303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/27
 - 4s - loss: 2.4808 - acc: 0.0704 - val_loss: 2.8363 - val_acc: 0.0625
Epoch 2/27
 - 3s - loss: 2.5633 - acc: 0.0833 - val_loss: 2.5680 - val_acc: 0.0625
Epoch 3/27
 - 3s - loss: 2.5144 - acc: 0.0833 - val_loss: 2.5712 - val_acc: 0.0625
Epoch 4/27
 - 3s - loss: 2.5878 - acc: 0.0833 - val_loss: 2.6363 - val_acc: 0.0938
Epoch 5/27
 - 3s - loss: 2.5760 - acc: 0.1095 - val_loss: 2.4758 - val_acc: 0.1250
Epoch 6/27
 - 3s - loss: 2.4649 - acc: 0.0991 - val_loss: 2.6894 - val_acc: 0.0938
Epoch 7/27
 - 3s - loss: 2.4564 - acc: 0.0909 - val_loss: 2.6450 - val_acc: 0.0312
Epoch 8/27
 - 3s - loss: 2.4868 - acc: 0.1016 - val_loss: 2.6770 - val_acc: 0.0625
Epoch 9/27
 - 3s - loss: 2.4600 - acc: 0.0886 - val_loss: 2.7313 - val_acc: 0.0625
Epoch 10/27
 - 3s - loss: 2.4507 - acc: 0.1251 - val_loss: 2.4879 - val_acc: 0.1562
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 11/27
 - 3s - loss: 2.5565 - acc: 0.0530 - val_loss: 2.6191 - val_acc: 0.1250
Epoch 12/27
 - 3s - loss: 2.5074 - acc: 0.1381 - val_loss: 2.7288 - val_acc: 0.0312
Epoch 13/27
 - 3s - loss: 2.4808 - acc: 0.0911 - val_loss: 2.6830 - val_acc: 0.0625
Epoch 14/27
 - 3s - loss: 2.4932 - acc: 0.1136 - val_loss: 2.6667 - val_acc: 0.1562
Epoch 15/27
 - 3s - loss: 2.4819 - acc: 0.0860 - val_loss: 2.6954 - val_acc: 0.0938
Epoch 16/27
 - 3s - loss: 2.4682 - acc: 0.0755 - val_loss: 2.5739 - val_acc: 0.0938
Epoch 17/27
 - 3s - loss: 2.4592 - acc: 0.0677 - val_loss: 2.7605 - val_acc: 0.0625
Epoch 18/27
 - 3s - loss: 2.5203 - acc: 0.0833 - val_loss: 2.7492 - val_acc: 0.0000e+00
Epoch 19/27
 - 3s - loss: 2.4725 - acc: 0.0599 - val_loss: 2.6882 - val_acc: 0.0938
Epoch 20/27
 - 3s - loss: 2.4110 - acc: 0.1173 - val_loss: 2.4382 - val_acc: 0.0938
Epoch 21/27
 - 3s - loss: 2.4175 - acc: 0.1563 - val_loss: 2.5654 - val_acc: 0.0938
Epoch 22/27
 - 3s - loss: 2.4419 - acc: 0.1212 - val_loss: 2.6040 - val_acc: 0.1250
Epoch 23/27
 - 3s - loss: 2.3982 - acc: 0.1069 - val_loss: 2.7463 - val_acc: 0.0312
Epoch 24/27
 - 3s - loss: 2.4955 - acc: 0.0624 - val_loss: 2.5896 - val_acc: 0.1562
Epoch 25/27
 - 3s - loss: 2.3850 - acc: 0.0963 - val_loss: 2.6616 - val_acc: 0.1250
Epoch 26/27
 - 3s - loss: 2.4320 - acc: 0.0758 - val_loss: 2.6827 - val_acc: 0.0625
Epoch 27/27
 - 3s - loss: 2.3841 - acc: 0.1328 - val_loss: 2.4562 - val_acc: 0.1562
{'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00016064634883598665, 'height_shift_range': 0.267, 'batch_size': 44, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.0801402706163908, 'num_dense_units_0': 455, 'cnn_learning_rate': 6.51402026530474e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 313}

 ****** ResNet50 unfrozen 1 top blocks, cut_off after layer 160 ******
Epoch 1/5
 - 4s - loss: 2.4259 - acc: 0.1354 - val_loss: 2.6828 - val_acc: 0.1250
Epoch 2/5
 - 3s - loss: 2.4034 - acc: 0.1407 - val_loss: 2.6074 - val_acc: 0.1875
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/5
 - 3s - loss: 2.3641 - acc: 0.1354 - val_loss: 2.7160 - val_acc: 0.0938
Epoch 4/5
 - 3s - loss: 2.3847 - acc: 0.1591 - val_loss: 2.5593 - val_acc: 0.0938
Epoch 5/5
 - 3s - loss: 2.3347 - acc: 0.1406 - val_loss: 2.1319 - val_acc: 0.0000e+00
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (5, 0, 2), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (5, 0, 2) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (5, 0, 2) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (5, 0, 2) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (5, 0, 2)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00016064634883598665, 'height_shift_range': 0.267, 'batch_size': 44, 'num_dense_layers': 2, 'optimizer': 'SGD', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.0801402706163908, 'num_dense_units_0': 455, 'cnn_learning_rate': 6.51402026530474e-05, 'cnn_unlock_epoch': 27, 'num_dense_units_1': 313}, 'working_directory': '.', 'budget': 32.0}
result: {'loss': 1.0, 'info': {'histories': {'val_loss': [2.836265802383423, 2.5680017471313477, 2.5711753368377686, 2.63629412651062, 2.475768804550171, 2.689373016357422, 2.6450021266937256, 2.677039861679077, 2.7313072681427, 2.4879021644592285, 2.6191163063049316, 2.7287607192993164, 2.683032512664795, 2.6666994094848633, 2.695387363433838, 2.5738537311553955, 2.7604594230651855, 2.749229907989502, 2.6882476806640625, 2.438241720199585, 2.5653839111328125, 2.603973388671875, 2.7462658882141113, 2.5895638465881348, 2.66156268119812, 2.682689905166626, 2.456242561340332, 2.682830333709717, 2.607400894165039, 2.7159669399261475, 2.5593199729919434, 2.131901264190674], 'acc': [0.06779661370536029, 0.08474576561632803, 0.08474576561632803, 0.0833333358168602, 0.10169492131572659, 0.09322034554966425, 0.09090909361839294, 0.10169491980035426, 0.08474576599517111, 0.11864407436322358, 0.05303030461072922, 0.13559322816840672, 0.09322033936189393, 0.11363636950651805, 0.08474576675285728, 0.07627118909257953, 0.06779661256883104, 0.0833333358168602, 0.05932203604508254, 0.11016949783947508, 0.15254238045821755, 0.12121212234099706, 0.10169491828498194, 0.06779661218998796, 0.10169491569622088, 0.07575757801532745, 0.13559322867353082, 0.1355932251376621, 0.13559322741072058, 0.1355932251376621, 0.15909091383218765, 0.14406780241909672], 'loss': [2.484787177231352, 2.5673156350345936, 2.5105419158935547, 2.5877927939097085, 2.587700698335292, 2.4795799174551236, 2.4564267794291177, 2.4769963409941074, 2.4634763588339594, 2.4541221715636174, 2.556520382563273, 2.5122689150147517, 2.477673114356348, 2.493168036142985, 2.486480413857153, 2.4702264696864757, 2.4631036580619163, 2.5202908515930176, 2.468150429806467, 2.4206009476871815, 2.42309051449016, 2.441866397857666, 2.4030839184583246, 2.4838459289680093, 2.3849835153353416, 2.4320135911305747, 2.369650186118433, 2.4222667742583712, 2.4071142309803073, 2.3618923930798545, 2.38469131787618, 2.3281539133039573], 'val_acc': [0.0625, 0.0625, 0.0625, 0.09375, 0.125, 0.09375, 0.03125, 0.0625, 0.0625, 0.15625, 0.125, 0.03125, 0.0625, 0.15625, 0.09375, 0.09375, 0.0625, 0.0, 0.09375, 0.09375, 0.09375, 0.125, 0.03125, 0.15625, 0.125, 0.0625, 0.15625, 0.125, 0.1875, 0.09375, 0.09375, 0.0]}, 'runtime': 104.30509781837463}}
exception: None

DEBUG:hpbandster:job_callback for (5, 0, 2)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (5, 0, 3)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (5, 0, 3) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (5, 0, 3) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 5
DEBUG:hpbandster:HBMASTER: submitting job (5, 0, 4) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (5, 0, 3) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (5, 0, 3)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007002512731703047, 'height_shift_range': 0.267, 'batch_size': 16, 'num_dense_units_2': 134, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.262206320971868, 'num_dense_units_0': 469, 'cnn_learning_rate': 0.00034381861413947237, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 222}, 'working_directory': '.', 'budget': 32.0}
2018-02-08 16:03:14.803589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/20
 - 5s - loss: 2.5483 - acc: 0.0567 - val_loss: 2.4770 - val_acc: 0.0917
Epoch 2/20
 - 3s - loss: 2.3982 - acc: 0.0820 - val_loss: 2.4053 - val_acc: 0.0826
Epoch 3/20
 - 3s - loss: 2.4073 - acc: 0.1000 - val_loss: 2.4619 - val_acc: 0.0642
Epoch 4/20
 - 3s - loss: 2.3006 - acc: 0.2133 - val_loss: 2.4153 - val_acc: 0.0826
Epoch 5/20
 - 3s - loss: 2.3044 - acc: 0.1387 - val_loss: 2.2837 - val_acc: 0.0826
Epoch 6/20
 - 3s - loss: 2.2246 - acc: 0.1750 - val_loss: 2.3284 - val_acc: 0.1560
Epoch 7/20
 - 3s - loss: 2.3413 - acc: 0.1324 - val_loss: 2.2793 - val_acc: 0.1376
Epoch 8/20
 - 3s - loss: 2.2283 - acc: 0.1338 - val_loss: 2.3469 - val_acc: 0.1193
Epoch 9/20
 - 3s - loss: 2.1914 - acc: 0.2000 - val_loss: 2.2918 - val_acc: 0.1651
Epoch 10/20
 - 3s - loss: 2.2811 - acc: 0.1576 - val_loss: 2.2833 - val_acc: 0.1743
Epoch 11/20
 - 3s - loss: 2.1804 - acc: 0.2270 - val_loss: 2.2641 - val_acc: 0.1743
Epoch 12/20
 - 3s - loss: 2.1664 - acc: 0.2522 - val_loss: 2.2465 - val_acc: 0.1835
Epoch 13/20
 - 3s - loss: 2.1900 - acc: 0.2585 - val_loss: 2.2022 - val_acc: 0.2110
Epoch 14/20
 - 3s - loss: 2.1296 - acc: 0.2270 - val_loss: 2.2113 - val_acc: 0.2202
Epoch 15/20
 - 3s - loss: 2.0591 - acc: 0.2687 - val_loss: 2.1848 - val_acc: 0.1927
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 16/20
 - 3s - loss: 2.0937 - acc: 0.2548 - val_loss: 2.1836 - val_acc: 0.2202
Epoch 17/20
 - 3s - loss: 2.0438 - acc: 0.3125 - val_loss: 2.1178 - val_acc: 0.2385
Epoch 18/20
 - 3s - loss: 2.0779 - acc: 0.3550 - val_loss: 2.1626 - val_acc: 0.2569
Epoch 19/20
 - 3s - loss: 1.9729 - acc: 0.3720 - val_loss: 2.1370 - val_acc: 0.2752
Epoch 20/20
 - 3s - loss: 2.0664 - acc: 0.2774 - val_loss: 2.0973 - val_acc: 0.2936
{'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007002512731703047, 'height_shift_range': 0.267, 'batch_size': 16, 'num_dense_units_2': 134, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.262206320971868, 'num_dense_units_0': 469, 'cnn_learning_rate': 0.00034381861413947237, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 222}

 ****** MobileNet unfrozen 7 top blocks, cut_off after layer 60 ******
Epoch 1/12
 - 5s - loss: 1.9574 - acc: 0.3531 - val_loss: 2.0494 - val_acc: 0.3211
Epoch 2/12
 - 3s - loss: 1.8718 - acc: 0.4188 - val_loss: 1.9334 - val_acc: 0.3761
Epoch 3/12
 - 3s - loss: 1.8316 - acc: 0.4013 - val_loss: 1.8813 - val_acc: 0.3303
Epoch 4/12
 - 3s - loss: 1.5913 - acc: 0.5296 - val_loss: 1.8216 - val_acc: 0.3853
Epoch 5/12
 - 3s - loss: 1.4564 - acc: 0.6312 - val_loss: 1.7614 - val_acc: 0.3945
Epoch 6/12
 - 3s - loss: 1.4587 - acc: 0.6417 - val_loss: 1.6522 - val_acc: 0.4312
Epoch 7/12
 - 3s - loss: 1.2103 - acc: 0.6813 - val_loss: 1.6101 - val_acc: 0.4954
Epoch 8/12
 - 3s - loss: 1.1952 - acc: 0.6596 - val_loss: 1.5591 - val_acc: 0.4771
Epoch 9/12
 - 3s - loss: 1.1629 - acc: 0.7080 - val_loss: 1.5353 - val_acc: 0.4679
Epoch 10/12
 - 3s - loss: 0.9637 - acc: 0.8172 - val_loss: 1.4476 - val_acc: 0.4954
Epoch 11/12
 - 3s - loss: 1.0749 - acc: 0.6935 - val_loss: 1.3339 - val_acc: 0.5688
Epoch 12/12
 - 3s - loss: 1.0619 - acc: 0.7459 - val_loss: 1.3957 - val_acc: 0.4771
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (5, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (5, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (5, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (5, 0, 3) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (5, 0, 3)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007002512731703047, 'height_shift_range': 0.267, 'batch_size': 16, 'num_dense_units_2': 134, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.262206320971868, 'num_dense_units_0': 469, 'cnn_learning_rate': 0.00034381861413947237, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 222}, 'working_directory': '.', 'budget': 32.0}
result: {'loss': 0.5229357759886926, 'info': {'histories': {'val_loss': [2.476966280455983, 2.4053208215521016, 2.461900365461997, 2.415280484278268, 2.2837186056539553, 2.328445224586977, 2.2792768369027234, 2.3469307925723015, 2.291774552896482, 2.283252930422442, 2.2641257036716564, 2.246528179273693, 2.2021636962890625, 2.211328941747683, 2.1848362607693455, 2.1835708115078987, 2.1177708883897974, 2.1626249212737476, 2.1370200585881505, 2.097336340388027, 2.049365509540663, 1.9333634081236812, 1.8812780139643117, 1.821633303931, 1.76142358014343, 1.6522485138079441, 1.6101384830037389, 1.559148023981567, 1.535295875794297, 1.4475583581749452, 1.333907448917354, 1.3957299179987077], 'acc': [0.06164383561643835, 0.08904109589041095, 0.1, 0.1590909090909091, 0.1506849315068493, 0.175, 0.14383561643835616, 0.1590909090909091, 0.2, 0.17123287671232876, 0.2465753424657534, 0.273972602739726, 0.2808219178082192, 0.2465753424657534, 0.26875, 0.30303030303030304, 0.3125, 0.3424657534246575, 0.4041095890410959, 0.3013698630136986, 0.3835616438356164, 0.41875, 0.4772727272727273, 0.5753424657534246, 0.63125, 0.6212121212121212, 0.68125, 0.6301369863013698, 0.726027397260274, 0.8013698630136986, 0.7534246575342466, 0.7671232876712328], 'loss': [2.519629517646685, 2.4084279700501323, 2.407251238822937, 2.317124290899797, 2.312056201778046, 2.2246407747268675, 2.3198092016455245, 2.191862828803785, 2.191395568847656, 2.2439104890170163, 2.1608614072407764, 2.1458835993727594, 2.1609427537003607, 2.1115519510556573, 2.059067130088806, 2.036007552435904, 2.043831431865692, 2.079309388382794, 1.9468595622337028, 2.012762030510053, 1.9147892063611174, 1.871793556213379, 1.7289676846879902, 1.5677409204718185, 1.4563787579536438, 1.4370176250284368, 1.2102566480636596, 1.1846263686271563, 1.1507386932634327, 0.9844979243735744, 0.9808824748209078, 0.9748844643161722], 'val_acc': [0.0917431196078248, 0.08256880802298905, 0.06422018382800829, 0.08256880802298905, 0.08256880733944955, 0.1559633034358331, 0.13761467924085233, 0.11926605572941107, 0.1651376153624386, 0.1743119285194152, 0.1743119285194152, 0.18348623887387985, 0.21100917622583723, 0.22018348692207163, 0.1926605518257946, 0.22018348692207163, 0.23853211391956433, 0.25688073531203315, 0.27522935916524416, 0.29357798301845517, 0.3211009187982717, 0.3761467903579047, 0.3302752307248772, 0.3853211041984208, 0.3944954161250263, 0.43119266191753775, 0.49541284731768687, 0.47706422100373364, 0.4678899180998496, 0.49541284731768687, 0.5688073402697887, 0.47706422401130744]}, 'runtime': 114.16252994537354}}
exception: None

DEBUG:hpbandster:job_callback for (5, 0, 3)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (5, 0, 4)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (5, 0, 4) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 5
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: submitting job (5, 0, 5) to dispatcher
DEBUG:hpbandster:DISPATCHER: starting job (5, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: job (5, 0, 4) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (5, 0, 4)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000521720636708256, 'height_shift_range': 0.267, 'batch_size': 27, 'num_dense_units_2': 35, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.09807266515169462, 'num_dense_units_0': 623, 'cnn_learning_rate': 0.0004423776057438744, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 353}, 'working_directory': '.', 'budget': 32.0}
2018-02-08 16:05:14.581595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/29
 - 7s - loss: 2.4329 - acc: 0.1049 - val_loss: 2.4208 - val_acc: 0.0625
Epoch 2/29
 - 5s - loss: 2.4175 - acc: 0.1358 - val_loss: 2.4368 - val_acc: 0.0938
Epoch 3/29
 - 5s - loss: 2.3521 - acc: 0.1605 - val_loss: 2.3900 - val_acc: 0.0938
Epoch 4/29
 - 5s - loss: 2.3718 - acc: 0.0988 - val_loss: 2.4022 - val_acc: 0.0938
Epoch 5/29
 - 5s - loss: 2.3751 - acc: 0.0926 - val_loss: 2.4468 - val_acc: 0.1250
Epoch 6/29
 - 6s - loss: 2.3389 - acc: 0.1173 - val_loss: 2.4319 - val_acc: 0.0938
Epoch 7/29
 - 5s - loss: 2.2982 - acc: 0.1543 - val_loss: 2.3734 - val_acc: 0.1250
Epoch 8/29
 - 6s - loss: 2.3171 - acc: 0.0988 - val_loss: 2.3766 - val_acc: 0.1406
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 9/29
 - 5s - loss: 2.3269 - acc: 0.0988 - val_loss: 2.3763 - val_acc: 0.1562
Epoch 10/29
 - 6s - loss: 2.2959 - acc: 0.1605 - val_loss: 2.3417 - val_acc: 0.1719
Epoch 11/29
 - 5s - loss: 2.3078 - acc: 0.0988 - val_loss: 2.3557 - val_acc: 0.1719
Epoch 12/29
 - 6s - loss: 2.2600 - acc: 0.1605 - val_loss: 2.3256 - val_acc: 0.1719
Epoch 13/29
 - 6s - loss: 2.2280 - acc: 0.1667 - val_loss: 2.3073 - val_acc: 0.2344
Epoch 14/29
 - 6s - loss: 2.2820 - acc: 0.1235 - val_loss: 2.2856 - val_acc: 0.2500
Epoch 15/29
 - 6s - loss: 2.2766 - acc: 0.1975 - val_loss: 2.2683 - val_acc: 0.2188
Epoch 16/29
 - 6s - loss: 2.2383 - acc: 0.2099 - val_loss: 2.2853 - val_acc: 0.1875
Epoch 17/29
 - 6s - loss: 2.2601 - acc: 0.1728 - val_loss: 2.3039 - val_acc: 0.1094
Epoch 18/29
 - 6s - loss: 2.2468 - acc: 0.1543 - val_loss: 2.3280 - val_acc: 0.1250
Epoch 19/29
 - 6s - loss: 2.2322 - acc: 0.1852 - val_loss: 2.2711 - val_acc: 0.1250
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 20/29
 - 6s - loss: 2.2131 - acc: 0.1667 - val_loss: 2.2564 - val_acc: 0.1406
Epoch 21/29
 - 6s - loss: 2.2226 - acc: 0.1975 - val_loss: 2.2562 - val_acc: 0.1719
Epoch 22/29
 - 6s - loss: 2.2473 - acc: 0.2160 - val_loss: 2.2668 - val_acc: 0.1719
Epoch 23/29
 - 6s - loss: 2.2503 - acc: 0.1358 - val_loss: 2.2545 - val_acc: 0.1562
Epoch 24/29
 - 6s - loss: 2.1900 - acc: 0.2099 - val_loss: 2.2775 - val_acc: 0.1719
Epoch 25/29
 - 6s - loss: 2.2290 - acc: 0.1975 - val_loss: 2.2387 - val_acc: 0.1562
Epoch 26/29
 - 6s - loss: 2.2036 - acc: 0.2099 - val_loss: 2.2393 - val_acc: 0.1562
Epoch 27/29
 - 6s - loss: 2.2079 - acc: 0.2160 - val_loss: 2.2354 - val_acc: 0.1875
Epoch 28/29
 - 6s - loss: 2.1840 - acc: 0.2222 - val_loss: 2.2361 - val_acc: 0.1562
Epoch 29/29
 - 5s - loss: 2.1715 - acc: 0.2160 - val_loss: 2.2241 - val_acc: 0.1406
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
{'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000521720636708256, 'height_shift_range': 0.267, 'batch_size': 27, 'num_dense_units_2': 35, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.09807266515169462, 'num_dense_units_0': 623, 'cnn_learning_rate': 0.0004423776057438744, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 353}

 ****** InceptionResNetV2 unfrozen 4 top blocks, cut_off after layer 712 ******
Epoch 1/3
 - 8s - loss: 2.1594 - acc: 0.2531 - val_loss: 2.2220 - val_acc: 0.1562
Epoch 2/3
 - 6s - loss: 2.1495 - acc: 0.3025 - val_loss: 2.1902 - val_acc: 0.2188
Epoch 3/3
 - 6s - loss: 2.1188 - acc: 0.3025 - val_loss: 2.1236 - val_acc: 0.3125
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (5, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (5, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (5, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (5, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (5, 0, 4)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000521720636708256, 'height_shift_range': 0.267, 'batch_size': 27, 'num_dense_units_2': 35, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.09807266515169462, 'num_dense_units_0': 623, 'cnn_learning_rate': 0.0004423776057438744, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 353}, 'working_directory': '.', 'budget': 32.0}
result: {'loss': 0.6875, 'info': {'histories': {'val_loss': [2.420759677886963, 2.436761736869812, 2.3899964094161987, 2.40217924118042, 2.4467551708221436, 2.431894302368164, 2.373449683189392, 2.376577854156494, 2.3762669563293457, 2.3417121171951294, 2.3557485342025757, 2.325581669807434, 2.3072562217712402, 2.2855576276779175, 2.268322229385376, 2.285276174545288, 2.30385959148407, 2.3280457258224487, 2.271078944206238, 2.2564446926116943, 2.256220579147339, 2.266827702522278, 2.2544983625411987, 2.2775301933288574, 2.2387356758117676, 2.2392916679382324, 2.2354480028152466, 2.2360700368881226, 2.2240899801254272, 2.2219719886779785, 2.1902230978012085, 2.123565196990967], 'acc': [0.10493827238678932, 0.13580247635642687, 0.16049383083979288, 0.09876543283462524, 0.09259259328246117, 0.1172839527328809, 0.1543209912876288, 0.09876543407638867, 0.09876543283462524, 0.16049383208155632, 0.09876543283462524, 0.16049383083979288, 0.16666666915019354, 0.12345679104328156, 0.19753086815277734, 0.2098765435318152, 0.17283950746059418, 0.15432098880410194, 0.18518519649902979, 0.16666666915019354, 0.19753087063630423, 0.21604938680926958, 0.13580247138937315, 0.20987654601534209, 0.19753086691101393, 0.20987654974063238, 0.21604938929279646, 0.22222223257025084, 0.21604938680926958, 0.2530864303310712, 0.3024691368142764, 0.3024691467483838], 'loss': [2.432916283607483, 2.417531132698059, 2.352062741915385, 2.3717974026997886, 2.3751214345296225, 2.338923613230387, 2.298178752263387, 2.3171091874440513, 2.3269087870915732, 2.295927087465922, 2.307823419570923, 2.2599805990854898, 2.228010614713033, 2.2820005416870117, 2.2765605449676514, 2.238339424133301, 2.260062257448832, 2.2467597325642905, 2.232152223587036, 2.213140368461609, 2.2225910822550454, 2.247274080912272, 2.250289559364319, 2.1899699767430625, 2.229037125905355, 2.2036307652791343, 2.207879066467285, 2.183996597925822, 2.1715348958969116, 2.159428079922994, 2.149511218070984, 2.1188196539878845], 'val_acc': [0.0625, 0.09375, 0.09375, 0.09375, 0.125, 0.09375, 0.125, 0.140625, 0.15625, 0.171875, 0.171875, 0.171875, 0.234375, 0.25, 0.21875, 0.1875, 0.109375, 0.125, 0.125, 0.140625, 0.171875, 0.171875, 0.15625, 0.171875, 0.15625, 0.15625, 0.1875, 0.15625, 0.140625, 0.15625, 0.21875, 0.3125]}, 'runtime': 193.80294108390808}}
exception: None

DEBUG:hpbandster:job_callback for (5, 0, 4)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (5, 0, 5)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (5, 0, 5) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (5, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (5, 0, 5) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (5, 0, 5)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0022505080736426025, 'height_shift_range': 0.267, 'batch_size': 27, 'num_dense_units_2': 42, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.11772790920544693, 'num_dense_units_0': 313, 'cnn_learning_rate': 1.6223331693445134e-05, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 298}, 'working_directory': '.', 'budget': 32.0}
2018-02-08 16:08:45.870817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model ResNet50
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/24
 - 61s - loss: 2.9038 - acc: 0.0864 - val_loss: 2.4066 - val_acc: 0.1250
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/24
 - 35s - loss: 2.3409 - acc: 0.1605 - val_loss: 2.5662 - val_acc: 0.1406
Epoch 3/24
 - 36s - loss: 2.2656 - acc: 0.2037 - val_loss: 2.5127 - val_acc: 0.0625
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/24
 - 37s - loss: 2.1411 - acc: 0.2160 - val_loss: 2.8682 - val_acc: 0.0938
Epoch 5/24
 - 35s - loss: 2.0692 - acc: 0.2654 - val_loss: 3.1475 - val_acc: 0.0781
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 6/24
 - 35s - loss: 1.4483 - acc: 0.5000 - val_loss: 2.9844 - val_acc: 0.0781
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 7/24
 - 35s - loss: 2.0586 - acc: 0.3025 - val_loss: 2.9233 - val_acc: 0.0781
Epoch 8/24
 - 34s - loss: 1.8639 - acc: 0.3272 - val_loss: 3.0398 - val_acc: 0.0625
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 9/24
 - 35s - loss: 1.5923 - acc: 0.5062 - val_loss: 3.1070 - val_acc: 0.1406
Epoch 10/24
 - 34s - loss: 1.3048 - acc: 0.5432 - val_loss: 3.2384 - val_acc: 0.0938
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 11/24
 - 37s - loss: 1.2055 - acc: 0.5617 - val_loss: 2.7519 - val_acc: 0.0469
Epoch 12/24
 - 33s - loss: 1.1274 - acc: 0.5864 - val_loss: 3.0536 - val_acc: 0.0938
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 13/24
 - 36s - loss: 0.9036 - acc: 0.7037 - val_loss: 3.1467 - val_acc: 0.0625
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 14/24
 - 35s - loss: 0.9369 - acc: 0.6728 - val_loss: 3.2113 - val_acc: 0.0781
Epoch 15/24
 - 36s - loss: 1.1253 - acc: 0.6667 - val_loss: 3.1856 - val_acc: 0.1094
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 16/24
 - 35s - loss: 0.7957 - acc: 0.7346 - val_loss: 3.8555 - val_acc: 0.1250
Epoch 17/24
 - 36s - loss: 0.9081 - acc: 0.6914 - val_loss: 3.5774 - val_acc: 0.1094
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 18/24
 - 35s - loss: 0.7047 - acc: 0.7531 - val_loss: 3.9764 - val_acc: 0.1094
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 19/24
 - 35s - loss: 0.7302 - acc: 0.7531 - val_loss: 3.2024 - val_acc: 0.1094
Epoch 20/24
 - 34s - loss: 0.8619 - acc: 0.7284 - val_loss: 3.2612 - val_acc: 0.1094
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 21/24
 - 35s - loss: 0.5040 - acc: 0.8519 - val_loss: 3.8597 - val_acc: 0.0938
Epoch 22/24
 - 35s - loss: 0.4660 - acc: 0.8519 - val_loss: 4.0577 - val_acc: 0.0781
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 23/24
 - 35s - loss: 0.4191 - acc: 0.8642 - val_loss: 3.9354 - val_acc: 0.0938
Epoch 24/24
 - 36s - loss: 0.3799 - acc: 0.8765 - val_loss: 3.7213 - val_acc: 0.0938
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
{'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0022505080736426025, 'height_shift_range': 0.267, 'batch_size': 27, 'num_dense_units_2': 42, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.11772790920544693, 'num_dense_units_0': 313, 'cnn_learning_rate': 1.6223331693445134e-05, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 298}

 ****** ResNet50 unfrozen 1 top blocks, cut_off after layer 160 ******
Epoch 1/8
 - 59s - loss: 0.4493 - acc: 0.8580 - val_loss: 3.7103 - val_acc: 0.1250
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/8
 - 35s - loss: 0.3842 - acc: 0.8889 - val_loss: 3.8324 - val_acc: 0.1094
Epoch 3/8
 - 34s - loss: 0.5536 - acc: 0.8519 - val_loss: 3.8694 - val_acc: 0.0781
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/8
 - 35s - loss: 0.4825 - acc: 0.8642 - val_loss: 4.3256 - val_acc: 0.0625
Epoch 5/8
 - 37s - loss: 0.3807 - acc: 0.8889 - val_loss: 3.9340 - val_acc: 0.0625
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 6/8
 - 34s - loss: 0.5139 - acc: 0.8395 - val_loss: 3.7114 - val_acc: 0.1094
Epoch 7/8
 - 35s - loss: 0.4555 - acc: 0.8642 - val_loss: 3.7821 - val_acc: 0.0938
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/8
 - 36s - loss: 0.4229 - acc: 0.8827 - val_loss: 3.8864 - val_acc: 0.1094
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (5, 0, 5), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (5, 0, 5) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (5, 0, 5) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (5, 0, 5) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (5, 0, 5)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0022505080736426025, 'height_shift_range': 0.267, 'batch_size': 27, 'num_dense_units_2': 42, 'num_dense_layers': 3, 'optimizer': 'RMSProp', 'base_model': 'ResNet50', 'rotation_range': 24, 'unfreeze_percentage': 0.11772790920544693, 'num_dense_units_0': 313, 'cnn_learning_rate': 1.6223331693445134e-05, 'cnn_unlock_epoch': 24, 'num_dense_units_1': 298}, 'working_directory': '.', 'budget': 32.0}
result: {'loss': 0.890625, 'info': {'histories': {'val_loss': [2.4066463708877563, 2.566165566444397, 2.512691855430603, 2.8681660890579224, 3.1475212574005127, 2.9844051599502563, 2.923323631286621, 3.0398197174072266, 3.1070363521575928, 3.2384010553359985, 2.7519198656082153, 3.053624391555786, 3.1467491388320923, 3.21127986907959, 3.1855627298355103, 3.855499744415283, 3.577431559562683, 3.976394772529602, 3.2023836374282837, 3.261225938796997, 3.859673500061035, 4.0577086210250854, 3.9354441165924072, 3.7213131189346313, 3.710299849510193, 3.8323967456817627, 3.869413733482361, 4.325602293014526, 3.934017300605774, 3.711360812187195, 3.7821305990219116, 3.8864121437072754], 'acc': [0.08641975373029709, 0.16049382711450258, 0.20370370522141457, 0.21604938680926958, 0.26543210446834564, 0.5, 0.3024691517154376, 0.3271604950229327, 0.506172850728035, 0.5432098805904388, 0.5617284178733826, 0.5864197760820389, 0.7037037114302317, 0.6728395173947016, 0.6666666666666666, 0.734567920366923, 0.6913580397764841, 0.7530864179134369, 0.7530864179134369, 0.7283950646718343, 0.8518518606821696, 0.8518518606821696, 0.8641975323359171, 0.8765432039896647, 0.8580246965090433, 0.8888889054457346, 0.8518518507480621, 0.8641975323359171, 0.8888888955116272, 0.8395061691602071, 0.8641975422700247, 0.882716049750646], 'loss': [2.903828183809916, 2.3409189780553183, 2.265618880589803, 2.141149123509725, 2.0691608587900796, 1.4483103553454082, 2.0585755507151284, 1.8639198144276936, 1.5922916531562805, 1.3048449158668518, 1.2054517269134521, 1.1274486482143402, 0.9036269088586172, 0.936894545952479, 1.1253401339054108, 0.7957300742467245, 0.9081152925888697, 0.7046880076328913, 0.7302236954371134, 0.8618966440359751, 0.5039980883399645, 0.46596548954645794, 0.41907384246587753, 0.3799019406239192, 0.4493357141812642, 0.38421032577753067, 0.5536016722520193, 0.48251724739869434, 0.38072119156519574, 0.5139141380786896, 0.4554767931501071, 0.4229271411895752], 'val_acc': [0.125, 0.140625, 0.0625, 0.09375, 0.078125, 0.078125, 0.078125, 0.0625, 0.140625, 0.09375, 0.046875, 0.09375, 0.0625, 0.078125, 0.109375, 0.125, 0.109375, 0.109375, 0.109375, 0.109375, 0.09375, 0.078125, 0.09375, 0.09375, 0.125, 0.109375, 0.078125, 0.0625, 0.0625, 0.109375, 0.09375, 0.109375]}, 'runtime': 1313.0010902881622}}
exception: None

DEBUG:hpbandster:job_callback for (5, 0, 5)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 5
DEBUG:hpbandster:HBMASTER: submitting job (5, 0, 4) to dispatcher
DEBUG:hpbandster:DISPATCHER: trying to submit job (5, 0, 4)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (5, 0, 4) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 5
DEBUG:hpbandster:HBMASTER: submitting job (5, 0, 1) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (5, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (5, 0, 4) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (5, 0, 4)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000521720636708256, 'height_shift_range': 0.267, 'batch_size': 27, 'num_dense_units_2': 35, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.09807266515169462, 'num_dense_units_0': 623, 'cnn_learning_rate': 0.0004423776057438744, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 353}, 'working_directory': '.', 'budget': 64.0}
2018-02-08 16:30:22.248437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model InceptionResNetV2
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/29
 - 7s - loss: 2.3989 - acc: 0.0617 - val_loss: 2.5443 - val_acc: 0.1094
Epoch 2/29
 - 5s - loss: 2.3448 - acc: 0.1296 - val_loss: 2.4772 - val_acc: 0.0938
Epoch 3/29
 - 5s - loss: 2.3820 - acc: 0.0556 - val_loss: 2.4504 - val_acc: 0.0938
Epoch 4/29
 - 5s - loss: 2.3813 - acc: 0.0679 - val_loss: 2.4512 - val_acc: 0.0469
Epoch 5/29
 - 5s - loss: 2.3368 - acc: 0.0926 - val_loss: 2.3827 - val_acc: 0.1250
Epoch 6/29
 - 5s - loss: 2.3414 - acc: 0.0741 - val_loss: 2.3616 - val_acc: 0.0938
Epoch 7/29
 - 5s - loss: 2.3299 - acc: 0.1049 - val_loss: 2.3876 - val_acc: 0.1094
Epoch 8/29
 - 5s - loss: 2.3567 - acc: 0.0926 - val_loss: 2.3649 - val_acc: 0.1250
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 9/29
 - 5s - loss: 2.3146 - acc: 0.0926 - val_loss: 2.3651 - val_acc: 0.1250
Epoch 10/29
 - 5s - loss: 2.3063 - acc: 0.0988 - val_loss: 2.3532 - val_acc: 0.1094
Epoch 11/29
 - 5s - loss: 2.2890 - acc: 0.1543 - val_loss: 2.2919 - val_acc: 0.1406
Epoch 12/29
 - 5s - loss: 2.3014 - acc: 0.1111 - val_loss: 2.3177 - val_acc: 0.1406
Epoch 13/29
 - 5s - loss: 2.2786 - acc: 0.1358 - val_loss: 2.3334 - val_acc: 0.1094
Epoch 14/29
 - 5s - loss: 2.2670 - acc: 0.1420 - val_loss: 2.3228 - val_acc: 0.1406
Epoch 15/29
 - 5s - loss: 2.2399 - acc: 0.1667 - val_loss: 2.2875 - val_acc: 0.1562
Epoch 16/29
 - 5s - loss: 2.2824 - acc: 0.1481 - val_loss: 2.3138 - val_acc: 0.1562
Epoch 17/29
 - 5s - loss: 2.2637 - acc: 0.1543 - val_loss: 2.3153 - val_acc: 0.1875
Epoch 18/29
 - 5s - loss: 2.2685 - acc: 0.1420 - val_loss: 2.3274 - val_acc: 0.1719
Epoch 19/29
 - 5s - loss: 2.2755 - acc: 0.1481 - val_loss: 2.2851 - val_acc: 0.2031
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 20/29
 - 6s - loss: 2.2330 - acc: 0.1790 - val_loss: 2.3001 - val_acc: 0.1719
Epoch 21/29
 - 5s - loss: 2.2208 - acc: 0.1975 - val_loss: 2.2668 - val_acc: 0.1875
Epoch 22/29
 - 5s - loss: 2.2332 - acc: 0.2099 - val_loss: 2.2475 - val_acc: 0.2031
Epoch 23/29
 - 5s - loss: 2.2192 - acc: 0.2099 - val_loss: 2.2639 - val_acc: 0.2188
Epoch 24/29
 - 5s - loss: 2.2338 - acc: 0.1605 - val_loss: 2.2976 - val_acc: 0.1875
Epoch 25/29
 - 5s - loss: 2.2202 - acc: 0.1790 - val_loss: 2.3175 - val_acc: 0.1719
Epoch 26/29
 - 5s - loss: 2.2596 - acc: 0.1728 - val_loss: 2.2708 - val_acc: 0.2031
Epoch 27/29
 - 5s - loss: 2.1948 - acc: 0.1790 - val_loss: 2.3184 - val_acc: 0.1562
Epoch 28/29
 - 5s - loss: 2.2238 - acc: 0.1728 - val_loss: 2.2600 - val_acc: 0.2031
Epoch 29/29
 - 6s - loss: 2.2379 - acc: 0.1481 - val_loss: 2.2952 - val_acc: 0.1562
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
{'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000521720636708256, 'height_shift_range': 0.267, 'batch_size': 27, 'num_dense_units_2': 35, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.09807266515169462, 'num_dense_units_0': 623, 'cnn_learning_rate': 0.0004423776057438744, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 353}

 ****** InceptionResNetV2 unfrozen 4 top blocks, cut_off after layer 712 ******
Epoch 1/35
 - 8s - loss: 2.2113 - acc: 0.1728 - val_loss: 2.2346 - val_acc: 0.2031
Epoch 2/35
 - 6s - loss: 2.1912 - acc: 0.1975 - val_loss: 2.2256 - val_acc: 0.2031
Epoch 3/35
 - 6s - loss: 2.1351 - acc: 0.2284 - val_loss: 2.2009 - val_acc: 0.2500
Epoch 4/35
 - 6s - loss: 2.0778 - acc: 0.3086 - val_loss: 2.1694 - val_acc: 0.2344
Epoch 5/35
 - 6s - loss: 2.0219 - acc: 0.3333 - val_loss: 2.1127 - val_acc: 0.2344
Epoch 6/35
 - 6s - loss: 1.9814 - acc: 0.4198 - val_loss: 2.0562 - val_acc: 0.3125
Epoch 7/35
 - 6s - loss: 1.9231 - acc: 0.4198 - val_loss: 1.9623 - val_acc: 0.3125
Epoch 8/35
 - 6s - loss: 1.9030 - acc: 0.4198 - val_loss: 1.9341 - val_acc: 0.3750
Epoch 9/35
 - 6s - loss: 1.8096 - acc: 0.4938 - val_loss: 1.9543 - val_acc: 0.3281
Epoch 10/35
 - 6s - loss: 1.8184 - acc: 0.5123 - val_loss: 1.9046 - val_acc: 0.3438
Epoch 11/35
 - 6s - loss: 1.7237 - acc: 0.5679 - val_loss: 1.9027 - val_acc: 0.3906
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 12/35
 - 6s - loss: 1.7043 - acc: 0.5494 - val_loss: 1.7902 - val_acc: 0.4219
Epoch 13/35
 - 6s - loss: 1.6344 - acc: 0.6049 - val_loss: 1.8015 - val_acc: 0.4062
Epoch 14/35
 - 6s - loss: 1.6190 - acc: 0.6049 - val_loss: 1.8169 - val_acc: 0.3750
Epoch 15/35
 - 6s - loss: 1.5908 - acc: 0.6111 - val_loss: 1.7397 - val_acc: 0.4375
Epoch 16/35
 - 6s - loss: 1.5410 - acc: 0.5988 - val_loss: 1.6962 - val_acc: 0.4844
Epoch 17/35
 - 6s - loss: 1.5055 - acc: 0.6543 - val_loss: 1.7365 - val_acc: 0.5156
Epoch 18/35
 - 6s - loss: 1.4556 - acc: 0.6975 - val_loss: 1.6185 - val_acc: 0.5938
Epoch 19/35
 - 6s - loss: 1.4403 - acc: 0.7284 - val_loss: 1.6626 - val_acc: 0.5625
Epoch 20/35
 - 6s - loss: 1.3591 - acc: 0.7284 - val_loss: 1.5688 - val_acc: 0.6094
Epoch 21/35
 - 6s - loss: 1.3441 - acc: 0.7160 - val_loss: 1.5675 - val_acc: 0.5625
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 22/35
 - 6s - loss: 1.2735 - acc: 0.7160 - val_loss: 1.5062 - val_acc: 0.5781
Epoch 23/35
 - 6s - loss: 1.2581 - acc: 0.7407 - val_loss: 1.4972 - val_acc: 0.6094
Epoch 24/35
 - 6s - loss: 1.2711 - acc: 0.7222 - val_loss: 1.5328 - val_acc: 0.5625
Epoch 25/35
 - 6s - loss: 1.2231 - acc: 0.7716 - val_loss: 1.4670 - val_acc: 0.6250
Epoch 26/35
 - 6s - loss: 1.1676 - acc: 0.7840 - val_loss: 1.4760 - val_acc: 0.5781
Epoch 27/35
 - 6s - loss: 1.1647 - acc: 0.7840 - val_loss: 1.4485 - val_acc: 0.5938
Epoch 28/35
 - 6s - loss: 1.1505 - acc: 0.7778 - val_loss: 1.4403 - val_acc: 0.5781
Epoch 29/35
 - 6s - loss: 1.0974 - acc: 0.8148 - val_loss: 1.3585 - val_acc: 0.6250
Epoch 30/35
 - 6s - loss: 1.0507 - acc: 0.8333 - val_loss: 1.4380 - val_acc: 0.5781
Epoch 31/35
 - 6s - loss: 1.0680 - acc: 0.8148 - val_loss: 1.3979 - val_acc: 0.5781
Epoch 32/35
 - 6s - loss: 1.0355 - acc: 0.8210 - val_loss: 1.3469 - val_acc: 0.6094
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 33/35
 - 6s - loss: 0.9807 - acc: 0.8395 - val_loss: 1.3841 - val_acc: 0.5781
Epoch 34/35
 - 6s - loss: 0.9922 - acc: 0.8210 - val_loss: 1.4167 - val_acc: 0.5625
Epoch 35/35
 - 6s - loss: 0.9678 - acc: 0.8395 - val_loss: 1.2474 - val_acc: 0.6719
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (5, 0, 4), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (5, 0, 4) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (5, 0, 4) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (5, 0, 4) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (5, 0, 4)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.000521720636708256, 'height_shift_range': 0.267, 'batch_size': 27, 'num_dense_units_2': 35, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'InceptionResNetV2', 'rotation_range': 24, 'unfreeze_percentage': 0.09807266515169462, 'num_dense_units_0': 623, 'cnn_learning_rate': 0.0004423776057438744, 'cnn_unlock_epoch': 29, 'num_dense_units_1': 353}, 'working_directory': '.', 'budget': 64.0}
result: {'loss': 0.328125, 'info': {'histories': {'val_loss': [2.5443204641342163, 2.4772093296051025, 2.4504151344299316, 2.451245903968811, 2.3826780319213867, 2.361617088317871, 2.3875731229782104, 2.364946126937866, 2.3650879859924316, 2.353238821029663, 2.2918752431869507, 2.3177268505096436, 2.3334466218948364, 2.322771906852722, 2.2874664068222046, 2.3137558698654175, 2.315315365791321, 2.3273561000823975, 2.2850977182388306, 2.3001129627227783, 2.266798734664917, 2.247488856315613, 2.2638633251190186, 2.2976441383361816, 2.3175350427627563, 2.2708405256271362, 2.318435311317444, 2.2599931955337524, 2.29516339302063, 2.2345688343048096, 2.2256417274475098, 2.2009273767471313, 2.169397473335266, 2.1127063035964966, 2.0561545491218567, 1.9623416066169739, 1.93411386013031, 1.9542563557624817, 1.904564917087555, 1.902719795703888, 1.7902013659477234, 1.801509976387024, 1.8168525099754333, 1.7397346496582031, 1.6961995363235474, 1.7365213632583618, 1.618537187576294, 1.6625739932060242, 1.5688138008117676, 1.5674916505813599, 1.5062140822410583, 1.4971776008605957, 1.5327898263931274, 1.4670006036758423, 1.4759659171104431, 1.4485173225402832, 1.440267562866211, 1.3584690690040588, 1.4380207657814026, 1.3978590965270996, 1.3469318747520447, 1.3841403126716614, 1.416705846786499, 1.2473804950714111], 'acc': [0.06172839552164078, 0.12962963183720908, 0.0555555559694767, 0.06790123507380486, 0.09259259328246117, 0.07407407462596893, 0.10493827238678932, 0.09259259328246117, 0.09259259328246117, 0.09876543407638867, 0.15432099252939224, 0.11111111318071683, 0.1358024701476097, 0.1419753134250641, 0.1666666679084301, 0.1481481504937013, 0.15432099625468254, 0.14197531094153723, 0.1481481504937013, 0.1790123445292314, 0.19753087063630423, 0.2098765509823958, 0.20987654601534209, 0.16049383208155632, 0.1790123482545217, 0.17283950870235762, 0.17901235073804855, 0.17283951118588448, 0.14814815297722816, 0.17283950746059418, 0.19753087436159453, 0.22839507212241492, 0.30864199499289197, 0.3333333407839139, 0.4197530845801036, 0.4197530870636304, 0.419753094514211, 0.4938271641731262, 0.5123456915219625, 0.5679012537002563, 0.5493827313184738, 0.6049382785956064, 0.604938268661499, 0.6111111243565878, 0.5987654527028402, 0.6543209950129191, 0.6975308855374655, 0.7283950646718343, 0.7283950547377268, 0.7160494029521942, 0.7160493930180868, 0.7407407561937968, 0.722222238779068, 0.7716049452622732, 0.7839506367842356, 0.7839506367842356, 0.7777777910232544, 0.8148148159186045, 0.8333333233992258, 0.814814825852712, 0.8209876418113708, 0.8395061790943146, 0.8209876517454783, 0.8395061989625295], 'loss': [2.398896257082621, 2.3448199033737183, 2.382005214691162, 2.3812735080718994, 2.3368353048960366, 2.341445287068685, 2.329853812853495, 2.3567148049672446, 2.314625382423401, 2.306255022684733, 2.288952867190043, 2.301362156867981, 2.2786241372426352, 2.2669687271118164, 2.239919384320577, 2.282392899195353, 2.2636754512786865, 2.2684577306111655, 2.275506019592285, 2.2330313523610434, 2.2207659482955933, 2.233172138532003, 2.219180782636007, 2.233792265256246, 2.2202078104019165, 2.2596299250920615, 2.1947545607884726, 2.223769028981527, 2.2379306157430015, 2.2112711668014526, 2.1911525328954062, 2.1351383129755654, 2.077842036883036, 2.0219489534695945, 1.9813526471455891, 1.9230982462565105, 1.9030259251594543, 1.8095593253771465, 1.818442463874817, 1.7236641844113667, 1.704332212607066, 1.6344411373138428, 1.6190138459205627, 1.5907952189445496, 1.5410144925117493, 1.5055088996887207, 1.4556429982185364, 1.4402572711308796, 1.359061559041341, 1.3441264828046162, 1.273539125919342, 1.258137305577596, 1.2711005409558613, 1.223054548104604, 1.167560378710429, 1.1646653612454732, 1.1505300402641296, 1.0973778168360393, 1.050721287727356, 1.0679779946804047, 1.0354534188906352, 0.9806614617506663, 0.992231676975886, 0.9677879909674326], 'val_acc': [0.109375, 0.09375, 0.09375, 0.046875, 0.125, 0.09375, 0.109375, 0.125, 0.125, 0.109375, 0.140625, 0.140625, 0.109375, 0.140625, 0.15625, 0.15625, 0.1875, 0.171875, 0.203125, 0.171875, 0.1875, 0.203125, 0.21875, 0.1875, 0.171875, 0.203125, 0.15625, 0.203125, 0.15625, 0.203125, 0.203125, 0.25, 0.234375, 0.234375, 0.3125, 0.3125, 0.375, 0.328125, 0.34375, 0.390625, 0.421875, 0.40625, 0.375, 0.4375, 0.484375, 0.515625, 0.59375, 0.5625, 0.609375, 0.5625, 0.578125, 0.609375, 0.5625, 0.625, 0.578125, 0.59375, 0.578125, 0.625, 0.578125, 0.578125, 0.609375, 0.578125, 0.5625, 0.671875]}, 'runtime': 371.62835597991943}}
exception: None

DEBUG:hpbandster:job_callback for (5, 0, 4)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:DISPATCHER: trying to submit job (5, 0, 1)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (5, 0, 1) submitted to dispatcher
DEBUG:hpbandster:HBMASTER: schedule new run for iteration 5
DEBUG:hpbandster:HBMASTER: submitting job (5, 0, 3) to dispatcher
DEBUG:hpbandster:HBMASTER: running jobs: 1, queue sizes: (0, 1) -> wait
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (5, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (5, 0, 1) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (5, 0, 1)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00042410173759327153, 'height_shift_range': 0.267, 'batch_size': 32, 'num_dense_units_2': 166, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.0225853473275863, 'num_dense_units_0': 699, 'cnn_learning_rate': 6.61813807267213e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 101}, 'working_directory': '.', 'budget': 64.0}
2018-02-08 16:36:29.695560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
training model Xception
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/20
 - 6s - loss: 2.4382 - acc: 0.1298 - val_loss: 2.3588 - val_acc: 0.2031
Epoch 2/20
 - 4s - loss: 1.9660 - acc: 0.3315 - val_loss: 2.2264 - val_acc: 0.1719
Epoch 3/20
 - 4s - loss: 1.7370 - acc: 0.4091 - val_loss: 1.9167 - val_acc: 0.3906
Epoch 4/20
 - 5s - loss: 1.4712 - acc: 0.5438 - val_loss: 1.8592 - val_acc: 0.3906
Epoch 5/20
 - 4s - loss: 1.2840 - acc: 0.6233 - val_loss: 1.7953 - val_acc: 0.3438
Epoch 6/20
 - 4s - loss: 1.1844 - acc: 0.7012 - val_loss: 1.7955 - val_acc: 0.4062
Epoch 7/20
 - 4s - loss: 1.0743 - acc: 0.6363 - val_loss: 1.5459 - val_acc: 0.5312
Epoch 8/20
 - 5s - loss: 0.9144 - acc: 0.7625 - val_loss: 1.5239 - val_acc: 0.4844
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 9/20
 - 4s - loss: 1.1363 - acc: 0.6752 - val_loss: 1.5780 - val_acc: 0.4531
Epoch 10/20
 - 4s - loss: 1.0436 - acc: 0.6558 - val_loss: 1.4696 - val_acc: 0.5312
Epoch 11/20
 - 4s - loss: 0.9799 - acc: 0.6817 - val_loss: 1.3829 - val_acc: 0.5938
Epoch 12/20
 - 4s - loss: 0.8468 - acc: 0.8118 - val_loss: 1.4786 - val_acc: 0.4688
Epoch 13/20
 - 5s - loss: 0.6769 - acc: 0.8063 - val_loss: 1.3087 - val_acc: 0.6250
Epoch 14/20
 - 4s - loss: 1.2371 - acc: 0.5387 - val_loss: 1.2563 - val_acc: 0.5938
Epoch 15/20
 - 5s - loss: 0.6837 - acc: 0.7875 - val_loss: 1.1377 - val_acc: 0.6250
Epoch 16/20
 - 4s - loss: 0.9554 - acc: 0.6947 - val_loss: 1.2557 - val_acc: 0.5625
Epoch 17/20
 - 4s - loss: 1.0217 - acc: 0.6298 - val_loss: 1.1227 - val_acc: 0.5781
Epoch 18/20
 - 4s - loss: 1.0393 - acc: 0.5841 - val_loss: 1.1790 - val_acc: 0.6094
Epoch 19/20
 - 4s - loss: 0.8678 - acc: 0.7207 - val_loss: 1.2332 - val_acc: 0.5469
Epoch 20/20
 - 4s - loss: 0.9193 - acc: 0.6880 - val_loss: 1.1851 - val_acc: 0.5781
{'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00042410173759327153, 'height_shift_range': 0.267, 'batch_size': 32, 'num_dense_units_2': 166, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.0225853473275863, 'num_dense_units_0': 699, 'cnn_learning_rate': 6.61813807267213e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 101}

 ****** Xception no layers unfrozen
Epoch 1/44
 - 5s - loss: 0.8278 - acc: 0.7209 - val_loss: 1.4351 - val_acc: 0.4688
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 2/44
 - 5s - loss: 0.7886 - acc: 0.7125 - val_loss: 0.9042 - val_acc: 0.6719
Epoch 3/44
 - 4s - loss: 0.6297 - acc: 0.8694 - val_loss: 0.8124 - val_acc: 0.7188
Epoch 4/44
 - 5s - loss: 0.5583 - acc: 0.8125 - val_loss: 1.0122 - val_acc: 0.6562
Epoch 5/44
 - 4s - loss: 0.6060 - acc: 0.7921 - val_loss: 0.9363 - val_acc: 0.6875
Epoch 6/44
 - 4s - loss: 0.4991 - acc: 0.8572 - val_loss: 1.0682 - val_acc: 0.6094
Epoch 7/44
 - 4s - loss: 0.6736 - acc: 0.7204 - val_loss: 0.8369 - val_acc: 0.7656
Epoch 8/44
 - 4s - loss: 0.6908 - acc: 0.7531 - val_loss: 0.8945 - val_acc: 0.7188
Epoch 9/44
 - 4s - loss: 0.6089 - acc: 0.7596 - val_loss: 0.7899 - val_acc: 0.7812
Epoch 10/44
 - 4s - loss: 0.6284 - acc: 0.8115 - val_loss: 0.8165 - val_acc: 0.7031
Epoch 11/44
 - 5s - loss: 0.4548 - acc: 0.8750 - val_loss: 0.9506 - val_acc: 0.6094
Epoch 12/44
 - 4s - loss: 0.4955 - acc: 0.9351 - val_loss: 0.8624 - val_acc: 0.6406
Epoch 13/44
 - 4s - loss: 0.4698 - acc: 0.8637 - val_loss: 0.8630 - val_acc: 0.7031
Epoch 14/44
 - 4s - loss: 0.7646 - acc: 0.7791 - val_loss: 0.8100 - val_acc: 0.7500
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 15/44
 - 4s - loss: 0.6401 - acc: 0.7923 - val_loss: 1.1167 - val_acc: 0.5938
Epoch 16/44
 - 4s - loss: 0.8642 - acc: 0.6101 - val_loss: 0.8738 - val_acc: 0.6719
Epoch 17/44
 - 4s - loss: 0.6152 - acc: 0.8180 - val_loss: 0.9947 - val_acc: 0.6250
Epoch 18/44
 - 5s - loss: 0.4652 - acc: 0.8375 - val_loss: 0.7511 - val_acc: 0.7656
Epoch 19/44
 - 5s - loss: 0.4051 - acc: 0.8812 - val_loss: 0.6787 - val_acc: 0.8125
Epoch 20/44
 - 4s - loss: 1.0155 - acc: 0.6556 - val_loss: 0.9771 - val_acc: 0.6562
Epoch 21/44
 - 4s - loss: 0.4595 - acc: 0.8702 - val_loss: 0.9096 - val_acc: 0.6406
Epoch 22/44
 - 4s - loss: 0.5723 - acc: 0.7334 - val_loss: 0.9617 - val_acc: 0.7188
Epoch 23/44
 - 5s - loss: 0.4453 - acc: 0.8688 - val_loss: 0.9952 - val_acc: 0.6875
Epoch 24/44
 - 4s - loss: 0.6492 - acc: 0.7399 - val_loss: 0.9184 - val_acc: 0.6719
Epoch 25/44
 - 4s - loss: 0.4697 - acc: 0.8180 - val_loss: 0.8939 - val_acc: 0.6406
Epoch 26/44
 - 4s - loss: 0.8312 - acc: 0.7464 - val_loss: 0.9441 - val_acc: 0.7188
Epoch 27/44
 - 4s - loss: 0.4508 - acc: 0.8637 - val_loss: 0.9643 - val_acc: 0.6406
Epoch 28/44
 - 5s - loss: 0.3874 - acc: 0.9125 - val_loss: 0.9709 - val_acc: 0.6562
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 29/44
 - 4s - loss: 0.6384 - acc: 0.8440 - val_loss: 0.9923 - val_acc: 0.6094
Epoch 30/44
 - 4s - loss: 0.5044 - acc: 0.7594 - val_loss: 0.7233 - val_acc: 0.7188
Epoch 31/44
 - 4s - loss: 0.5317 - acc: 0.8115 - val_loss: 0.9393 - val_acc: 0.7188
Epoch 32/44
 - 5s - loss: 0.5216 - acc: 0.7625 - val_loss: 0.7582 - val_acc: 0.7031
Epoch 33/44
 - 4s - loss: 1.0935 - acc: 0.6296 - val_loss: 1.6180 - val_acc: 0.5312
Epoch 34/44
 - 4s - loss: 1.1985 - acc: 0.6685 - val_loss: 0.7644 - val_acc: 0.7188
Epoch 35/44
 - 4s - loss: 0.7823 - acc: 0.7010 - val_loss: 0.8704 - val_acc: 0.6719
Epoch 36/44
 - 4s - loss: 0.7994 - acc: 0.8115 - val_loss: 0.8910 - val_acc: 0.6719
Epoch 37/44
 - 4s - loss: 0.7446 - acc: 0.8050 - val_loss: 1.0869 - val_acc: 0.6562
Epoch 38/44
 - 4s - loss: 0.7073 - acc: 0.7269 - val_loss: 0.7979 - val_acc: 0.7344
Epoch 39/44
 - 4s - loss: 0.5547 - acc: 0.7921 - val_loss: 0.8880 - val_acc: 0.6875
Epoch 40/44
 - 5s - loss: 0.5180 - acc: 0.8312 - val_loss: 1.0105 - val_acc: 0.6562
Epoch 41/44
 - 4s - loss: 0.5459 - acc: 0.8050 - val_loss: 0.9119 - val_acc: 0.6875
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 42/44
 - 4s - loss: 0.3928 - acc: 0.9026 - val_loss: 1.2357 - val_acc: 0.5938
Epoch 43/44
 - 4s - loss: 0.3169 - acc: 0.9351 - val_loss: 0.9076 - val_acc: 0.6562
Epoch 44/44
 - 4s - loss: 0.3971 - acc: 0.8440 - val_loss: 0.7630 - val_acc: 0.6719
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (5, 0, 1), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (5, 0, 1) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (5, 0, 1) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (5, 0, 1) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (5, 0, 1)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.00042410173759327153, 'height_shift_range': 0.267, 'batch_size': 32, 'num_dense_units_2': 166, 'num_dense_layers': 3, 'optimizer': 'Adam', 'base_model': 'Xception', 'rotation_range': 24, 'unfreeze_percentage': 0.0225853473275863, 'num_dense_units_0': 699, 'cnn_learning_rate': 6.61813807267213e-05, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 101}, 'working_directory': '.', 'budget': 64.0}
result: {'loss': 0.328125, 'info': {'histories': {'val_loss': [2.3588016033172607, 2.2263578176498413, 1.916748046875, 1.8591673970222473, 1.7953409552574158, 1.7954735159873962, 1.5459260940551758, 1.52387273311615, 1.5780407190322876, 1.4696325659751892, 1.3828937411308289, 1.478611171245575, 1.308734655380249, 1.2562609314918518, 1.1377047300338745, 1.2557108402252197, 1.1226952075958252, 1.1789954900741577, 1.2332203388214111, 1.1850892901420593, 1.4351189136505127, 0.9042462706565857, 0.8123735785484314, 1.0121849179267883, 0.9363473653793335, 1.0682438015937805, 0.8369314074516296, 0.8944750726222992, 0.7899485528469086, 0.8165353536605835, 0.950622022151947, 0.8623747825622559, 0.8630324602127075, 0.8100320398807526, 1.1166841983795166, 0.8738347291946411, 0.9947462677955627, 0.7511205077171326, 0.6787402629852295, 0.9770511388778687, 0.9096432626247406, 0.9616706967353821, 0.9952243566513062, 0.9183663725852966, 0.8939092755317688, 0.9441131949424744, 0.9642866253852844, 0.9709053635597229, 0.9922794699668884, 0.7232650816440582, 0.9393450617790222, 0.7581990361213684, 1.6180275082588196, 0.7644312977790833, 0.8703984618186951, 0.8909773826599121, 1.0868847966194153, 0.797921359539032, 0.8880473375320435, 1.0104516744613647, 0.9119282364845276, 1.235720932483673, 0.9076437950134277, 0.7629793584346771], 'acc': [0.15384615384615385, 0.2076923076923077, 0.3923076923076923, 0.54375, 0.6461538461538462, 0.7384615384615385, 0.6615384615384615, 0.7625, 0.7076923076923077, 0.6846153846153846, 0.7153846153846154, 0.7769230769230769, 0.80625, 0.67, 0.7875, 0.7307692307692307, 0.6538461538461539, 0.6923076923076923, 0.7615384615384615, 0.8153846153846154, 0.6692307692307692, 0.7125, 0.81, 0.8125, 0.8461538461538461, 0.8307692307692308, 0.8538461538461538, 0.8, 0.8076923076923077, 0.8692307692307693, 0.875, 0.9230769230769231, 0.8384615384615385, 0.8307692307692308, 0.7538461538461538, 0.7230769230769231, 0.8769230769230769, 0.8375, 0.88125, 0.84, 0.8461538461538461, 0.8692307692307693, 0.86875, 0.8769230769230769, 0.8769230769230769, 0.8846153846153846, 0.8384615384615385, 0.9125, 0.9076923076923077, 0.9, 0.8692307692307693, 0.7625, 0.7461538461538462, 0.7923076923076923, 0.8307692307692308, 0.8692307692307693, 0.8615384615384616, 0.8615384615384616, 0.8461538461538461, 0.83125, 0.8615384615384616, 0.8846153846153846, 0.9230769230769231, 0.9076923076923077], 'loss': [2.405303089435284, 2.1460637184289784, 1.7423312480633075, 1.4712489366531372, 1.275614175429711, 1.1171760815840501, 1.083843100987948, 0.9143725991249084, 0.9242309423593374, 0.9499147855318509, 0.8817467671174269, 0.8076834825369028, 0.6768955111503601, 0.9198597764968872, 0.6837242245674133, 0.7809200873741737, 0.9503327277990488, 0.8692854129351102, 0.6968293740199163, 0.7331267760350154, 0.8858845829963684, 0.7885504126548767, 0.6230523526668549, 0.5583282351493836, 0.5135818609824547, 0.5520524719586739, 0.4989298123579759, 0.5693699598312378, 0.5302131231014545, 0.46886093616485597, 0.454813951253891, 0.37020710064814644, 0.5110346619899456, 0.5037304107959454, 0.6785900317705594, 0.7861376927449153, 0.4102770530260526, 0.4652000814676285, 0.4051498532295227, 0.5101271152496338, 0.43743321712200456, 0.3862361614520733, 0.44531278014183046, 0.3800578264089731, 0.40770125755896935, 0.44266142478355996, 0.46529154594127947, 0.38738396763801575, 0.38102013147794284, 0.3622347905085637, 0.3993017655152541, 0.5216487765312194, 0.6246058757488544, 0.6747178884652945, 0.515840247961191, 0.4984614995809702, 0.48136166425851673, 0.46546859374413124, 0.44534592995276817, 0.5179966747760772, 0.3763920710637019, 0.39322866889146657, 0.27787574162850015, 0.28892420071821945], 'val_acc': [0.203125, 0.171875, 0.390625, 0.390625, 0.34375, 0.40625, 0.53125, 0.484375, 0.453125, 0.53125, 0.59375, 0.46875, 0.625, 0.59375, 0.625, 0.5625, 0.578125, 0.609375, 0.546875, 0.578125, 0.46875, 0.671875, 0.71875, 0.65625, 0.6875, 0.609375, 0.765625, 0.71875, 0.78125, 0.703125, 0.609375, 0.640625, 0.703125, 0.75, 0.59375, 0.671875, 0.625, 0.765625, 0.8125, 0.65625, 0.640625, 0.71875, 0.6875, 0.671875, 0.640625, 0.71875, 0.640625, 0.65625, 0.609375, 0.71875, 0.71875, 0.703125, 0.53125, 0.71875, 0.671875, 0.671875, 0.65625, 0.734375, 0.6875, 0.65625, 0.6875, 0.59375, 0.65625, 0.671875]}, 'runtime': 294.56311106681824}}
exception: None

DEBUG:hpbandster:job_callback for (5, 0, 1)
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: trying to submit job (5, 0, 3)
DEBUG:hpbandster:DISPATCHER: trying to notify the job_runner thread.
DEBUG:hpbandster:HBMASTER: job (5, 0, 3) submitted to dispatcher
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: starting job (5, 0, 3) on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: job (5, 0, 3) dispatched on hpbandster.run_0.worker.tfpool63.7854140186567472896
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 0 -> waiting!
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: start processing job (5, 0, 3)
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: args: ()
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007002512731703047, 'height_shift_range': 0.267, 'batch_size': 16, 'num_dense_units_2': 134, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.262206320971868, 'num_dense_units_0': 469, 'cnn_learning_rate': 0.00034381861413947237, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 222}, 'working_directory': '.', 'budget': 64.0}
2018-02-08 16:41:33.359724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:01:00.0)
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
training model MobileNet
old directory removed data/model_train
old directory removed data/model_valid
copy 34 images for whale # 1, called w_1287fbc
copy 27 images for whale # 2, called w_98baff9
copy 26 images for whale # 3, called w_7554f44
copy 23 images for whale # 4, called w_1eafe46
copy 22 images for whale # 5, called w_693c9ee
copy 22 images for whale # 6, called w_ab4cae2
copy 22 images for whale # 7, called w_fd1cb9d
copy 21 images for whale # 8, called w_43be268
copy 21 images for whale # 9, called w_73d5489
copy 21 images for whale # 10, called w_987a36f
239  images of  10  whales copied in total
Target Directory train:  data/model_train  validation:  data/model_valid
162  images copied as training data
77  images copied as validation data
Found 162 images belonging to 10 classes.
Found 77 images belonging to 10 classes.
Epoch 1/20
 - 60s - loss: 2.5202 - acc: 0.0820 - val_loss: 2.6604 - val_acc: 0.0642
Epoch 2/20
 - 35s - loss: 2.4815 - acc: 0.0938 - val_loss: 2.5665 - val_acc: 0.1101
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/20
 - 35s - loss: 2.2669 - acc: 0.2929 - val_loss: 2.5175 - val_acc: 0.1009
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/20
 - 33s - loss: 2.3524 - acc: 0.1198 - val_loss: 2.5166 - val_acc: 0.1284
Epoch 5/20
 - 35s - loss: 2.3658 - acc: 0.1072 - val_loss: 2.5612 - val_acc: 0.0642
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 6/20
 - 34s - loss: 2.3239 - acc: 0.1750 - val_loss: 2.4431 - val_acc: 0.1009
Epoch 7/20
 - 35s - loss: 2.2890 - acc: 0.0828 - val_loss: 2.4374 - val_acc: 0.1284
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/20
 - 35s - loss: 2.2190 - acc: 0.1828 - val_loss: 2.4244 - val_acc: 0.1101
Epoch 9/20
 - 34s - loss: 2.2337 - acc: 0.2313 - val_loss: 2.4076 - val_acc: 0.1009
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 10/20
 - 34s - loss: 2.1839 - acc: 0.2793 - val_loss: 2.3112 - val_acc: 0.1468
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 11/20
 - 34s - loss: 2.2901 - acc: 0.1639 - val_loss: 2.3355 - val_acc: 0.1560
Epoch 12/20
 - 35s - loss: 2.1954 - acc: 0.2163 - val_loss: 2.3026 - val_acc: 0.1651
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 13/20
 - 35s - loss: 2.1429 - acc: 0.2207 - val_loss: 2.3053 - val_acc: 0.1376
Epoch 14/20
 - 35s - loss: 2.1096 - acc: 0.2522 - val_loss: 2.2579 - val_acc: 0.1835
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 15/20
 - 34s - loss: 2.1356 - acc: 0.3312 - val_loss: 2.2910 - val_acc: 0.1560
Epoch 16/20
 - 34s - loss: 2.0966 - acc: 0.3676 - val_loss: 2.2346 - val_acc: 0.1560
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 17/20
 - 35s - loss: 2.1032 - acc: 0.2900 - val_loss: 2.2198 - val_acc: 0.1927
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 18/20
 - 34s - loss: 2.0878 - acc: 0.2522 - val_loss: 2.2088 - val_acc: 0.1743
Epoch 19/20
 - 34s - loss: 2.1077 - acc: 0.3137 - val_loss: 2.1965 - val_acc: 0.2202
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 20/20
 - 35s - loss: 2.0610 - acc: 0.3172 - val_loss: 2.1344 - val_acc: 0.2385
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
{'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007002512731703047, 'height_shift_range': 0.267, 'batch_size': 16, 'num_dense_units_2': 134, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.262206320971868, 'num_dense_units_0': 469, 'cnn_learning_rate': 0.00034381861413947237, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 222}

 ****** MobileNet unfrozen 7 top blocks, cut_off after layer 60 ******
Epoch 1/44
 - 62s - loss: 2.0277 - acc: 0.3361 - val_loss: 2.1045 - val_acc: 0.2569
Epoch 2/44
 - 35s - loss: 1.8215 - acc: 0.4326 - val_loss: 2.0615 - val_acc: 0.3028
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 3/44
 - 34s - loss: 1.8849 - acc: 0.3152 - val_loss: 1.9245 - val_acc: 0.3578
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 4/44
 - 35s - loss: 1.6712 - acc: 0.4938 - val_loss: 1.8599 - val_acc: 0.4037
Epoch 5/44
 - 34s - loss: 1.7031 - acc: 0.4985 - val_loss: 1.7914 - val_acc: 0.3761
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 6/44
 - 35s - loss: 1.3874 - acc: 0.6937 - val_loss: 1.8542 - val_acc: 0.3578
Epoch 7/44
 - 34s - loss: 1.2875 - acc: 0.6722 - val_loss: 1.6993 - val_acc: 0.4679
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 8/44
 - 34s - loss: 1.3382 - acc: 0.6338 - val_loss: 1.6161 - val_acc: 0.4587
Epoch 9/44
 - 34s - loss: 1.1452 - acc: 0.7188 - val_loss: 1.5787 - val_acc: 0.4404
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 10/44
 - 34s - loss: 1.2233 - acc: 0.7469 - val_loss: 1.6089 - val_acc: 0.4128
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 11/44
 - 35s - loss: 0.9586 - acc: 0.7750 - val_loss: 1.7189 - val_acc: 0.4404
Epoch 12/44
 - 35s - loss: 1.0137 - acc: 0.7207 - val_loss: 1.6707 - val_acc: 0.3853
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 13/44
 - 34s - loss: 0.8835 - acc: 0.8172 - val_loss: 1.5712 - val_acc: 0.4679
Epoch 14/44
 - 34s - loss: 0.8406 - acc: 0.8250 - val_loss: 1.4122 - val_acc: 0.5688
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 15/44
 - 35s - loss: 0.8375 - acc: 0.8535 - val_loss: 1.4133 - val_acc: 0.5229
Epoch 16/44
 - 35s - loss: 0.7647 - acc: 0.7691 - val_loss: 1.4441 - val_acc: 0.5046
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 17/44
 - 35s - loss: 0.7385 - acc: 0.8550 - val_loss: 1.3608 - val_acc: 0.5321
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 18/44
 - 34s - loss: 0.7370 - acc: 0.8562 - val_loss: 1.3528 - val_acc: 0.5872
Epoch 19/44
 - 34s - loss: 0.6182 - acc: 0.9108 - val_loss: 1.3261 - val_acc: 0.5505
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 20/44
 - 35s - loss: 0.5778 - acc: 0.9062 - val_loss: 1.3410 - val_acc: 0.5321
Epoch 21/44
 - 34s - loss: 0.6303 - acc: 0.8531 - val_loss: 1.1593 - val_acc: 0.6606
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 22/44
 - 35s - loss: 0.6647 - acc: 0.8531 - val_loss: 1.2252 - val_acc: 0.6147
Epoch 23/44
 - 34s - loss: 0.5215 - acc: 0.9243 - val_loss: 1.2688 - val_acc: 0.6239
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 24/44
 - 35s - loss: 0.4789 - acc: 0.9559 - val_loss: 1.2756 - val_acc: 0.6422
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 25/44
 - 35s - loss: 0.6084 - acc: 0.8385 - val_loss: 1.1294 - val_acc: 0.6789
Epoch 26/44
 - 34s - loss: 0.4507 - acc: 0.9500 - val_loss: 1.3275 - val_acc: 0.5872
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 27/44
 - 34s - loss: 0.4829 - acc: 0.8720 - val_loss: 1.1969 - val_acc: 0.6422
Epoch 28/44
 - 35s - loss: 0.4147 - acc: 0.9307 - val_loss: 1.2173 - val_acc: 0.6606
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 29/44
 - 35s - loss: 0.4412 - acc: 0.9307 - val_loss: 1.2132 - val_acc: 0.6239
Epoch 30/44
 - 35s - loss: 0.4525 - acc: 0.8886 - val_loss: 1.1569 - val_acc: 0.6330
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 31/44
 - 36s - loss: 0.4135 - acc: 0.9559 - val_loss: 1.1657 - val_acc: 0.6697
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 32/44
 - 35s - loss: 0.3663 - acc: 0.9500 - val_loss: 1.1149 - val_acc: 0.6972
Epoch 33/44
 - 34s - loss: 0.3609 - acc: 0.9622 - val_loss: 1.0369 - val_acc: 0.7064
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 34/44
 - 35s - loss: 0.3472 - acc: 0.9496 - val_loss: 1.1750 - val_acc: 0.6514
Epoch 35/44
 - 34s - loss: 0.5459 - acc: 0.8574 - val_loss: 1.2102 - val_acc: 0.6514
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 36/44
 - 35s - loss: 0.3503 - acc: 0.9937 - val_loss: 0.9571 - val_acc: 0.6972
Epoch 37/44
 - 34s - loss: 0.3181 - acc: 0.9500 - val_loss: 1.0002 - val_acc: 0.6881
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 38/44
 - 34s - loss: 0.6819 - acc: 0.7581 - val_loss: 1.0975 - val_acc: 0.7064
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 39/44
 - 34s - loss: 0.3964 - acc: 0.9187 - val_loss: 1.2004 - val_acc: 0.6239
Epoch 40/44
 - 35s - loss: 0.3478 - acc: 0.9745 - val_loss: 1.0029 - val_acc: 0.7248
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 41/44
 - 35s - loss: 0.3096 - acc: 0.9437 - val_loss: 1.0439 - val_acc: 0.7156
Epoch 42/44
 - 34s - loss: 0.3527 - acc: 0.9809 - val_loss: 0.9995 - val_acc: 0.7156
DEBUG:hpbandster:DISPATCHER: Starting worker discovery
DEBUG:hpbandster:DISPATCHER: Found 1 potential workers, 1 currently in the pool.
DEBUG:hpbandster:DISPATCHER: Finished worker discovery
Epoch 43/44
 - 34s - loss: 0.2397 - acc: 0.9563 - val_loss: 1.0018 - val_acc: 0.7064
Epoch 44/44
 - 34s - loss: 0.2603 - acc: 0.9811 - val_loss: 1.0495 - val_acc: 0.6972
DEBUG:hpbandster.run_0.worker.tfpool63.7854:WORKER: done with job (5, 0, 3), trying to register it.
INFO:hpbandster.run_0.worker.tfpool63.7854:WORKER: registered result for job (5, 0, 3) with dispatcher
DEBUG:hpbandster:DISPATCHER: job (5, 0, 3) finished
DEBUG:hpbandster:DISPATCHER: register_result: lock acquired
DEBUG:hpbandster:DISPATCHER: job (5, 0, 3) on hpbandster.run_0.worker.tfpool63.7854140186567472896 finished
DEBUG:hpbandster:job_id: (5, 0, 3)
args: ()
kwargs: {'config': {'activation': 'tanh', 'width_shift_range': 0.013, 'zoom_range': 0.273, 'learning_rate': 0.0007002512731703047, 'height_shift_range': 0.267, 'batch_size': 16, 'num_dense_units_2': 134, 'num_dense_layers': 3, 'optimizer': 'SGD', 'base_model': 'MobileNet', 'rotation_range': 24, 'unfreeze_percentage': 0.262206320971868, 'num_dense_units_0': 469, 'cnn_learning_rate': 0.00034381861413947237, 'cnn_unlock_epoch': 20, 'num_dense_units_1': 222}, 'working_directory': '.', 'budget': 64.0}
result: {'loss': 0.3027522913906553, 'info': {'histories': {'val_loss': [2.660371579161478, 2.566521071512765, 2.517473710786312, 2.516617376869972, 2.5612294302074186, 2.4431232093671045, 2.4373890544296404, 2.4244105465915227, 2.4075705895730115, 2.311243809691263, 2.3354745742377885, 2.302611427569608, 2.30534937184885, 2.2578936563719303, 2.2910106335211236, 2.23457794014467, 2.219753208510373, 2.2088274387044646, 2.1965227455174157, 2.1344110265784306, 2.104486241253144, 2.061536546147198, 1.9245389021864725, 1.8598604858468433, 1.7913644193509304, 1.854185177645552, 1.6992664862116542, 1.616104045045485, 1.5786627924770391, 1.6088736363507192, 1.7188988541244368, 1.6706503815607194, 1.5711596646440138, 1.4122082191869754, 1.4132514142115182, 1.4441121160437207, 1.360783788042331, 1.3528005792460311, 1.326144460144393, 1.3410220900806813, 1.1592726379359535, 1.2252262513571923, 1.2687675045170914, 1.275570462603088, 1.1293526887893677, 1.3275180387934413, 1.196892520703307, 1.2173161353539983, 1.2131686527794654, 1.1568970111531949, 1.1657384185616029, 1.1149120281595704, 1.036888895778481, 1.1749654188068634, 1.2102174824530925, 0.9571059329794087, 1.0002323733557255, 1.0974917608663577, 1.2003693864979874, 1.0029225360362901, 1.0439246532020219, 0.9994924762927064, 1.0018110603367516, 1.0494878160844154], 'acc': [0.08904109589041095, 0.09375, 0.1590909090909091, 0.13013698630136986, 0.11643835616438356, 0.175, 0.09848484848484848, 0.19863013698630136, 0.23125, 0.2602739726027397, 0.1780821917808219, 0.1917808219178082, 0.23972602739726026, 0.273972602739726, 0.33125, 0.3561643835616438, 0.3150684931506849, 0.273972602739726, 0.32575757575757575, 0.3013698630136986, 0.3219178082191781, 0.3835616438356164, 0.3424657534246575, 0.49375, 0.5454545454545454, 0.69375, 0.6438356164383562, 0.6590909090909091, 0.71875, 0.8409090909090909, 0.775, 0.7397260273972602, 0.8013698630136986, 0.825, 0.8257575757575758, 0.8356164383561644, 0.8424657534246576, 0.85625, 0.8939393939393939, 0.90625, 0.8835616438356164, 0.8835616438356164, 0.9178082191780822, 0.952054794520548, 0.910958904109589, 0.95, 0.9041095890410958, 0.9246575342465754, 0.9246575342465754, 0.9621212121212122, 0.952054794520548, 0.95, 0.958904109589041, 0.9452054794520548, 0.9315068493150684, 0.9931506849315068, 0.95, 0.9015151515151515, 0.91875, 0.9696969696969697, 0.94375, 0.9772727272727273, 0.95625, 0.9794520547945206], 'loss': [2.478584217698607, 2.4815049171447754, 2.4084606206778325, 2.3452821431094653, 2.3434226480248856, 2.323859453201294, 2.313712549932075, 2.2185517337224256, 2.233728051185608, 2.1933818386025625, 2.303049521903469, 2.201859624418494, 2.1612194776535034, 2.1215196994886005, 2.1355541348457336, 2.0671373262797315, 2.047004222869873, 2.0568322384194153, 2.0768285989761353, 2.043312219724263, 2.027008693512172, 1.8491608867906544, 1.8589054852315825, 1.671167504787445, 1.5964127291332593, 1.3874101638793945, 1.2759359960686671, 1.2457059621810913, 1.1451993763446808, 1.0248119668527083, 0.9585980653762818, 0.9960484814970461, 0.8660573142848603, 0.8406203210353851, 0.7966723261457501, 0.715455850509748, 0.7453283291973479, 0.7370465278625489, 0.5649177901672594, 0.5777808248996734, 0.5494465991242291, 0.6041542356961394, 0.5197593324804959, 0.467197790537795, 0.5112072441675891, 0.4507435768842697, 0.43620198883422434, 0.40174255060822994, 0.4226034014192346, 0.3411915771888964, 0.3687031244578427, 0.3662714213132858, 0.33282404729764753, 0.3394172256940032, 0.36727191814004556, 0.283942312410433, 0.3180580735206604, 0.3653014193881642, 0.39642641842365267, 0.2873120533697533, 0.3095638036727905, 0.2630895358143431, 0.23966630697250366, 0.2598905432714175], 'val_acc': [0.06422018382800829, 0.11009174346103581, 0.10091743153443031, 0.12844036697247707, 0.06422018540014915, 0.10091743187620006, 0.12844036765601657, 0.11009174448634507, 0.10091743187620006, 0.14678899082568808, 0.1559633034358331, 0.1651376190535519, 0.13761467889908258, 0.18348624044602072, 0.1559633034358331, 0.1559633027522936, 0.1926605518257946, 0.17431192694727435, 0.22018348815244274, 0.23853211200565372, 0.25688073585886473, 0.3027522949450607, 0.3577981665046937, 0.4036697266845528, 0.37614679281864694, 0.3577981678717727, 0.46788991044420714, 0.4587155971505226, 0.44036697630488547, 0.41284404107190054, 0.44036697575805384, 0.3853211041984208, 0.46788991099103877, 0.5688073492925102, 0.5229357885658195, 0.5045871567835502, 0.5321100950241089, 0.5871559654900788, 0.5504587177836567, 0.5321100944772773, 0.660550461996586, 0.6146789012698952, 0.6238532208521431, 0.6422018375965434, 0.6788990847561338, 0.5871559654900788, 0.6422018370497118, 0.660550467464902, 0.6238532142901639, 0.6330275256699378, 0.6697247793915075, 0.697247715171324, 0.7064220183486238, 0.6513761555382965, 0.6513761489763172, 0.6972477146244924, 0.6880734032447186, 0.7064220194422871, 0.6238532148369955, 0.7247706443891613, 0.7155963330093874, 0.7155963324625557, 0.7064220281915927, 0.6972477086093447]}, 'runtime': 2335.920393705368}}
exception: None

DEBUG:hpbandster:job_callback for (5, 0, 3)
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:HBMASTER: Trying to run another job!
DEBUG:hpbandster:DISPATCHER: jobs to submit = 0, number of idle workers = 1 -> waiting!
DEBUG:hpbandster:HBMASTER: shutdown initiated, shutdown_workers = True
INFO:hpbandster:DISPATCHER: Dispatcher shutting down
DEBUG:hpbandster:DISPATCHER: Trying to submit another job.
DEBUG:hpbandster:DISPATCHER: job_runner shutting down
DEBUG:hpbandster:DISPATCHER: discover_workers shutting down
DEBUG:hpbandster:DISPATCHER: 'discover_worker' thread exited
DEBUG:hpbandster:DISPATCHER: 'job_runner' thread exited
INFO:hpbandster:DISPATCHER: shut down complete
